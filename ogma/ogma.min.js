/**
 * Ogma
 * @description Graph visualization library
 * @version 3.0.5 (built on Mon Jun 29 2020 17:35:08 GMT+0200 (Central European Summer Time))
 * @author Linkurious SAS
 * @license (c) Linkurious 2020. All rights reserved.
 * @preserve
 */
/* eslint-disable */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Ogma=e()}(this,function(){"use strict";function d(t){return"function"==typeof t||"[object Function]"===e.call(t)}function h(value){var t=function(value){var t=Number(value);return isNaN(t)?0:0!==t&&isFinite(t)?(0<t?1:-1)*Math.floor(Math.abs(t)):t}(value);return Math.min(Math.max(t,0),i)}var e,i;Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(value){if(null==this)throw new TypeError("this is null or not defined");for(var t=Object(this),e=t.length>>>0,i=arguments[1]>>0,r=i<0?Math.max(e+i,0):Math.min(i,e),n=arguments[2],o=void 0===n?e:n>>0,s=o<0?Math.max(e+o,0):Math.min(o,e);r<s;)t[r]=value,r++;return t}}),Array.prototype.copyWithin||(Array.prototype.copyWithin=function(t,e){if(null==this)throw new TypeError("this is null or not defined");var i=Object(this),r=i.length>>>0,n=t>>0,o=n<0?Math.max(r+n,0):Math.min(n,r),s=e>>0,a=s<0?Math.max(r+s,0):Math.min(s,r),u=arguments[2],l=void 0===u?r:u>>0,d=l<0?Math.max(r+l,0):Math.min(l,r),h=Math.min(d-a,r-o),c=1;for(a<o&&o<a+h&&(c=-1,a+=h-1,o+=h-1);0<h;)a in i?i[o]=i[a]:delete i[o],a+=c,o+=c,h--;return i}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(t){if(null==this)throw new TypeError;var e=Object(this),i=e.length>>>0;if(0==i)return-1;var r=i-1;1<arguments.length&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(0<r?1:-1)*Math.floor(Math.abs(r))));for(var n=0<=r?Math.min(r,i-1):i-Math.abs(r);0<=n;n--)if(n in e&&e[n]===t)return n;return-1}),Array.from||(Array.from=(e=Object.prototype.toString,i=Math.pow(2,53)-1,function(t,e,i){var r=Object(t);if(null==t)throw new TypeError("Array.from requires an array-like object - not null or undefined");var n,o=1<arguments.length?e:void 0;if(void 0!==o){if(!d(o))throw new TypeError("Array.from: when provided, the second argument must be a function");2<arguments.length&&(n=i)}for(var s,a=h(r.length),u=d(this)?Object(new this(a)):new Array(a),l=0;l<a;)s=r[l],u[l]=o?void 0===n?o(s,l):o.call(n,s,l):s,l+=1;return u.length=a,u})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var i=Object(this),r=i.length>>>0;if(0==r)return!1;var n,o,s=0|e,a=Math.max(0<=s?s:r-Math.abs(s),0);for(;a<r;){if((n=i[a])===(o=t)||"number"==typeof n&&"number"==typeof o&&isNaN(n)&&isNaN(o))return!0;a++}return!1}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),i=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var r=arguments[1],n=0;n<i;){var o=e[n];if(t.call(r,o,n,e))return o;n++}},configurable:!0,writable:!0});var r=[Uint32Array,Uint16Array,Uint8Array,Int32Array,Int16Array,Int8Array,Float32Array,Float64Array],n=["join","slice","reverse","forEach","map","includes","copyWithin","reduce","indexOf","sort","filter","every","some","fill"];ArrayBuffer.isView||(ArrayBuffer.isView=function(t){for(var e=0;e<r.length;++e)if(t instanceof r[e])return!0;return!1});for(var o,s=function(i){return function(t,e){return new i(Array.prototype.slice.call(this,t,e))}},t=function(a){for(var t=0,e=n;t<e.length;t++){var i=e[t];if(!a.prototype[i]){var r="slice"===i?s(a):Array.prototype[i];a.prototype[i]=r}}a.from||(a.from=function(t,e,i){var r=a.__proto__;if("function"!=typeof this)throw new TypeError("# is not a constructor");if(this.__proto__!==r)throw new TypeError("this is not a typed array.");if("function"!=typeof(e=e||function(t){return t}))throw new TypeError("specified argument is not a function");if(!(t=Object(t)).length)return new this(0);for(var n=[],o=0;o<t.length;o++)n.push(t[o]);var s=new this((n=n.map(e,i)).length);for(o=0;o<s.length;o++)s[o]=n[o];return s})},a=0,u=r;a<u.length;a++){t(u[a])}function l(){}function c(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],m(t,this)}function f(i,r){for(;3===i._state;)i=i._value;0!==i._state?(i._handled=!0,c._immediateFn(function(){var t=1===i._state?r.onFulfilled:r.onRejected;if(null!==t){var e;try{e=t(i._value)}catch(t){return void p(r.promise,t)}g(r.promise,e)}else(1===i._state?g:p)(r.promise,i._value)})):i._deferreds.push(r)}function g(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if(t instanceof c)return e._state=3,e._value=t,void _(e);if("function"==typeof i)return void m((r=i,n=t,function(){r.apply(n,arguments)}),e)}e._state=1,e._value=t,_(e)}catch(t){p(e,t)}var r,n}function p(t,e){t._state=2,t._value=e,_(t)}function _(t){2===t._state&&0===t._deferreds.length&&c._immediateFn(function(){t._handled||c._unhandledRejectionFn(t._value)});for(var e=0,i=t._deferreds.length;e<i;e++)f(t,t._deferreds[e]);t._deferreds=null}function v(t,e,i){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=i}function m(t,e){var i=!1;try{t(function(value){i||(i=!0,g(e,value))},function(t){i||(i=!0,p(e,t))})}catch(t){if(i)return;i=!0,p(e,t)}}"undefined"==typeof CanvasRenderingContext2D||CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(t){}),Math.log2||(Math.log2=function(t){return Math.log(t)*Math.LOG2E}),Math.sign||(Math.sign=function(t){return(0<t?1:0)-(t<0?1:0)||+t}),Number.isNaN||(Number.isNaN=function(value){return"number"==typeof value&&isNaN(value)}),Number.MAX_SAFE_INTEGER||Object.defineProperty(Number,"MAX_SAFE_INTEGER",{enumerable:!1,configurable:!1,writable:!1,value:Math.pow(2,53)-1}),o=setTimeout,c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var i=new this.constructor(l);return f(this,new v(t,e,i)),i},c.all=function(t){var a=Array.prototype.slice.call(t);return new c(function(r,n){if(0===a.length)return r([]);var o=a.length;function s(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var i=t.then;if("function"==typeof i)return void i.call(t,function(t){s(e,t)},n)}a[e]=t,0==--o&&r(a)}catch(t){n(t)}}for(var t=0;t<a.length;t++)s(t,a[t])})},c.resolve=function(value){return value&&"object"==typeof value&&value.constructor===c?value:new c(function(t){t(value)})},c.reject=function(value){return new c(function(t,e){e(value)})},c.race=function(n){return new c(function(t,e){for(var i=0,r=n.length;i<r;i++)n[i].then(t,e)})},c._immediateFn="object"==typeof global&&"function"==typeof global.setImmediate?function(t){global.setImmediate(t)}:function(t){o(t,0)},c._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},c._setImmediateFn=function(t){c._immediateFn=t},c._setUnhandledRejectionFn=function(t){c._unhandledRejectionFn=t},"object"!=typeof global||global.Promise||(global.exports=c),"object"!=typeof window||"Promise"in window||(window.Promise=c),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var r=i.lastIndexOf(t,e);return-1!==r&&r===e}),String.prototype.startsWith||(String.prototype.startsWith=function(t,e){return this.substr(e||0,t.length)===t}),String.prototype.includes||(String.prototype.includes=function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(t){var e=arguments;if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(t),r=1;r<arguments.length;r++){var n=e[r];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])}return i},writable:!0,configurable:!0});var y=function(t,e){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function x(t,e){function i(){this.constructor=t}y(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var I=function(){return(I=Object.assign||function(t){for(var e,i=arguments,r=1,n=arguments.length;r<n;r++)for(var o in e=i[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function b(t,e){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(i[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(t);n<r.length;n++)e.indexOf(r[n])<0&&Object.prototype.propertyIsEnumerable.call(t,r[n])&&(i[r[n]]=t[r[n]])}return i}function E(){for(var t=arguments,e=0,i=0,r=arguments.length;i<r;i++)e+=t[i].length;var n=Array(e),o=0;for(i=0;i<r;i++)for(var s=arguments[i],a=0,u=s.length;a<u;a++,o++)n[o]=s[a];return n}var A={},S={},w={},T=function(t){return null};if("object"==typeof global&&(S=global),"object"==typeof window&&(w=window),"object"==typeof module&&"function"==typeof module.require){var C=module.require.bind(module);T=function(t){try{return C(t)}catch(t){return null}}}else"function"==typeof S.require&&(T=function(t){var e=module.require;try{return e(t)}catch(t){return null}});function M(t,e){var i=(void 0===e?{}:e).throwOnError,r=null;if(!r&&t&&(r=A[t]),!r&&t&&(r=T(t)),!r&&t&&(r=w[t]),!r&&t&&(r=S[t]),r||!i)return r;var n=['unable to find module "'+t+'"; make sure one of these statements is true:',"- Ogma.libraries['"+t+"'] is set to the right library","- require('"+t+"') returns the right library","- window['"+t+"'] is set to the right library"].join("\n");throw new Error(n)}function X(t,e){for(var i=1,r=t.length;i<r;i++){for(var n=t[i],o=i;0<o&&e.get(t[o-1])>e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t}function L(value){return Array.isArray(value)||ArrayBuffer.isView(value)}function N(value){return Array.isArray(value)?value:[value]}function O(t){for(var e=[],i=0;i<t.length;++i){var r=t[i];if(Array.isArray(r))for(var n=0;n<r.length;++n)e.push(r[n]);else e.push(r)}return e}function k(t,e){var i=t.indexOf(e);return-1!==i&&(t.splice(i,1),!0)}function F(t,e){for(var i,r,n=0,o=t.length-1;n<=o;)if((r=t[i=(n+o)/2|0])<e)n=1+i;else{if(!(e<r))return i;o=i-1}return-1}function R(t){if(!t)return[];if("string"==typeof t)return t.split(".");if(Array.isArray(t)){for(var e=0;e<t.length;++e)if("string"!=typeof t[e])throw new TypeError(t[e]+" is not a string");return t.slice()}throw new TypeError('invalid property path "'+t+'": expected string or array of strings')}function P(e,i,r){var n,o,t;if(0===i)return function(){e.apply(r,arguments)};function s(){n=!1,o&&(t.apply(r,o),o=null)}return t=function(){var t;return n?o=arguments:(t=e.apply(r,arguments),setTimeout(s,i),n=!0),t}}function D(){return 120===new Uint8Array(new Uint32Array([305419896]).buffer)[0]}function z(t){return t.reduce(function(t,e){return t.then(e)},Promise.resolve())}function B(t,e,i,r,n,o,s,a){return t+n+256*(e+o)+65536*(i+s)+16777216*(r+a)}function U(t){return!(null===t||"object"!=typeof t||L(t)||t instanceof RegExp||"undefined"!=typeof HTMLElement&&t instanceof HTMLElement)}function V(t){for(var e=Object.keys(t),i=new Array(e.length),r=0;r<e.length;++r)i[r]=t[e[r]];return i}function j(t,e,i){if(Array.isArray(t))return t.forEach(e,i);if(!U(t))throw new Error("forEach: invalid argument "+JSON.stringify(t));var r=Object.keys(t);if(void 0!==i)for(var n=0;n<r.length;++n){var o=r[n];e.call(i,t[o],o)}else for(n=0;n<r.length;++n){e(t[o=r[n]],o)}}function G(t){if(Array.isArray(t)){for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=G(t[i]);return e}if(!$(t))return t;var r={},n=Object.keys(t);for(i=0;i<n.length;++i){var o=n[i];r[o]=G(t[o])}return r}function H(t,e,value){for(var i="string"==typeof e?e.split("."):e,r=0;r<i.length-1;++r){var n=i[r],o=t[n];o||(o={},t[n]=o),t=o}t[i[i.length-1]]=value}function W(t,e){var i=R(e);if(!i.length)return t;if(t){for(var r=0;r<i.length-1;++r){var n=t[i[r]];if(!n)return;t=n}return t[i[i.length-1]]}}function q(t,e,i){void 0===i&&(i="."),e=e||function(t){return!U(t)};for(var r={},n=Object.keys(t),o=0;o<n.length;++o){var s=n[o],value=t[s];if(e(value))r[s]=value;else for(var a=q(value,e),u=Object.keys(a),l=0;l<u.length;l++){var d=u[l];r[""+s+i+d]=a[d]}}return r}function Y(t){for(var e={},i=Object.keys(t),r=0;r<i.length;++r){var n=i[r];H(e,n,t[n])}return e}function Z(t,e,i){void 0===i&&(i=[]);for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n],value=t[o],s=e?e+o:o;$(value)?Z(value,s+".",i):i.push(s)}return i}function K(t,e){if(void 0===e&&(e=[]),$(t))for(var i=0,r=Object.keys(t);i<r.length;i++){K(t[r[i]],e)}else e.push(t);return e}function Q(t){for(var e in t)"function"==typeof t[e]&&delete t[e];return t}function J(value,t){if(void 0===value)return G(t);if(!U(value))return value;for(var e={},i=0,r=Object.keys(t);i<r.length;i++){var n=r[i],o=t[n],s=value[n];U(o)?e[n]=J(s,o):e[n]=void 0===s?G(o):s}return e}function $(value){return value&&(value.constructor===Object||!value.constructor)}function tt(t,e){if(!$(e)||!$(t))return e;for(var i=Object.assign({},t),r=Object.keys(e),n=0;n<r.length;++n){var o=r[n];i[o]=tt(i[o],e[o])}return i}function et(i,t){return null==t?i:t.reduce(function(t,e){return t[e]=i[e],t},{})}var it,rt=(it=0,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:function(t){var e=Date.now(),i=Math.min(16,Math.max(0,16-(e-it))),r=it=e+i;return setTimeout(function(){return t(r)},i)}),nt="undefined"!=typeof cancelAnimationFrame?cancelAnimationFrame:function(t){return clearTimeout(t)};function ot(e,i){return rt(function(t){e.call(i,t)})}function st(t){t&&nt(t)}var at,ut,lt,dt,ht="object"==typeof global&&null!==global&&void 0!==global.it,ct="undefined"!=typeof document,ft="undefined"!=typeof window,gt=ft&&!window.__OGMA_HEADLESS,pt=gt&&ct,_t=(vt.prototype.open=function(t,e){this.method=t,this.url=e,vt.onSend&&vt.onSend(this)},vt.prototype.respond=function(t,e,i){this.readyState=4,this.status=t,this.headers=e,this.responseText=i,this.response=i,this.onreadystatechange()},vt.prototype.send=function(){this.readyState=4},vt.onCreate=function(){},vt.onSend=function(){},vt);function vt(){this.method=null,this.url=null,this.status=0,this.readyState=0,this.headers={},this.responseText=null,this.response=null,vt.onCreate&&vt.onCreate(this)}var mt=(yt.prototype.readAsDataURL=function(t){this._blob=t,yt.onRead&&yt.onRead(this)},yt.prototype.load=function(t){this.result="function"==typeof t?t(this._blob):t,this.onload&&this.onload()},yt.onCreate=function(){},yt.onRead=function(){},yt);function yt(){this.onload=function(){},yt.onCreate&&yt.onCreate(this)}function xt(){return ut||{createElementNS:function(){return null},createElement:function(){return null},implementation:{createDocument:function(){throw new Error('unable to create XML document; if you use Node JS install the "xmldom" package')}}}}function bt(t,e){if(document&&document.defaultView){var value=t.style[e];if((!value||"auto"===value)&&xt().defaultView){var i=document.defaultView.getComputedStyle(t,null);value=i?i[e]:null}return"auto"===value?null:value}return null}at=M("xmldom"),ut=ct?document:at?(new at.DOMImplementation).createDocument():null,lt="undefined"!=typeof XMLHttpRequest?XMLHttpRequest:_t,dt="undefined"!=typeof FileReader?FileReader:mt;var Et=(Object.defineProperty(At.prototype,"offsetWidth",{get:function(){return parseFloat(this.style.width||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(At.prototype,"offsetHeight",{get:function(){return parseFloat(this.style.height||"0")},enumerable:!0,configurable:!0}),Object.defineProperty(At.prototype,"firstChild",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(At.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(At.prototype,"classList",{get:function(){return{length:0,value:"",add:function(){},remove:function(){},contains:function(t){return!1},item:null}},enumerable:!0,configurable:!0}),Object.defineProperty(At.prototype,"innerHTML",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),At.prototype.appendChild=function(){},At.prototype.removeChild=function(){},At.prototype.addEventListener=function(){},At.prototype.removeEventListener=function(){},At.prototype.insertBefore=function(){},At.prototype.contains=function(t){return!1},At);function At(){this.onmousewheel=function(){},this.__dummy=!0,this.style={},this.clientWidth=0,this.clientHeight=0,this.childNodes=[],this.style={width:"0px",height:"0px",top:void 0,left:void 0,position:"",backgroundColor:void 0}}function St(){return new Et}var wt=ft?function(){return window.devicePixelRatio}:function(){return 1};function Tt(t){var e,i,r,n=";base64,";if(-1===t.indexOf(n))return i=(e=t.split(","))[0].split(":")[1],Mt(r=decodeURIComponent(e[1]),i);i=(e=t.split(n))[0].split(":")[1];for(var o=(r=window.atob(e[1])).length,s=new Uint8Array(o),a=0;a<o;++a)s[a]=r.charCodeAt(a);return Mt([s],i)}var Ct=function(t,e){this.data=t,this.type=e};function Mt(t,e){return"undefined"!=typeof Blob?new Blob(t,{type:e}):new Ct(t,e)}function It(t,e,i){if(!gt)return t;var r,n,o=null,s=null,a=null;if(window.Blob?(r=t,o="blob"===(n=i)?r:"dataURL"===n?Tt(r):Mt([r],"text/xml"),s=window.URL.createObjectURL(o)):a="data:text/xml;charset=UTF-8,"+encodeURIComponent('<?xml version="1.0" encoding="UTF-8"?>')+encodeURIComponent(t),navigator.msSaveBlob)navigator.msSaveBlob(o,e);else if(navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(o,e);else{var u=document.createElement("a");u.setAttribute("href",s||a),u.setAttribute("download",e),document.body.appendChild(u),u.click(),document.body.removeChild(u)}return s&&setTimeout(function(){window.URL.revokeObjectURL(s)},0),t}function Lt(t,e,i,r){if(void 0===r&&(r=wt()),t.style.width=e+"px",t.style.height=i+"px","IMG"===t.tagName||"CANVAS"===t.tagName){var n=t;n.width=e*r,n.height=i*r}}function Nt(e,t){j(t,function(value,t){void 0!==value&&e.setAttribute(t,value)})}var Ot="http://www.w3.org/2000/svg",kt="http://www.w3.org/2000/xmlns/",Ft="http://www.w3.org/1999/xlink";function Rt(t,e){var i=ut.createElementNS(Ot,t);return i.style||(i.style={}),e&&Nt(i,e),i}function Pt(t){if(ut)return ut.createTextNode(t)}function Dt(i){return"undefined"==typeof Image?Promise.resolve(null):new Promise(function(t){var e=new Image;e.src=i,e.onload=function(){return t(e)},e.onerror=function(){return t(null)}})}function zt(t){if(0===t.indexOf("http://")||0===t.indexOf("https://"))return t;var e=window.location.origin,i=window.location.pathname,r=i.lastIndexOf("/");return-1===r?e+"/"+t:e+i.substr(0,r)+"/"+t}function Bt(n){return new Promise(function(e,i){var r=new lt;r.open("GET",zt(n),!0),r.onreadystatechange=function(){if(4===r.readyState){var t=r.status;200===t?e(r.responseText):i(0!==t?new Error('cannot retrieve file at url "'+n+'"; the server responded with status code '+t+"."):new Error('cannot send XMLHttpRequest to url "'+n+"\"; if you're using the local file protocol this is most likely the cause."))}},r.onerror=function(){i(new Error('cannot retrieve file at url "'+n+'"; the XMLHttpRequest failed.'))},r.send()})}function Ut(t){return"undefined"!=typeof HTMLElement&&t instanceof HTMLElement}function Vt(t,e){t.style.cursor=e,t.style.cursor!==e&&(t.style.cursor="-webkit-"+e)}function jt(r){return new Promise(function(t,e){var i=new lt;i.responseType="blob",i.open("GET",zt(r),!0),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(i.response):e(i.status))},i.onerror=function(t){return e(t)},i.send()})}function Gt(t){return jt(t).then(function(r){return new Promise(function(t,e){var i=new dt;i.onerror=e,i.onload=function(){return t(i.result)},i.readAsDataURL(r)})})}function Ht(t,e){void 0===e&&(e=!0);var i=e?"&#13;":"\n";return(""+t).replace(/&/g,"&amp;").replace(/'/g,"&apos;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r\n/g,i).replace(/[\r\n]/g,i)}var Wt={0:"left",1:"middle",2:"right"};function qt(t){if(t.baseURI)return t.baseURI;var e=t.getElementsByTagName("base");return 0<e.length?e[0].href:t.URL||t.location.href}function Xt(o,t,s,a){return new Promise(function(e){var i=t,r=Date.now(),n=(s-t)*Math.min(1,1/(a/16));!function t(){Date.now()-r<a?(i=Math.min(1,Math.max(0,i+n)),o.style.opacity=i.toString(),ot(t)):e()}()})}var Yt="undefined"!=typeof performance&&performance.now?function(){return 0|performance.now()}:function(){return Date.now()},Zt=Yt();function Kt(){return Yt()-Zt}function Qt(){var t=new Date,e=t.getDate(),i=t.getMonth()+1;return t.getFullYear()+"-"+(i<10?"0"+i:i)+"-"+(e<10?"0"+e:e)}function Jt(){var t=new Date;return"["+$t((t.getUTCHours()-(t.getTimezoneOffset()/60|0))%24)+":"+$t(t.getUTCMinutes())+":"+$t(t.getUTCSeconds())+":"+$t(t.getUTCMilliseconds(),3)+"]"}function $t(t,e){void 0===e&&(e=2);for(var i=Math.pow(10,e-1),r=String(t);1<i;)t<i&&(r="0"+r),i/=10;return r}var te,ee,ie=ft&&!window.PointerEvent&&!!window.MSPointerEvent,re=ft&&!(!window.PointerEvent&&!ie),ne=ie?"MSPointerDown":"pointerdown",oe=ie?"MSPointerMove":"pointermove",se=ie?"MSPointerUp":"pointerup",ae=ie?"MSPointerCancel":"pointercancel",ue={},le=0;function de(t){return"mouse"===t.pointerType||t.MSPOINTER_TYPE_MOUSE&&t.pointerType===t.MSPOINTER_TYPE_MOUSE}function he(t){return"mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE}function ce(t){ue[t.pointerId]=t}function fe(t){ue[t.pointerId]&&(ue[t.pointerId]=t)}function ge(t){delete ue[t.pointerId]}function pe(t,e){for(var i in t.touches=[],ue)t.touches.push(ue[i]);t.changedTouches=[t],e(t)}function _e(t,e,i){function r(t){de(t)||(he(t)&&t.preventDefault(),pe(t,i))}return t(e,ne,r,!1),r}function ve(t,e,i){function r(t){he(t)&&t.preventDefault(),pe(t,i)}return t(e,ae,r,!1),r}function me(t,e,i){function r(t){de(t)&&0===t.buttons||pe(t,i)}return t(e,oe,r,!1),r}function ye(t,e,i){function r(t){return pe(t,i)}return t(e,se,r,!1),t(e,ae,r,!1),r}function xe(t,e,i,r){return i===te.START?t(e,ne,r,!1):i===te.MOVE?t(e,oe,r,!1):i===te.END&&(t(e,se,r,!1),t(e,ae,r,!1))}(ee=te=te||{}).START="touchstart",ee.MOVE="touchmove",ee.END="touchend",ee.CANCEL="touchcancel";var be,Ee,Ae=(Se.prototype.onMounted=function(t,e){},Se.prototype.destroy=function(t){},Se);function Se(){}(Ee=be=be||{}).MOVE="move",Ee.DOWN="down",Ee.UP="up",Ee.CLICK="click",Ee.DOUBLE_CLICK="doubleClick",Ee.HOVER="hover",Ee.UNHOVER="unhover",Ee.WHEEL="wheel",Ee.DRAG_START="dragStart",Ee.DRAG_PROGRESS="dragProgress",Ee.DRAG_END="dragEnd",Ee.GESTURE_START="gestureStart",Ee.GESTURE_PROGRESS="gestureProgress",Ee.GESTURE_END="gestureEnd",Ee.RESIZE="resize",Ee.ADD_NODES="addNodes",Ee.ADD_EDGES="addEdges",Ee.REMOVE_NODES="removeNodes",Ee.REMOVE_EDGES="removeEdges",Ee.BEFORE_REMOVE_NODES="beforeRemoveNodes",Ee.BEFORE_REMOVE_EDGES="beforeRemoveEdges",Ee.CLEAR_GRAPH="clear",Ee.EXCLUDED_STATE_CHANGE="excludedStateChange",Ee.BEFORE_UPDATE_ATTRIBUTES="beforeUpdateAttributes",Ee.UPDATE_ATTRIBUTES="updateAttributes",Ee.RENDERER_STATE_CHANGE="rendererStateChange",Ee.UPDATE_NODE_DATA="updateNodeData",Ee.UPDATE_EDGE_DATA="updateEdgeData",Ee.SET_DATA="setData",Ee.START_ZOOM="startZoom",Ee.VIEW_CHANGED="viewChanged",Ee.MOVE_END="moveEnd",Ee.CAMERA_MOVE="cameraMove",Ee.CAMERA_ROTATE="cameraRotate",Ee.CAMERA_PAN="cameraPan",Ee.CAMERA_ZOOM="cameraZoom",Ee.NODES_DRAG_START="startMoveNodesByDragging",Ee.NODES_DRAG_PROGRESS="progressMoveNodesByDragging",Ee.NODES_DRAG_END="endMoveNodesByDragging",Ee.ANIMATE="animate",Ee.NEW_FRAME="newFrame",Ee.BEFORE_NEW_FRAME="beforeNewFrame",Ee.AFTER_NEW_FRAME="afterNewFrame",Ee.SET_CONTAINER="setContainer",Ee.RELOAD_FONTS="reloadFonts",Ee.MOUSE_LEAVE="mouseLeave",Ee.MOUSE_DOWN="mouseDown",Ee.MOUSE_UP="mouseUp",Ee.MOUSE_MOVE="mouseMove",Ee.MOUSE_WHEEL="mouseWheel",Ee.MOUSE_CLICK="mouseClick",Ee.MOUSE_DOUBLE_CLICK="mouseDoubleClick",Ee.DOCUMENT_MOUSE_MOVE="documentMouseMove",Ee.DOCUMENT_MOUSE_UP="documentMouseUp",Ee.DROP="drop",Ee.VIRTUAL_DOWN="virtualDown",Ee.VIRTUAL_UP="virtualUp",Ee.VIRTUAL_MOVE="virtualMove",Ee.VIRTUAL_CLICK="virtualClick",Ee.VIRTUAL_DOUBLE_CLICK="virtualDoubleClick",Ee.VIRTUAL_WHEEL="virtualWheel",Ee.TOUCH_DOWN="touchDown",Ee.TOUCH_UP="touchUp",Ee.TOUCH_TAP="touchTap",Ee.TOUCH_DOUBLE_TAP="touchDoubleTap",Ee.TOUCH_MOVE="touchMove",Ee.TOUCH_START_GESTURE="touchStartGesture",Ee.TOUCH_PROGRESS_GESTURE="touchProgressGesture",Ee.TOUCH_END_GESTURE="touchEndGesture",Ee.DOCUMENT_TOUCH_MOVE="documentTouchMove",Ee.DOCUMENT_TOUCH_UP="documentTouchUp",Ee.GEO_LOADED="geoLoaded",Ee.GEO_ENABLED="geoEnabled",Ee.GEO_DISABLED="geoDisabled",Ee.GEO_READY="geoReady",Ee.TOOLTIP_HIDE="hideTooltip",Ee.TOOLTIP_SHOW="showTooltip",Ee.CONNECT_NODES="connectNodes",Ee.LAYOUT_START="layoutStart",Ee.LAYOUT_END="layoutEnd",Ee.LAYOUT_COMPUTED="layoutComputed";var we,Te=["graphics","legend","brand"],Ce=(x(Me,we=Ae),Me.prototype.onMounted=function(t,e){e.container&&t.setContainer(e.container)},Me.prototype.addWindowEventListener=function(t,e,i){this._isRealBrowser&&this.addElementEventListener(window,t,e,i)},Me.prototype.addDirectWindowEventListener=function(t,e,i){this._isRealBrowser&&window.addEventListener(t,e,i)},Me.prototype.removeDirectWindowEventListener=function(t,e){this._isRealBrowser&&window.removeEventListener(t,e)},Me.prototype.addDocumentEventListener=function(t,e,i){return this._isDocumentReady&&this.addElementEventListener(document.documentElement,t,e,i),e},Me.prototype.removeDocumentEventListener=function(t,e){this._isDocumentReady&&document.documentElement.removeEventListener(t,e)},Me.prototype.addMediaListener=function(t,e){if(this._isDocumentReady&&"function"==typeof window.matchMedia){var i=window.matchMedia(t);i.addListener(e),this._onDetachDom.push(function(){return i.removeListener(e)})}},Me.prototype.addElementEventListener=function(t,e,i,r){return this._isDestroyed||(t.addEventListener(e,i,r),this._onDetachDom.push(function(){return t.removeEventListener(e,i,r)})),i},Me.prototype.detachFromDom=function(){this._onDetachDom.forEach(function(t){return t()}),this._onDetachDom=[],this._emptyContainer()},Me.prototype.setTimeout=function(t,e){var i=this;void 0===e&&(e=0);var r=setTimeout(function(){i._timeouts.splice(i._timeouts.indexOf(r),1),t()},e);return this._timeouts.push(r),r},Me.prototype.clearTimeout=function(t){return t&&(clearTimeout(t),this._timeouts.splice(this._timeouts.indexOf(t),1)),null},Me.prototype.clearAllTimeouts=function(){this._timeouts.forEach(clearTimeout),this._timeouts=[]},Me.prototype.stopFrames=function(){this._isDestroyed=!0,this._nextFrame&&(st(this._nextFrame),this._nextFrame=null)},Me.prototype.isDestroyed=function(){return this._isDestroyed},Me.prototype.getDimensions=function(){return{width:this._width,height:this._height}},Me.prototype.setDimensions=function(t){this._resize(t)},Me.prototype.setLayer=function(t,e,i){var r=(void 0===i?{}:i).automaticResize,n=void 0!==r&&r;e&&(e._ogmaLayer=t,n&&(e.style.position="absolute",e.style.top="0px",e.style.left="0px",Lt(e,this._width,this._height,wt()))),this._layers[t]={element:e,automaticResize:n},this._updateContainerContent()},Me.prototype.setContainer=function(t){var e,i=this;if("string"==typeof t){if(!(e=document.getElementById(t)))throw new Error('unable to find DOM element with id "'+t+'"')}else e=t;if(e!==this._container){var r=this._container;this._isFullScreen=!1,this._container=e,["fullscreenchange","webkitfullscreenchange"].forEach(function(t){i.addElementEventListener(i._container,t,i._onFullscreenChange)}),this._resize(),this._updateContainerContent(),this._events.fire(be.SET_CONTAINER,{element:e,prevElement:r})}},Me.prototype.getContainer=function(){return this._container},Me.prototype.appendElement=function(t){null!==this._container&&this._container.appendChild(t)},Me.prototype.focus=function(){this._focus=!0},Me.prototype.blur=function(){this._focus=!1},Me.prototype.hasFocus=function(){return this._focus},Me.prototype.forceResize=function(){this._resize()},Me.prototype._beforeOrAfterNextFrame=function(t){var e=t?this._afterNextFramePromises:this._beforeNextFramePromises,i=new Promise(function(t){e.push(function(){return t(),i})});return this._refresh(),i},Me.prototype.beforeNextFrame=function(){return this._beforeOrAfterNextFrame(!1)},Me.prototype.afterNextFrame=function(){return this._beforeOrAfterNextFrame(!0)},Me.prototype.refresh=function(t){t&&(this._refreshUntil=Math.max(this._refreshUntil,t)),this._refresh()},Me.prototype._emptyContainer=function(){if(this._container){for(var t=[],e=0;e<this._container.childNodes.length;++e){var i=this._container.childNodes[e];i._ogmaLayer&&t.push(i)}for(e=0;e<t.length;++e)this._container.removeChild(t[e])}},Me.prototype._fillContainer=function(){var i=this;if(this._container){var t=bt(this._container,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(this._container.style.position="relative");var r=this._container.firstChild;Te.forEach(function(t){var e=i._layers[t];e&&e.element&&i._container&&i._container.insertBefore(e.element,r)})}},Me.prototype._updateContainerContent=function(){this._emptyContainer(),this._fillContainer()},Me.prototype._resize=function(t){if(this._container||t){var i,r,e=this._width,n=this._height;if(this._container){var o=this._settings.get("minimumWidth"),s=this._settings.get("minimumHeight"),a=this._container.clientWidth||1,u=this._container.clientHeight||1;i=Math.max(o,t?t.width:a),r=Math.max(s,t?t.height:u)}else null!=t&&(i=t.width,r=t.height);i===e&&r===n||(this._width=i,this._height=r,j(this._layers,function(t){var e=t.element;t.automaticResize&&Lt(e,i,r)}),this._events.fire(be.RESIZE,{prevWidth:e,prevHeight:n,width:i,height:r,difWidth:i-e,difHeight:r-n}))}},Me.prototype._refresh=function(){var t=this;this._inFrame?this._mustRefresh=!0:this._nextFrame||this._isDestroyed||(this._nextFrame=ot(function(){return t._playFrame()}))},Me.prototype._playFrame=function(){var i=this,t=Kt(),e=t-this._currentTime,r=O([this._beforeNextFramePromises,function(){return i._events.fire(be.BEFORE_NEW_FRAME,{elapsed:e})},function(){return i._events.fire(be.NEW_FRAME,{elapsed:e})},function(){return i._events.fire(be.AFTER_NEW_FRAME,{elapsed:e})},this._afterNextFramePromises,function(){i._inFrame=!1,(i._mustRefresh||t<i._refreshUntil+17)&&(i._mustRefresh=!1,i._refresh())}]);this._inFrame=!0,this._nextFrame=null,this._mustRefresh=!1,this._currentTime=t,this._beforeNextFramePromises=[],this._afterNextFramePromises=[],r.reduce(function(t,e){return t.then(function(){if(!i._isDestroyed)return e()})},Promise.resolve())},Me.prototype.isPlayingFrame=function(){return this._inFrame||!!this._nextFrame},Me.prototype.setFullScreen=function(value){var e=this,t=Promise.resolve();return value!==this._isFullScreen?(this._container&&(t=value?function(t){return Ie()?Promise.resolve():t.requestFullscreen?t.requestFullscreen():t.requestFullScreen?t.requestFullScreen():t.webkitRequestFullScreen?Promise.resolve(t.webkitRequestFullScreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.msRequestFullscreen?t.msRequestFullscreen():Promise.resolve()}(this._container):Ie()&&"undefined"!=typeof document?document.exitFullscreen?document.exitFullscreen():document.cancelFullScreen?document.cancelFullScreen():document.webkitCancelFullScreen?Promise.resolve(document.webkitCancelFullScreen()):document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen?document.msExitFullscreen():Promise.resolve():Promise.resolve()),t.then(function(){return new Promise(function(t){e.setTimeout(function(){e._isFullScreen=Ie(),t(void 0)},200)})})):t},Me.prototype.isFullScreen=function(){return Ie()},Me.prototype.debounceBeforeFrame=function(e){function i(){var t=o;n=!1,o=[],e(),t.forEach(function(t){return t()})}var r=this,n=!1,o=[];return function(){return new Promise(function(t){o.push(t),n||(n=!0,r.beforeNextFrame().then(i))})}},Me.prototype.destroy=function(){!function(){if(le--,ct&&0===le){var t=document.documentElement;t.removeEventListener(ne,ce,!0),t.removeEventListener(oe,fe,!0),t.removeEventListener(se,ge,!0),t.removeEventListener(ae,ge,!0)}}(),this.detachFromDom(),this.clearAllTimeouts(),this.stopFrames()},Me);function Me(t,e){var i=t.events,r=t.settings,n=void 0===e?{}:e,o=n.width,s=void 0===o?300:o,a=n.height,u=void 0===a?300:a,l=we.call(this)||this;return l._layers={},l._focus=!1,l._container=null,l._isFullScreen=!1,l._beforeNextFramePromises=[],l._afterNextFramePromises=[],l._refreshUntil=0,l._currentTime=Kt(),l._timeouts=[],l._isDestroyed=!1,l._onDetachDom=[],l._isRealBrowser=gt,l._isDocumentReady=pt,l._inFrame=!1,l._mustRefresh=!1,l._nextFrame=null,l._onWindowResize=function(){return l._resize()},l._onWindowFocus=function(){return l.refresh()},l._onFullscreenChange=function(){l._isFullScreen=Ie()},l._events=i,l._settings=r,l._width=s,l._height=u,l._settings.register("minimumWidth",300,function(){return l._resize()},!1),l._settings.register("minimumHeight",300,function(){return l._resize()},!1),l._events.register([be.BEFORE_NEW_FRAME,be.NEW_FRAME,be.AFTER_NEW_FRAME,be.SET_CONTAINER,be.RESIZE]),l._onDetachDom=[],function(){if(ct&&0===le&&re){var t=document.documentElement;t.addEventListener(ne,ce,!0),t.addEventListener(oe,fe,!0),t.addEventListener(se,ge,!0),t.addEventListener(ae,ge,!0)}le++}(),l.addWindowEventListener("resize",l._onWindowResize),l.addWindowEventListener("focus",l._onWindowFocus),l}function Ie(){return"undefined"!=typeof document&&!!(document.fullscreenElement||document.msFullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)}var Le,Ne=(x(Oe,Le=Ae),Oe.prototype.setProperty=function(t,e,value,i){var r=(void 0===i?{}:i).dispatch,n=void 0!==r&&r;this._setDataProperty(t.isNode,t._indexes,e,value,n),this._events.fire(be.SET_DATA,{elements:t})},Oe.prototype.getProperty=function(t,e){return this._getDataProperty(t.isNode,t._indexes,e)},Oe.prototype._setDataProperty=function(t,e,i,value,r){r&&"function"==typeof value&&(r=!1);for(var n=ke(i),o="function"==typeof value,s=t?this._nodeList:this._edgeList,a=t?this._nodeDataList:this._edgeDataList,u=function(t,e){for(var i=0;i<t.length;++i){var r=t[i],n=r.property;if(null===e&&null===n)return r;if(e&&n&&n.length===e.length){for(var o=!0,s=0;s<n.length;++s)if(n[s]!==e[s]){o=!1;break}if(o)return r}}var a={property:e&&e.slice(),indexes:[],previousValues:[],newValues:[],nodes:null,edges:null};return t.push(a),a}(t?this._nodeChanges:this._edgeChanges,n),l=0;l<e.length;++l){var d=e[l],h=a.get(d),c=s.get(d),f=r?value[l]:value,g=void 0,p=void 0;if(null===n)g=h,p=o?f(c):f,a.set(d,p);else{null==h&&(h={},a.set(d,h));for(var _=n.length,v=0;v<_;v++){var m=n[v],y=h[m];v<_-1?(null==y&&(y={},h[m]=y),h=y):(g=y,p=o?f(c):f,h[m]=p)}}u.indexes.push(d),u.previousValues.push(g),u.newValues.push(p)}this._scheduleEvents()},Oe.prototype._getDataProperty=function(t,e,i,r){var n=ke(i);r=r||new Array(e.length);for(var o=t?this._nodeDataList:this._edgeDataList,s=0;s<e.length;++s){var a=e[s],u=o.get(a),value=void 0;if(null!==n&&n.length)if(null==u)value=void 0;else for(var l=n.length,d=0;d<l&&u;++d)value=u=u[n[d]];else value=u;r[s]=value}return r},Oe.prototype._scheduleEvents=function(){this._shouldTriggerEvents=!0,this._dom.refresh()},Oe.prototype._triggerEvents=function(){var t=this._prepareEvtPayload(!0),e=this._prepareEvtPayload(!1);this._events.fire(be.UPDATE_NODE_DATA,t),this._events.fire(be.UPDATE_EDGE_DATA,e)},Oe.prototype._prepareEvtPayload=function(t){var e=t?this._graph.nodeList:this._graph.edgeList,i=t?"_nodeChanges":"_edgeChanges",r=[],n=this[i];this[i]=[];for(var o=[],s=0;s<n.length;++s){var a=n[s],u=a.indexes,l=a.property,d=a.newValues,h=a.previousValues;r=r.concat(u||[]),t?o.push({property:l,newValues:d,previousValues:h,nodes:e(u)}):o.push({property:l,newValues:d,previousValues:h,edges:e(u)})}return t?{nodes:e(r).dedupe(),isNode:t,changes:o}:{edges:e(r).dedupe(),isNode:t,changes:o}},Oe);function Oe(t){var e,i=t.dom,r=t.graph,n=t.events,d=Le.call(this)||this;return d._nodeChanges=[],d._edgeChanges=[],d._shouldTriggerEvents=!1,d._dom=i,d._graph=r,d._events=n,d._nodeDataList=d._graph.createAttribute(!0,{name:"data",storage:"any"}),d._edgeDataList=d._graph.createAttribute(!1,{name:"data",storage:"any"}),d._nodeList=d._graph.getNodeAttribute("object"),d._edgeList=d._graph.getEdgeAttribute("object"),d._events.register([be.SET_DATA,be.UPDATE_NODE_DATA,be.UPDATE_EDGE_DATA]),d._events.on(((e={})[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){for(var e=t.nodes,i=t.edges,r=t.objects,n=e||i,o=n.isNode,s=n.size,a=n._indexes,u=d[o?"_nodeDataList":"_edgeDataList"],l=0;l<s;++l)u.set(a[l],r[l].data)},e[be.BEFORE_NEW_FRAME]=function(){d._shouldTriggerEvents&&(d._shouldTriggerEvents=!1,d._triggerEvents())},e)),d}function ke(t){return"string"==typeof t?t.split("."):L(t)?t:null}var Fe={1:ze(1),2:ze(2),4:ze(4),8:Pe(),16:Pe(),32:Pe(),int8:Pe(),int16:Pe(),int32:Pe(),float:Pe(),any:Pe()},Re={1:Be(1),2:Be(2),4:Be(4),8:De(),16:De(),32:De(),int8:De(),int16:De(),int32:De(),float:De(),any:De()};function Pe(){return new Function("array","index","return array[index];")}function De(){return new Function("array","index","value","array[index] = value;")}function ze(t){var e=8/t;return new Function("array","index","return (array[index / "+e+" | 0] >> ((index % "+e+") * "+t+")) & "+((1<<t)-1)+";")}function Be(t){return new Function("array","index","value","\n    var offset = (index % "+8/t+") * "+t+";\n    var finalIndex = index / "+8/t+" | 0;\n    var orMask = value << offset;\n    var andMask = 255 - (("+(Math.pow(2,t)-1)+" - value) << offset);\n\n    array[finalIndex] = (array[finalIndex] & andMask) | orMask;")}var Ue={get:function(t){return this._getArrayElt(this._buffer,t)},set:function(t,value){this._setArrayElt(this._buffer,t,value)}},Ve={get:function(t){return this._byIndex[this._getArrayElt(this._buffer,t)]},set:function(t,value){var e=this._byName[value];void 0===e&&(e=this._nextIndex++,this._byIndex.push(value),this._getElementBitSize()>this._elementSize&&this.increaseElementSize(),this._byName[value]=e);this._setArrayElt(this._buffer,t,e)}},je=(Ge.prototype.getValues=function(){return Object.keys(this._byName||{})},Ge.prototype.getName=function(){return this._name},Ge.prototype.get=function(t){return this._get(t)},Ge.prototype.set=function(t,value){this._set(t,value)},Ge.prototype._get=function(t){return this._defaultValue},Ge.prototype._set=function(t,value){value!==this._defaultValue&&(this._initialize(),this._set(t,value))},Ge.prototype.setFallback=function(t){this._fallback=t,this.get=this._getWithFallback},Ge.prototype._getWithFallback=function(t){var value=this._get(t);return void 0===value&&this._fallback?this._fallback.get(t):value},Ge.prototype._initialize=function(){this._initialized=!0,this._buffer=We(this._nbElements,this._elementSize),this._get=this._methods.get,this._set=this._methods.set,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(0)},Ge.prototype.increaseNbElements=function(t){var e=He(t+1);if(!(e<=this._nbElements)){if(this._initialized)if("any"===this._elementSize)for(var i=this._nbElements;i<e;++i)this._buffer.push(this._defaultValue);else{var r=We(e,this._elementSize);r.set(this._buffer),this._buffer=r,"resource"!==this._storage&&this._defaultValue!==this._BASE_VALUE&&this._reset(this._nbElements)}this._nbElements=e}},Ge.prototype.increaseElementSize=function(){var t=this._elementSize;if("number"!=typeof t||32===t)throw new Error("FlexArray: cannot increase element size");var e=2*t,i=Fe[e],r=Re[e];if(this._initialized){var n=this._nbElements,o=this._getArrayElt,s=this._buffer,a=We(n,e);if(8<=t)a.set(s);else for(var u=0;u<n;++u)r(a,u,o(s,u));this._buffer=a}this._elementSize=e,this._getArrayElt=i,this._setArrayElt=r},Ge.prototype.buffer=function(){if(!this._buffer)throw new Error("FlexArray: buffer not instantiated");return this._buffer},Ge.prototype.elementBitSize=function(){return this._elementSize},Ge.prototype.capacity=function(){return this._nbElements},Ge.prototype.byteSize=function(){return this._nbElements*this._elementSize/8},Ge.prototype.isInitialized=function(){return this._initialized||this._fallback&&this._fallback.isInitialized()},Ge.prototype.getMultiple=function(t,e){var i=t.length;void 0===e&&(e=new Array(i));for(var r=0,n=i;r<n;++r)e[r]=this.get(t[r]);return e},Ge.prototype.fill=function(t,value){for(var e=0,i=t.length;e<i;++e)this.set(t[e],value)},Ge.prototype.setMultiple=function(t,e,i){if(i||!Array.isArray(e)&&!ArrayBuffer.isView(e))for(r=0,n=t.length;r<n;++r)this.set(t[r],e);else for(var r=0,n=t.length;r<n;++r)this.set(t[r],e[r])},Ge.prototype.reset=function(){return this._initialized&&this._reset(0),this},Ge.prototype._reset=function(t){var value="resource"===this._storage?0:this._defaultValue;if(this._buffer)if("number"!=typeof this._elementSize||8<=this._elementSize)this._buffer.fill(value,t);else{for(var e=8/this._elementSize,i=0,r=0;r<e;++r)i<<=this._elementSize,i+=value;if(void 0===t)this._buffer.fill(i);else{var n=t+(8-t%8);for(r=t;r<n;++r)this._setArrayElt(this._buffer,r,value);this._buffer.fill(i,n/8)}}},Ge.prototype._getElementBitSize=function(){if(this._nextIndex)return Math.pow(2,Math.ceil(Math.log2(Math.log2(this._nextIndex))))},Ge);function Ge(t){this._initialized=!1;var e,i,r=t.name,n=t.storage,o=t.size||0,s=(e=t.default,i=n,void 0===e&&"any"!==i&&"resource"!==i?0:e),a=Math.max(8,He(o+1)),u="resource"===n?1:n;this._name=r,this._storage=n,this._getArrayElt=Fe[u],this._setArrayElt=Re[u],this._elementSize=u,this._nbElements=a,this._fallback=null,this._byName=void 0,this._byIndex=void 0,this._nextIndex=void 0,this._defaultValue=s,this._BASE_VALUE="any"===n?void 0:0,this._methods=Ue,this._initialized=!1,this._buffer=null,"resource"===n&&(this._methods=Ve,this._byName={},this._byIndex=[],this._nextIndex=1,this._byName[s]=0,this._byIndex.push(s))}function He(t){for(var e=2;e<t;)e*=2;return e}function We(t,e){return"any"===e?new Array(t):"float"===e?new Float32Array(t):"int8"===e?new Int8Array(t):"int16"===e?new Int16Array(t):"int32"===e?new Int32Array(t):32===e?new Uint32Array(t):16===e?new Uint16Array(t):new Uint8Array(Math.ceil(t/8*e))}function qe(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Xe(t){for(var e=0,i=0;i<t.length;++i)e+=t[i];return e}function Ye(value,t,e){return Math.max(t,Math.min(e,value))}function Ze(t,e,i){return t+(e-t)*i}function Ke(t,e,i){return t*(1-i)+e*i}function Qe(t){if(!t.length)return-1/0;for(var e=t[0],i=1,r=t.length;i<r;++i){var n=t[i];e<n&&(e=n)}return e}function Je(t){if(!t.length)return 1/0;for(var e=t[0],i=1,r=t.length;i<r;++i){var n=t[i];n<e&&(e=n)}return e}function $e(t,e){return Math.log(t)/Math.log(e)}var ti=(ei.prototype.isBusy=function(){return this._busy},ei.prototype.markBusy=function(){return this._busy=!0,this},ei.prototype.sliceAndReset=function(){this._busy=!1;var t=this.slice(0,this._size);return this.reset(),t},ei.prototype.reset=function(){return this._size=0,this},ei.prototype.reserve=function(value){return value>this._capacity&&this._setCapacity(qe(value)),this},ei.prototype._setCapacity=function(t){var e=new Uint32Array(t);e.set(this._buffer),this._buffer=e,this._capacity=t},ei.prototype.push=function(value){return this._size===this._capacity&&this._setCapacity(2*this._capacity),this._buffer[this._size++]=value,this},ei.prototype.pushUnchecked=function(value){return this._buffer[this._size++]=value,this},ei.prototype.slice=function(t,e){return void 0===t&&(t=0),void 0===e&&(e=this._size),this._buffer.slice(t,e)},ei.prototype.getBuffer=function(){return this._buffer},ei.prototype.getLength=function(){return this._size},ei.prototype.getCapacity=function(){return this._capacity},ei.prototype.setLength=function(value){return this._size=value,this},ei.prototype.isEmpty=function(){return 0===this._size},ei);function ei(){this._buffer=new Uint32Array(4),this._capacity=4,this._size=0,this._busy=!1}var ii=(ri.prototype.addElements=function(t){for(var e=[],i=0,r=t.length;i<r;++i){var n=t[i],o=this._idToIndex[n];void 0===o&&(o=this._getNextIndex(),this._idToIndex[n]=o,this._indexToId[o]=n),e.push(o)}for(var s=0,a=this._flexArrays;s<a.length;s++)a[s].increaseNbElements(this._nextIndex);for(var u=0,l=this._indexLists;u<l.length;u++)l[u].reserve(this._nextIndex);return new Uint32Array(e)},ri.prototype.removeElements=function(t){for(var e=0,i=t.length;e<i;++e){var r=t[e],n=this._indexToId[r];void 0!==n&&(delete this._idToIndex[n],this._removeIndex(r))}},ri.prototype.clear=function(){this._idToIndex=Object.create(null),this._indexToId=[void 0],this._nextIndex=1,this._freeIndexes=[];for(var t=0,e=this._flexArrays;t<e.length;t++)e[t].reset();for(var i=0,r=this._indexLists;i<r.length;i++)r[i].reset()},ri.prototype.has=function(t){return void 0!==this._indexToId[t]},ri.prototype.getIndex=function(t,e){void 0===e&&(e=!1);var i=this._idToIndex[t];if(void 0===i&&e)throw new Error(this._name+' id "'+t+'" not found');return i},ri.prototype.createFlexArray=function(t){var e=t.name;if(e&&this._flexArraysByName[e])throw new Error(this._name+' flexArray "'+e+'" already exists');var i=t.default;void 0===i&&"any"!==t.storage&&"resource"!==t.storage&&(i=0);var r,n=this._nextIndex,o={storage:t.storage,size:n,name:e,default:i};return void 0===i&&"any"!==t.storage&&t.storage,r=new je(o),this._flexArrays.push(r),this._defaultValues.push(t.default),e&&(this._flexArraysByName[e]=r),r},ri.prototype.getFlexArray=function(t){return this._flexArraysByName[t]},ri.prototype.getAllFlexArrays=function(){return this._flexArraysByName},ri.prototype.createIndexList=function(){var t=new ti;return t.reserve(this._nextIndex),this._indexLists.push(t),t},ri.prototype.getId=function(t){return this._indexToId[t]},ri.prototype.getMaxIndex=function(){return this._nextIndex-1},ri.prototype._removeIndex=function(t){this._indexesToBeFreed.push(t)},ri.prototype._getNextIndex=function(){var t=this._freeIndexes.pop();return void 0===t&&(t=this._nextIndex++),t},ri.prototype.freeIndexes=function(){for(var t=0,e=this._indexesToBeFreed;t<e.length;t++){var i=e[t];this._indexToId[i]=void 0,this._freeIndexes.push(i)}for(var r=0;r<this._flexArrays.length;++r)for(var n=this._flexArrays[r],o=this._defaultValues[r],s=0,a=this._indexesToBeFreed;s<a.length;s++)i=a[s],n.set(i,o);this._indexesToBeFreed=[]},ri);function ri(t){var r=this;this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._flexArrays=[],this._defaultValues=[],this._flexArraysByName={},this._indexLists=[],this._name=t?"node":"edge",this._nextIndex=1,this._freeIndexes=[],this._indexesToBeFreed=[],this._idToIndex=Object.create(null),this._indexToId=[void 0],this._idFlexArray=new je({storage:"int32"}),this._idFlexArray.get=function(t){return r._indexToId[t]},this._idFlexArray.getMultiple=function(t){for(var e=new Array(t.length),i=0;i<t.length;++i)e[i]=r._indexToId[t[i]];return e},this._flexArraysByName.id=this._idFlexArray}var ni=(oi.prototype.addEntry=function(t){return void 0===t&&(t=this._nextIndex++),t>=this._capacity&&this._reserve(t+1),this._sizes[t]=0,t},oi.prototype.get=function(t){var e=this._sizes[t],i=this._MAX_LIST_SIZE*t;if(e<=this._MAX_LIST_SIZE){for(var r=0,n=this._constList.length=e;r<n;++r)this._constList[r]=this._buffer[i+r];return this._constList}if(e!==this._BIG_LIST)throw new Error("Table: "+t+" out of bounds ("+e+")");var o=this._buffer[i];return this._bigLists[o]},oi.prototype.size=function(t){var e=this._sizes[t];return e<=this._MAX_LIST_SIZE?e:this._bigLists[this._buffer[t*this._MAX_LIST_SIZE]].length},oi.prototype.sizes=function(t){for(var e=this._sizes,i=this._bigLists,r=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,s=new Array(o),a=0;a<o;a++){var u=t[a],l=e[u];s[a]=l<=n?l:i[r[u*n]].length}return s},oi.prototype.addTo=function(t,value){var e=this._sizes[t],i=t*this._MAX_LIST_SIZE;if(e<this._MAX_LIST_SIZE)this._buffer[i+e]=value,this._sizes[t]=e+1;else if(e===this._BIG_LIST){var r=this._buffer[i];this._bigLists[r].push(value)}else{for(var n=new Array(this._MAX_LIST_SIZE),o=0;o<this._MAX_LIST_SIZE;++o)n[o]=this._buffer[i+o];n.push(value),this._bigLists.push(n),this._sizes[t]=this._BIG_LIST,this._buffer[i]=this._bigLists.length-1}return this},oi.prototype.removeFrom=function(t,value){return this.removeFromAndGetSize(t,value),this},oi.prototype.removeFromAndGetSize=function(t,value){var e=this._MAX_LIST_SIZE*t,i=this._sizes[t];if(i<=this._MAX_LIST_SIZE){for(var r=e,n=e+i;r<n;++r)if(this._buffer[r]===value)return--i,this._buffer[r]=this._buffer[n-1],this._sizes[t]=i}else if(i===this._BIG_LIST){var o=this._buffer[e],s=this._bigLists[o];if(-1!==(r=s.indexOf(value)))return s.splice(r,1),s.length}throw new Error('topology: Table: "removeFrom" failed, should not happen')},oi.prototype.reserve=function(t){return this._capacity<t&&this._reserve(t),this},oi.prototype._reserve=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=si(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=si(this._sizes,this._capacity)},oi);function oi(){this._BIG_LIST=255,this._MAX_LIST_SIZE=8,this._capacity=8,this._buffer=new Uint32Array(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._constList=new Array(this._MAX_LIST_SIZE)}function si(t,e){var i=new t.constructor(e);return i.set(t),i}var ai="_visible",ui="_data",li="_hovered",di="_hoverExtremityHighlighted",hi="_selected",ci="_selectionExtremityHighlighted",fi="_dragged",gi="_rewirable",pi="_export",_i="_faded",vi="_transparent",mi=-1,yi="out",xi="both",bi=[hi,fi,ci,li,di,gi,pi,_i,vi,"_visual_groups"],Ei=["hover","zoom","panning","rotation","gesture","drag","selection","tooltip","user","interactions","resizing","rewiring","connectNodes","lasso"],Ai=void 0,Si=(wi.prototype.getAdjacentDirections=function(t){return this._neighborTable.get(t)},wi.prototype.getEdgeIndexesInDirection=function(t){return this._parallelTable.get(t)},wi.prototype.allocateNodes=function(t){this._neighborTable.reserve(t.length);for(var e=0;e<t.length;++e)this._neighborTable.addEntry(t[e])},wi.prototype.allocateEdges=function(t,e,i){this._parallelTable.reserve(Math.floor(t.length/2));for(var r=0;r<t.length;r++){var n=t[r],o=e[r],s=i[r];this._sourceList.set(n,o),this._targetList.set(n,s),this.addToAdjacencyList(n)}},wi.prototype.getExtremity=function(t,e){var i=t?this._sourceList:this._targetList;if(e.isList){for(var r=this._graph.acquireIndexList(!0),n=0;n<e._indexes.length;n++)r.push(i.get(e._indexes[n]));return this._graph.nodeList(r.sliceAndReset())}return this._graph.getObjectList(!0).get(i.get(e._index))},wi.prototype.setExtremities=function(t,e,i){for(var r=0;r<t.length;++r)this.removeFromAdjacencyList(t[r]);for(null!==e&&this._sourceList.setMultiple(t,e),null!==i&&this._targetList.setMultiple(t,i),r=0;r<t.length;++r)this.addToAdjacencyList(t[r])},wi.prototype.addToAdjacencyList=function(t){var e=this._sourceList.get(t),i=this._targetList.get(t),r=Ti(e,i),n=this._parallelEdgesIndex[r];n===Ai&&(n=this._parallelTable.addEntry(),this._parallelEdgesIndex[r]=n,this._neighborTable.addTo(e,n),e!==i&&this._neighborTable.addTo(i,n)),this._parallelTable.addTo(n,t)},wi.prototype.removeFromAdjacencyList=function(t){var e=this._sourceList.get(t),i=this._targetList.get(t),r=Ti(e,i),n=this._parallelEdgesIndex[r];n!==Ai&&0===this._parallelTable.removeFromAndGetSize(n,t)&&(this._neighborTable.removeFrom(e,n),e!==i&&this._neighborTable.removeFrom(i,n),this._parallelEdgesIndex[r]=Ai)},wi.prototype.getParallelEdges=function(t,e){void 0===e&&(e={});for(var i=e.filter||"visible",r=this._graph.acquireIndexList(!1),n=this._graph.getFilter(!1,i),o=0;o<t._indexes.length;o++){var s=t._indexes[o],a=Ti(this._sourceList.get(s),this._targetList.get(s)),u=this._parallelEdgesIndex[a];if(u!==Ai){var l=this._parallelTable.get(+u);if(l)for(var d=0,h=l;d<h.length;d++){var c=h[d];n(c)&&r.push(c)}}}return this._graph.edgeList(r.sliceAndReset())},wi.prototype.fastGetNodesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),i=this._graph.acquireIndexList(!1),r=this._sourceList,n=this._targetList,o=0;o<t.length;o++)for(var s=t[o],a=0,u=this._neighborTable.get(s);a<u.length;a++){var l=u[a],d=this._parallelTable.get(l),h=d[0],c=r.get(h),f=n.get(h);e.push(c+f-s);for(var g=0,p=d;g<p.length;g++){var _=p[g];i.push(_)}}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(i.sliceAndReset())}},wi.prototype.fastGetEdgesAdjacentElements=function(t){for(var e=this._graph.acquireIndexList(!0),i=this._graph.acquireIndexList(!1),r=this._sourceList,n=this._targetList,o=0;o<t.length;o++){var s=t[o],a=r.get(s),u=n.get(s),l=Ti(a,u),d=this._parallelEdgesIndex[l];if(d!==Ai){var h=this._parallelTable.get(+d);if(h)for(var c=0,f=h;c<f.length;c++){var g=f[c];i.push(g)}}e.push(a),e.push(u)}return{nodes:this._graph.nodeList(e.sliceAndReset()),edges:this._graph.edgeList(i.sliceAndReset())}},wi.prototype.getDeduper=function(t){return(t?this.nodeDeduper:this.edgeDeduper).reset()},wi.prototype.collectAdjacentEdges=function(t,e,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var o="in"===e,s=!(e===yi||o||n),a=this._graph.acquireIndexList(!1),u=this._graph.getFilter(!1,i),l=r?this.getDeduper(!1):this._fakeDeduper,d=this._fakeInvertedDeduper,h=this._sourceList,c=this._targetList;if(n){d=this.getDeduper(!0);for(var f=0;f<t.length;f++)d.set(t[f],1)}for(f=0;f<t.length;f++)for(var g=t[f],p=0,_=this._neighborTable.get(g);p<_.length;p++){var v=_[p],m=this._parallelTable.get(v);if(s)for(var y=0,x=m;y<x.length;y++)u(A=x[y])&&0===l.get(A)&&(a.push(A),l.set(A,1));else for(var b=0,E=m;b<E.length;b++){var A=E[b],S=h.get(A),w=c.get(A),T=S+w-g;o!=(w===g)&&S!==w||!u(A)||0!==l.get(A)||1!==d.get(T)||(a.push(A),l.set(A,1))}}return a.sliceAndReset()},wi.prototype.collectAdjacentNodes=function(t,e,i,r,n,o){void 0===r&&(r=!1);var s="in"!==e,a=e!==yi,u=this._graph.acquireIndexList(!0),l=this._graph.getFilter(!1,i),d=r?this.getDeduper(!0):this._fakeDeduper,h=this._sourceList,c=this._targetList;if(n)for(var f=0;f<n.length;f++){var g=n[f];u.push(g),d.set(g,1)}if(o)for(f=0;f<o.length;f++)g=o[f],d.set(g,1);for(f=0;f<t.length;f++)for(var p=t[f],_=0,v=this._neighborTable.get(p);_<v.length;_++)for(var m=v[_],y=0,x=this._parallelTable.get(m);y<x.length;y++){var b=x[y];if(l(b)){var E=h.get(b),A=c.get(b);if(g=E+A-p,(a&&p===A||s&&p===E)&&0===d.get(g)){u.push(g),d.set(g,1);break}}}return u.sliceAndReset()},wi.prototype.getAdjacentElements=function(t,e,i){void 0===i&&(i={});var r=i.direction||xi,n=i.filter||"visible",o=i.policy||"union",s=!!i.bothExtremities,a=i.includeSources;if(!0===a?o="include-sources":!1===a&&(o="exclude-sources"),t){var u="include-sources"===o?e:null,l="exclude-sources"===o?e:null;return this.collectAdjacentNodes(e,r,n,!0,u,l)}return this.collectAdjacentEdges(e,r,n,!0,s)},wi.prototype.getEdgesBetweenTwoNodes=function(t,e){var i=Ti(t,e),r=this._parallelEdgesIndex[i];if(r===Ai)return new Uint32Array;var n=this._parallelTable.get(+r);return new Uint32Array(n)},wi.prototype.getConnectedComponents=function(t,e){for(var i=void 0===e?{}:e,r=i.filter,n=void 0===r?"visible":r,o=i.returnIds,s=void 0!==o&&o,a=i.internalIndexes,u=void 0!==a&&a,l=this._graph,d=[],h={},c=l.acquireIndexList(!0),f=l.getFilter(!0,n),g=0;g<t.length;g++)f(v=t[g])&&c.push(v);var p=c.sliceAndReset(),_={filter:n};for(g=0;g<p.length;g++){var v;if(!h[v=p[g]]){for(var m=[v],y=[];0<m.length;){var x=m.pop();h[x]||(m.push.apply(m,this.getAdjacentElements(!0,new Uint32Array([x]),_)),h[x]=!0,y.push(x))}0<y.length&&d.push(y)}}if(s){var b=l.getNodeAttribute("id");for(g=0;g<d.length;g++)d[g]=b.getMultiple(d[g])}else if(!u)for(g=0;g<d.length;g++)d[g]=l.nodeList(new Uint32Array(d[g]));return d},wi.prototype.getAdjacencyList=function(t){for(var e=t.directed,i=t.ids,r=t.weight,n=t.nodes,o=e?yi:xi,s=new Array(n.length),a=this._graph,u=0;u<n.length;++u)s[u]=this.collectAdjacentEdges(new Uint32Array([n[u]]),o,"all");var l=a.getEdgeAttribute("source"),d=a.getEdgeAttribute("target"),h=a.getEdgeAttribute("width"),c=a.getNodeAttribute("id"),f=[],g="number"==typeof r,p=!("function"==typeof r||g||!r);for(u=0;u<s.length;u++){for(var _=s[u],v=n[u],m=_.length,y=new(i?Array:Uint32Array)(m),x=new Array(m),b=0;b<m;b++){var E=_[b],A=l.get(E),S=d.get(E),w=e||v===A?S:A;if(i&&(w=c.get(w)),y[b]=w,r){if(g&&(x[b]=r),"function"==typeof r){var T=a.getNode(A),C=a.getNode(S);x[b]=r(T,C)}p&&(x[b]=h.get(E)||1)}}var M=I({nodes:y,id:i?c.get(v):v},r&&{weights:x});f.push(M)}return f},wi.prototype.degrees=function(t,e){if("in"!==e&&e!==yi)return this._neighborTable.sizes(t);for(var i=new Array(t.length),r="in"===e,n=0,o=t.length;n<o;n++)i[n]=this._degree(t[n],r);return i},wi.prototype._degree=function(t,e){for(var i=this._neighborTable.get(t),r=this._sourceList,n=this._targetList,o=0,s=0;s<i.length;++s)for(var a=this._parallelTable.get(i[s]),u=0;u<a.length;++u){var l=a[u],d=r.get(l),h=n.get(l);if(e&&h===t||!e&&d===t){o+=1;break}}return o},wi.prototype.getDegree=function(t,e){for(var i=this._getDegreeOptions(e),r=i.direction,n=i.filter,o=new Array(t.length),s=new Uint32Array(1),a=0;a<t.length;++a)s[0]=t[a],o[a]=this.collectAdjacentNodes(s,r,n).length;return o},wi.prototype._getDegreeOptions=function(t){var e={direction:xi,filter:"visible"};return"string"==typeof t?e.direction=t:t&&("string"==typeof t.direction&&(e.direction=t.direction),"string"==typeof t.filter&&(e.filter=t.filter)),e},wi);function wi(t){this._neighborTable=new ni,this._parallelTable=new ni,this._parallelEdgesIndex=[],this._fakeDeduper={get:function(){return 0},set:function(){},reset:function(){return this}},this._fakeInvertedDeduper={get:function(){return 1},set:function(){},reset:function(){return this}},this._graph=t,this.nodeDeduper=t.createNodeAttribute({storage:1}),this.edgeDeduper=t.createEdgeAttribute({storage:1}),this._sourceList=t.getEdgeAttribute("source"),this._targetList=t.getEdgeAttribute("target")}function Ti(t,e){var i=t<e?t:e;return 67108864*i+(t+e-i)}function Ci(t){ht||console.warn(Jt()+" "+t)}var Mi=[];function Ii(t){"object"==typeof t&&null!==t||(t={});var e="function"==typeof t.data?t.data:function(t){return t};return{attributes:Array.isArray(t.attributes)?t.attributes:Mi,data:e}}function Li(t){1<t&&Ci("getData: more than one argument were specified, you probably want to use a single array argument instead of multiple arguments")}function Ni(t,i){for(var e=function(t){var e=i;Object.keys(e).forEach(function(i){var r=e[i];t.prototype[i]=function(t,e){return Ci('Deprecated method "'+i+'"; please use "'+r+'" instead.'),this[r](t,e)}})},r=0,n=t;r<n.length;r++){e(n[r])}}function Oi(t){var e=t.getFlexArray("removed"),i=t.getFlexArray("excluded"),r=t.getFlexArray("virtual");return{all:function(t){return 0===e.get(t)},visible:function(t){return 0===i.get(t)},raw:function(t){return 0===r.get(t)&&0===e.get(t)},_all:function(t){return!0}}}function ki(t,e,i){return{all:Fi(i.all,t,e),visible:Fi(i.visible,t,e),raw:Fi(i.raw,t,e),_all:Fi(i._all,t,e)}}function Fi(r,n,o){var s=null;return{getList:function(){if(!s){var t=n(),e=o();e.reset();for(var i=1;i<=t;++i)r(i)&&e.push(i);s=e.sliceAndReset()}return s},invalidList:function(){s=null}}}function Ri(t){if(void 0===t)return Math.round(Math.random()*Number.MAX_SAFE_INTEGER);if("string"!=typeof t&&("number"!=typeof t||!isFinite(t)))throw new Error(t+" is not a valid id, expected string or number");return t}function Pi(t,e,i){for(var r=t.getObjectList(e.isNode),n=0;n<e._indexes.length;++n){var o=e._indexes[n];i(r.get(o),n)}}function Di(t,e,i){for(var r=new Array(e.size),n=t.getObjectList(e.isNode),o=0;o<e._indexes.length;++o){var s=e._indexes[o],a=n.get(s);r[o]=i(a,o)}return r}function zi(t,e,i){i=i||function(){return!0};for(var r=e.isNode,n=t.acquireIndexList(r),o=t.getObjectList(r),s=t.getListFactory(r),a=0;a<e._indexes.length;++a){var u=e._indexes[a],l=o.get(u);if(l)i(l,a)&&n.push(u)}return s(n.sliceAndReset())}function Bi(t,e,i,r){var n=t.getListFactory(e.isNode);if(!i)return{valid:e,invalid:n()};for(var o=t.acquireIndexList(e.isNode),s=t.acquireIndexList(e.isNode),a=t.getObjectList(e.isNode),u=0;u<e._indexes.length;u++){var l=e._indexes[u],d=a.get(l);if(void 0!==d)(i(d,r)?o:s).pushUnchecked(l)}return{valid:n(o.sliceAndReset()),invalid:n(s.sliceAndReset())}}function Ui(t,e,i,r){for(var n=t.getObjectList(e.isNode),o=r,s=0;s<e._indexes.length;++s){var a=e._indexes[s];o=i(o,n.get(a),s)}return o}function Vi(t,e){for(var i=e.isNode,r=t.topology.getDeduper(i),n=t.acquireIndexList(i),o=t.getListFactory(i),s=0;s<e._indexes.length;s++){var a=e._indexes[s];0===r.get(a)&&(r.set(a,1),n.push(a))}return o(n.sliceAndReset())}function ji(t,e){for(var i=e.isNode,r=t.storage.fetch(i),n=r.getFlexArray("excluded"),o=r.getMaxIndex(),s=t.topology.getDeduper(i),a=t.acquireIndexList(i),u=t.getListFactory(i),l=0;l<e._indexes.length;l++)s.set(e._indexes[l],1);for(var d=1;d<=o;++d)0===s.get(d)&&0===n.get(d)&&a.push(d);return u(a.sliceAndReset())}function Gi(t,e,i){var r=t.getListFactory(e.isNode),n=new Uint32Array(e._indexes.length+i._indexes.length);return n.set(e._indexes),n.set(i._indexes,e._indexes.length),r(n)}function Hi(t,e){return t.getObjectList(e.isNode).getMultiple(e._indexes)}function Wi(t,e){var i=t.getStorage(e.isNode);if(e.isList){for(var r=new Array(e.size),n=0;n<e._indexes.length;++n)r[n]=i.getId(e._indexes[n]);return r}return i.getId(e._index)}function qi(t,e){return t.topology.getExtremity(!0,e)}function Xi(t,e){return t.topology.getExtremity(!1,e)}function Yi(t,e,i){return t.getObjectList(e.isNode).get(e._indexes[i])}function Zi(t,e,n){var i=t.getListFactory(e.isNode),o=t.getObjectList(e.isNode),r=e._indexes.slice();return r.sort(function(t,e){var i=o.get(t),r=o.get(e);return n(i,r)}),i(r)}var Ki=new Uint32Array(1),Qi=(Object.defineProperty(Ji.prototype,"_indexes",{get:function(){return Ki[0]=this._index,Ki},enumerable:!0,configurable:!0}),Ji.prototype.setAttributes=function(t,e,i){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e,i)},Ji.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},Ji.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},Ji.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},Ji.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},Ji.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},Ji.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},Ji.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},Ji.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},Ji.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},Ji.prototype.isVisible=function(){return!this.isExcluded()},Ji.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},Ji.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},Ji.prototype.setVisible=function(value){return this.setExcluded(!value)},Ji.prototype.toList=function(){return this._ogma.modules.graph.edgeList(new Uint32Array([this._index]))},Ji.prototype.getId=function(){return Wi(this._ogma.modules.graph,this)},Ji.prototype.getSource=function(){return qi(this._ogma.modules.graph,this)},Ji.prototype.getTarget=function(){return Xi(this._ogma.modules.graph,this)},Ji.prototype.getExtremities=function(){return this._ogma.modules.graph.nodeList(new Uint32Array([this.getSource()._index,this.getTarget()._index]))},Ji.prototype.setSource=function(t){this._ogma.modules.graph.setSource(this,t)},Ji.prototype.setTarget=function(t){this._ogma.modules.graph.setTarget(this,t)},Ji.prototype.slice=function(){return this.toList()},Ji.prototype.toJSON=function(t){void 0===t&&(t={});var e=Ii(t),i=e.attributes,r=e.data;return{id:this.getId(),source:this.getSource().getId(),target:this.getTarget().getId(),attributes:this.getAttributes(i),data:r(G(this.getData()))}},Ji.prototype.get=function(t){return 0===t?this:void 0},Ji.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},Ji.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},Ji.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},Ji.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},Ji.prototype.setData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value),this},Ji.prototype.getData=function(t){return Li(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},Ji.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},Ji.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},Ji.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},Ji.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},Ji.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},Ji.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},Ji.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},Ji.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},Ji.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},Ji.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},Ji.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},Ji.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},Ji);function Ji(t,e){this.size=1,this.isNode=!1,this.isList=!1,this._index=t,this._ogma=e}Ni([Qi],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var $i=(Object.defineProperty(tr.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),tr.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},tr.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},tr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},tr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},tr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},tr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},tr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},tr.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},tr.prototype.getParallelEdges=function(t){return this._ogma.modules.graph.getParallelEdges(this,t)},tr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetEdgesAdjacentElements(this)},tr.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})},tr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},tr.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},tr.prototype.setVisible=function(value){return this.setExcluded(!value)},tr.prototype.toList=function(){return this},tr.prototype.toArray=function(){return Hi(this._ogma.modules.graph,this)},tr.prototype.clone=function(){return this._ogma.modules.graph.edgeList(this._indexes.slice())},tr.prototype.getId=function(){return Wi(this._ogma.modules.graph,this)},tr.prototype.getSource=function(){return qi(this._ogma.modules.graph,this)},tr.prototype.getTarget=function(){return Xi(this._ogma.modules.graph,this)},tr.prototype.getExtremities=function(){return this.getSource().concat(this.getTarget())},tr.prototype.get=function(t){return Yi(this._ogma.modules.graph,this,t)},tr.prototype.forEach=function(t){Pi(this._ogma.modules.graph,this,t)},tr.prototype.map=function(t){return Di(this._ogma.modules.graph,this,t)},tr.prototype.filter=function(t){return zi(this._ogma.modules.graph,this,t)},tr.prototype.reduce=function(t,e){return Ui(this._ogma.modules.graph,this,t,e)},tr.prototype.concat=function(t){return Gi(this._ogma.modules.graph,this,t)},tr.prototype.dedupe=function(){return Vi(this._ogma.modules.graph,this)},tr.prototype.slice=function(t,e){return this._ogma.modules.graph.edgeList(this._indexes.slice(t,e))},tr.prototype.indexOf=function(t){return t instanceof Qi?this._indexes.indexOf(t._index):-1},tr.prototype.includes=function(t){return-1!==this.indexOf(t)},tr.prototype.sort=function(t){return Zi(this._ogma.modules.graph,this,t)},tr.prototype.inverse=function(){return ji(this._ogma.modules.graph,this)},tr.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},tr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},tr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},tr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},tr.prototype.getBoundingBox=function(t){return this._ogma.modules.locate.getBoundingBox(this,t)},tr.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!L(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},tr.prototype.fillData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value,{dispatch:!1}),this},tr.prototype.getData=function(t){return Li(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},tr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},tr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},tr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},tr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},tr.prototype.hasClass=function(e){var i=this;return this.map(function(t){return i._ogma.modules.classes.hasSingleElementClass(e,t)})},tr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},tr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},tr.prototype.getMetaEdge=function(){return this._ogma.modules.grouping.getMetaElement(this)},tr.prototype.getSubEdges=function(){return this._ogma.modules.grouping.getSubElements(this)},tr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},tr);function tr(t,e){this.isList=!0,this.isNode=!1,this._indexes=t,this._ogma=e}Ni([$i],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute"});var er="geo.latitude",ir="geo.longitude",rr=85.0511287798,nr=1,or={latitudePath:"latitude",longitudePath:"longitude",maxZoomLevel:22,minZoomLevel:0,wrapCoordinates:!0,tileUrlTemplate:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",tileUrlSubdomains:"abc",attribution:null,attributionOptions:void 0,backgroundColor:"silver",opacity:1,duration:0,detectRetina:!1,disableNodeDragging:!0,tileBuffer:1,sizeRatio:1,tiles:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",subdomains:"abc",tms:!1,wms:!1},crs:void 0},sr={maxBoundsViscosity:1,worldCopyJump:!0,zoomControl:!1,attributionControl:!1};function ar(){return ft||"undefined"!=typeof global&&!global.process}function ur(t){return Math.log2(t)+nr}function lr(t){return null!=t&&!isNaN(t)}function dr(t,e){return cr(t,e,"longitude")}function hr(t,e){return cr(t,e,"latitude")}function cr(t,e,i){if(isNaN(e))throw new TypeError("node "+t+": "+e+" is not a valid "+i)}var fr=xt().createElement("div");function gr(t,e,i,r){var n,o,s,a,u,l,d,h;o=!0,s=e,a=i,u=r,l=(n=t).getAttribute(o,a),d=n.getAttribute(o,u),h=s._indexes,d.setMultiple(h,l.getMultiple(h))}var pr=new Uint32Array(1),_r=(Object.defineProperty(vr.prototype,"_indexes",{get:function(){return pr[0]=this._index,pr},enumerable:!0,configurable:!0}),vr.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},vr.prototype.setAttribute=function(t,value,e){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,value,e)},vr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},vr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)[0]},vr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)[0]},vr.prototype.getPosition=function(){return this.getAttributes(["x","y"])},vr.prototype.getPositionOnScreen=function(){return this._ogma.modules.camera.graphToScreenCoordinates(this.getPosition())},vr.prototype.isInScreen=function(){var t=this.getPositionOnScreen(),e=this._ogma.modules.camera;return 0<=t.x&&t.x<=e.width&&0<=t.y&&t.y<=e.height},vr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},vr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)[0]},vr.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},vr.prototype.isInView=function(t){return this._ogma.modules.locate.isElementInView(this,t)},vr.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},vr.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},vr.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)[0]},vr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},vr.prototype.getConnectedComponent=function(t){return this._ogma.modules.graph.getConnectedComponentByNode(this,t)[0]},vr.prototype.isVisible=function(){return!this.isExcluded()},vr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)[0]},vr.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},vr.prototype.setVisible=function(value){return this.setExcluded(!value)},vr.prototype.toList=function(){return this._ogma.nodeList(new Uint32Array([+this._index]))},vr.prototype.getId=function(){return Wi(this._ogma.modules.graph,this)},vr.prototype.slice=function(){return this.toList()},vr.prototype.toJSON=function(t){void 0===t&&(t={});var e=Ii(t),i=e.attributes,r=e.data;return{id:this.getId(),attributes:this.getAttributes(i),data:r(G(this.getData()))}},vr.prototype.get=function(t){return 0===t?this:void 0},vr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},vr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},vr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},vr.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},vr.prototype.setData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value),this},vr.prototype.getData=function(t){return Li(arguments.length),this._ogma.modules.data.getProperty(this,t||null)[0]},vr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},vr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},vr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},vr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},vr.prototype.hasClass=function(t){return this._ogma.modules.classes.hasSingleElementClass(t,this)},vr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)[0]},vr.prototype.getGeoCoordinates=function(){var t=this._ogma.modules.graph,e=t.getNodeAttribute(er).get(this._index),i=t.getNodeAttribute(ir).get(this._index);return{latitude:lr(e)?e:void 0,longitude:lr(i)?i:void 0}},vr.prototype.setGeoCoordinates=function(t){var e=this;return this.toList().setGeoCoordinates([t]).then(function(){return e})},vr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)[0]},vr.prototype.isVirtual=function(){return this._ogma.modules.transformations.isElementVirtual(this)},vr.prototype.getTransformation=function(){return this._ogma.modules.transformations.getElementTransformation(this)},vr.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)[0]},vr.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)[0]},vr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},vr);function vr(t,e){this.size=1,this.isNode=!0,this.isList=!1,this._index=t,this._ogma=e}Ni([_r],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var mr=(Object.defineProperty(yr.prototype,"size",{get:function(){return this._indexes.length},enumerable:!0,configurable:!0}),yr.prototype.setAttributes=function(t,e){return this._ogma.modules.individualAttributes.setMultipleAttributes(this,t,e)},yr.prototype.setAttribute=function(t,e,i){return this._ogma.modules.individualAttributes.setSingleAttribute(this,t,e,i)},yr.prototype.getAttributes=function(t){return this._ogma.modules.individualAttributes.getMultipleAttributes(this,t)},yr.prototype.getAttribute=function(t){return this._ogma.modules.individualAttributes.getSingleAttribute(this,t)},yr.prototype.resetAttributes=function(t,e){return this._ogma.modules.individualAttributes.resetMultipleAttributes(this,t,e)},yr.prototype.getPosition=function(){return this.getAttributes(["x","y"])},yr.prototype.getPositionOnScreen=function(){var e=this;return this.getPosition().map(function(t){return e._ogma.modules.camera.graphToScreenCoordinates(t)})},yr.prototype.replaceOriginalAttributes=function(t,e){return this._ogma.modules.individualAttributes.replaceOriginalAttributes(this,t,e)},yr.prototype.getPreviousAttributes=function(t){return this._ogma.modules.individualAttributes.getMultiplePreviousAttributes(this,t)},yr.prototype.getPreviousAttribute=function(t){return this._ogma.modules.individualAttributes.getSinglePreviousAttribute(this,t)},yr.prototype.getAdjacentNodes=function(t){return this._ogma.modules.graph.getAdjacentNodes(this,t)},yr.prototype.getAdjacentEdges=function(t){return this._ogma.modules.graph.getAdjacentEdges(this,t)},yr.prototype.getDegree=function(t){return this._ogma.modules.graph.getDegree(this,t)},yr.prototype.getConnectedComponents=function(t){return this._ogma.modules.graph.getConnectedComponents(this,t)},yr.prototype.fastGetAdjacentElements=function(){return this._ogma.modules.graph.fastGetNodesAdjacentElements(this)},yr.prototype.isVisible=function(){return this.isExcluded().map(function(value){return!value})},yr.prototype.isExcluded=function(){return this._ogma.modules.graph.isExcluded(this)},yr.prototype.setExcluded=function(value){return this._ogma.modules.graph.setExcluded(this,value)},yr.prototype.setVisible=function(value){return this.setExcluded(!value)},yr.prototype.toList=function(){return this},yr.prototype.toArray=function(){return Hi(this._ogma.modules.graph,this)},yr.prototype.clone=function(){return this._ogma.modules.graph.nodeList(this._indexes.slice())},yr.prototype.getId=function(){return Wi(this._ogma.modules.graph,this)},yr.prototype.get=function(t){return Yi(this._ogma.modules.graph,this,t)},yr.prototype.forEach=function(t){Pi(this._ogma.modules.graph,this,t)},yr.prototype.map=function(t){return Di(this._ogma.modules.graph,this,t)},yr.prototype.filter=function(t){return zi(this._ogma.modules.graph,this,t)},yr.prototype.reduce=function(t,e){return Ui(this._ogma.modules.graph,this,t,e)},yr.prototype.concat=function(t){return Gi(this._ogma.modules.graph,this,t)},yr.prototype.dedupe=function(){return Vi(this._ogma.modules.graph,this)},yr.prototype.slice=function(t,e){return this._ogma.modules.graph.nodeList(this._indexes.slice(t,e))},yr.prototype.indexOf=function(t){return t instanceof _r?this._indexes.indexOf(t._index):-1},yr.prototype.includes=function(t){return-1!==this.indexOf(t)},yr.prototype.inverse=function(){return ji(this._ogma.modules.graph,this)},yr.prototype.sort=function(t){return Zi(this._ogma.modules.graph,this,t)},yr.prototype.toJSON=function(e){return void 0===e&&(e={}),this.map(function(t){return t.toJSON(e)})},yr.prototype.setSelected=function(t){this._ogma.modules.selection.setActive(this,t)},yr.prototype.isSelected=function(){return this._ogma.modules.selection.areActive(this)},yr.prototype.locate=function(t){return this._ogma.modules.locate.locateElements(this,t)},yr.prototype.getBoundingBox=function(){return this._ogma.modules.locate.getBoundingBox(this)},yr.prototype.setData=function(t,e){if(arguments.length<2&&(e=t,t=null),"function"!=typeof e&&!L(e))throw new Error("invalid argument "+e+"; expected array or function");return this._ogma.modules.data.setProperty(this,t,e,{dispatch:!0}),this},yr.prototype.fillData=function(t,value){return arguments.length<2&&(value=t,t=null),this._ogma.modules.data.setProperty(this,t,value,{dispatch:!1}),this},yr.prototype.getData=function(t){return Li(arguments.length),this._ogma.modules.data.getProperty(this,t||null)},yr.prototype.addClass=function(t,e){return this._ogma.modules.classes.addClassesToElements([t],this,e)},yr.prototype.addClasses=function(t,e){return this._ogma.modules.classes.addClassesToElements(t,this,e)},yr.prototype.removeClass=function(t,e){return this._ogma.modules.classes.removeClassesFromElements([t],this,e)},yr.prototype.removeClasses=function(t,e){return this._ogma.modules.classes.removeClassesFromElements(t,this,e)},yr.prototype.hasClass=function(e){var i=this;return this.map(function(t){return i._ogma.modules.classes.hasSingleElementClass(e,t)})},yr.prototype.getClassList=function(){return this._ogma.modules.classes.getElementsClassList(this)},yr.prototype.getGeoCoordinates=function(){for(var t=this._ogma.modules.graph,e=new Array(this._indexes.length),i=t.getNodeAttribute(er).getMultiple(this._indexes),r=t.getNodeAttribute(ir).getMultiple(this._indexes),n=0,o=this._indexes.length;n<o;n++)e[n]={latitude:i[n],longitude:r[n]};return e},yr.prototype.setGeoCoordinates=function(t){var e=this,i=this._ogma.modules.geo,r=this._ogma.modules.graph,n=this.getId(),o=this._indexes,s=new Array(o.length),a=new Array(o.length);if(null===t&&(t=new Array(o.length).fill(null)),t.length!==o.length)throw new RangeError("You must provide coordinates for each node in the NodeList");for(var u=0,l=o.length;u<l;u++){var d=t[u]||{latitude:void 0,longitude:void 0},h=d.latitude,c=d.longitude,f=n[u];null==h&&null==c?h=c=void 0:(hr(f,h),dr(f,c)),s[u]=h,a[u]=c}return this.setData(i.latitudePath,s),this.setData(i.longitudePath,a),r.getNodeAttribute(er).setMultiple(o,s),r.getNodeAttribute(ir).setMultiple(o,a),this._ogma.modules.transformations.refresh().then(function(){return e})},yr.prototype.getAnimationInformation=function(){return this._ogma.modules.graphics.getAnimationInformation(this)},yr.prototype.getMetaNode=function(){return this._ogma.modules.grouping.getMetaElement(this)},yr.prototype.getSubNodes=function(){return this._ogma.modules.grouping.getSubElements(this)},yr.prototype.pulse=function(t){this._ogma.modules.pulses.pulse(this,t)},yr);function yr(t,e){this.isList=!0,this.isNode=!0,this._indexes=t,this._ogma=e}function xr(t,e,i,r){return void 0===i&&(i={}),void 0===r&&(r={}),Er(t,e,[i],r).get(0)}function br(r,n,t,o){if(void 0===o&&(o={}),o.batchSize){for(var e=[],i=0;i<t.length;i+=o.batchSize)e.push(t.slice(i,i+o.batchSize));var s=n?r.nodeList():r.edgeList();return e.reduce(function(t,e){var i;return t.then(function(t){return i=t,r.getDom().afterNextFrame()}).then(function(){return Er(r,n,e,o)}).then(function(t){return i.concat(t)})},Promise.resolve(s))}return Promise.resolve(Er(r,n,t,o))}function Er(t,e,i,r){t.setIndexFreeStep(0);for(var n=t.storage.fetch(e),o=[],s=[],a=[],u=[],l=new Set,d=r.virtual,h=void 0!==d&&d,c=0,f=i;c<f.length;c++){var g=f[c];if("object"!=typeof g||null===g||Array.isArray(g))throw new Error(g+" is not a valid "+(e?"node":"edge"));var p=Ri(g.id);if(!n.getIndex(p,!1)&&!l.has(p)&&(s.push(p),o.push(g),l.add(p),!e)){var _=g,v=t.getExtremityIndex(p,_.source,"source"),m=t.getExtremityIndex(p,_.target,"target");a.push(v),u.push(m)}}var y=n.addElements(s);e?t.topology.allocateNodes(y):t.topology.allocateEdges(y,a,u);for(var x=n.getFlexArray("object"),b=n.getFlexArray("excluded"),E=n.getFlexArray("removed"),A=n.getFlexArray("virtual"),S=e?t.node:t.edge,w=e?t.nodeList:t.edgeList,T=t.getCacheLists(e),C=w(y),M=0;M<y.length;M++){var I=y[M];x.set(I,S(I))}return b.setMultiple(y,0),E.setMultiple(y,0),A.setMultiple(y,h?1:0),T.visible.invalidList(),T.all.invalidList(),T._all.invalidList(),h||T.raw.invalidList(),0!==C.size&&(e?t.fireEvent(be.ADD_NODES,{virtual:h,objects:o,nodes:C}):t.fireEvent(be.ADD_EDGES,{virtual:h,objects:o,edges:C})),C}Ni([mr],{setStyle:"setAttributes",resetStyle:"resetAttributes",getStyle:"getAttribute",setPosition:"setAttributes"});var Ar,Sr=(x(wr,Ar=Ae),wr.prototype.onMounted=function(t,e){if(e.graph){var i=e.graph,r=i.nodes,n=i.edges;r&&this.addNodes(r),n&&this.addEdges(n)}},wr.prototype.createIndexList=function(t){return this.storage.fetch(t).createIndexList()},wr.prototype.setIndexFreeStep=function(t){this._indexFreeStep=t},wr.prototype.getDom=function(){return this._dom},wr.prototype.acquireIndexList=function(t){var e=t?this._nodeIndexLists:this._edgeIndexLists,i=e.find(function(t){return!t.isBusy()});return i||(i=this.createIndexList(t),e.push(i)),i.markBusy(),i},wr.prototype.getObjectList=function(t){return t?this._nodes:this._edges},wr.prototype.getListFactory=function(t){return t?this.nodeList:this.edgeList},wr.prototype.getStorage=function(t){return t?this.storage.nodes:this.storage.edges},wr.prototype.getFilter=function(t,e){var i=t?this._nodeFilters:this._edgeFilters;return i[e]||i.visible},wr.prototype.fireEvent=function(t,e){this._events.fire(t,e)},wr.prototype.getCacheLists=function(t){return t?this._nodeCacheLists:this._edgeCacheLists},wr.prototype._resolvePromises=function(){var t=this._promisesToResolve;this._promisesToResolve=[],t.forEach(function(t){return t()})},wr.prototype._initialize=function(){var t=this;this._nodeCacheLists=ki(function(){return t.getNodeMaxIndex()},function(){return t.acquireIndexList(!0)},this._nodeFilters),this._edgeCacheLists=ki(function(){return t.getEdgeMaxIndex()},function(){return t.acquireIndexList(!1)},this._edgeFilters),this.topology=new Si(this),this._resolvePromises()},wr.prototype.getNodeMaxIndex=function(){return this.storage.nodes.getMaxIndex()},wr.prototype.getEdgeMaxIndex=function(){return this.storage.edges.getMaxIndex()},wr.prototype.isExcluded=function(t){return this.storage.fetch(t.isNode).getFlexArray("excluded").getMultiple(t._indexes)},wr.prototype.setExcluded=function(t,value){for(var e=value?1:0,i=t.isNode,r=this.storage.fetch(i),n=r.getFlexArray("excluded"),o=r.getFlexArray("removed"),s=this.acquireIndexList(i),a=this.getListFactory(i),u=0;u<t._indexes.length;u++){var l=t._indexes[u],d=n.get(l),h=o.get(l);e!==d&&0===h&&s.push(l)}var c=s.sliceAndReset();if(c.length){this.getCacheLists(t.isNode).visible.invalidList();var f=a(c);n.setMultiple(c,e),this._events.fire(be.EXCLUDED_STATE_CHANGE,{elements:f,value:value})}},wr.prototype.addNode=function(t,e){return xr(this,!0,t,e)},wr.prototype.addEdge=function(t,e){return xr(this,!1,t,e)},wr.prototype.addNodes=function(t,e){return br(this,!0,t,e)},wr.prototype.addEdges=function(t,e){return br(this,!1,t,e)},wr.prototype.getExtremityIndex=function(t,e,i){if(e instanceof _r)return e._index;var r=this.storage.nodes.getIndex(e);if(!r)throw new Error("addEdge(s): invalid "+i+' for edge "'+t+'"; node "'+e+'" does not exist');return r},wr.prototype.getNodes=function(t){return this.getElements(!0,t)},wr.prototype.getEdges=function(t){return this.getElements(!1,t)},wr.prototype.getElements=function(t,e){var i=t?this.nodeList:this.edgeList,r=t?mr:$i,n=t?_r:Qi;if(e&&"string"!=typeof e){var o=this.acquireIndexList(t),s=this.storage.fetch(t);if(e instanceof n)o.push(e._index);else if(L(e))for(var a=0,u=e;a<u.length;a++){var l=u[a];l instanceof n?o.push(l._index):(f=s.getIndex(l))&&o.push(f)}else if(e instanceof r)for(var d=this.getFilter(t,"all"),h=e,c=0;c<h._indexes.length;c++){var f;d(f=h._indexes[c])&&o.push(f)}return i(o.sliceAndReset())}var g=e||"visible",p=this.getCacheLists(t)[g];if(!p)throw new Error('getNodes/getEdges: unexpected argument "'+g+'"');return i(p.getList())},wr.prototype.getNode=function(t){return this._getElement(!0,t)},wr.prototype.getEdge=function(t){return this._getElement(!1,t)},wr.prototype._getElement=function(t,e){if(e instanceof(t?_r:Qi))return e;var i=this.getStorage(t),r=this.getObjectList(t),n=i.getIndex(e);return n?r.get(n):void 0},wr.prototype.clear=function(){this._events.fire(be.CLEAR_GRAPH),this.storage.nodes.clear(),this.storage.edges.clear(),this._initialize()},wr.prototype.createAttribute=function(t,e){return this.storage.fetch(t).createFlexArray(e)},wr.prototype.createNodeAttribute=function(t){return this.createAttribute(!0,t)},wr.prototype.createEdgeAttribute=function(t){return this.createAttribute(!1,t)},wr.prototype.getAttribute=function(t,e){return this.storage.fetch(t).getFlexArray(e)},wr.prototype.getAttributes=function(e,t){var i=this;return t.map(function(t){return i.getAttribute(e,t)})},wr.prototype.getNodeAttribute=function(t){return this.storage.nodes.getFlexArray(t)},wr.prototype.getNodeAttributes=function(t){return this.getAttributes(!0,t)},wr.prototype.getEdgeAttribute=function(t){return this.storage.edges.getFlexArray(t)},wr.prototype.getEdgeAttributes=function(t){return this.getAttributes(!1,t)},wr.prototype.getAllNodeAttributes=function(){return this.storage.nodes.getAllFlexArrays()},wr.prototype.getAllEdgeAttributes=function(){return this.storage.edges.getAllFlexArrays()},wr.prototype.setSource=function(t,e){var i=this.getNode(e);i&&this.topology.setExtremities(t._indexes,i._indexes,null)},wr.prototype.setTarget=function(t,e){var i=this.getNode(e);i&&this.topology.setExtremities(t._indexes,null,i._indexes)},wr.prototype.getParallelEdges=function(t,e){return void 0===e&&(e={}),this.topology.getParallelEdges(t,e)},wr.prototype.getEdgesBetweenTwoNodes=function(t,e){return this.edgeList(this.topology.getEdgesBetweenTwoNodes(t._index,e._index))},wr.prototype.getAdjacentDirections=function(t){return this.topology.getAdjacentDirections(t)},wr.prototype.getEdgeIndexesInDirection=function(t){return this.topology.getEdgeIndexesInDirection(t)},wr.prototype.fastGetNodesAdjacentElements=function(t){return this.topology.fastGetNodesAdjacentElements(t._indexes)},wr.prototype.fastGetEdgesAdjacentElements=function(t){return this.topology.fastGetEdgesAdjacentElements(t._indexes)},wr.prototype.getAdjacentNodes=function(t,e){return this.nodeList(this.topology.getAdjacentElements(!0,t._indexes,e))},wr.prototype.getAdjacentEdges=function(t,e){return this.edgeList(this.topology.getAdjacentElements(!1,t._indexes,e))},wr.prototype.getDegree=function(t,e){return this.topology.getDegree(t._indexes,e)},wr.prototype.degrees=function(t,e){return this.topology.degrees(t,e)},wr.prototype.getAdjacencyList=function(t){var e=void 0===t?{}:t,i=e.directed,r=void 0!==i&&i,n=e.internalIndexes,o=void 0!==n&&n,s=e.weight,a=void 0===s?1:s,u=e.nodes,l=e.indexes;return this.topology.getAdjacencyList({directed:r,weight:a,ids:!o,nodes:l||this.getNodes(u)._indexes})},wr.prototype.getConnectedComponents=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},wr.prototype.getConnectedComponentByNode=function(t,e){return this.topology.getConnectedComponents(t._indexes,e)},wr);function wr(t,e){var i=t.dom,r=t.events,n=Ar.call(this)||this;n.storage={nodes:new ii(!0),edges:new ii(!1),fetch:function(t){return t?this.nodes:this.edges}},n._promisesToResolve=[],n._indexFreeStep=0,n._nodeIndexLists=[],n._edgeIndexLists=[],n._onNewFrame=function(){1===n._indexFreeStep?n._indexFreeStep=2:2===n._indexFreeStep&&(n.storage.nodes.freeIndexes(),n.storage.edges.freeIndexes(),n._indexFreeStep=0)},n._events=r,n._dom=i,n._events.register([be.ADD_NODES,be.ADD_EDGES,be.EXCLUDED_STATE_CHANGE],[be.CLEAR_GRAPH,be.BEFORE_REMOVE_NODES,be.REMOVE_NODES,be.BEFORE_REMOVE_EDGES,be.REMOVE_EDGES]);return[{name:"excluded",storage:1,default:1},{name:"removed",storage:1,default:1},{name:"virtual",storage:1,default:0}].forEach(function(t){n.createNodeAttribute(t),n.createEdgeAttribute(t)}),n.node=e.node,n.edge=e.edge,n.nodeList=e.nodeList,n.edgeList=e.edgeList,n._nodes=n.createAttribute(!0,{name:"object",storage:"any"}),n._edges=n.createAttribute(!1,{name:"object",storage:"any"}),n.createAttribute(!1,{name:"source",storage:32}),n.createAttribute(!1,{name:"target",storage:32}),n._nodeFilters=Oi(n.storage.nodes),n._edgeFilters=Oi(n.storage.edges),n._initialize(),n._events.on(be.NEW_FRAME,n._onNewFrame),n}var Tr=["AliceBlue","#F0F8FF","AntiqueWhite","#FAEBD7","Aqua","#00FFFF","Aquamarine","#7FFFD4","Azure","#F0FFFF","Beige","#F5F5DC","Bisque","#FFE4C4","Black","#000000","BlanchedAlmond","#FFEBCD","Blue","#0000FF","BlueViolet","#8A2BE2","Brown","#A52A2A","BurlyWood","#DEB887","CadetBlue","#5F9EA0","Chartreuse","#7FFF00","Chocolate","#D2691E","Coral","#FF7F50","CornflowerBlue","#6495ED","Cornsilk","#FFF8DC","Crimson","#DC143C","Cyan","#00FFFF","DarkBlue","#00008B","DarkCyan","#008B8B","DarkGoldenRod","#B8860B","DarkGray","#A9A9A9","DarkGrey","#A9A9A9","DarkGreen","#006400","DarkKhaki","#BDB76B","DarkMagenta","#8B008B","DarkOliveGreen","#556B2F","DarkOrange","#FF8C00","DarkOrchid","#9932CC","DarkRed","#8B0000","DarkSalmon","#E9967A","DarkSeaGreen","#8FBC8F","DarkSlateBlue","#483D8B","DarkSlateGray","#2F4F4F","DarkSlateGrey","#2F4F4F","DarkTurquoise","#00CED1","DarkViolet","#9400D3","DeepPink","#FF1493","DeepSkyBlue","#00BFFF","DimGray","#696969","DimGrey","#696969","DodgerBlue","#1E90FF","FireBrick","#B22222","FloralWhite","#FFFAF0","ForestGreen","#228B22","Fuchsia","#FF00FF","Gainsboro","#DCDCDC","GhostWhite","#F8F8FF","Gold","#FFD700","GoldenRod","#DAA520","Gray","#808080","Grey","#808080","Green","#008000","GreenYellow","#ADFF2F","HoneyDew","#F0FFF0","HotPink","#FF69B4","IndianRed","#CD5C5C","Indigo","#4B0082","Ivory","#FFFFF0","Khaki","#F0E68C","Lavender","#E6E6FA","LavenderBlush","#FFF0F5","LawnGreen","#7CFC00","LemonChiffon","#FFFACD","LightBlue","#ADD8E6","LightCoral","#F08080","LightCyan","#E0FFFF","LightGoldenRodYellow","#FAFAD2","LightGray","#D3D3D3","LightGrey","#D3D3D3","LightGreen","#90EE90","LightPink","#FFB6C1","LightSalmon","#FFA07A","LightSeaGreen","#20B2AA","LightSkyBlue","#87CEFA","LightSlateGray","#778899","LightSlateGrey","#778899","LightSteelBlue","#B0C4DE","LightYellow","#FFFFE0","Lime","#00FF00","LimeGreen","#32CD32","Linen","#FAF0E6","Magenta","#FF00FF","Maroon","#800000","MediumAquaMarine","#66CDAA","MediumBlue","#0000CD","MediumOrchid","#BA55D3","MediumPurple","#9370DB","MediumSeaGreen","#3CB371","MediumSlateBlue","#7B68EE","MediumSpringGreen","#00FA9A","MediumTurquoise","#48D1CC","MediumVioletRed","#C71585","MidnightBlue","#191970","MintCream","#F5FFFA","MistyRose","#FFE4E1","Moccasin","#FFE4B5","NavajoWhite","#FFDEAD","Navy","#000080","OldLace","#FDF5E6","Olive","#808000","OliveDrab","#6B8E23","Orange","#FFA500","OrangeRed","#FF4500","Orchid","#DA70D6","PaleGoldenRod","#EEE8AA","PaleGreen","#98FB98","PaleTurquoise","#AFEEEE","PaleVioletRed","#DB7093","PapayaWhip","#FFEFD5","PeachPuff","#FFDAB9","Peru","#CD853F","Pink","#FFC0CB","Plum","#DDA0DD","PowderBlue","#B0E0E6","Purple","#800080","RebeccaPurple","#663399","Red","#FF0000","RosyBrown","#BC8F8F","RoyalBlue","#4169E1","SaddleBrown","#8B4513","Salmon","#FA8072","SandyBrown","#F4A460","SeaGreen","#2E8B57","SeaShell","#FFF5EE","Sienna","#A0522D","Silver","#C0C0C0","SkyBlue","#87CEEB","SlateBlue","#6A5ACD","SlateGray","#708090","SlateGrey","#708090","Snow","#FFFAFA","SpringGreen","#00FF7F","SteelBlue","#4682B4","Tan","#D2B48C","Teal","#008080","Thistle","#D8BFD8","Tomato","#FF6347","Turquoise","#40E0D0","Violet","#EE82EE","Wheat","#F5DEB3","White","#FFFFFF","WhiteSmoke","#F5F5F5","Yellow","#FFFF00","YellowGreen","#9ACD32"],Cr=/^rgba?\((\d+),?\s*(\d+),?\s*(\d+),?\s*((\d+)?\.?\d+)*\)$/;function Mr(t,e){void 0===e&&(e=[0,0,0,0]);var i=Cr.exec(t);return i?(e[0]=parseInt(i[1])/255,e[1]=parseInt(i[2])/255,e[2]=parseInt(i[3])/255,e[3]=void 0===i[4]?1:parseFloat(i[4]),e):null}function Ir(t){return t<16?"0"+t.toString(16):t.toString(16)}function Lr(t){var e=t[0],i=t[1],r=t[2],n=t[3];return"rgba("+(256*e|0)+","+(256*i|0)+","+(256*r|0)+","+(void 0===n?1:n)+")"}function Nr(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,i,r){return e+e+i+i+r+r});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?[parseInt(e[1],16)/255,parseInt(e[2],16)/255,parseInt(e[3],16)/255,1]:null}var Or=[0,0,0,0],kr=(Fr.prototype.parseColor=function(t){var e=this._colorByName.get(t);if(void 0===e){var i=t+"",r=("#"===i.charAt(0)?Nr:Mr)(i);this._colorByName.set(t,r),e=r}return e},Fr.prototype.toHexa=function(t){var e=this.parseColor(t);if(!e)return null;var i=e[0],r=e[1],n=e[2];return"#"+Ir(255*i)+Ir(255*r)+Ir(255*n)},Fr.prototype.rgbaToRgb=function(t){var e=1,i=t;return i&&Mr(t,Or)&&(i="rgb("+255*Or[0]+","+255*Or[1]+","+255*Or[2]+")",e=parseFloat(Or[3].toString())),{color:i,opacity:e}},Fr);function Fr(){this._colorByName=new Map,this._colorByName.set(null,[0,0,0,0]),this._colorByName.set("transparent",[0,0,0,0]);for(var t=0;t<Tr.length;t+=2){var e=Tr[t].toLowerCase(),value=Tr[t+1];this._colorByName.set(e,Nr(value))}}var Rr,Pr=2,Dr=4,zr=5,Br=6,Ur=7,Vr=1,jr=2,Gr=3,Hr=4,Wr=5,qr=((Rr={})[Pr]="image",Rr[Dr]="piechart",Rr[3]="text",Rr[zr]="icon",Rr[Br]="badge",Rr),Xr=(Yr.prototype.reset=function(){this._init_()},Yr.prototype._init_=function(){this._mustUpdate=!0,this._nextPatternId=1,this._patterns=[null],this._patternsByHash={},this._pixelRatio=1,this._nullPattern={id:-1,type:1,attributes:{}}},Yr.prototype._increaseNextId=function(){var t=this._nextPatternId++;for(t%256==255&&(t=this._nextPatternId++);this._patterns.length<=t;)this._patterns.push(void 0);return t},Yr.prototype._createPattern=function(t){var e=t.type,i=t.attributes,r={id:this._increaseNextId(),type:e,attributes:this._cloneAttributes(e,i)};return this._patterns[r.id]=r,this._mustUpdate=!0,r},Yr.prototype._cloneAttributes=function(t,e){return t===Pr?{image:e.image,scaled:e.scaled,duplicated:e.duplicated}:3===t||t===zr||t===Br?{font:e.font,size:e.size,style:e.style,text:e.text,align:e.align||"center",offset:e.offset||0}:t===Dr&&e.colors?{colors:e.colors,colorArray:e.colors.split(";").map(function(t){return t.trim()})}:{}},Yr.prototype.getPatternList=function(){return this._patterns.filter(function(t){return t})},Yr.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},Yr.prototype.setPixelRatio=function(value){value!==this._pixelRatio&&(this._pixelRatio=value,this._mustUpdate=!0)},Yr.prototype.getPixelRatio=function(){return this._pixelRatio},Yr.prototype.notifyUpdate=function(){this._mustUpdate=!0},Yr.prototype.getIdFromDefinition=function(t){var e=t.type,i=t.attributes,r=3===e||e===zr||e===Br,n=0;return e&&1!==e&&e!==Ur&&(e!==Pr||i.image)&&(!r||i.text&&i.font)&&(n=this._addPattern(t),3===e&&"normal"===i.style&&(i.style="bold",this._addPattern(t))),n},Yr.prototype._addPattern=function(t){var e=this._getPatternHash(t),i=this._patternsByHash[e];return i||(65500<this._nextPatternId?Ci("maximum number of pattern exceeded"):(i=this._createPattern(t).id,this._patternsByHash[e]=i)),i},Yr.prototype._getPatternHash=function(t){var e=t.type,i=t.attributes,r=[qr[e]];return e===Pr?r.push(i.scaled?"scaled":"non-scaled",i.duplicated?"duplicated":"non-duplicated",i.image.src||i.image.toDataURL()):3===e?r.push(i.text,i.font,i.style,i.size,i.align||"center",i.offset||0):e===zr||e===Br?r.push(i.text,i.font,i.style,i.size):r.push(i.colors),r.join("+")},Yr.prototype.getDefinitionFromId=function(t){if(t&&this._patterns[t]){var e=this._patterns[t];if(e)return e}return this._nullPattern},Yr.prototype.getVersion=function(){return this._version},Yr);function Yr(){this._pixelRatio=1,this._nextPatternId=1,this._version=0,this._init_()}var Zr=Math.round(Math.log2(512)),Kr=Math.round(Math.log2(128)),Qr=Zr+Kr,Jr=128,$r=Math.round(Math.sqrt(16)),tn=Jr*$r,en=16,rn=1,nn=256,on=5,sn=5;function an(t){return t.map(function(t){var e=t.x,i=t.y,r=t.r;return{x:e,y:i,r:void 0===r?0:r}})}var un=(ln.prototype.register=function(t,e){var i=e.getDistanceFromStrokeVertically,r=e.getDistanceFromStrokeHorizontally,n=e.points,o=e.hole,s=e.isSimple;if(!this._byName[t]){for(var a=s?1:8,u=s?7:15;this._byId[a];)a+=1;if(u<a)throw new Error("max number of shape exceeded");var l={id:a,name:t,getDistanceFromStrokeVertically:i,getDistanceFromStrokeHorizontally:r,points:an(n.slice()),hole:o?an(o.slice()):null,isSimple:!!s};return this._mustUpdate=!0,this._byId[a]=l,this._byName[t]=l}},ln.prototype.getIdFromName=function(t){return this._byName[t].id},ln.prototype.getNameFromId=function(t){var e=this._byId[t];return e?e.name:""},ln.prototype.getDefinitionFromName=function(t){return this._byName[t]},ln.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1)},ln.prototype.getVersion=function(){return this._version},ln.prototype.getShapeList=function(){return this._byId.filter(function(t){return t})},ln);function ln(){this._version=0,this._mustUpdate=!0,this._byName={},this._byId=new Array(16)}var dn=(hn.prototype.update=function(){this._mustUpdate&&(this._version+=1,this._mustUpdate=!1,this._isFullyAllocated&&this._nbCellsFreed===this._nbCellsAllocated&&(this._isFullyFreed=!0))},hn.prototype.allocate=function(t){var e=-1;return!this._isFullyAllocated&&this._nbCellsAllocated+t<=this._capacity?(e=this._nbCellsAllocated,this._nbCellsAllocated+=t,this._mustUpdate=!0):this._isFullyAllocated=!0,e},hn.prototype.free=function(t,e){for(var i=0;i<e;i++){var r=(t+i)*this._elementSize;if(0===this._dataView.getUint16(r))throw new Error('"free": invalid address provided');this._dataView.setUint16(r,0)}this._mustUpdate=!0,this._nbCellsFreed+=e},hn.prototype.triggerUpdate=function(){this._mustUpdate=!0},hn.prototype.isEmpty=function(){return this._nbCellsFreed===this._nbCellsAllocated},hn.prototype.isFullyFreed=function(){return this._isFullyFreed},hn.prototype.getId=function(){return this._id},hn.prototype.getDepth=function(){return this._depth},hn.prototype.getElementType=function(){return this._elementType},hn.prototype.getDataView=function(){return this._dataView},hn.prototype.getByteArray=function(){return this._byteArray},hn.prototype.getElementSize=function(){return this._elementSize},hn.prototype.isAnimated=function(){return this._animated},hn.prototype.getCapacity=function(){return this._capacity},hn.prototype.getSize=function(){return this._nbCellsAllocated},hn.prototype.getNbSideElementsPerMainElement=function(){return this._nbSideElementsPerMainElement},hn.prototype.hasSideData=function(){return 0<this._nbSideElementsPerMainElement},hn.prototype.getSideDataView=function(){return this._sideDataView},hn.prototype.getSideByteArray=function(){return this._sideByteArray},hn.prototype.getTotalSideElementsSize=function(){return this._totalSideElementsSize},hn.prototype.getVersion=function(){return this._version},hn.prototype.getStencilUsage=function(){return this._stencilUsage},hn);function hn(t){var e=t.elementSize,i=t.sideElementSize,r=t.nbSideElementsPerMainElement,n=t.id,o=t.depth,s=t.elementType,a=t.animated,u=t.stencilUsage;this._version=0,this._nbCellsAllocated=0,this._nbCellsFreed=0,this._isFullyAllocated=!1,this._isFullyFreed=!1,this._mustUpdate=!0,this._capacity=512,this._id=n,this._depth=o,this._elementType=s,this._animated=a,this._stencilUsage=u,this._elementSize=e,this._sideElementSize=i,this._nbSideElementsPerMainElement=r,this._totalSideElementsSize=r*i,this._byteCapacity=this._capacity*this._elementSize,this._byteArray=new Uint8Array(this._byteCapacity),this._dataView=new DataView(this._byteArray.buffer),this._sideByteCapacity=this._capacity*this._totalSideElementsSize,this._sideByteArray=new Uint8Array(this._sideByteCapacity),this._sideDataView=new DataView(this._sideByteArray.buffer)}var cn=(fn.prototype.reset=function(){this._init_()},fn.prototype._init_=function(){this._buffersByDepth=new Array(100),this._buffersById=[],this._buffersByAscendingDepth=[],this._buffersByDescendingDepth=[],this._mustUpdate=!0},fn.prototype._fillBlockInfo=function(t,e,i,r){return this._blockInfo.buffer=t,this._blockInfo.offset=e,this._blockInfo.size=i,this._blockInfo.address=r,this._blockInfo},fn.prototype._createBuffer=function(t,e,i,r,n){var o=e?120:52,s=this._buffersById.length,a=new dn({elementSize:o,sideElementSize:6,nbSideElementsPerMainElement:r,id:s,depth:i,elementType:t,animated:e,stencilUsage:n});return this._buffersById.push(a),a},fn.prototype.getBlockInfo=function(t){return this._getBlockInfo(t)},fn.prototype._getBlockInfo=function(t){return this._fillBlockInfo(this._buffersById[t>>Qr],(t>>Kr)%512,t%128,t)},fn.prototype.allocateBlock=function(t,e,i,r,n,o,s){var a=function(t,e){for(var value=0;value<t;)value+=e;return value}(o,8);this._mustUpdate=!0;var u=null,l=-1;if(t){var d=this._getBlockInfo(t),h=d.buffer,c=d.offset,f=d.size,g=d.size===n,p=h.getDepth()===r,_=h.getElementType()===e,v=h.isAnimated()===i,m=h.getNbSideElementsPerMainElement()===a,y=h.getStencilUsage()===s;g&&p&&_&&v&&m&&y?(h.triggerUpdate(),u=h,l=c):h.free(c,f)}if(-1===l){var x=+i,b=a/8,E=this._buffersByDepth[r]||Array(2),A=(this._buffersByDepth[r]=E)[x]||[],S=(E[x]=A)[e]||Array(16),w=(A[e]=S)[b]||Array(4),T=(S[b]=w)[s]||[],C=(w[s]=T)[T.length-1];C&&(l=(u=C).allocate(n)),-1===l&&(l=(u=this._createBuffer(e,i,r,a,s)).allocate(n),T.push(u))}var M=((u.getId()<<Zr)+l<<Kr)+n;return this._fillBlockInfo(u,l,n,M)},fn.prototype.freeBlock=function(t){if(t){this._mustUpdate=!0;var e=this._getBlockInfo(t);e.buffer.free(e.offset,e.size)}return 0},fn.prototype._sortBuffersByDepth=function(){for(var t=[],e=0;e<this._buffersByDepth.length;e++){var i=this._buffersByDepth[e];if(i)for(var r=0;r<i.length;r++){var n=i[r];if(n)for(var o=0;o<n.length;o++){var s=n[o];if(s)for(var a=0;a<s.length;a++){var u=s[a];if(u)for(var l=0;l<u.length;l++){var d=u[l];if(d)for(var h=0;h<d.length;h++){var c=d[h];c.update(),c.isFullyFreed()?(this._buffersById[c.getId()]=void 0,d.splice(h,1),--h):t.push(c)}}}}}}this._buffersByAscendingDepth=t,this._buffersByDescendingDepth=t.slice().reverse()},fn.prototype.update=function(){this._mustUpdate&&(this._sortBuffersByDepth(),this._version+=1,this._mustUpdate=!1)},fn.prototype.getBuffers=function(){return this._buffersById},fn.prototype.getBuffersByAscendingDepth=function(){return this._buffersByAscendingDepth},fn.prototype.getBuffersByDescendingDepth=function(){return this._buffersByDescendingDepth},fn.prototype.getVersion=function(){return this._version},fn);function fn(){this._version=0,this._version=0,this._blockInfo={buffer:null,offset:0,size:0,address:0},this._init_()}var gn=300,pn=150,_n=(Object.defineProperty(vn.prototype,"__dummy",{get:function(){return!0},enumerable:!0,configurable:!0}),Object.defineProperty(vn.prototype,"parentNode",{get:function(){return null},enumerable:!0,configurable:!0}),vn.prototype.getContext=function(t){return"2d"===t?this.__context:null},vn.prototype.toDataURL=function(t){return void 0===t&&(t="png"),"data:image/"+t+";base64,"},vn.prototype.addEventListener=function(){},vn.prototype.removeEventListener=function(){},vn.prototype.getBoundingClientRect=function(){return{left:0,top:0,bottom:0,right:0,width:this.width,height:this.height}},vn);function vn(){this.style={},this.width=gn,this.height=pn,this.__context=new mn,this.style={},this.width=gn,this.height=pn}var mn=(Object.defineProperty(yn.prototype,"font",{set:function(t){var e=t.match(/\d+/);e&&(this._fontSize=parseFloat(e[0]))},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"fillStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"textBaseline",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"textAlign",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"strokeStyle",{set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(yn.prototype,"lineWidth",{set:function(t){},enumerable:!0,configurable:!0}),yn.prototype.fill=function(){},yn.prototype.stroke=function(){},yn.prototype.clearRect=function(){},yn.prototype.fillRect=function(){},yn.prototype.strokeRect=function(){},yn.prototype.beginPath=function(){},yn.prototype.closePath=function(){},yn.prototype.moveTo=function(){},yn.prototype.lineTo=function(){},yn.prototype.rect=function(){},yn.prototype.arc=function(){},yn.prototype.save=function(){},yn.prototype.restore=function(){},yn.prototype.clip=function(){},yn.prototype.translate=function(){},yn.prototype.rotate=function(){},yn.prototype.fillText=function(){},yn.prototype.setLineDash=function(){},yn.prototype.quadraticCurveTo=function(){},yn.prototype.bezierCurveTo=function(){},yn.prototype.drawImage=function(){},yn.prototype.measureText=function(t){return{width:t.length*Math.ceil(.625*this._fontSize)}},yn.prototype.getImageData=function(){return{width:0,height:0,data:new Uint8ClampedArray(0)}},yn);function yn(){this._fontSize=10}var xn=M("canvas")||M("canvas-prebuilt");function bn(){if(ct)return document.createElement("canvas");if(xn){var t=null;return(t="createCanvas"in xn?xn.createCanvas(gn,pn):new xn(gn,pn)).style={},t}return new _n}function En(t,e,i,r){void 0===i&&(i=t.width),void 0===r&&(r=t.height),e.clearRect(0,0,i,r)}function An(t,e,i,r){void 0===r&&(r=""),t.font=r+" "+i+"px "+e}function Sn(){return null!==wn(bn(),{})}function wn(t,e){var i=t.getContext("webgl",e);return(i=i||t.getContext("experimental-webgl",e))||null}function Tn(){return{pieceId:0,shape:"circle",x1:0,y1:0,x2:0,y2:0,rectWidthOrSourceRadiusScaled:0,rectWidthOrSourceRadiusFixed:0,rectHeightOrTargetRadiusScaled:0,rectHeightOrTargetRadiusFixed:0,thicknessOrFontSizeScaled:0,thicknessOrFontSizeFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,offsetScaled:0,offsetFixed:0,pattern:{id:void 0,type:0,attributes:{}},opacity:1,fillColor:null,strokeColor:null,patternColor:null,globalMinVisibleSize:0,strokeMinVisibleSize:0,patternMinVisibleSize:0,offsetAngle:0,patternScale:0,symbolicSize:-1,curvature:0,dashLength:0,gapLength:0,hasHead:!1,hasTail:!1,isBodyTriangle:!1,isSelfLoop:!1,isText:!1,adjustTextAngle:!1,isBadge:!1,unusedFlag2:!1,unusedFlag3:!1}}function Cn(t){return void 0===t&&(t={}),t.pieceId=0,t.shape="",t.x1=0,t.y1=0,t.x2=0,t.y2=0,t.rectWidthOrSourceRadiusScaled=0,t.rectWidthOrSourceRadiusFixed=0,t.rectHeightOrTargetRadiusScaled=0,t.rectHeightOrTargetRadiusFixed=0,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern=t.pattern||{type:0,attributes:{}},t.pattern.type=0,t.opacity=1,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1,t.isSelfLoop=!1,t.isText=!1,t.adjustTextAngle=!1,t.isBadge=!1,t.unusedFlag2=!1,t.unusedFlag3=!1,t}function Mn(){return{valid:!1,id:void 0,end:Tn(),start:Tn(),animation:{duration:0,beginTime:-1,easing:"linear"}}}function In(t,e,i,r){t.width=e*r,t.height=i*r,t.style.width=e+"px",t.style.height=i+"px"}var Ln=(Nn.createInitData=function(){return null},Nn.getName=function(){return null},Nn.isAvailable=function(){return!0},Nn.prototype.getDomElement=function(){return null},Nn.prototype._initCanvas=function(t){t.style.touchAction="none"},Nn.prototype.export=function(t){return Promise.resolve()},Nn.prototype.extractElement=function(t,e){return this._memoryManager.extractGenericElement(t,e,this._scales)},Nn.prototype._compareDimensions=function(t,e,i){return(t!==this._width||e!==this._height||i!==this._pixelRatio)&&(this._width=t,this._height=e,this._pixelRatio=i,!0)},Nn.prototype._compareView=function(t,e,i,r){return(t!==this._viewX||e!==this._viewY||i!==this._viewZoom||r!==this._viewAngle)&&(this._viewX=t,this._viewY=e,this._viewZoom=i,this._viewAngle=r,this._viewAngleCos=Math.cos(r),this._viewAngleSin=Math.sin(r),!0)},Nn.prototype._compareCurrentTime=function(t){return t!==this._currentTime&&(this._currentTime=t,!0)},Nn.prototype._compareBackgroundColor=function(t,e){return(t!==this._backgroundColor||e!==this._renderBackground)&&(this._renderBackground=e,this._backgroundColor=t,this._backgroundRgba=this._colorManager.parseColor(this._backgroundColor),!0)},Nn.prototype._compareShapes=function(){return this._shapesVersion!==this._shapeManager.getVersion()&&(this._shapesVersion=this._shapeManager.getVersion(),!0)},Nn.prototype._comparePatterns=function(){return this._patternsVersion!==this._patternManager.getVersion()&&(this._patternsVersion=this._patternManager.getVersion(),!0)},Nn.prototype._compareBoundaries=function(){return this._boundariesVersion!==this._boundariesManager.getVersion()&&(this._boundariesVersion=this._boundariesManager.getVersion(),!0)},Nn.prototype._compareTexts=function(){return this._textsVersion!==this._textManager.getVersion()&&(this._textsVersion=this._textManager.getVersion(),!0)},Nn.prototype._compareIsDisplayableBuffer=function(t){return this._isBufferDisplayable!==t&&(this._isBufferDisplayable=t,!0)},Nn.prototype._compareHideImages=function(t){return this._hideImages!==t&&(this._hideImages=t,!0)},Nn.prototype.renderFrame=function(t){var e=t.x,i=t.y,r=t.zoom,n=t.angle,o=t.width,s=t.height,a=t.pixelRatio,u=t.backgroundColor,l=t.currentTime,d=t.isBufferDisplayable,h=t.hideImages,c=t.renderBackground,f=this._compareShapes(),g=this._comparePatterns(),p=this._compareBoundaries(),_=this._compareTexts(),v=this._compareDimensions(o,s,a),m=this._compareView(e,i,r,n),y=this._compareCurrentTime(l),x=this._compareBackgroundColor(u,c),b=this._compareIsDisplayableBuffer(d),E=this._compareHideImages(h);if(p){var A=this._boundariesManager,S=this._scales;S.bytesToActualCoord=1,S.bytesToActualScaledSize=A.maxScaledSize/65535,S.bytesToActualMinVisibleSize=A.maxMinVisibleSize/15,S.bytesToActualSymbolicSize=A.maxSymbolicSize/255,S.bytesToActualDashLength=A.maxDashLength/3,S.bytesToActualGapLength=A.maxGapLength/3,S.bytesToActualPatternScale=A.maxPatternScale/255}this._firstFrame&&this._beforeFirstFrame(),this._render({shapesChanged:f,patternsChanged:g,boundariesChanged:p,textsChanged:_,dimensionsChanged:v,viewChanged:m,currentTimeChanged:y,backgroundColorChanged:x,isBufferDisplayableChanged:b,isHideImagesChanged:E}),this._firstFrame&&(this._afterFirstFrame(),this._firstFrame=!1)},Nn.prototype._render=function(t){},Nn.prototype._beforeFirstFrame=function(){},Nn.prototype._afterFirstFrame=function(){},Nn.prototype.destroy=function(){},Nn.prototype.ensureAnimationsReady=function(){},Nn.prototype.getImageData=function(){return null},Nn.prototype.setViewportClipping=function(t){},Nn);function Nn(t){var e=t.bufferList,i=t.patternManager,r=t.boundariesManager,n=t.colorManager,o=t.shapeManager,s=t.textManager,a=t.easingManager,u=t.memoryManager;this._firstFrame=!0,this._width=0,this._height=0,this._pixelRatio=0,this._viewX=0,this._viewY=0,this._viewZoom=0,this._viewAngle=0,this._viewAngleCos=0,this._viewAngleSin=0,this._currentTime=0,this._scales={bytesToActualCoord:0,bytesToActualScaledSize:0,bytesToActualMinVisibleSize:0,bytesToActualSymbolicSize:0,bytesToActualDashLength:0,bytesToActualGapLength:0,bytesToActualPatternScale:0},this._shapesVersion=0,this._patternsVersion=0,this._boundariesVersion=0,this._textsVersion=0,this._backgroundRgba=[1,1,1,0],this._renderBackground=!1,this._hideImages=!1,this._genericObject=Mn(),this._littleEndian=D(),this._bufferList=e,this._shapeManager=o,this._patternManager=i,this._boundariesManager=r,this._textManager=s,this._colorManager=n,this._easingManager=a,this._memoryManager=u}var On,kn,Fn="#define D3D9_FIX 0\n#define ANIMATED 0\nprecision highp float;\nprecision mediump int;\nattribute /*ushort*/ vec4 a_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_final_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_final_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_final_offsetScaled_offsetFixed;\nattribute /*ushort*/ vec4 a_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature;\nattribute /*ushort*/ vec4 a_prev_patternId_fillRGBA_strokeRGBA_patternRGBA;\nattribute /*float*/ vec4 a_prev_x1_y1_x2_y2;\nattribute /*ushort*/ vec4 a_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed;\nattribute /*ushort*/ vec4 a_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed;\nattribute /*ushort*/ vec2 a_prev_offsetScaled_offsetFixed;\nattribute /*float*/ vec2 a_animationBeginTime_animationDuration; \nattribute /*ushort*/ vec4 a_animationEasing; \nattribute /*ushort*/ vec3 a_text_charId_charOffsetXY; \nattribute vec3 a_vertexInfo;\nuniform float u_viewWidth;\nuniform float u_viewHeight;\nuniform float u_viewX;\nuniform float u_viewY;\nuniform float u_viewAngle;\nuniform float u_viewZoom;\nuniform float u_currentTime;\nuniform float u_pixelRatio;\nuniform sampler2D u_patternInfoTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float EPSILON = 0.000001;\nconst float INFINITY = 10000000.0;\nconst float PI = 3.14159265359;\nconst float P2_17 = 131072.0;\nconst float P2_16 = 65536.0;\nconst float P2_12 = 4096.0;\nconst float P2_8 = 256.0;\nconst float P2_7 = 128.0;\nconst float P2_6 = 64.0;\nconst float P2_5 = 32.0;\nconst float P2_4 = 16.0;\nconst float P2_3 = 8.0;\nconst float P2_2 = 4.0;\nconst float P2_1 = 2.0;\nuniform float BYTES_TO_COORD;\nuniform float BYTES_TO_SCALED_SIZE;\nuniform float BYTES_TO_MIN_VISIBLE_SIZE;\nuniform float BYTES_TO_SYMBOLIC_SIZE;\nuniform float BYTES_TO_CURVATURE;\nuniform float BYTES_TO_DASH_LENGTH;\nuniform float BYTES_TO_GAP_LENGTH;\nuniform float BYTES_TO_PATTERN_SCALE;\nuniform float PATTERN_POSITION_GRANULARITY;\nuniform float PATTERN_INFO_TEXTURE_SIZE;\nuniform float PATTERN_NEAREST_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_TEXTURE_SIZE;\nuniform float PATTERN_LINEAR_SDF_TEXTURE_SIZE;\nuniform float PATTERN_MIPMAP_TEXTURE_SIZE;\nconst float BYTES_TO_OFFSET_ANGLE = 0.0;\nconst float BYTES_TO_COLOR = 0.0;\nconst float SDF_FONT_SIZE = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float CURVATURE_RATIO = 0.0;\nconst float PATTERN_MARGIN = 0.0;\nconst float TEXT_WIDTH_MULTIPLIER = 0.0;\nconst float TEXT_HEIGHT_MULTIPLIER = 0.0;\nconst float SELF_LOOP_CURVATURE_MULTIPLIER = 0.0;\nconst float EDGE_ARROW_SIZE_RATIO = 0.0;\nconst float NB_PIECES_PER_CURVE = 0.0;\nconst float PIECE_NODE_COMPONENT = 0.0;\nconst float PIECE_EDGE_BODY = 0.0;\nconst float PIECE_EDGE_HEAD = 0.0;\nconst float PIECE_EDGE_TAIL = 0.0;\nconst float PIECE_EDGE_TEXT = 0.0;\nconst float MAX_TEXT_SIZE = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_X = 0.0;\nconst float BYTES_TO_TEXT_OFFSET_Y = 0.0;\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SHAPE_TEXTURE_SIZE = 0.0;\nconst float SIMPLE_SHAPE_SAMPLING_SIZE = 0.0;\nconst float COMPLEX_SHAPE_SAMPLING_SIZE = 0.0;\nconst float SHAPE_SAMPLING_BUFFER_RATIO = 0.0;\nconst float MAX_NB_SHAPES = 0.0;\nconst float FIRST_COMPLEX_SHAPE_ID = 0.0;\nconst float SELF_LOOP_TO_CIRCLE_APPROX = 0.0;\nconst float NB_SHAPES_BY_SIDE = SHAPE_TEXTURE_SIZE / COMPLEX_SHAPE_SAMPLING_SIZE;\nconst float SHAPE_FILL_PERCENT = 1.0 - SHAPE_SAMPLING_BUFFER_RATIO;\nconst float T_STEP_PER_CURVE_PIECE = 1.0 / NB_PIECES_PER_CURVE;\nconst float HEAD_TAIL_PX_ADJUST = 1.5;\nconst float SDF_SMOOTH_FACTOR = 2.0;\nstruct nv {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\n};\nstruct oe {\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\n};\nstruct om {\nfloat nw;\nfloat nx;\nfloat ny;\nfloat nz;\nfloat oa;\nfloat ob;\nfloat oc;\nfloat od;\nfloat of;\nfloat og;\nfloat oh;\nfloat oi;\nfloat oj;\nfloat ok;\nfloat ol;\nfloat bu;\nfloat on;\nfloat oo;\nfloat op;\nfloat oq;\nfloat or;\nfloat os;\nvec4 bd;\nvec4 be;\nvec4 bz;\nfloat ot;\nfloat ou;\nfloat ov;\nfloat ow;\nfloat ox;\nfloat oy;\nfloat oz;\nfloat pa;\nfloat pb;\nfloat pc;\nfloat pd;\nfloat pe;\nfloat pf;\nfloat pg;\nfloat ph;\nfloat pi;\nfloat pj;\n};\nstruct pk {\nfloat pl;\nvec2 pm;\nvec4 bd;\nvec4 be;\nfloat bu;\nfloat pn;\nfloat po;\nfloat ny;\nfloat pp;\nvec2 pq;\nfloat pr;\nvec2 bi;\nvec2 ps;\nvec2 pt;\nfloat pu;\nfloat pv;\nvec4 bz;\nvec2 pw;\nfloat px;\nfloat py;\nvec2 pz;\nvec2 qa;\nvec2 qb;\n};\nfloat qc(float ly, float qd, float qe) {\nfloat qf = mod(ly, pow(2.0, qe));\nreturn floor(qf / pow(2.0, qd));\n}\nnv qg(float ly) {\nnv qh;\nqh.nw = qc(ly, 0.0, 4.0);\nqh.nx = qc(ly, 4.0, 8.0);\nqh.ny = qc(ly, 8.0, 10.0);\nqh.nz = qc(ly, 10.0, 12.0);\nqh.oa = qc(ly, 12.0, 13.0);\nqh.ob = qc(ly, 13.0, 14.0);\nqh.oc = qc(ly, 14.0, 15.0);\nqh.od = qc(ly, 15.0, 16.0);\nreturn qh;\n}\noe qi(float ly) {\noe qh;\nqh.of = qc(ly, 0.0, 8.0);\nqh.og = qc(ly, 8.0, 11.0);\nqh.oh = qc(ly, 11.0, 12.0);\nqh.oi = qc(ly, 12.0, 13.0);\nqh.oj = qc(ly, 13.0, 14.0);\nqh.ok = qc(ly, 14.0, 15.0);\nqh.ol = qc(ly, 15.0, 16.0);\nreturn qh;\n}\nvec4 qj(in float ly) {\nreturn vec4(\nqc(ly, 0.0, 4.0),\nqc(ly, 4.0, 8.0),\nqc(ly, 8.0, 12.0),\nqc(ly, 12.0, 16.0)\n);\n}\nvec2 qk(in float ly) {\nreturn vec2(mod(ly, 256.0), floor(ly / 256.0));\n}\nvec2 ql(in float ly) {\nfloat qm = floor(ly / P2_6);\nfloat qn = ly - (qm * P2_6);\nreturn vec2(qm, qn);\n}\nvec2 qo(in float ly) {\nfloat qp = floor(ly / P2_7);\nfloat qq = ly - (qp * P2_7);\nreturn vec2(qp, qq);\n}\nvec2 qr(in vec2 qs, in float qt) {\nfloat qu = cos(qt);\nfloat qv = sin(qt);\nreturn vec2(qu * qs.x + qv * qs.y, -qv * qs.x + qu * qs.y);\n}\nvec4 qw(in vec4 qx) {\nreturn floor(qx / 256.0) - 128.0;\n}\nvec4 qy(in vec4 qx) {\nreturn mod(qx, 256.0) - 128.0;\n}\nfloat qz(float ly) {\nreturn ly - 128.0;\n}\nvec2 qz(vec2 ly) {\nreturn ly - 128.0;\n}\nvec2 ra(vec2 rb) {\nreturn vec2(-rb.y, rb.x);\n}\nvec2 rc(vec2 rd, vec2 gj, vec2 re, float t) {\nfloat rf = 1.0 - t;\nreturn (rf * rf * rd) + (2.0 * rf * t * gj) + (t * t * re);\n}\nvec2 rg(vec2 rd, vec2 rh, vec2 ri, vec2 re, float t) {\nfloat rf = 1.0 - t;\nfloat rj = rf * rf;\nfloat rk = rj * rf;\nfloat rl = t * t;\nfloat rm = rl * t;\nreturn (rk * rd) + (3.0 * rj * t * rh) + (3.0 * rf * rl * ri) + (rm * re);\n}\nvec2 rn(vec2 rd, vec2 gj, vec2 re, float t) {\nfloat rf = (1.0 - t);\nvec2 qs = (rf * gj + t * re) - (rf * rd + t * gj);\nreturn normalize(qs);\n}\nvec2 ro(vec2 rd, vec2 gj, vec2 re, float t) {\nreturn ra(rn(rd, gj, re, t));\n}\nvec2 rp(vec2 rd, vec2 rh, vec2 ri, vec2 re, float t) {\nfloat rf = 1.0 - t;\nfloat rj = rf * rf;\nfloat rl = t * t;\nvec2 qs = rj * (rh - rd) + 2.0 * rf * t * (ri - rh) + rl * (re - ri);\nreturn normalize(qs);\n}\nvec2 rq(vec2 rd, vec2 rh, vec2 ri, vec2 re, float t) {\nreturn ra(rp(rd, rh, ri, re, t));\n}\nfloat sb(float or, float sc, float t) {\nfloat y = abs(or) / CURVATURE_RATIO + EPSILON;\nfloat ow = y * y;\nfloat rf = t - 0.5;\nfloat rj = rf * rf;\nfloat sd = 1.0 / (16.0 * ow);\nfloat se = sqrt(rj + sd);\nfloat sf = (0.5 / y) * sqrt(ow + 0.25);\nfloat sg = (abs(2.0 * y)) * ((rf * se) + (0.5 * sf) + (sd * log(abs((rf + se) / (-0.5 + sf)))));\nreturn sg * sc;\n}\nfloat sh(vec2 rd, vec2 si, vec2 sj, vec2 re, float sk) {\nvec2 pw = (rd + si + sj) / 3.0;\nvec2 sl = pw - si;\nvec2 sm = si - sj;\nfloat sn = dot(sl, sl);\nfloat so = dot(sm, sm) / 4.0;\nfloat sw = sqrt(sn - so) * SELF_LOOP_TO_CIRCLE_APPROX * 1.55;\nreturn 2.0 * PI * sw * sk;\n}\nfloat sx(float ly) {\nreturn ly - 32.0;\n}\nfloat sy(float ly) {\nreturn ly - 512.0;\n}\nfloat sz(float ly) {\nreturn ly - 32768.0;\n}\nvoid ta() {\ngl_Position = vec4(-10.0, -10.0, 1.0, 1.0);\n}\nvec4 tb(vec2 tc) {\nreturn vec4(((vec2(tc.x, u_viewHeight - tc.y) / vec2(u_viewWidth, u_viewHeight)) * 2.0 - 1.0), 0.5, 1.0);\n}\nfloat tg(float ap, float aq) {\nreturn step(ap - EPSILON, aq) * step(aq, ap + EPSILON);\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nbool th(float ly) {\nreturn ly > 0.5;\n}\nvec2 ti(vec2 tj) {\nreturn qr((tj - vec2(u_viewX, u_viewY)) * u_viewZoom, u_viewAngle) + vec2(u_viewWidth, u_viewHeight) / 2.0;\n}\nfloat tk(float py) {\nreturn py * EDGE_ARROW_SIZE_RATIO;\n}\nfloat tl(float tm, float tn) {\nreturn tm * BYTES_TO_SCALED_SIZE * u_viewZoom + tn;\n}\nfloat tt(float pn, float tr, float ts) {\nfloat tu = ts - tr;\nfloat a = 1.0 / tu;\nfloat b = -tr / tu;\nreturn pn * a + b;\n}\nstruct tv {\nvec2 tw;\nvec2 tx;\n};\ntv ty(vec2 tz, float sw, float or) {\ntv ma;\nfloat ua = (sw + sw / SELF_LOOP_CURVATURE_MULTIPLIER * or) * SELF_LOOP_CURVATURE_MULTIPLIER;\nfloat ub = -u_viewAngle + PI;\nfloat uc = -u_viewAngle + PI / 2.0;\nma.tw = tz + vec2(cos(ub), sin(ub)) * ua;\nma.tx = tz + vec2(cos(uc), sin(uc)) * ua;\nreturn ma;\n}\nfloat uh(vec2 ui, vec2 si, vec2 sj, vec2 uj, float uk) {\nvec2 ul = ui;\nfloat t = 0.0;\nfloat um = 0.0;\nfloat un = sh(ui, si, sj, uj, 1.0);\nreturn uk / un;\n}\nom uo(\nvec4 up,\nvec4 uq,\nvec4 ur,\nvec4 us,\nvec4 ut,\nvec2 uu,\nvec3 uv\n) {\nom a;\nnv ax = qg(up.x);\noe uw = qi(up.y);\nvec4 ux = qj(up.z);\nvec2 uy = qk(up.w);\na.nw = ax.nw;\na.nx = ax.nx;\na.ny = ax.ny;\na.nz = ax.nz;\na.oa = ax.oa;\na.ob = ax.ob;\na.oc = ax.oc;\na.od = ax.od;\na.of = uw.of;\na.og = uw.og;\na.oh = uw.oh;\na.oi = uw.oi;\na.oj = uw.oj;\na.ok = uw.ok;\na.ol = uw.ol;\na.bu = ux.x;\na.on = ux.y;\na.oo = ux.z;\na.op = ux.w;\na.oq = uy.x;\na.or = uy.y;\na.os = uq.x;\na.bd = qj(uq.y);\na.be = qj(uq.z);\na.bz = qj(uq.w);\na.ot = ur.x;\na.ou = ur.y;\na.ov = ur.z;\na.ow = ur.w;\na.ox = us.x;\na.oy = us.y;\na.oz = us.z;\na.pa = us.w;\na.pb = ut.x;\na.pc = ut.y;\na.pd = ut.z;\na.pe = ut.w;\na.pf = uu.x;\na.pg = uu.y;\na.ph = uv.x;\nfloat x = uv.y;\nfloat y = mod(x, P2_8);\nif (uv.z > 0.0) x += uv.z * P2_16;\na.pi = ((x - y) / P2_8) - P2_16;\na.pj = (y - P2_7) * BYTES_TO_TEXT_OFFSET_Y;\nreturn a;\n}\n/**\n* vg a pk cj aa vh om.\n* dw dx cy dm vi vj, aa vh om ds dm\n* vk fx aa vl bg vm vn cy aa vj,\n* vo dj aa vp vq.\n*/\nbool vr(const in om a, out pk ma) {\nfloat nw = a.nw;\nfloat nx = a.nx;\nfloat ny = a.ny * BYTES_TO_DASH_LENGTH;\nfloat nz = a.nz * BYTES_TO_GAP_LENGTH;\nfloat oa = a.oa;\nfloat ob = a.ob;\nfloat oc = a.oc;\nfloat od = a.od;\nfloat of = a.of * BYTES_TO_PATTERN_SCALE;\nfloat og = a.og * BYTES_TO_OFFSET_ANGLE;\nfloat oh = a.oh;\nfloat oi = a.oi;\nfloat oj = a.oj;\nfloat ok = a.ok;\nfloat ol = a.ol;\nfloat bu = a.bu * BYTES_TO_COLOR;\nfloat on = a.on * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oo = a.oo * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat op = a.op * BYTES_TO_MIN_VISIBLE_SIZE - EPSILON;\nfloat oq = a.oq * BYTES_TO_SYMBOLIC_SIZE * u_viewZoom + step(a.oq, EPSILON) * INFINITY;\nfloat or = qz(a.or);\nfloat os = a.os;\nvec4 bd = a.bd * BYTES_TO_COLOR;\nvec4 be = a.be * BYTES_TO_COLOR;\nvec4 bz = a.bz * BYTES_TO_COLOR;\nvec2 vs = vec2(a.ot, a.ou) * BYTES_TO_COORD;\nvec2 vt = vec2(a.ov, a.ow) * BYTES_TO_COORD;\nvec2 ui = ti(vs);\nvec2 uj = ti(vt);\nfloat vu = tl(a.ox, a.oy);\nfloat vv = tl(a.oz, a.pa);\nfloat vw = tl(a.pb, a.pc);\nfloat pl = tl(a.pd, a.pe);\nfloat vx = tl(a.pf, a.pg);\nvec2 vy = a_vertexInfo.xy;\nvec2 vz = vec2(0.0, 0.0);\nfloat wa = vu;\nfloat wb = vv;\nfloat wc = vv * of;\nif (oh > EPSILON) {\nif (a.ph < EPSILON) return false;\nwc = vw;\nos = a.ph;\nvu = wc * TEXT_WIDTH_MULTIPLIER * u_pixelRatio;\nvv = wc * TEXT_HEIGHT_MULTIPLIER * u_pixelRatio;\n}\nbool wv = abs(or) > EPSILON && tg(nx, PIECE_EDGE_BODY) < EPSILON;\nbool ww = wv && a_vertexInfo.z > EPSILON;\nif (nw < EPSILON || nx < EPSILON || oq < on || ww) {\nreturn false;\n}\npl *= step(oo, oq);\nfloat xj = 0.0;\nfloat xk = 1.0;\nfloat xg = 0.0;\nfloat xi = 1.0;\nfloat xl = 0.0;\nfloat xv = 1.0;\nfloat xx = 1.0;\nfloat yi = 0.0;\nfloat yj = 0.0;\nvec2 pw;\nvec2 pz;\nvec2 qa;\nvec2 qb;\nfloat py;\nfloat px;\nfloat zc = 0.0;\nfloat zd = 1.0;\nif (tg(nx, PIECE_NODE_COMPONENT) > EPSILON) {\npw = ceil((ui + uj) / 2.0);\npz = normalize(vec2(vt.x - vs.x + 0.001, vs.y - vt.y));\nqa = ra(pz);\nqb = qa;\npy = vu;\npx = vv;\n} else {\nxx = 0.0;\nfloat zr = distance(ui, uj);\nvec2 zs = normalize(uj - ui);\nvec2 zt = (ui + uj) / 2.0;\nvec2 zu = ra(zs);\nvec2 zv = zt + (zu * zr * -or / CURVATURE_RATIO);\nif (tg(nx, PIECE_EDGE_TEXT) > 0.0) {\nfloat zw;\nfloat zx = pl;\npl = 0.0;\nif (od > EPSILON) {\ntv gj = ty(ui, zx / 2.0, or);\npw = rg(ui, gj.tw, gj.tx, uj, 0.5);\npz = rp(ui, gj.tw, gj.tx, uj, 0.5);\nqa = ra(pz);\nqb = qa;\nzw = sh(ui, gj.tw, gj.tx, uj, 0.5);\n} else if (abs(or) > EPSILON) {\npw = rc(ui, zv, uj, 0.5);\npz = rn(ui, zv, uj, 0.5);\nqa = ra(pz);\nqb = qa;\nzw = sb(or, zr, 1.0);\n} else {\npw = zt;\npz = zs;\nqa = zu;\nqb = zu;\nzw = zr;\n}\npy = vu;\npx = vv;\nif (oi > EPSILON\n&& od < EPSILON\n&& wa > zw - zx) {\npz = vec2(1.0, 0.0);\nqa = vec2(0.0, 1.0);\nqb = vec2(0.0, 1.0);\n} else {\nfloat qt = -atan(pz.y, pz.x);\nzc = qt;\nog -= qt;\nif ((qt > PI / 2.0 || qt < -PI / 2.0)) {\nog += (1.0 - od) * PI;\nzd = -1.0;\npz *= -1.0;\nqa *= -1.0;\nqb *= -1.0;\n}\n}\n} else {\nfloat yb = vw;\nfloat aaf = vu;\nfloat aag = vv;\nfloat aah = oa + ob;\nfloat aai = tk(yb);\nfloat aaj = oa * aai;\nfloat aak = ob * aai;\nfloat aal = tg(nx, PIECE_EDGE_HEAD);\nfloat aam = tg(nx, PIECE_EDGE_TAIL);\nfloat aan = INFINITY * od + zr - aaf - aag;\nfloat aao = min(aan / aah, aai);\nfloat aax =\nob * (aai + max(aaf + aao - aak, 0.0))\n+ (1.0 - ob) * oc * aaf;\nfloat aay =\noa * (aai + max(aag + aao - aaj, 0.0))\n+ (1.0 - oa) * oc * aag;\nif (aal > EPSILON || aam > EPSILON) {\nvec2 abb = aal * uj + aam * ui;\nfloat vx = aal * aay + aam * aax + (HEAD_TAIL_PX_ADJUST - 0.5);\nfloat abc = aal * aaj + aam * aak;\nvec2 abd;\nif (od > EPSILON) {\ntv gj = ty(ui, aaf, or);\nfloat zw = sh(ui, gj.tw, gj.tx, uj, 1.0);\nfloat uk = aal * (zw - aay) + aam * aax;\nfloat t = uh(ui, gj.tw, gj.tx, uj, uk);\nabd = rg(ui, gj.tw, gj.tx, uj, t);\n} else {\nfloat zw = sb(or, zr, 1.0);\nfloat t = (aal * (zw - aay) + aam * aax) / zw;\nabd = rc(ui, zv, uj, t);\n}\npz = normalize(abb - abd);\nqa = ra(pz);\nqb = qa;\npw = abb - pz * (vx - abc / 2.0);\npy = abc;\npx = abc;\nny = 0.0;\nnz = 0.0;\n} else {\nfloat abh;\nfloat abi;\nfloat abj;\nif (abs(or) < EPSILON) {\npw = zt;\npz = zs;\nqa = zu;\nqb = qa;\npy = zr;\nabh = zr;\nabi = 0.0;\nabj = zr;\n} else {\nfloat abl = a_vertexInfo.z;\nfloat abm = abl * T_STEP_PER_CURVE_PIECE;\nfloat rl = abm + T_STEP_PER_CURVE_PIECE;\nif (od < EPSILON) {\nvec2 abn = rc(ui, zv, uj, abm);\nvec2 abo = rc(ui, zv, uj, rl);\npw = (abn + abo) / 2.0;\npz = normalize(abo - abn);\nqa = ro(ui, zv, uj, abm);\nqb = ro(ui, zv, uj, rl);\npy = distance(abn, abo);\nabh = sb(or, zr, 1.0);\nabi = sb(or, zr, abm);\nabj = sb(or, zr, rl);\n} else {\ntv gj = ty(ui, aaf, or);\nvec2 si = gj.tw;\nvec2 sj = gj.tx;\nvec2 abn = rg(ui, si, sj, uj, abm);\nvec2 abo = rg(ui, si, sj, uj, rl);\npw = (abn + abo) / 2.0;\npz = normalize(abo - abn);\nqa = rq(ui, si, sj, uj, abm);\nqb = rq(ui, si, sj, uj, rl);\npy = distance(abn, abo);\nabh = sh(ui, si, sj, uj, 1.0);\nabi = sh(ui, si, sj, uj, abm);\nabj = sh(ui, si, sj, uj, rl);\n}\n}\npx = vw;\nxg = (aax - 1.0) / abh;\nxi = 1.0 - (aay - HEAD_TAIL_PX_ADJUST) / abh;\nxj = abi / abh;\nxk = abj / abh;\nxl = abh;\nif (oc > 0.0 && aan > 5.0) {\nfloat abv = (abh * px) / (abh - aax);\nfloat un = abh;\nfloat ot = aax;\nfloat ov = abh - aay;\nfloat a = -abv / un;\nfloat b = abv;\nfloat ou = a * ot + b;\nfloat ow = a * ov + b;\nfloat abw = ou / (ot - ov);\nfloat abx = -abw * ov;\npx = abx;\nyj = abw * un + abx + 1.0;\n}\n}\n}\n}\nvec2 bi = vec2(0.0, 0.0);\nvec2 ps = vec2(EPSILON, EPSILON);\nvec2 pt = vec2(-EPSILON, -EPSILON);\nfloat pu = -1.0;\nfloat pv = 0.0;\nbool aby = false;\nif (os > EPSILON && oq > op) {\nfloat acb = floor(os / PATTERN_INFO_TEXTURE_SIZE);\nfloat acc = os - (acb * PATTERN_INFO_TEXTURE_SIZE);\nvec4 acd = texture2D(u_patternInfoTexture, vec2(acc, acb) / 255.0) * 255.0;\nvec2 ace = qo(acd.z);\nvec2 acf = qo(acd.w);\npu = ace.x * 2.0 + acf.x;\nfloat acg = 0.0;\nif (ao(pu, FILTER_NEAREST)) { \nacg = PATTERN_NEAREST_TEXTURE_SIZE;\n} else if (ao(pu, FILTER_LINEAR)) { \nacg = PATTERN_LINEAR_TEXTURE_SIZE;\n} else if (ao(pu, FILTER_LINEAR_SDF)) { \nacg = PATTERN_LINEAR_SDF_TEXTURE_SIZE;\naby = true;\n} else if (ao(pu, FILTER_MIPMAP)) { \nacg = PATTERN_MIPMAP_TEXTURE_SIZE;\n}\nfloat acj = 1.0 / acg;\nvec2 ack = (vec2(ace.y, acf.y) * PATTERN_POSITION_GRANULARITY) * acj / 2.0;\nvec2 acl = (acd.xy * PATTERN_POSITION_GRANULARITY * acj) + ack;\nacl += PATTERN_MARGIN * acj;\nack -= PATTERN_MARGIN * acj * 2.0;\nvec2 acm = vec2(py / 2.0, px / 2.0) * acj;\nvec2 acn = vec2(pl, pl) * acj;\nfloat acp = 1.0 * u_pixelRatio;\nfloat acq = SDF_SMOOTH_FACTOR;\nif (of > EPSILON) {\nif (aby) { \nif (a.oj > EPSILON) {\nacq = SDF_SMOOTH_FACTOR * u_pixelRatio / SDF_GAMMA;\n}\npv = acq * SDF_GAMMA / wc / u_pixelRatio;\nacp = SDF_FONT_SIZE / wc;\n} else { \nacp = (ack.y / acm.y) / of;\n}\n}\nvec2 acu = (acm + acn) * acp;\nack += PATTERN_MARGIN * acj;\nbi = acl + acu * vy;\nps = acl - ack;\npt = acl + ack;\n}\nif (oh > EPSILON) {\nvz.y = (a.pj) * wc;\nxv = 0.0;\nxx = 0.0;\nvz.x = a.pi * wc * BYTES_TO_TEXT_OFFSET_X;\nvz += vec2(1.0, 1.0);\nvz = qr(vz, zc);\nvz *= zd;\n}\nvec2 acw = vec2(cos(og), sin(og)) * vx;\nvec2 acx = pw + acw + vz;\nfloat acy = pl * 2.0;\nfloat acz = py + xx * (acy + 1.0);\nfloat ada = px + xv * (acy + 1.0);\nvec2 adb = pz * acz / 2.0;\nvec2 adc = qa * ada / 2.0;\nvec2 add = qb * ada / 2.0;\nfloat ade = (xk - xj);\nfloat adf = vy.x / 2.0 + 0.5;\nfloat pn = xj + ade * adf;\nfloat pr = yi + (yj - yi) * pn / 2.0;\nfloat adg = step(nw, FIRST_COMPLEX_SHAPE_ID - EPSILON);\nfloat adh = adg * SIMPLE_SHAPE_SAMPLING_SIZE + (1.0 - adg) * COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat adi = adh / COMPLEX_SHAPE_SAMPLING_SIZE;\nfloat adj = adi * SHAPE_SAMPLING_BUFFER_RATIO / 2.0;\nfloat adk = adi * (1.0 - SHAPE_SAMPLING_BUFFER_RATIO);\nvec2 ads = vec2(\nmod(nw, NB_SHAPES_BY_SIDE),\nfloor(nw / NB_SHAPES_BY_SIDE)\n);\nvec2 adt = ads + vec2(adj) +\nvec2(xj * adk, 0.0);\nvec2 adw = vec2(ade, 1.0) * adk;\nvec2 pm = (adt + adw * (vy / 2.0 + 0.5)) / NB_SHAPES_BY_SIDE;\nvec2 pq = vec2(acz / ade, ada) / 2.0;\nfloat aed = ny * vw;\nfloat aee = nz * vw;\nfloat po = aed + aee;\nfloat pp = (pn * xl) / po;\nma.pm = pm;\nma.pq = pq;\nma.pl = pl;\nma.bd = bd;\nma.be = be;\nma.bu = bu;\nma.pn = tt(pn, xg, xi);\nma.po = po;\nma.ny = aed;\nma.pp = pp;\nma.pr = pr;\nma.bi = bi;\nma.ps = ps;\nma.pt = pt;\nma.pu = pu;\nma.pv = pv;\nma.bz = bz;\nma.pw = acx;\nma.py = acz;\nma.px = ada;\nma.pz = pz;\nma.qa = qa;\nma.qb = qb;\nreturn true;\n}\nfloat aef(float aeg, float aeh, vec4 aei) {\nfloat aej = clamp(((u_currentTime - aeg) / aeh), 0.0, 1.0);\nfloat r = aej;\nfloat aek = r * r;\nfloat ael = aek * r;\nvec4 aem = aej < 0.5 ? qw(aei) : qy(aei);\nfloat aen = aem.x;\nfloat aeo = aem.y;\nfloat aep = aem.z;\nfloat aeq = aem.w;\nfloat aer = aen + aeo * r + aep * aek + aeq * ael;\nreturn aer;\n}\nvoid main() {\nom a_final = uo(\na_final_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_final_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_final_x1_y1_x2_y2,\na_final_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_final_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_final_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\n#if ANIMATED\nfloat aeg = a_animationBeginTime_animationDuration.x;\nfloat aeh = a_animationBeginTime_animationDuration.y;\nvec4 aei = a_animationEasing;\nfloat vq = aef(aeg, aeh, aei);\nom a_prev = uo(\na_prev_shapeInfo_miscInfo_opacityAndAllMinVisibleSizes_symbolicSizeAndCurvature,\na_prev_patternId_fillRGBA_strokeRGBA_patternRGBA,\na_prev_x1_y1_x2_y2,\na_prev_rectWidthOrSourceRadiusScaled_rectWidthOrSourceRadiusFixed_rectHeightOrTargetRadiusScaled_rectHeightOrTargetRadiusFixed,\na_prev_thicknessOrFontSizeScaled_thicknessOrFontSizeFixed_strokeWidthScaled_strokeWidthFixed,\na_prev_offsetScaled_offsetFixed,\na_text_charId_charOffsetXY\n);\nconst float ONE = 1.0;\na_final.nw = mix(a_prev.nw, a_final.nw, ONE);\na_final.ny = mix(a_prev.ny, a_final.ny, vq);\na_final.nz = mix(a_prev.nz, a_final.nz, vq);\na_final.oa = mix(a_prev.oa, a_final.oa, ONE);\na_final.ob = mix(a_prev.ob, a_final.ob, ONE);\na_final.nx = mix(a_prev.nx, a_final.nx, ONE);\na_final.of = mix(a_prev.of, a_final.of, ONE);\na_final.oh = mix(a_prev.oh, a_final.oh, ONE);\na_final.oi = mix(a_prev.oi, a_final.oi, ONE);\na_final.oj = mix(a_prev.oj, a_final.oj, ONE);\na_final.ok = mix(a_prev.ok, a_final.ok, ONE);\na_final.od = mix(a_prev.od, a_final.od, ONE);\na_final.og = mix(a_prev.og, a_final.og, vq);\na_final.bu = mix(a_prev.bu, a_final.bu, vq);\na_final.on = mix(a_prev.on, a_final.on, vq);\na_final.oo = mix(a_prev.oo, a_final.oo, vq);\na_final.op = mix(a_prev.op, a_final.op, vq);\na_final.oq = mix(a_prev.oq, a_final.oq, vq);\na_final.or = mix(a_prev.or, a_final.or, vq);\na_final.os = mix(a_prev.os, a_final.os, ONE);\na_final.bd = mix(a_prev.bd, a_final.bd, vq);\na_final.be = mix(a_prev.be, a_final.be, vq);\na_final.bz = mix(a_prev.bz, a_final.bz, vq);\na_final.ot = mix(a_prev.ot, a_final.ot, vq);\na_final.ou = mix(a_prev.ou, a_final.ou, vq);\na_final.ov = mix(a_prev.ov, a_final.ov, vq);\na_final.ow = mix(a_prev.ow, a_final.ow, vq);\na_final.ox = mix(a_prev.ox, a_final.ox, vq);\na_final.oy = mix(a_prev.oy, a_final.oy, vq);\na_final.oz = mix(a_prev.oz, a_final.oz, vq);\na_final.pa = mix(a_prev.pa, a_final.pa, vq);\na_final.pb = mix(a_prev.pb, a_final.pb, vq);\na_final.pc = mix(a_prev.pc, a_final.pc, vq);\na_final.pd = mix(a_prev.pd, a_final.pd, vq);\na_final.pe = mix(a_prev.pe, a_final.pe, vq);\na_final.pf = mix(a_prev.pf, a_final.pf, vq);\na_final.pg = mix(a_prev.pg, a_final.pg, vq);\na_final.ph = mix(a_prev.ph, a_final.ph, ONE);\na_final.pi = mix(a_prev.pi, a_final.pi, ONE);\na_final.pj = mix(a_prev.pj, a_final.pj, ONE);\n#endif\npk ma;\nbool aev = vr(a_final, ma);\nif (!aev) {\nta();\nreturn;\n}\nvec2 vy = a_vertexInfo.xy;\na = ma.bd;\nb = ma.be;\nc = ma.bz;\nd = ma.pm;\ne = ma.bi;\n#if D3D9_FIX\n#else\nj = ma.pl;\nk = ma.ps;\nl = ma.pt;\nm = vec2(ma.bu, ma.pr);\nn = ma.pn;\no = ma.po;\np = vec2(ma.ny, ma.pp);\nq = ma.pq;\nr = ma.pv;\ns = ma.pu;\n#endif\nfloat aey = step(vy.x, 0.0);\nfloat aez = 1.0 - aey;\nvec2 tc = ma.pw\n+ (ma.pz * (ma.py / 2.0) * vy.x)\n+ ((aey * ma.qa + aez * ma.qb) * (ma.px / 2.0) * vy.y);\ngl_Position = tb(tc);\n}\n",Rn="#define D3D9_FIX 0\nprecision highp float;\nprecision mediump int;\nuniform vec3 u_backgroundColor;\nuniform sampler2D u_patternNearestTexture;\nuniform sampler2D u_patternLinearTexture;\nuniform sampler2D u_patternLinearSdfTexture;\nuniform sampler2D u_patternMipmapTexture;\nuniform sampler2D u_shapeTexture;\nvarying vec4 a;\nvarying vec4 b;\nvarying vec4 c;\nvarying vec2 d;\nvarying vec2 e;\n#if D3D9_FIX\n#else\nvarying float j;\nvarying vec2 k;\nvarying vec2 l;\nvarying vec2 m;\nvarying float n;\nvarying float o;\nvarying vec2 p;\nvarying vec2 q;\nvarying float r;\nvarying float s;\n#endif\nconst float FILTER_NEAREST = 0.0;\nconst float FILTER_LINEAR = 0.0;\nconst float FILTER_LINEAR_SDF = 0.0;\nconst float FILTER_MIPMAP = 0.0;\nconst float SDF_GAMMA = 0.0;\nconst float EPSILON = 0.000000001;\nconst float SDF_BUFFER = (256.0 - 64.0) / 256.0; \nvec4 ad(in vec4 ae, in vec4 af) {\nfloat ag = af.a;\nfloat ah = ae.a + EPSILON;\nfloat ai = min(ag + ah, 1.0);\nfloat r = ag / ai;\nreturn vec4(mix(ae.rgb, af.rgb, r), ai);\n}\nfloat aj(in float ak, in float al) {\nfloat am = (ak * 256.0 + al) * 256.0;\nfloat an = am / 32768.0;\nreturn an * 2.0 - 1.0;\n}\nbool ao(float ap, float aq) {\nreturn abs(ap - aq) < EPSILON;\n}\nvoid main() {\n#if D3D9_FIX\n#else\nfloat ar = m.x;\nfloat as = m.y;\nfloat at = p.x;\nfloat au = p.y;\n#endif\nvec4 ax = texture2D(u_shapeTexture, d);\nfloat ay = aj(ax.b, ax.a) * q.x;\nfloat az = aj(ax.r, ax.g) * q.y;\naz += as;\nfloat bc = min(ay, az);\nvec4 bd = a;\nvec4 be = b;\nif (s > -EPSILON) {\nvec2 bi = e;\nfloat bv =\nstep(k.x, bi.x) *\nstep(bi.x, l.x) *\nstep(k.y, bi.y) *\nstep(bi.y, l.y);\nfloat bw = bv;\nvec4 bz;\nif (ao(s, FILTER_NEAREST)) {\nbz = texture2D(u_patternNearestTexture, bi);\n} else if (ao(s, FILTER_LINEAR)) { \nbz = texture2D(u_patternLinearTexture, bi);\n} else if (ao(s, FILTER_LINEAR_SDF)) { \nbz = texture2D(u_patternLinearSdfTexture, bi);\nbz.a = smoothstep(SDF_BUFFER - r, SDF_BUFFER + r, bz.a);\n} else if (ao(s, FILTER_MIPMAP)) { \nbz = texture2D(u_patternMipmapTexture, bi);\n}\nbz.rgb += c.rgb;\nbz.a *= bw;\nbd = ad(bd, bz);\n}\nfloat cl = clamp(bc, 0.0, 1.0);\nfloat cm = clamp(bc - j, 0.0, 1.0);\nfloat cn = cl - cm;\ncn = 1.0 - clamp(bc - j, 0.0, 1.0);\nbd.a *= cm;\nbe.a *= cn;\nvec4 co = ad(bd, be);\nfloat cp = cl;\nco.rgb = mix(u_backgroundColor, co.rgb, ar);\nif (o > EPSILON) {\nfloat de = fract(au) * o;\nfloat df = clamp(min(de, at - de), 0.0, 1.0);\ncp *= df;\n}\nif (n < 0.0 || n > 1.0 || cp < EPSILON) {\ndiscard;\n}\nco.a *= cp;\nco.rgb *= co.a;\ngl_FragColor = co;\n}\n";(kn=On=On||{})[kn.INIT=0]="INIT",kn[kn.COMPILING=1]="COMPILING",kn[kn.DONE=2]="DONE";var Pn=(Dn.prototype.setConstant=function(t,value){this._constants[t]=value},Dn.prototype.setMacro=function(t,value){this._macros[t]=value},Dn.prototype.getState=function(){return this._state},Dn.prototype.getProgram=function(){return this._program},Dn.prototype.compile=function(){var t=this._gl,e=zn(this._vertexSource,this._macros,this._constants),i=zn(this._fragmentSource,this._macros,this._constants);this._program&&(t.deleteProgram(this._program),t.deleteShader(this._vertexShader),t.deleteShader(this._fragmentShader));var r=t.createProgram(),n=t.createShader(t.VERTEX_SHADER),o=t.createShader(t.FRAGMENT_SHADER);if(!(r&&n&&o))throw new Error("Error instantiating WebGL program");this._program=r,this._vertexShader=n,this._fragmentShader=o,t.shaderSource(this._vertexShader,e),t.compileShader(this._vertexShader),t.attachShader(this._program,this._vertexShader),t.shaderSource(this._fragmentShader,i),t.compileShader(this._fragmentShader),t.attachShader(this._program,this._fragmentShader),t.linkProgram(this._program),this._state=On.COMPILING},Dn.prototype.getError=function(){var t=this._gl;return t.getShaderParameter(this._vertexShader,t.COMPILE_STATUS)?t.getShaderParameter(this._fragmentShader,t.COMPILE_STATUS)?t.getProgramParameter(this._program,t.LINK_STATUS)?(this._state=On.DONE,null):{step:"link",message:t.getProgramInfoLog(this._program)||""}:{step:"fragment",message:t.getShaderInfoLog(this._fragmentShader)||""}:{step:"vertex",message:t.getShaderInfoLog(this._vertexShader)||""}},Dn);function Dn(t,e){var i=e.vertex,r=e.fragment,n=e.constants,o=e.macros;this._state=On.INIT,this._gl=t,this._vertexSource=i,this._fragmentSource=r,this._constants=G(n||{}),this._macros=G(o||{})}function zn(t,e,i){for(var r=Object.keys(e),n=Object.keys(i),o=0;o<r.length;++o){var s=r[o],a=e[s];t=t.replace("#define "+s+" 0","#define "+s+" "+a)}for(o=0;o<n.length;++o){var u=n[o],value=i[u],l=value+(value%1==0?".0":"");t=t.replace("const float "+u+" = 0.0;","const float "+u+" = "+l+";")}return t}var Bn,Un,Vn=0,jn=((Bn={})[0]={min:"NEAREST",mag:"NEAREST",mipmap:!1},Bn[1]={min:"LINEAR",mag:"LINEAR",mipmap:!1},Bn[2]={min:"LINEAR",mag:"LINEAR",mipmap:!1},Bn[3]={min:"LINEAR_MIPMAP_LINEAR",mag:"LINEAR",mipmap:!0},Bn),Gn=((Un={})[Vn]="ALPHA",Un[1]="RGBA",Un);function Hn(value){return Math.ceil((value+2*rn)/en)*en}function Wn(t,e,i,r,n){for(var o=0,s=t.length;o<s;++o){var a=t[o],u=a.x,l=a.y,d=u+r,h=l+n,c=d<i&&h<i;if(c)for(var f=u;f<d;++f)if(1===e[f+l*i]){c=!1;break}if(c)for(f=l;f<h;++f)if(1===e[u+f*i]){c=!1;break}if(c){for(f=u;f<d;++f)for(var g=l;g<h;++g)e[f+g*i]=1;return t.splice(o,1),t.push({x:u,y:h},{x:d,y:l}),a}}return null}function qn(t,e,i,r,n,o,s){var a=4*t,u=e>>1<<7,l=e%2<<7;s[a]=i/en,s[1+a]=r/en,s[2+a]=u+n/en,s[3+a]=l+o/en}function Xn(t,e,i,r,n,o,s){r|=0,n|=0,o|=0,s|=0,e|=0;for(var a=0;a<o;++a)for(var u=0;u<s;++u){var l=4*(r+a+(n+u)*e),d=4*(a+u*o);t[l]=i[d],t[1+l]=i[1+d],t[2+l]=i[2+d],t[3+l]=i[3+d]}}function Yn(t,e){for(var i=0,r=4,n=0;n<t.length;++n){var o=t[n],s=o.width,a=o.height,u=Hn(s),l=Hn(a);i+=u*l,r=Math.max(r,Math.max(u,l))}var d=qe(Math.max(r,Math.sqrt(i)));return Math.min(d,e)}function Zn(t,e){return Math.floor((e-t)/2)}function Kn(t,e,i,r,n,o,s){var a=jn[o],u=a.min,l=a.mag,d=a.mipmap,h=t[Gn[s]];if(s===Vn){for(var c=new Uint8Array(n*n),f=0;f<c.length;++f)c[f]=r[4*f+3];r=c}t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,h,n,n,0,h,t.UNSIGNED_BYTE,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[l]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[u]),d&&t.generateMipmap(t.TEXTURE_2D)}function Qn(t,e,i,r,n){for(var o=new Uint8Array(i*i*4),s=Math.ceil(i/en),a=new Uint8Array(s*s),u=[{x:0,y:0}],l=0;l<e.length;++l){var d=e[l],h=d.id,c=Hn(d.width)/en,f=Hn(d.height)/en,g=Wn(u,a,s,c,f);if(g){var p=d.width,_=d.height,v=d.pixels,m=c*en,y=f*en,x=g.x*en+Zn(p,m),b=g.y*en+Zn(_,y);Xn(o,i,v,x,b,p,_),qn(h,t,x,b,m,y,n)}else{if(i<r)return Qn(t,e,2*i,r,n);Ci("exceeded max WebGL texture size of "+r+"; some texts/icons/images won't be displayed"),qn(h,t,0,0,0,0,n)}}return{texture:o,size:i}}function Jn(t,e,i,r){for(var n=t.getDistanceFromStrokeVertically,o=t.getDistanceFromStrokeHorizontally,s=e*(1-i)/2,a=(e-1)/2,u=0;u<e;++u)for(var l=0;l<e;++l){var d=4*(l*e+u),h=(u-a)/s,c=(l-a)/s,f=Ye(n(h,c),-1,1),g=Ye(o(h,c),-1,1);to(r,d,$n(f),$n(g))}}function $n(value){return 32768*((value+1)/2)}function to(t,e,i,r){t[e]=i>>8,t[e+1]=i%256,t[e+2]=r>>8,t[e+3]=r%256}function eo(t,e){for(var i=-Math.PI/2,r=2*Math.PI/t.length,n=0,o=t;n<o.length;n++){var s=i+r;e(o[n],i,s),i=s}}function io(r,t,n,o,s){eo(t,function(t,e,i){r.beginPath(),r.moveTo(n,o),r.arc(n,o,s,e,i),r.fillStyle=t,r.fill()})}var ro=(no.prototype.refresh=function(t){for(var e=0,i=t.getShapeList();e<i.length;e++){var r=i[e];if(!this._shapesWritten.includes(r.id)){var n=r.isSimple?32:Jr,o=r.isSimple?this._simpleShapePixels:this._complexShapePixels;Jn(r,n,1/16,o),this._loadShapeInGpu(r.id,n,o),this._shapesWritten.push(r.id)}}},no.prototype._loadShapeInGpu=function(t,e,i){var r=this._gl,n=tn,o=t%$r*Jr,s=Math.floor(t/$r)*Jr;if(this._texture)r.bindTexture(r.TEXTURE_2D,this._texture);else{var a=new Uint8Array(n*n*4);this._texture=r.createTexture(),r.activeTexture(r.TEXTURE0+this._glTextureUnit),r.bindTexture(r.TEXTURE_2D,this._texture),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,n,n,0,r.RGBA,r.UNSIGNED_BYTE,a)}r.texSubImage2D(r.TEXTURE_2D,0,o,s,e,e,r.RGBA,r.UNSIGNED_BYTE,i)},no.prototype.getTextureSize=function(){return tn},no.prototype.getSamplingSize=function(){return Jr},no.prototype.getBufferRatio=function(){return 1/16},no.prototype.getTextureUnit=function(){return this._glTextureUnit},no);function no(t,e){this._gl=t,this._glTextureUnit=e,this._simpleShapePixels=new Uint8Array(4096),this._complexShapePixels=new Uint8Array(65536),this._shapesWritten=[]}var oo=1e20,so=(ao.prototype.setOptions=function(t){var e=t.fontSize,i=void 0===e?24:e,r=t.buffer,n=void 0===r?8:r,o=t.cutoff,s=void 0===o?.25:o,a=t.radius,u=void 0===a?6:a;this._fontSize=i,this._buffer=n,this._cutoff=s,this._radius=u,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5)},ao.prototype.draw=function(t,e,i){An(this._ctx,e,this._fontSize,i);var value,r=this._ctx.measureText(t).width+2*this._buffer,n=(value=r,Math.ceil((value+2*rn)/en)*en-2*rn),o=this._height,s=n*o,a=Math.max(n,o);this._canvas.width<n&&(this._canvas.width=n,An(this._ctx,e,this._fontSize,i),this._ctx.textAlign="center",this._ctx.textBaseline="middle",this._ctx.fillStyle="black"),s>this._gridSize&&(this._gridOuter=new Float64Array(s),this._gridInner=new Float64Array(s),this._gridSize=s),a>this._maxDimension&&(this._f=new Float64Array(a),this._d=new Float64Array(a),this._z=new Float64Array(a+1),this._v=new Int16Array(a),this._maxDimension=a),this._ctx.clearRect(0,0,n,o),this._ctx.fillText(t,n/2,o/2);for(var u=this._ctx.getImageData(0,0,n,o),l=new Uint8ClampedArray(s),d=0;d<s;d++){var h=u.data[4*d+3]/255;this._gridOuter[d]=1==h?0:0==h?oo:Math.pow(Math.max(0,.5-h),2),this._gridInner[d]=1==h?oo:0==h?0:Math.pow(Math.max(0,h-.5),2)}for(uo(this._gridOuter,n,o,this._f,this._d,this._v,this._z),uo(this._gridInner,n,o,this._f,this._d,this._v,this._z),d=0;d<s;d++){var c=this._gridOuter[d]-this._gridInner[d];l[d]=Math.max(0,Math.min(255,Math.round(255-255*(c/this._radius+this._cutoff))))}return{height:o,width:n,distance:l}},ao);function ao(t){var e=void 0===t?{}:t,i=e.fontSize,r=void 0===i?24:i,n=e.buffer,o=void 0===n?8:n,s=e.radius,a=void 0===s?6:s,u=e.cutoff,l=void 0===u?.25:u;this._maxDimension=1,this._gridSize=1,this._fontSize=r,this._buffer=o,this._radius=a,this._cutoff=l,this._height=Math.ceil(this._fontSize+2*this._buffer*1.5),this._canvas=bn(),this._canvas.height=this._height,this._canvas.width=1;var d=this._canvas.getContext("2d");(this._ctx=d).textBaseline="middle",d.textAlign="center",d.fillStyle="black"}function uo(t,e,i,r,n,o,s){for(var a=0;a<e;a++){for(var u=0;u<i;u++)r[u]=t[u*e+a];lo(r,n,o,s,i);for(u=0;u<i;u++)t[u*e+a]=n[u]}for(u=0;u<i;u++){for(a=0;a<e;a++)r[a]=t[u*e+a];lo(r,n,o,s,e);for(a=0;a<e;a++)t[u*e+a]=Math.sqrt(n[a])}}function lo(t,e,i,r,n){r[i[0]=0]=-oo,r[1]=+oo;for(var o=1,s=0;o<n;o++){for(var a=(t[o]+o*o-(t[i[s]]+i[s]*i[s]))/(2*o-2*i[s]);a<=r[s];)s--,a=(t[o]+o*o-(t[i[s]]+i[s]*i[s]))/(2*o-2*i[s]);i[++s]=o,r[s]=a,r[s+1]=+oo}for(o=0,s=0;o<n;o++){for(;r[s+1]<o;)s++;e[o]=(o-i[s])*(o-i[s])+t[i[s]]}}var ho=128-2*rn,co=128-2*rn,fo={fontSize:24,cutoff:.275,radius:6},go={fontSize:24,cutoff:.25,radius:8},po=(_o.prototype.refresh=function(t){this._pixelRatio=t.getPixelRatio();for(var e=this._gl,i=this._getPatternsByFilter(t.getPatternList()),r=0;r<i.length;++r){var n=r,o=i[r],s=Qn(n,o,Yn(o,this._maxTextureSize),this._maxTextureSize,this._patternIdToInfoTexture),a=s.texture,u=s.size,l=this._glTextures[n]||(this._glTextures[n]=e.createTexture()),d=0===n?Vn:1;Kn(e,l,this._glUnit+1+n,a,u,n,d),this._textureSizes[n]=u}var h=this._glTextureInfo||(this._glTextureInfo=e.createTexture()),c=this._patternIdToInfoTexture;Kn(e,h,this._glUnit,c,256,0,1)},_o.prototype.bindMetDataTexture=function(){var t=this._gl;t.activeTexture(t.TEXTURE0+this._glUnit),t.bindTexture(t.TEXTURE_2D,this._glTextureInfo)},_o.prototype.getGranularity=function(){return en},_o.prototype.getInfoTextureUnit=function(){return this._glUnit},_o.prototype.getNearestTextureUnit=function(){return this._glUnit+1+0},_o.prototype.getLinearTextureUnit=function(){return this._glUnit+1+1},_o.prototype.getLinearSdfTextureUnit=function(){return this._glUnit+1+2},_o.prototype.getMipmapTextureUnit=function(){return this._glUnit+1+3},_o.prototype.getInfoTextureSize=function(){return 256},_o.prototype.getNearestTextureSize=function(){return this._textureSizes[0]},_o.prototype.getLinearTextureSize=function(){return this._textureSizes[1]},_o.prototype.getLinearSdfTextureSize=function(){return this._textureSizes[2]},_o.prototype.getMipmapTextureSize=function(){return this._textureSizes[3]},_o.prototype._getPatternsByFilter=function(t){for(var e=new Array(4),i=0;i<4;++i)e[i]=[];for(i=0;i<t.length;++i){var r=this._getPatternPixels(t[i]);e[r.filter].push(r)}return e},_o.prototype._getPatternPixels=function(t){var e,i=t.id,r=t.type,n=t.attributes,o=n.text,s=n.font,a=n.style,u=n.image,l=n.scaled,d=n.duplicated,h=n.colorArray;switch(r){case Pr:e=d?this._getDuplicatedImagePixels(u):l?this._getScaledImagePixels(u):this._getNonScaledImagePixels(u);break;case 3:e=this._getSdfTextPixels(o,s,a);break;case zr:e=this._getIconPixels(o,s,a);break;case Br:e=this._getBadgeIconPixels(o,s,a);break;case Dr:e=this._getPieChartPixels(h);break;default:throw new Error('pattern type "'+r+'" does not exist')}return e.id=i,e},_o.prototype._getScaledImagePixels=function(t){var e=t.width,i=t.height;if(nn<e||nn<i){var r=nn/Math.max(t.width,t.height);e*=r,i*=r}return e&&i&&(e=Hn(e),i=Hn(i)),e-=2*rn,i-=2*rn,this._getImagePixels(t,e,i)},_o.prototype._getNonScaledImagePixels=function(t){return this._getImagePixels(t,t.width,t.height)},_o.prototype._getDuplicatedImagePixels=function(t){if(0===t.width||0===t.height)return this._getImagePixels(t,0,0);this._canvasForDuplicatedImage||(this._canvasForDuplicatedImage=bn(),this._canvasForDuplicatedImage.width=nn,this._canvasForDuplicatedImage.height=nn);for(var e=this._canvasForDuplicatedImage,i=e.getContext("2d"),r=t.width,n=t.height,o=(nn-r)/2,s=(nn-n)/2;0<o;)o-=r;for(;0<s;)s-=n;for(var a=o;a<nn;a+=r)for(var u=s;u<nn;u+=n)i.drawImage(t,a,u);return this._getImagePixels(e,nn,nn)},_o.prototype._getImagePixels=function(t,e,i){var r;if(0===e||0===i)r=new Uint8Array(0);else{(this._imageCanvas.width<e||this._imageCanvas.height<i)&&(this._imageCanvas.width=e,this._imageCanvas.height=i);var n=this._imageCanvasContext;En(this._imageCanvas,n,e,i);try{n.drawImage(t,0,0,e,i)}catch(t){}r=n.getImageData(0,0,e,i).data}return{width:e,height:i,pixels:r,filter:3}},_o.prototype._getPieChartPixels=function(t){var e=co,i=this._imageCanvasContext,r=e/2,n=e/2;return En(this._imageCanvas,i,e,e),i.save(),i.rect(0,0,e,e),i.clip(),io(i,t,r,n,e),i.restore(),{width:e,height:e,pixels:i.getImageData(0,0,e,e).data,filter:1}},_o.prototype._getTextPixels=function(t,e,i,r,n,o){var s=this._imageCanvasContext,a=n*this._pixelRatio;An(s,i,a,r);var u=Math.ceil(s.measureText(e).width);0===u&&(u=a);var l=0,d=0;3===t||(l=2*Math.ceil(1.5*a/2),d=2*Math.ceil(u/2));var h=Math.ceil(u+d),c=Math.ceil(a+l),f=this._imageCanvas.height<c||this._imageCanvas.width<h;return this._imageCanvas.height<c&&(this._imageCanvas.height=c),this._imageCanvas.width<h&&(this._imageCanvas.width=h),f&&An(s,i,a,r),s.clearRect(0,0,h,c),s.fillStyle="black",s.textBaseline="middle",s.textAlign="left",s.fillText(e,o+d/2,c/2),{width:h,height:c,pixels:s.getImageData(0,0,h,c).data,filter:t}},_o.prototype._getIconPixels=function(t,e,i){return this._getTextPixels(3,t,e,i,ho,0)},_o.prototype._getBadgeIconPixels=function(t,e,i){return this._sdfGenerator.setOptions(go),this._getSdfPixels(t,e,i)},_o.prototype._getSdfTextPixels=function(t,e,i){return this._sdfGenerator.setOptions(fo),this._getSdfPixels(t,e,i)},_o.prototype._getSdfPixels=function(t,e,i){for(var r=this._sdfGenerator.draw(t,e,i),n=r.width,o=r.height,distance=r.distance,s=new Uint8Array(n*o*4),a=0;a<distance.length;++a)s[4*a+3]=distance[a];return{width:n,height:o,pixels:s,filter:2}},_o);function _o(t,e){this._patternIdToInfoTexture=new Uint8Array(262144),this._glTextures=[],this._textureSizes=[],this._pixelRatio=1,this._gl=t,this._glUnit=e;var i=bn();i.width=nn,i.height=nn,this._imageCanvasContext=i.getContext("2d"),this._imageCanvas=i,this._canvasForDuplicatedImage,this._sdfGenerator=new so(fo),this._maxTextureSize=Math.min(4096,t.getParameter(t.MAX_TEXTURE_SIZE))}function vo(){var t=xt(),e=t.styleSheets;if(!e||!t.location)return Promise.resolve([]);for(var i=qt(t),r=[],n=[],o=0;o<e.length;o++){var s=e[o];null===s.href?r.push({href:i,content:s.ownerNode.textContent}):n.push(s.href)}var a=/@font-face\s*\{[^}]+\}/g;return Promise.all(n.map(function(e){return Bt(e).then(function(t){return{href:e,content:t}}).catch(function(){return null})})).then(function(t){return t.concat(r)}).then(function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];if(null!==r){var n=r.href,o=r.content.match(a);if(o){var s=xo(o,n);e.push.apply(e,s)}}}return e})}function mo(t,r){return Promise.all(t.map(function(t){var e=t.formats,o=t.originalRule;return Promise.all(e.map(function(t){var e=t.format,i=t.url;return r?Gt(i).then(function(t){return{format:e,src:t}}).catch(function(){return null}):{format:e,src:i}})).then(function(t){for(var e=[],i=0;i<t.length;i++){var r=t[i];null!==r&&e.push("url('"+r.src+"') format('"+r.format+"')")}if(0===e.length)return o;var n="src: "+e.join(",")+";";return o.replace(/src\s*:[^;]+;/g,n)})}))}var yo={"embedded-opentype":!0,svg:!0};function xo(t,e){for(var i=/url\(['"]?([^'")]+)['"]?\)\s+format\(['"]?([^'")]+)['"]?\)/g,r=/font-family\s*:\s*['"]?([^;'"]+)['"]?;/,n=[],o=0;o<t.length;o++){var s=t[o],a=s.match(r);if(a){for(var u=a[1],l=[],d=void 0;d=i.exec(s);){var h=d[1],c=d[2];yo[c.toLowerCase()]||l.push({format:c,url:bo(h,e)})}n.push({name:u,formats:l,originalRule:s})}}return n}function bo(t,e){if(/^http(s)?:/.test(t))return t;if("/"===t[0]){var i=e.match(/((\w+:\/\/)([^/]+))/);return i?i[1]+t:t}var r=t.split("/"),n=e.split("/");for("/"!==e[e.length-1]&&n.pop();".."===r[0];)r.shift(),n.pop();return n.concat(r).join("/").replace(/[\w](\/{2,})/g,function(t){return t[0]+"/"})}function Eo(t){if(t.keys)return Array.from(t.keys());var i=[];return t.forEach(function(t,e){return i.push(e)}),i}function Ao(t){if(t.values)return Array.from(t.values());var e=[];return t.forEach(function(value){return e.push(value)}),e}var So=(wo.prototype.reserve=function(t){if(this._capacity<t){t=Math.pow(2,Math.ceil(Math.log2(t+1)));var e=new Uint32Array(t);e.set(this._array),this._capacity=t,this._array=e}},wo.prototype.has=function(value){var t=To(this._array,value,0,this.length);return t<this.length&&this._array[t]===value},wo.prototype.add=function(value){var t=To(this._array,value,0,this.length),e=t<this.length&&this._array[t]===value;return e||(this.length===this._capacity&&this.reserve(this.length+1),this._array.copyWithin(t+1,t,this.length),this._array[t]=value,this.length+=1),!e},wo.prototype.remove=function(value){var t=To(this._array,value,0,this.length),e=t<this.length&&this._array[t]===value;return e&&(this._array.copyWithin(t,t+1,this.length),--this.length),e},wo.prototype.removeByPosition=function(t){return!(t>=this.length||(this._array.copyWithin(t,t+1,this.length),--this.length,0))},wo.prototype.get=function(t){return this._array[t]},wo.prototype.clear=function(){this.length=0},wo.prototype.slice=function(){return this._array.slice(0,this.length)},wo);function wo(){this._array=new Uint32Array(8),this._capacity=8,this.length=0,this._array=new Uint32Array(8),this._capacity=8,this.length=0}function To(t,e,i,r){if(i===r)return i;var n=i+((r-i)/2|0),o=e-t[n];return 0==o?n:o<0?To(t,e,i,n):To(t,e,n+1,r)}var Co="undefined"==typeof HTMLElement?function(t){return!1}:function(t){return t instanceof HTMLElement},Mo=function(t){return"object"!=typeof t||null===t||L(t)||((e=t)instanceof RegExp||e instanceof Date);var e};function Io(t,e,i){if(void 0===e&&(e=[]),void 0===i&&(i=[]),!Co(t)){if(Mo(t))e.push({path:i.slice(),value:t});else for(var r=Object.keys(t),n=0;n<r.length;++n){var o=r[n],s=i.slice();s.push(o),Io(t[o],e,s)}return e}}var Lo=(Object.defineProperty(No.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),No.prototype.set=function(t,value){var e=this._getIndex(t);-1!==e?this._values[e]=value:(Oo(this._cachedPath,t)&&(this._cachedIndex=this._keys.length),this._keys.push(t),this._values.push(value),this._size+=1)},No.prototype.get=function(t){var e=this._getIndex(t);if(-1!==e)return this._values[e]},No.prototype.has=function(t){return-1!==this._getIndex(t)},No.prototype.keys=function(){return this._keys.slice()},No.prototype._getIndex=function(t){if(Oo(t,this._cachedPath))return this._cachedIndex;this._cachedPath=t.slice();for(var e=this._keys,i=0;i<e.length;++i)if(Oo(e[i],t))return this._cachedIndex=i;return this._cachedIndex=-1},No);function No(){this._keys=[],this._values=[],this._size=0,this._cachedPath=[],this._cachedIndex=-1}function Oo(t,e){if(t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return;return 1}}var ko=Set.prototype.keys?function(t){return Array.from(t.keys())}:function(t){var e=[];return t.forEach(function(t){return e.push(t)}),e},Fo=Set.prototype.values?function(t){return Array.from(t.values())}:function(t){var e=[];return t.forEach(function(t,value){return e.push(value)}),e},Ro=M("webworker-threads"),Po=Ro?Ro.Worker:null;function Do(t){return Po?function t(e){{if(ArrayBuffer.isView(e))return Array.from(e);if(Array.isArray(e)){for(var i=0;i<e.length;++i)e[i]=t(e[i]);return e}if($(e)){for(var r=Object.keys(e),n=0,o=r;n<o.length;n++){var s=o[n];e[s]=t(e[s])}return e}}return e}(t):t}function zo(t){return Po?function(t){if(Po)return new Po(new Function(t))}(t):"undefined"==typeof URL||-1!==navigator.appVersion.indexOf("MSIE 10")?new Bo(t):function(e){try{var t=new Blob([e],{type:"application/javascript"}),i=URL.createObjectURL(t);return new Worker(i)}catch(t){return new Bo(e)}}(t)}var Bo=(Uo.prototype.terminate=function(){this._terminated=!1,this._otherSide._terminated=!0},Uo.prototype.addEventListener=function(t,e){this._listeners.push(e)},Uo.prototype.postMessage=function(t){setTimeout(Ho,0,this._otherSide,{data:t})},Uo);function Uo(t){this._main=!0,this._listeners=[],this._terminated=!1,this._f=new Function("self",t),this._otherSide=new jo(this),this._f(this._otherSide)}var Vo,jo=(Go.prototype.addEventListener=function(t,e){this._listeners.push(e)},Go.prototype.postMessage=function(t){setTimeout(Ho,0,this._otherSide,{data:t})},Go);function Go(t){this._listeners=[],this._main=!1,this._terminated=!1,this._otherSide=t}function Ho(t,e){if(!t._terminated)for(var i=0;i<t._listeners.length;++i)t._listeners[i](e)}var Wo=M("xmldom");Vo="undefined"!=typeof XMLSerializer?XMLSerializer:Wo?Wo.XMLSerializer:null;var qo=(Xo.prototype.setAttribute=function(t,value){this._attributes[t]=value},Xo.prototype.appendChild=function(t){this._children.push(t)},Object.defineProperty(Xo.prototype,"tagName",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"childNodes",{get:function(){return this._children},enumerable:!0,configurable:!0}),Object.defineProperty(Xo.prototype,"firstChild",{get:function(){return this._children[0]||null},enumerable:!0,configurable:!0}),Xo.prototype.serialize=function(){var t=this._name,e=this._attributes,i=this._children,r=Object.keys(e).filter(function(t){return void 0!==e[t]}).map(function(t){return" "+t+'="'+e[t]+'"'}).join(""),n=i.map(function(t){return t.serialize()}).join("");return n.length?"<"+t+r+">"+n+"</"+t+">":"<"+t+r+"/>"},Xo.prototype.cloneNode=function(t){for(var e=new Xo(this._name),i=0,r=Object.keys(this._attributes);i<r.length;i++){var n=r[i];e.setAttribute(n,this._attributes[n])}if(t)for(var o=0;o<this._children.length;o++)e.appendChild(this._children[o].cloneNode(t));return e},Xo);function Xo(t){this._attributes={},this._children=[],this._name=t}var Yo=(Zo.prototype.serialize=function(){return this._text},Zo.prototype.cloneNode=function(){return new Zo(this._text)},Zo);function Zo(t){this._text=t}var Ko=(Qo.prototype.appendChild=function(t){this._children.push(t)},Qo.prototype.serialize=function(){return this._meta.concat(this._children.map(function(t){return t.serialize()})).join("")},Qo.prototype.createElement=function(t){return new qo(t)},Qo.prototype.createTextNode=function(t){return new Yo(t)},Qo);function Qo(){this._children=[],this._meta=[],this._children=[],this._meta=[]}function Jo(){return new Ko}function $o(t){if(Vo)return(new Vo).serializeToString(t)}function ts(){return xt().implementation.createDocument("","",null)}var es=(is.prototype.add=function(t){var e=this._keyToIndex[t];-1===e&&(e=this._size++,this._heap[e]=t),this._keyToIndex[t]=this._bubble(e)},is.prototype.removeMin=function(){if(0===this._size)return NaN;var t=this._heap[0];return this._heap[0]=this._heap[--this._size],this._bubble(0),t},is.prototype.isEmpty=function(){return 0===this._size},is.prototype.has=function(t){return-1!==this._keyToIndex[t]},is.prototype._bubble=function(t){var value=this._indexToValue(t),e=this._getParentIndex(t),i=this._indexToValue(e),r=t;if(0!==t&&value<i)r=this._swap(t,e);else{var n=this._getLeftChildIndex(t),o=this._getRightChildIndex(t),s=this._indexToValue(n),a=this._indexToValue(o),u=Math.min(value,s,a);u===value||(r=u===s?this._swap(t,n):this._swap(t,o))}return r===t?t:this._bubble(r)},is.prototype._indexToValue=function(t){return t>=this._size?1/0:this._keyToValue[this._heap[t]]},is.prototype._getParentIndex=function(t){return(t-1)/2|0},is.prototype._getLeftChildIndex=function(t){return 2*t+1},is.prototype._getRightChildIndex=function(t){return 2*t+2},is.prototype._swap=function(t,e){var i=this._heap[t],r=this._heap[e];return this._heap[t]=r,this._heap[e]=i,this._keyToIndex[i]=e,this._keyToIndex[r]=t,e},is);function is(t){this._heap=[],this._size=0,this._keyToValue=t,this._keyToIndex=new Int32Array(t.length),this._keyToIndex.fill(-1)}var rs=(ns.prototype._get=function(t){return t.isNode?this._nodes:this._edges},ns.prototype.addOrRemoveElements=function(t,e){return e?this.addElements(t):this.removeElements(t)},ns.prototype.addElements=function(t){for(var e=this._get(t),i=e.elementList,r=e.flexArray,n=e.indexList,o=n.getLength(),s=0;s<t._indexes.length;s++){var a=t._indexes[s];1!==r.get(a)&&(r.set(a,1),n.pushUnchecked(a))}return i(n.slice(o))},ns.prototype.removeElements=function(t){for(var e=this._get(t),i=e.elementList,r=e.flexArray,n=e.indexList,o=n.getLength(),s=n.getBuffer(),a=0,u=0;u<t._indexes.length;u++){var l=t._indexes[u];0!==r.get(l)&&(r.set(l,0),a+=1)}if(a===o)return i(n.sliceAndReset());if(0===a)return i();var d=this._graph.acquireIndexList(t.isNode),h=0;for(u=0;u<o;++u)l=s[u],0===r.get(l)?(h+=1,d.pushUnchecked(l)):s[u-h]=l;return n.setLength(o-a),i(d.sliceAndReset())},ns.prototype.hasElement=function(t){return!!this._get(t).flexArray.get(t._index)},ns.prototype.clear=function(){this._nodes.indexList.isEmpty()||(this._nodes.indexList.reset(),this._nodes.flexArray.reset()),this._edges.indexList.isEmpty()||(this._edges.indexList.reset(),this._edges.flexArray.reset())},ns.prototype.isEmpty=function(){return this._nodes.indexList.isEmpty()&&this._edges.indexList.isEmpty()},ns.prototype.getElements=function(){return{nodes:this._nodes.elementList(this._nodes.indexList.slice()),edges:this._edges.elementList(this._edges.indexList.slice())}},ns);function ns(t,e){this._graph=t,this._nodes={elementList:t.nodeList,flexArray:t.createNodeAttribute({storage:1,name:e}),indexList:t.createIndexList(!0)},this._edges={elementList:t.edgeList,flexArray:t.createEdgeAttribute({storage:1,name:e}),indexList:t.createIndexList(!1)}}var os=function(){return{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}},ss=(as.prototype.reset=function(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.minScaledSize=1/0,this.maxScaledSize=-1/0,this.minFixedSize=1/0,this.maxFixedSize=-1/0,this.width=0,this.height=0,this.cx=0,this.cy=0,this},as.prototype.addPoint=function(t,e,i,r){return this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,e),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,e),void 0!==i&&void 0!==r&&("scaled"===r?(this.minScaledSize=Math.min(this.minScaledSize,i),this.maxScaledSize=Math.max(this.maxScaledSize,i)):(this.minFixedSize=Math.min(this.minFixedSize,i),this.maxFixedSize=Math.max(this.maxFixedSize,i))),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY,this},as.prototype.computeForZoom=function(t){var e=Math.max(this.maxScaledSize,this.maxFixedSize/t);return as.from({minX:this.minX-e/2,minY:this.minY-e/2,maxX:this.maxX+e/2,maxY:this.maxY+e/2,width:this.width+e,height:this.height+e})},as.from=function(t){var e=void 0===t?{}:t,i=e.minX,r=e.minY,n=e.maxX,o=e.maxY,s=e.width,a=e.height,u=new as;return null!=i&&(u.minX=i),null!=r&&(u.minY=r),null!=n&&(u.maxX=n),null!=o&&(u.maxY=o),null!=n&&null!=i&&(u.width=s||(n-i)/2,u.cx=(i+n)/2),null!=o&&null!=r&&(u.height=a||(o-r)/2,u.cy=(r+o)/2),u},as.fromValues=function(t,e,i){for(var r=1/0,n=1/0,o=-1/0,s=-1/0,a=-1/0,u=0;u<t.length;u++){var l=t[u],d=e[u],h=i[u];l-h<r&&(r=l-h),d-h<n&&(n=d-h),o<l+h&&(o=l+h),s<d+h&&(s=d+h),a<h&&(a=h)}var c=as.from({minX:r,minY:n,maxX:o,maxY:s});return c.maxScaledSize=a,c},as.prototype.pad=function(value){return this.minX-=value,this.minY-=value,this.maxX+=value,this.maxY+=value,this.width+=2*value,this.height+=2*value,this},as.prototype.isValid=function(){return isFinite(this.width)&&isFinite(this.height)},as.prototype.extend=function(t){return this.addPoint(t.minX,t.minY),this.addPoint(t.maxX,t.maxY),this},as.prototype.bottomLeft=function(){return{x:this.minX,y:this.minY}},as.prototype.topRight=function(){return{x:this.maxX,y:this.maxY}},as);function as(t){void 0===t&&(t={});var e=t.xValues,i=void 0===e?[]:e,r=t.yValues,n=void 0===r?[]:r,o=t.scaledSizeValues,s=void 0===o?[]:o,a=t.fixedSizeValues,u=void 0===a?[]:a;this.minX=Je(i),this.minY=Je(n),this.maxX=Qe(i),this.maxY=Qe(n),this.minScaledSize=Je(s),this.maxScaledSize=Qe(s),this.minFixedSize=Je(u),this.maxFixedSize=Qe(u),this.cx=this.minX+(this.maxX-this.minX)/2,this.cy=this.minY+(this.maxY-this.minY)/2,this.width=this.maxX-this.minX,this.height=this.maxY-this.minY}var us=(ls.prototype.on=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");if("function"!=typeof e)throw new TypeError("Event handler must be function");var i=this._events=this._events||{};return(i[t]=i[t]||[]).push(e),this},ls.prototype.off=function(t,e){if("string"!=typeof t)throw new TypeError("Event name must be string");var i=this._events=this._events||{},r=i[t];if(L(r))if("function"!=typeof e)i[t]=null;else{var n=r.indexOf(e);-1!==n&&r.splice(n,1),0===r.length&&(i[t]=null)}return this},ls.prototype.fire=function(t){for(var e=arguments,i=[],r=1;r<arguments.length;r++)i[r-1]=e[r];if("string"!=typeof t)throw new TypeError("Event name must be string");var n=(this._events=this._events||{})[t];if(L(n))for(var o=i,s=0;s<n.length;s++){var a=n[s];a&&a.apply(this,o)}return this},ls.prototype.once=function(r,n){var o=this,s=function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];n.apply(o,e),o.off(r,s)};return s.handler=n,this.on(r,s)},ls.prototype.hasListener=function(t,e){if(!t||!e)return!1;var i=(this._events=this._events||{})[t];if(L(i))for(var r=0,n=i.length;r<n;r++){var o=i[r];if(o===e||o.handler===e)return!0}return!1},ls.prototype.getListeners=function(t){return(this._events=this._events||{})[t]},ls);function ls(){}var ds=Object.freeze({__proto__:null,BoundingBox:ss,FlexArray:je,EventTarget:us,ColorManager:kr,Table:ni,requestAnimFrame:ot,cancelAnimFrame:st,getDocument:xt,getStyle:bt,DummyDomElement:Et,createDummyDomElement:St,getPixelRatio:wt,dataUrlToBlob:Tt,createBlob:Mt,isBlob:function(t){return"undefined"!=typeof Blob&&t instanceof Blob||t instanceof Ct},promptDownload:It,resizeElement:Lt,setAttributes:Nt,SVG_NS:Ot,XML_NS:kt,XLINK:Ft,createSvgElement:Rt,createTextNode:Pt,getImage:Dt,fetch:Bt,isHTMLElement:Ut,applyCursorStyle:Vt,fetchBinary:jt,fetchBinaryAsBase64:Gt,escapeDOMAttribute:Ht,BUTTON_MAPPING:Wt,baseURI:qt,fadeElement:Xt,DummyCanvas:_n,DummyCanvasRenderingContext2D:mn,createCanvas:bn,clearCanvas:En,setCtxFont:An,isWebGLSupported:Sn,getWebglContext:wn,getDocumentFontRules:vo,getEmbeddedFontRules:mo,resolvePath:bo,IndexList:ti,mapKeys:Eo,mapValues:Ao,isInteger:function(t){return"number"==typeof t&&t%1==0},toPropertyPath:R,throttle:P,debounce:function(e,i,r){var n,o,s,a,u,l=0===i||void 0===i?100:i;function d(){var t=Date.now()-a;t<l&&0<=t?n=setTimeout(d,l-t):(n=null,r||(u=e.apply(s,o),s=o=null))}function t(){s=this,o=arguments,a=Date.now();var t=r&&!n;return n=n||setTimeout(d,i),t&&(u=e.apply(s,o),s=o=null),u}return t.clear=function(){n&&(clearTimeout(n),n=null)},t.flush=function(){n&&(u=e.apply(s,o),s=o=null,clearTimeout(n),n=null)},t},processQueue:function(i,r){return new Promise(function(t,e){return function e(i,r,n,o,s){n(i[r],r,i,o,s).then(function(t){r===i.length-1?o(t):e(i,r+1,n,o,s)}).catch(s)}(i,0,r,t,e)})},isLittleEndian:D,promiseQueue:z,hash8:B,unorderedHash:function(t,e){return t<e?t*e+Math.pow(e-t-1,2)/4:t*e+Math.pow(t-e-1,2)/4},isRawObject:U,getValues:V,forEach:j,deepCopy:G,updateObject:function e(i,t){j(t,function(t,value){"object"==typeof value&&null!==value?("object"==typeof i[t]&&null!==i[t]||(i[t]={}),e(i[t],value)):i[t]=value})},extendList:function(e,t){t.forEach(function(t){-1===e.indexOf(t)&&e.push(t)})},setProperty:H,getProperty:W,flatten:q,unflatten:Y,getFlattenedKeys:Z,getLeafValues:K,ensureTransferable:Q,getOptions:J,isObject:$,mergeValues:tt,pick:et,objToValueList:Io,PathMap:Lo,smartRequire:M,setKeys:ko,setValues:Fo,getCurrentTime:Kt,getDate:Qt,getTime:Jt,formatWorkerMessage:Do,createWorker:zo,insertSortAsc:X,insertSortDesc:function(t,e){for(var i=1,r=t.length;i<r;i++){for(var n=t[i],o=i;0<o&&e.get(t[o-1])<e.get(n);)t[o]=t[o-1],--o;t[o]=n}return t},isArray:L,toArray:N,flattenArray:O,concatenateArrays:function(){for(var t=arguments,e=[],i=0;i<arguments.length;i++)e[i]=t[i];if(0===e.length)return[];for(var r=e[0].constructor,n=0,o=0,s=e;o<s.length;o++){n+=(h=s[o]).length}for(var a=new r(n),u=0,l=0,d=e;l<d.length;l++){for(var h=d[l],c=0;c<h.length;c++)a[u+c]=h[c];u+=h.length}return a},removeFromArray:k,binaryIndexOf:F,parseColorRgba:Mr,toHexa:Ir,componentsToRGBA:Lr,parseColorHex:Nr,createDummyXmlDocument:Jo,serializeXMLDocument:$o,createXmlDocument:ts,PrioritySet:es,nextPowerOfTwo:qe,computeSum:Xe,clamp:Ye,mix:Ze,lerp:Ke,computeMax:Qe,computeMin:Je,getBaseLog:$e,ElementSet:rs,displayPixelsOnScreen:function(t,e,i,r){void 0===r&&(r=0),void 0===e&&(e=i=Math.sqrt(t.length/4)),void 0===i&&(i=e);var n=document.createElement("canvas"),o=n.getContext("2d");if(o){var s=o.createImageData(e,i);n.style.imageRendering="pixelated",n.style.border="1px solid black",n.style.margin="2px",n.style.position="absolute",n.style.top=n.style.left="0px",n.width=e,n.height=i,s.data.set(t),o.putImageData(s,0,0);var a=document.getElementById("graph-container");a&&(a.style.position="static"),setTimeout(function(){return document.body.appendChild(n)},r)}}}),hs={byte:1,ubyte:1,short:2,ushort:2,ulong:4,float:4},cs={byte:"BYTE",ubyte:"UNSIGNED_BYTE",short:"SHORT",ushort:"UNSIGNED_SHORT",ulong:"UNSIGNED_LONG",float:"FLOAT"},fs=(gs.prototype._finishInit=function(){var e=this,i=this._gl,t=this._ext,r=this._programWrapper.getError();if(r)throw new Error('WebGL compilation at step "'+r.step+":\n"+r.message+'"');var n=this._programWrapper.getProgram();this._program=n,i.useProgram(n),this._metaData.attributes.forEach(function(t){t.location=i.getAttribLocation(e._program,t.name),t.byteSize=t.size*hs[t.type],t.glType=cs[t.type]}),this._specialAttributes=this._createSpecialAttributesFunctions();for(var o=[],s=[],a=0,u=this._metaData.attributes;a<u.length;a++){var l=u[a];-1!==l.location&&(l.name.startsWith("a_text")?s.push(l):o.push(l))}this._baseAttributes=_s(o,i,t),this._textAttributes=_s(s,i,t),this._setupUniforms=function(t,e,i){for(var r={},n=[],o=0;o<t.length;++o){var s=t[o],a=s.id,u=s.name,l=s.type,d=e.getUniformLocation(i,u),h=ps[l](a);d&&(r[a]=d,n.push(h))}var c=new Function("gl","l","u",n.join("\n"));return function(t){return c(e,r,t)}}(this._metaData.uniforms,i,n)},gs.prototype._createSpecialAttributesFunctions=function(){return _s([{location:this._gl.getAttribLocation(this._program,this._metaData.vertexInfoAttribute),size:3,glType:"BYTE",byteSize:3,type:"byte",name:"special"}],this._gl,this._ext)},gs.prototype.startPass=function(t){this._program||this._finishInit(),this._gl.useProgram(this._program),this._resetStencil(),this._setupUniforms(t),this._specialAttributes.enable(),this._specialAttributes.setup(this._specialGlBuffers.vertexInfo,null,0)},gs.prototype._setupAttributes=function(t,e){var i=e.glBuffer,r=e.dataBuffer,n=e.divisor;t.enabled&&!i?t.disable():!t.enabled&&i&&t.enable(),i&&t.setup(i,r,n)},gs.prototype.setupBaseAttributes=function(t){this._setupAttributes(this._baseAttributes,t)},gs.prototype.setupTextAttributes=function(t){this._setupAttributes(this._textAttributes,t)},gs.prototype._resetStencil=function(){var t=this._gl;this._stencilUsage=1,t.disable(t.STENCIL_TEST)},gs.prototype.setupStencil=function(t){if(t!==this._stencilUsage){var e=this._gl;1!==t?(e.enable(e.STENCIL_TEST),2===t?(e.stencilOp(e.KEEP,e.KEEP,e.REPLACE),e.stencilFunc(e.ALWAYS,1,1)):3===t&&(e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.stencilFunc(e.EQUAL,0,1))):e.disable(e.STENCIL_TEST),this._stencilUsage=t}},gs.prototype.endPass=function(){this._specialAttributes.disable(),this._baseAttributes.disable(),this._textAttributes.disable()},gs);function gs(t){var e=t.gl,i=t.ext,r=t.specialGlBuffers,n=t.metaData,o=t.programWrapper;this._stencilUsage=1,this._gl=e,this._ext=i,this._specialGlBuffers=r,this._metaData=G(n),this._programWrapper=o}var ps={int:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},sampler2D:function(t){return"gl.uniform1i(l."+t+", u."+t+");"},float:function(t){return"gl.uniform1f(l."+t+", u."+t+");"},vec2:function(t){return"gl.uniform2f(l."+t+", u."+t+"[0], u."+t+"[1]);"},vec3:function(t){return"gl.uniform3f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2]);"},vec4:function(t){return"gl.uniform4f(l."+t+", u."+t+"[0], u."+t+"[1], u."+t+"[2], u."+t+"[3]);"}};function _s(t,e,i){var r,n,o,s,a,u,l,d,h,c,f,g,p,_=(r=e,n=t.map(function(t){return"gl.enableVertexAttribArray("+t.location+");"}).join("\n"),o=new Function("gl",n),function(){return o(r)}),v=(s=e,a=t.map(function(t){return"gl.disableVertexAttribArray("+t.location+");"}).join("\n"),u=new Function("gl",a),function(){return u(s)});return{enable:function(){_(),this.enabled=!0},disable:function(){v(),this.enabled=!1},setup:(d=e,h=i,c=(l=t).reduce(function(t,e){return t+e.byteSize},0),f=0,g=E(["gl.bindBuffer(gl.ARRAY_BUFFER, glBuffer);","if (dataBuffer) gl.bufferData(gl.ARRAY_BUFFER, dataBuffer, gl.STATIC_DRAW);"],l.map(function(t){var e=t.location,i=t.size,r=t.glType,n=t.byteSize,o="gl.vertexAttribPointer(\n        "+e+", "+i+", gl."+r+",\n        false, "+c+", "+f+"\n      );";return f+=n,o}),l.map(function(t){return"ext.vertexAttribDivisorANGLE("+t.location+", divisor);"})).join("\n"),p=new Function("gl","ext","glBuffer","dataBuffer","divisor",g),function(t,e,i){return p(d,h,t,e,i)}),enabled:!1}}var vs=(ms.prototype.setDataBuffer=function(t){this._dataBuffer!==t&&(this._program=t.isAnimated()?this._animationProgram:this._staticProgram,this._dataBuffer=t,this._dataBufferChanged=!0,t.hasSideData()&&!this._sideGlBuffer?this._sideGlBuffer=this._gl.createBuffer():!t.hasSideData()&&this._sideGlBuffer&&(this._gl.deleteBuffer(this._sideGlBuffer),delete this._sideGlBuffer))},ms.prototype.markAsUnused=function(){return this._used=!1,this},ms.prototype.getProgram=function(){return this._program},ms.prototype.markAsUsed=function(){return this._used=!0,this},ms.prototype.isUsed=function(){return this._used},ms.prototype.draw=function(){var t=this._gl,e=this._dataBuffer.getElementType(),i=2===e,r=i?this._dataBuffer.getNbSideElementsPerMainElement():1,n=3===e?41:1,o=this._dataBuffer.getSize(),s=this._dataBuffer.getStencilUsage(),a=this._dataBuffer.getVersion(),u=this._version!==a||this._dataBufferChanged;this._program.setupBaseAttributes({glBuffer:this._glBuffer,dataBuffer:u?this._dataBuffer.getByteArray():null,divisor:r}),this._program.setupTextAttributes({glBuffer:this._sideGlBuffer,dataBuffer:u&&i?this._dataBuffer.getSideByteArray():null,divisor:1}),this._program.setupStencil(s),u&&(this._version=a,this._dataBufferChanged=!1),this._ext.drawArraysInstancedANGLE(t.TRIANGLES,0,6*n,o*r)},ms.prototype.destroy=function(){this._gl.deleteBuffer(this._glBuffer),this._sideGlBuffer&&this._gl.deleteBuffer(this._sideGlBuffer)},ms);function ms(t){var e=t.gl,i=t.ext,r=t.staticProgram,n=t.animationProgram;this._version=0,this._used=!1,this._dataBufferChanged=!1,this._gl=e,this._ext=i,this._staticProgram=r,this._animationProgram=n,this._glBuffer=this._gl.createBuffer()}function ys(t,e){if(e<2)return t;for(var i=t.split("\n"),r=[],n=0;n<i.length;++n){var o=i[n];if(o.length<e)r.push(o);else for(var s=xs(i[n],e),a=0;a<s.length;++a)r.push(s[a])}return r.join("\n")}function xs(t,e){for(var i=t.split(" "),r=[],n=0,o=-1,s=!0,a=0;a<i.length;++a)if(s){if(i[a].length>e){for(var u=bs(i[a],e),l=0;l<u.length;++l)r.push([u[l]]),++o;n=u[u.length-1].length}else r.push([i[a]]),++o,n=i[a].length+1;s=!1}else n+i[a].length<=e?(r[o].push(i[a]),n+=i[a].length+1):(s=!0,--a);var d=[];for(a=0;a<r.length;++a)d.push(r[a].join(" "));return d}function bs(t,e){for(var i=[],r=0;r<t.length;r+=e-1)i.push(t.substr(r,e-1)+"-");var n=i[i.length-1].length;return i[i.length-1]=i[i.length-1].substr(0,n-1)+" ",i}function Es(t,e){if(null===t)return null;for(var i=(t=t.toString()).split("\n"),r=[],n=0,o=0;o<i.length;o++){var s=i[o];if(!e||e<=1||s.length<e)r.push(s),n=Math.max(n,s.length);else for(var a=xs(i[o],e),u=0;u<a.length;u++)s=a[u],r.push(s),n=Math.max(n,s.length)}return{data:r,maxLength:n,lines:r.length}}function As(){var t=M("@mapbox/mapbox-gl-rtl-text")||M("mapbox-gl-rtl-text"),e=t?t.processBidirectionalText:ft?window.processBidirectionalText:null,i=t?t.applyArabicShaping:ft?window.applyArabicShaping:null;return{processBidirectionalText:e?function(t){return e(t,[]).join("")}:function(t){return t},applyArabicShaping:i?function(t){return null===t?null:"number"==typeof t?t.toString():i(t)}:function(t){return null===t?null:t.toString()}}}var Ss=D(),ws="\n".charCodeAt(0),Ts=(Cs.prototype._init=function(){this._mustClear=!1,this._clear()},Cs.prototype.reset=function(){this._init()},Cs.prototype.clear=function(){this._mustClear=!0},Cs.prototype._measureChar=function(t,e,i){return An(this._ctx,e,24,i),this._ctx.measureText(t).width/24},Cs.prototype._getAtlas=function(t,e,i){var r=i===mi?0:i,n=this._byFont[t]||(this._byFont[t]={}),o=n[e]||(n[e]=new Array(50));return o[r]||(o[r]=new Array(256))},Cs.prototype._getMeasurementAtlas=function(t,e){var i=this._widthAtlases[e];return i[t]||(i[t]=new Array(256))},Cs.prototype.measureText=function(t,e,i,r){if(void 0===r&&(r=1),!e)return this._textDimensions.width=0,this._textDimensions.height=0,this._textDimensions;for(var n=this._getMeasurementAtlas(e,i),o=0,s=0,a=1,u=0;u<t.length;++u){var l=t.charCodeAt(u);if(l===ws)o<s&&(o=s),s=0,a+=1;else{var d=n[l];void 0===d&&(d=this._measureChar(t[u],e,i),n[l]=d),s+=d}}return o<s&&(o=s),this._textDimensions.width=o*r,this._textDimensions.height=a*r,this._textDimensions},Cs.prototype._getCharInfo=function(t,e,i,r,n,o){var s=t[e];if(!s){var a=String.fromCharCode(e);s={ratio:this._measureChar(a,i,r),patternId:new Array(1)};for(var u=0;u<1;++u){var l=+u;s.patternId[u]=this._patternManager.getIdFromDefinition({id:0,type:3,attributes:{text:a,font:i,style:r,size:n,align:o,offset:l}})}t[e]=s}return s},Cs.prototype.storeTextInDataView=function(t,e,i,r){var n=e;if(r&&r.type===Ur){for(var o=r.attributes,s=o.font,a=o.style,u=o.size,l=o.align,d="center"===l,h=this._getAtlas(s,a,u),c=0,f=1,g=0,p=0,_=this._lineWidthList,v=this._processBidirectionalText(r.attributes.text),m=0;m<v.length;++m)(E=v.charCodeAt(m))===ws?(c<g&&(c=g),_[p]=g,p++,g=0,f++):g+=(A=this._getCharInfo(h,E,s,a,u,l)).ratio;c<(_[p]=g)&&(c=g),p=0;var y=-(d?_[p]:c)/2,x=(1-f)/2,b=0;for(m=0;m<v.length;++m){var E,A=h[E=v.charCodeAt(m)];if(E===ws)p+=1,y=-(d?_[p]:c)/2,x+=1,b=0;else{var S=A.ratio,w=A.patternId[0];y+=(S+b)/2,b=S;var T=(Ye(1e3*y+65536,0,131071)<<8)+Ye(2*x+128,0,255);t.setUint16(n,w,Ss),t.setUint32(n+2,T,Ss),n+=6}}}this._fillWithZeros(t,n,i)},Cs.prototype.extractTextFromDataView=function(t,e,i){for(var r=t,n=Ss,o=r.getUint16(e,n),s=this._textPattern,a=this._patternManager.getDefinitionFromId(o).attributes,u=a.font,l=a.style,d=a.size,h=a.align,c=this._getAtlas(u,l,d),f=[],g=0,p=0,_=0,v=null,m=e;m<i;m+=6){var y=r.getUint16(m,n);if(!y)break;var x=(r.getUint8(m+2)-128)/2,b=this._patternManager.getDefinitionFromId(y);if(!b||!b.attributes||!b.attributes.text)break;var E=b.attributes.text.charCodeAt(0),A=c[E];null===v?v=x:v<x&&(p<g&&(p=g),g=0,_+=1,f.push(ws),v=x),f.push(E),A&&(g+=A.ratio)}p<g&&(p=g);var S=String.fromCharCode.apply(null,f);return s.attributes.style=l,s.attributes.font=u,s.attributes.size=d,s.attributes.align=h,s.attributes.text=this._processBidirectionalText(S),s.dimensions&&(s.dimensions.width=p,s.dimensions.height=_),s},Cs.prototype._fillWithZeros=function(t,e,i){for(var r=e;r<i;r+=6)t.setUint16(r,0)},Cs.prototype._clear=function(){this._byFont={},this._widthAtlases={normal:{},bold:{},italic:{}}},Cs.prototype.update=function(){this._mustClear&&(this._clear(),this._mustClear=!1)},Cs.prototype.getVersion=function(){return 0},Cs);function Cs(t){this._patternManager=t,this._canvas=bn(),this._ctx=this._canvas.getContext("2d"),this._processBidirectionalText=As().processBidirectionalText,this._textPattern={id:0,type:Ur,attributes:{text:"",font:"",size:0,style:"normal",align:"center"},dimensions:{width:0,height:0}},this._textDimensions={width:0,height:0},this._lineWidthList=new Array(64),this._init()}var Ms,Is=Sn(),Ls={stencil:!0,antialias:!1,alpha:!0,premultipliedAlpha:!0,failIfMajorPerformanceCaveat:!("undefined"!=typeof window&&window.FORCE_WEBGL)},Ns={NO_WEBGL:'Unable to create a WebGL context: `canvas.getContext("webgl")` and `canvas.getContext("experimental-webgl")` returned `null`',NO_ANGLE_INSTANCED_ARRAYS:'WebGL extension "ANGLE_instanced_arrays" unavailable: `gl.getExtension("ANGLE_instanced_arrays")` returned `null`'},Os=(x(ks,Ms=Error),ks);function ks(){return null!==Ms&&Ms.apply(this,arguments)||this}function Fs(value,t){if(!value&&t){var e=new Os(Ns[t]);throw e.code=t,e}}var Rs,Ps=(x(Ds,Rs=Ln),Ds.isAvailable=function(){return Is||Fs(null,"NO_WEBGL"),Is},Ds.createInitData=function(){var t=bn(),e=wn(t,Ls),i=e&&"function"==typeof e.getExtension?e.getExtension("ANGLE_instanced_arrays"):null,r={BYTES_TO_OFFSET_ANGLE:2*Math.PI/8,BYTES_TO_COLOR:1/15,SDF_FONT_SIZE:24,CURVATURE_RATIO:on,PATTERN_MARGIN:rn,TEXT_WIDTH_MULTIPLIER:1,TEXT_HEIGHT_MULTIPLIER:1.5,SELF_LOOP_CURVATURE_MULTIPLIER:sn,EDGE_ARROW_SIZE_RATIO:3,NB_PIECES_PER_CURVE:41,PIECE_NODE_COMPONENT:Vr,PIECE_EDGE_BODY:jr,PIECE_EDGE_HEAD:Gr,PIECE_EDGE_TAIL:Hr,PIECE_EDGE_TEXT:Wr,MAX_TEXT_SIZE:25,BYTES_TO_TEXT_OFFSET_X:.001,BYTES_TO_TEXT_OFFSET_Y:.5,FILTER_NEAREST:0,FILTER_LINEAR:1,FILTER_LINEAR_SDF:2,FILTER_MIPMAP:3,SHAPE_TEXTURE_SIZE:tn,SIMPLE_SHAPE_SAMPLING_SIZE:32,COMPLEX_SHAPE_SAMPLING_SIZE:Jr,SHAPE_SAMPLING_BUFFER_RATIO:1/16,MAX_NB_SHAPES:15..toString(),FIRST_COMPLEX_SHAPE_ID:8,SELF_LOOP_TO_CIRCLE_APPROX:.9721,SDF_GAMMA:1.4142},n=new Pn(e,{vertex:Fn,fragment:Rn,constants:r,macros:{ANIMATED:0}}),o=new Pn(e,{vertex:Fn,fragment:Rn,constants:r,macros:{ANIMATED:1}});return e&&i&&(n.compile(),e.flush()),{canvas:t,gl:e,ext:i,staticProgramWrapper:n,animationProgramWrapper:o}},Ds.getName=function(){return"WebGL"},Ds.prototype._afterFirstFrame=function(){this._animationProgramWrapper.getState()===On.INIT&&this._animationProgramWrapper.compile()},Ds.prototype.ensureAnimationsReady=function(){var t=this._animationProgramWrapper.getState();t!==On.DONE&&(t===On.INIT&&this._animationProgramWrapper.compile(),this._animationProgramWrapper.getError())},Ds.prototype.getDomElement=function(){return this._glCanvas},Ds.prototype._initGl=function(){var t=this._gl;t.clearColor(0,0,0,0),t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA)},Ds.prototype._computeShaderInfo=function(){var t,e;this._shaderMetadata=(t=Rn,Bs(e={vertexInfoAttribute:"a_vertexInfo",attributes:[],uniforms:[]},Fn),Bs(e,t),e)},Ds.prototype._initGlPrograms=function(){this._staticProgram=new fs({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._staticProgramWrapper}),this._animationProgram=new fs({gl:this._gl,ext:this._ext,specialGlBuffers:this._specialGlBuffers,metaData:this._shaderMetadata,programWrapper:this._animationProgramWrapper})},Ds.prototype._initSpecialGlBuffers=function(){for(var t=this._gl,e=t.createBuffer(),i=new Int8Array(738),r=0;r<41;++r)for(var n=[-1,-1,r,1,-1,r,1,1,r,-1,-1,r,-1,1,r,1,1,r],o=r*n.length,s=0;s<n.length;s++)i[s+o]=n[s];t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,i,t.STATIC_DRAW),this._specialGlBuffers={vertexInfo:e}},Ds.prototype._computeUniforms=function(){return{viewWidth:this._width,viewHeight:this._height,viewX:this._viewX,viewY:this._viewY,viewZoom:this._viewZoom,viewAngle:this._viewAngle,currentTime:this._currentTime,pixelRatio:this._pixelRatio,backgroundColor:this._backgroundRgba,patternInfoTexture:this._patternTexture.getInfoTextureUnit(),patternNearestTexture:this._patternTexture.getNearestTextureUnit(),patternLinearTexture:this._patternTexture.getLinearTextureUnit(),patternLinearSdfTexture:this._patternTexture.getLinearSdfTextureUnit(),patternMipmapTexture:this._patternTexture.getMipmapTextureUnit(),shapeTexture:this._shapeTexture.getTextureUnit(),BYTES_TO_COORD:this._scales.bytesToActualCoord,BYTES_TO_SCALED_SIZE:this._scales.bytesToActualScaledSize,BYTES_TO_MIN_VISIBLE_SIZE:this._scales.bytesToActualMinVisibleSize,BYTES_TO_SYMBOLIC_SIZE:this._scales.bytesToActualSymbolicSize,BYTES_TO_DASH_LENGTH:this._scales.bytesToActualDashLength,BYTES_TO_GAP_LENGTH:this._scales.bytesToActualGapLength,BYTES_TO_PATTERN_SCALE:this._scales.bytesToActualPatternScale,PATTERN_INFO_TEXTURE_SIZE:this._patternTexture.getInfoTextureSize(),PATTERN_NEAREST_TEXTURE_SIZE:this._patternTexture.getNearestTextureSize(),PATTERN_LINEAR_TEXTURE_SIZE:this._patternTexture.getLinearTextureSize(),PATTERN_LINEAR_SDF_TEXTURE_SIZE:this._patternTexture.getLinearSdfTextureSize(),PATTERN_MIPMAP_TEXTURE_SIZE:this._patternTexture.getMipmapTextureSize(),PATTERN_POSITION_GRANULARITY:this._patternTexture.getGranularity(),SHAPE_TEXTURE_SIZE:this._shapeTexture.getTextureSize(),SHAPE_SAMPLING_SIZE:this._shapeTexture.getSamplingSize(),SHAPE_SAMPLING_BUFFER_RATIO:this._shapeTexture.getBufferRatio(),NB_SHAPES_BY_SIDE:this._shapeTexture.getTextureSize()/this._shapeTexture.getSamplingSize(),SHAPE_DIMENSIONS:this._shapeTexture.getSamplingSize()/this._shapeTexture.getTextureSize(),SHAPE_ACTUAL_RATIO:1-this._shapeTexture.getBufferRatio()}},Ds.prototype._render=function(t){var e=t.shapesChanged,i=t.patternsChanged,r=t.dimensionsChanged,n=t.backgroundColorChanged,o=this._gl;if(e&&(this._shapeTexture.refresh(this._shapeManager),this._patternTexture.bindMetDataTexture()),i&&this._patternTexture.refresh(this._patternManager),r&&(this._mustResize=!0),n){var s=this._renderBackground?this._backgroundRgba:[0,0,0,0],a=s[0],u=s[1],l=s[2],d=s[3];o.clearColor(a*d,u*d,l*d,d)}var h=this._computeUniforms(),c=this._startFrame();this._mustResize&&c.length&&(Lt(this._glCanvas,this._width,this._height,this._pixelRatio),o.viewport(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio),this._mustResize=!1),o.clear(o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT);for(var f=0;f<c.length;++f)this._displayBuffer(c[f],h);this._endFrame()},Ds.prototype._displayBuffer=function(t,e){var i=t.getProgram();i!==this._currentProgram&&(this._currentProgram&&this._currentProgram.endPass(),this._currentProgram=i,this._currentProgram.startPass(e)),t.markAsUsed(),t.draw()},Ds.prototype._startFrame=function(){for(var t=this._bufferList.getBuffersByAscendingDepth(),e=[],i=0;i<this._glBuffers.length;++i)(n=this._glBuffers[i])&&n.markAsUnused();for(i=0;i<t.length;++i){var r=t[i];(n=this._getAssociatedGlBuffer(r)).markAsUsed(),!r.isEmpty()&&this._isBufferDisplayable(r)&&e.push(n)}for(i=0;i<this._glBuffers.length;++i){var n;(n=this._glBuffers[i])&&!n.isUsed()&&(n.destroy(),this._glBuffers[i]=void 0)}return e},Ds.prototype._endFrame=function(){this._currentProgram&&(this._currentProgram.endPass(),this._currentProgram=null)},Ds.prototype._getAssociatedGlBuffer=function(t){var e=t.getId(),i=this._glBuffers[e];if(!i){for(;this._glBuffers.length<=e;)this._glBuffers.push(void 0);i=new vs({gl:this._gl,ext:this._ext,staticProgram:this._staticProgram,animationProgram:this._animationProgram}),this._glBuffers[e]=i}return i.setDataBuffer(t),i},Ds.prototype.destroy=function(){var t=this._gl.getExtension("WEBGL_lose_context");t&&t.loseContext()},Ds.prototype.getImageData=function(){var t=this._glCanvas.width,e=this._glCanvas.height;return(this._2dcanvas.width<t||this._2dcanvas.height<e)&&(this._2dcanvas.width=t,this._2dcanvas.height=e),this._ctx.drawImage(this._glCanvas,0,0),this._ctx.getImageData(0,0,t,e)},Ds.prototype._getImageDataFlippedYAxis=function(){var t=this._gl,e=this._glCanvas.width,i=this._glCanvas.height,r=this._ctx.createImageData(e,i),n=new Uint8Array(r.data.buffer);return t.readPixels(0,0,e,i,t.RGBA,t.UNSIGNED_BYTE,n),r},Ds);function Ds(t){var e=Rs.call(this,t)||this;e._2dcanvas=bn(),e._ctx=e._2dcanvas.getContext("2d"),e._glBuffers=[],e._mustResize=!1;var i=t.initData||Ds.createInitData(),r=i.canvas,n=i.gl,o=i.ext,s=i.staticProgramWrapper,a=i.animationProgramWrapper;return Fs(n,"NO_WEBGL"),Fs(o,"NO_ANGLE_INSTANCED_ARRAYS"),e._glCanvas=r,e._gl=n,e._ext=o,e._staticProgramWrapper=s,e._animationProgramWrapper=a,e._shapeTexture=new ro(e._gl,0),e._patternTexture=new po(e._gl,1),e._initCanvas(e._glCanvas),e._computeShaderInfo(),e._initSpecialGlBuffers(),e._initGlPrograms(),e._initGl(),e}var zs={float:1,vec2:2,vec3:3,vec4:4};function Bs(t,e){for(var i=/(?:attribute\s+\/\*\s*(byte|ubyte|short|ushort|float)\s*\*\/\s*(float|vec2|vec3|vec4)\s+(\w+)\s*;)|(?:#if\s*(\w+))|(?:#endif)/g,r=/uniform\s+(float|vec2|vec3|vec4|sampler2D|int)\s+(\w+)\s*;/g,n=[],o=i.exec(e);o;){var s=o[0];"#endif"===s?n.pop():s.startsWith("#if")?n.push(o[4]):t.attributes.push({name:o[3],size:zs[o[2]],type:o[1],tags:n.slice(),location:null,byteSize:0,glType:null}),o=i.exec(e)}for(o=r.exec(e);o;){if(!t.uniforms.some(function(t){return t.id===o[1]})){var a=o[1],u=o[2],l=u.replace("u_","");t.uniforms.push({id:l,name:u,type:a})}o=r.exec(e)}}var Us=0,Vs=1,js=2,Gs=30,Hs=0,Ws=1,qs=2,Xs=3,Ys=4,Zs=5,Ks=6,Qs=Math.PI,Js=2*Math.PI,$s=Qs*(5/4),ta=Qs*(7/4),ea=.75*Qs,ia=.25*Qs,ra=1.1,na=.07,oa=1,sa=1,aa=.17,ua=1,la=-Qs/2,da=Qs/2,ha=2/3,ca={plain:{dash:0,gap:0},dashed:{dash:3,gap:1},dotted:{dash:1,gap:3}},fa={right:0,top:-Math.PI/2,left:Math.PI,bottom:Math.PI/2,center:0},ga={right:Math.PI,top:-Math.PI/2,left:0,bottom:Math.PI/2,center:0};function pa(t,e,i,r,n){var o=1-n;return o*o*o*t+3*n*o*o*e+3*n*n*o*i+n*n*n*r}function _a(t,e,i,r){var n=1-r;return n*n*t+2*n*r*e+r*r*i}function va(t,e,i,r,n,o){var s=o||{x:0,y:0},a=(t+i)/2,u=(e+r)/2,l=t-i,d=e-r,distance=Math.sqrt(l*l+d*d);if(0===distance)return s.x=a,s.y=u,s;var h=d/distance,c=-l/distance,f=-distance*n/on;return s.x=a+h*f,s.y=u+c*f,s}function ma(t,e,i,r,n,o){var s=o||{x1:0,y1:0,x2:0,y2:0},a=(r+r/sn*i)*sn,u=-n+Qs,l=Qs/2-n;return s.x1=t+Math.cos(u)*a,s.y1=e+Math.sin(u)*a,s.x2=t+Math.cos(l)*a,s.y2=e+Math.sin(l)*a,s}var ya,xa=(x(ba,ya=Ln),ba.prototype._resetCachePoints=function(){this._nextCachePoint=0},ba.prototype._point=function(t,e){var i=this._cachePoints[this._nextCachePoint++];return i||(i={x:0,y:0},this._cachePoints.push(i)),i.x=t,i.y=e,i},ba.prototype.setViewportClipping=function(t){this._clipViewport=t},ba.prototype._formatAngle=function(t){return t<-Math.PI?t+2*Math.PI:t>Math.PI?t-2*Math.PI:t},ba.prototype._computeAnimationRatio=function(t){var e=t.beginTime,i=t.duration,r=t.easing,n=(this._currentTime-e)/i,o=n*n,s=o*n,a=this._easingManager.getCoefficients(r),u=n<.5?0:4;return Ye(a[u]+a[1+u]*n+a[2+u]*o+a[3+u]*s,0,1)},ba.prototype._mixColor=function(t,e,i,r){if(t===e)return t;var n=this._colorManager.parseColor(t),o=n[0],s=n[1],a=n[2],u=n[3],l=this._colorManager.parseColor(e),d=l[0],h=l[1],c=l[2],f=l[3];return"rgba("+Math.round(255*Ke(o,d,i))+","+Math.round(255*Ke(s,h,i))+","+Math.round(255*Ke(a,c,i))+","+Ke(u,f,r)+")"},ba.prototype._displayBuffer=function(t){for(var e=t.getSize(),i=t.isAnimated(),r=0;r<e;++r){var n=this.extractElement(t,r);n.valid&&this._displayElement(n,i)}},ba.prototype._mixAttributes=function(t,e,i){var r=this._computeAnimationRatio(i);return t.dashLength=Ke(e.dashLength,t.dashLength,r),t.gapLength=Ke(e.gapLength,t.gapLength,r),t.offsetAngle=Ke(e.offsetAngle,t.offsetAngle,r),t.opacity=Ke(e.opacity,t.opacity,r),t.globalMinVisibleSize=Ke(e.globalMinVisibleSize,t.globalMinVisibleSize,r),t.strokeMinVisibleSize=Ke(e.strokeMinVisibleSize,t.strokeMinVisibleSize,r),t.patternMinVisibleSize=Ke(e.patternMinVisibleSize,t.patternMinVisibleSize,r),t.symbolicSize=Ke(e.symbolicSize,t.symbolicSize,r),t.curvature=Ke(e.curvature,t.curvature,r),t.fillColor=this._mixColor(e.fillColor,t.fillColor,r,r),t.strokeColor=this._mixColor(e.strokeColor,t.strokeColor,r,r),t.patternColor=this._mixColor(e.patternColor,t.patternColor,r,r),t.x1=Ke(e.x1,t.x1,r),t.y1=Ke(e.y1,t.y1,r),t.x2=Ke(e.x2,t.x2,r),t.y2=Ke(e.y2,t.y2,r),t.rectWidthOrSourceRadiusScaled=Ke(e.rectWidthOrSourceRadiusScaled,t.rectWidthOrSourceRadiusScaled,r),t.rectWidthOrSourceRadiusFixed=Ke(e.rectWidthOrSourceRadiusFixed,t.rectWidthOrSourceRadiusFixed,r),t.rectHeightOrTargetRadiusScaled=Ke(e.rectHeightOrTargetRadiusScaled,t.rectHeightOrTargetRadiusScaled,r),t.rectHeightOrTargetRadiusFixed=Ke(e.rectHeightOrTargetRadiusFixed,t.rectHeightOrTargetRadiusFixed,r),t.thicknessOrFontSizeScaled=Ke(e.thicknessOrFontSizeScaled,t.thicknessOrFontSizeScaled,r),t.thicknessOrFontSizeFixed=Ke(e.thicknessOrFontSizeFixed,t.thicknessOrFontSizeFixed,r),t.strokeWidthScaled=Ke(e.strokeWidthScaled,t.strokeWidthScaled,r),t.strokeWidthFixed=Ke(e.strokeWidthFixed,t.strokeWidthFixed,r),t.offsetScaled=Ke(e.offsetScaled,t.offsetScaled,r),t.offsetFixed=Ke(e.offsetFixed,t.offsetFixed,r),t},ba.prototype._computeRenderInfo=function(t){var e=this._viewZoom,i=this._point(t.x1,t.y1),r=this._point(t.x2,t.y2);return{shape:this._shapeManager.getDefinitionFromName(t.shape),pieceId:t.pieceId,dashLength:t.dashLength,gapLength:t.gapLength,hasHead:t.hasHead,hasTail:t.hasTail,isBodyTriangle:t.isBodyTriangle,isSelfLoop:t.isSelfLoop,patternScale:t.patternScale,offsetAngle:this._formatAngle(t.offsetAngle),isText:t.isText,adjustTextAngle:t.adjustTextAngle,isBadge:t.isBadge,unusedFlag2:t.unusedFlag2,unusedFlag3:t.unusedFlag3,opacity:t.opacity,globalMinVisibleSize:t.globalMinVisibleSize,strokeMinVisibleSize:t.strokeMinVisibleSize,patternMinVisibleSize:t.patternMinVisibleSize,symbolicSize:0===t.symbolicSize?1/0:t.symbolicSize*e,curvature:t.curvature,pattern:t.pattern,fillColor:t.fillColor,strokeColor:t.strokeColor,patternColor:t.patternColor,pos1OnGraph:i,pos2OnGraph:r,pos1:this._graphToScreenCoordinates(i),pos2:this._graphToScreenCoordinates(r),rectWidthOrSourceRadius:t.rectWidthOrSourceRadiusScaled*e+t.rectWidthOrSourceRadiusFixed,rectHeightOrTargetRadius:t.rectHeightOrTargetRadiusScaled*e+t.rectHeightOrTargetRadiusFixed,thicknessOrFontSize:t.thicknessOrFontSizeScaled*e+t.thicknessOrFontSizeFixed,strokeWidth:t.strokeWidthScaled*e+t.strokeWidthFixed,offset:t.offsetScaled*e+t.offsetFixed}},ba.prototype._applyBackgroundBlending=function(t){1!==t.opacity&&(t.fillColor=this._blendColor(t.fillColor,t.opacity),t.strokeColor=this._blendColor(t.strokeColor,t.opacity),t.textColor=this._blendColor(t.textColor,t.opacity))},ba.prototype._pointArray=function(t){var e=this._pointCopies[t];if(!e){e=new Array(t),this._pointCopies[t]=e;for(var i=0;i<t;++i)e[i]={x:0,y:0,r:0}}return e},ba.prototype._scalePoints=function(t,e,i,r){for(var n=t.shape.points.length,o=this._pointArray(n),s=0;s<n;++s){var a=t.shape.points[s],u=o[s];u.x=e.x+a.x*i,u.y=e.y+a.y*r,u.r=a.r*i}var l=t.pos2OnGraph.x-t.pos1OnGraph.x,d=t.pos2OnGraph.y-t.pos1OnGraph.y;if(0!=l||0!=d)for(var h=Math.sqrt(l*l+d*d),c=l/h,f=d/h,g=0,p=o;g<p.length;g++){var _=p[g],v=_.x-e.x,m=_.y-e.y;_.x=e.x+c*v+f*m,_.y=e.y-f*v+c*m}return o},ba.prototype._drawPoints=function(t){1===t.length?this._drawCircle(t[0],t[0].r):this._drawPolygon(t)},ba.prototype._computeCenter=function(t){var e=Math.cos(t.offsetAngle),i=Math.sin(t.offsetAngle),r=(t.pos1.x+t.pos2.x)/2+e*t.offset,n=(t.pos1.y+t.pos2.y)/2+i*t.offset;return this._point(r,n)},ba.prototype._displayNodeComponent=function(e,t,i,r){var n=this,o=this._computeCenter(e);if(e.pattern.type!==Ur){var s=e.rectWidthOrSourceRadius/2,a=e.rectHeightOrTargetRadius/2,u=this._scalePoints(e,o,s,a);if((t||r)&&this._drawPoints(u),t&&this._fill(e.fillColor),r){if(this._startClip(),e.pattern.type===Dr){var l=e.pattern.attributes.colorArray;1!==e.opacity&&(l=l.map(function(t){return n._blendColor(t,e.opacity)})),this._displayPieChart(o,s,l)}else if(e.pattern.type===zr||e.pattern.type===Br){var d=0,h=Math.round(e.rectHeightOrTargetRadius*e.patternScale),c=e.pattern.attributes.text,f=e.patternColor,g=e.pattern.attributes.font,p=e.pattern.attributes.style,_=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius;this._displayText(o,d,c,f,g,h,p,_,v)}else if(e.pattern.type===Pr){var m=e.pattern.attributes.image;if(m.isDummy||m.width&&m.height){var y=e.pattern.attributes.duplicated,x=y?1:e.patternScale,b=e.rectWidthOrSourceRadius*x,E=e.rectHeightOrTargetRadius*x,A=e.pattern.attributes.scaled,S=e.opacity;this._displayImage(o,b,E,m,A,y,S)}}this._endClip()}if(i){var w=e.strokeWidth/2,T=this._scalePoints(e,o,s+w,a+w);this._drawPoints(T),this._stroke(e.strokeColor,e.strokeWidth)}}else r&&(d=0,h=e.thicknessOrFontSize,c=e.pattern.attributes.text,f=e.patternColor,g=e.pattern.attributes.font,p=e.pattern.attributes.style,_=e.pattern.attributes.align,v=e.rectWidthOrSourceRadius,this._displayText(o,d,c,f,g,h,p,_,v))},ba.prototype._displayElement=function(t,e){if(t.end&&t.end.shape&&t.end.pieceId&&(!e||t.start&&t.animation)){this._resetCachePoints();var i=e?this._mixAttributes(t.end,t.start,t.animation):t.end,r=this._computeRenderInfo(i);if(!(r.symbolicSize<r.globalMinVisibleSize||0===r.opacity)){this._applyBackgroundBlending(r);var n=!!(r.strokeColor&&0<r.strokeWidth&&r.symbolicSize>=r.strokeMinVisibleSize),o=!!(1!==r.pattern.type&&r.symbolicSize>=r.patternMinVisibleSize),s=!!r.fillColor;if(r.pieceId===Vr)return this._displayNodeComponent(r,s,n,o);var a,u,l,d,h,c,f,g,p,_,v,m,y,x,b,E,A,S,w,T,C,M,I,L=r.pos2.x-r.pos1.x,N=r.pos2.y-r.pos1.y,O=Math.sqrt(L*L+N*N),k=null,F=null;if(r.isSelfLoop){var R=r.pieceId===Wr?r.strokeWidth/2:r.rectWidthOrSourceRadius,P=this._getSelfLoopControlPoints(r.pos1,r.curvature,R),D=P.x1,z=P.y1,B=P.x2,U=P.y2;k=this._point(D,z),F=this._point(B,U),m=r.pos1,y=k,x=F,r.pos2,b=1,E=(m.x+y.x+x.x)/3,A=(m.y+y.y+x.y)/3,S=E-y.x,w=A-y.y,T=y.x-x.x,C=y.y-x.y,M=S*S+w*w,I=(T*T+C*C)/4,a=1.9442*Math.sqrt(M-I)*3.14159265359*b}else a=r.curvature?(k=this._getQuadraticCurveControlPoint(r),u=r.curvature,l=O,d=1,h=Math.abs(u)/on+1e-6,g=(f=d-.5)*f,p=1/(16*(c=h*h)),_=Math.sqrt(g+p),v=.5/h*Math.sqrt(.25+c),Math.abs(2*h)*(f*_+.5*v+p*Math.log(Math.abs((f+_)/(v-.5))))*l):O;if(r.pieceId===Wr){var V=r.strokeWidth,j=this._getPointOnLine(r.pos1,k,F,r.pos2,.5),G=this._getTangentOnLine(r.pos1,k,F,r.pos2,.5);r.adjustTextAngle&&!r.isSelfLoop&&r.rectWidthOrSourceRadius>=a-V&&(G.x=1,G.y=0,r.offset=0);var H=-Math.atan2(G.y,G.x),W=this._formatAngle(r.offsetAngle-H);(!r.isSelfLoop&&W<0||r.isSelfLoop&&r.offsetAngle<0)&&(G.x*=-1,G.y*=-1),(H>Math.PI/2||H<-Math.PI/2)&&(H+=Math.PI);var q=this._getOrthogonal(G),X=j.x+q.x*r.offset,Y=j.y+q.y*r.offset;if(r.fillColor){var Z=this._pointArray(4),K=r.rectWidthOrSourceRadius/2,Q=r.rectHeightOrTargetRadius/2,J=G.x*K,$=G.y*K,tt=q.x*Q,et=q.y*Q,it=Z[0],rt=Z[1],nt=Z[2],ot=Z[3];it.x=X+J+tt,it.y=Y+$+et,rt.x=X+J-tt,rt.y=Y+$-et,nt.x=X-J-tt,nt.y=Y-$-et,ot.x=X-J+tt,ot.y=Y-$+et,this._drawPoints(Z),this._fill(r.fillColor)}else{var st=this._point(X,Y),at=H,ut=r.thicknessOrFontSize,lt=r.pattern.attributes.text,dt=r.patternColor,ht=r.pattern.attributes.font,ct=r.pattern.attributes.style,ft=r.pattern.attributes.align,gt=r.rectWidthOrSourceRadius;this._displayText(st,at,lt,dt,ht,ut,ct,ft,gt)}}else{var pt=r.pieceId===Gr,_t=r.pieceId===Hr,vt=Math.cos(r.offsetAngle),mt=Math.sin(r.offsetAngle);r.pos1.x+=vt*r.offset,r.pos1.y+=mt*r.offset,r.pos2.x+=vt*r.offset,r.pos2.y+=mt*r.offset;var yt="line"===r.shape.name,xt=r.thicknessOrFontSize,bt=r.rectWidthOrSourceRadius,Et=r.rectHeightOrTargetRadius,At=+r.hasHead,St=+r.hasTail,wt=+r.isBodyTriangle,Tt=At+St,Ct=3*xt,Mt=At*Ct,It=St*Ct,Lt=r.isSelfLoop?1/0:O-bt-Et,Nt=Math.min(Lt/Tt,Ct),Ot=St*(Ct+Math.max(bt+Nt-It,0))+(1-St)*wt*bt,kt=At*(Ct+Math.max(Et+Nt-Mt,0))+(1-At)*wt*Et;if(pt||_t){var Ft=_t?-1:1,Rt=(pt?a-kt:Ot)-Ft,Pt=null,Dt=null;if(r.isSelfLoop&&k&&F){var zt=this._getTFromLengthOnCubicCurve(r.pos1,k,F,r.pos2,Rt-r.strokeWidth/2*Ft);Pt=this._getPointOnCubicCurve(r.pos1,k,F,r.pos2,zt),Dt=this._getTangentOnCubicCurve(r.pos1,k,F,r.pos2,zt)}else Dt=r.curvature&&k?(zt=this._getTFromLengthOnQuadraticCurve(r.pos1,k,r.pos2,Rt-r.strokeWidth/2*Ft),Pt=this._getPointOnQuadraticCurve(r.pos1,k,r.pos2,zt),this._getTangentOnQuadraticCurve(r.pos1,k,r.pos2,zt)):(zt=Rt/a,Pt=this._mixPoints(r.pos1,r.pos2,zt),this._point(L/O,N/O));if(Dt.x*=Ft,Dt.y*=Ft,s){if(r.shape.hole){var Bt=this._makeEdgeExtremityPoints(Pt,Dt,Ct,r.shape.hole);this._drawPoints(Bt),this._startReverseClip()}Z=this._makeEdgeExtremityPoints(Pt,Dt,Ct,r.shape.points),this._drawPoints(Z),this._fill(r.fillColor),r.shape.hole&&this._endReverseClip()}if(n){r.shape.hole&&(Bt=this._makeEdgeExtremityPoints(Pt,Dt,Ct,r.shape.hole),this._drawPoints(Bt),this._stroke(r.strokeColor,r.strokeWidth));var Ut=Ct+r.strokeWidth/2;Z=this._makeEdgeExtremityPoints(Pt,Dt,Ut,r.shape.points),this._drawPoints(Z),this._stroke(r.strokeColor,r.strokeWidth)}}else{if(a-Ot-kt<=0)return;if(yt){var Vt=function(t,e,i,r,n,o){var s=[];if(i&&s.push(0,i),n&&o){for(var a=n*e,u=o*e,l=a+u,d=t-r-i-l,h=0;h<d;)s.push(a,u),h+=l;var c=t-r-i-h,f=Math.min(a,c),g=Math.max(c-f,0);s.push(f,g)}else s.push(t-r-i,0);return r&&s.push(0,r),s}(a,xt,Ot,kt,r.dashLength,r.gapLength);n&&(this._drawLine(r.pos1,k,F,r.pos2),this._stroke(r.strokeColor,xt+2*r.strokeWidth,Vt)),s&&(this._drawLine(r.pos1,k,F,r.pos2),this._stroke(r.fillColor,xt,Vt))}else{var jt=Ot,Gt=a-kt;n&&(Z=this._makeTriangleEdgeBody(r.pos1,k,F,r.pos2,jt,Gt,xt+r.strokeWidth/2,r.strokeWidth/2),this._drawPoints(Z),this._stroke(r.strokeColor,r.strokeWidth)),s&&(Z=this._makeTriangleEdgeBody(r.pos1,k,F,r.pos2,jt,Gt,xt,0),this._drawPoints(Z),this._fill(r.fillColor))}}}}}},ba.prototype._makeTriangleEdgeBody=function(t,e,i,r,n,o,s,a){return e?i?this._makeSelfLoopTriangleEdge(t,e,i,r,n,o,s,a):this._makeCurveTriangleEdge(t,e,r,n,o,s,a):this._makeStraightTriangleEdge(t,r,n,o,s,a)},ba.prototype._makeCurveTriangleEdge=function(t,e,i,r,n,o,s){for(var a=this._pointArray(84),u=this._getTFromLengthOnQuadraticCurve(t,e,i,r),l=(this._getTFromLengthOnQuadraticCurve(t,e,i,n)-u)/41,d=(s-o)/41/2,h=o/2,c=u,f=0;f<=41;++f){var g=this._getPointOnQuadraticCurve(t,e,i,c),p=this._getTangentOnQuadraticCurve(t,e,i,c),_=this._getOrthogonal(p),v=_.x*h,m=_.y*h,y=a[f],x=a[83-f];y.x=g.x+v,y.y=g.y+m,x.x=g.x-v,x.y=g.y-m,c+=l,h+=d}return a},ba.prototype._makeSelfLoopTriangleEdge=function(t,e,i,r,n,o,s,a){for(var u=this._pointArray(84),l=this._getTFromLengthOnCubicCurve(t,e,i,r,n),d=(this._getTFromLengthOnCubicCurve(t,e,i,r,o)-l)/41,h=(a-s)/41/2,c=s/2,f=l,g=0;g<=41;++g){var p=this._getPointOnCubicCurve(t,e,i,r,f),_=this._getTangentOnCubicCurve(t,e,i,r,f),v=this._getOrthogonal(_),m=v.x*c,y=v.y*c,x=u[g],b=u[83-g];x.x=p.x+m,x.y=p.y+y,b.x=p.x-m,b.y=p.y-y,f+=d,c+=h}return u},ba.prototype._makeStraightTriangleEdge=function(t,e,i,r,n,o){var s=e.x-t.x,a=e.y-t.y,u=Math.sqrt(s*s+a*a),l=this._point(s/u,a/u),d=this._getOrthogonal(l),h=n/2,c=o/2,f=this._pointArray(4),g=f[0],p=f[1],_=f[2],v=f[3],m=t.x+l.x*i,y=t.y+l.y*i,x=t.x+l.x*r,b=t.y+l.y*r,E=d.x*h,A=d.y*h,S=d.x*c,w=d.y*c;return g.x=m+E,g.y=y+A,p.x=m-E,p.y=y-A,_.x=x-S,_.y=b-w,v.x=x+S,v.y=b+w,f},ba.prototype._makeEdgeExtremityPoints=function(t,e,i,r){for(var n=this._pointArray(r.length),o=i/2,s=t.x+e.x*o,a=t.y+e.y*o,u=e.x,l=e.y,d=0;d<r.length;++d){var h=r[d],c=n[d],f=(u*h.x-l*h.y)*o,g=(l*h.x+u*h.y)*o;c.x=s+f,c.y=a+g,c.r=h.r*o}return n},ba.prototype._drawLine=function(t,e,i,r){e?i?this._drawCubicCurve(t,e,i,r):this._drawQuadraticCurve(t,e,r):this._drawStraightLine(t,r)},ba.prototype._getSelfLoopControlPoints=function(t,e,i){return ma(t.x,t.y,e,i,this._viewAngle,this._tmp)},ba.prototype._getQuadraticCurveControlPoint=function(t){return va(t.pos1.x,t.pos1.y,t.pos2.x,t.pos2.y,t.curvature,this._point(0,0))},ba.prototype._graphToScreenCoordinates=function(t){var e=this._width/2,i=this._height/2,r=(t.x-this._viewX)*this._viewZoom,n=(t.y-this._viewY)*this._viewZoom,o=this._viewAngleCos,s=this._viewAngleSin,a=o*r+s*n+e,u=-s*r+o*n+i;return this._point(a,u)},ba.prototype._blendColor=function(t,e){return t&&this._backgroundColor?this._mixColor(this._backgroundColor,t,e,1):null},ba.prototype._getTangentOnLine=function(t,e,i,r,n){return e?i?this._getTangentOnCubicCurve(t,e,i,r,n):this._getTangentOnQuadraticCurve(t,e,r,n):this._getTangentOnStraightLine(t,r)},ba.prototype._getTangentOnStraightLine=function(t,e){var i=e.x-t.x,r=e.y-t.y,n=Math.sqrt(i*i+r*r);return this._point(i/n,r/n)},ba.prototype._getTangentOnQuadraticCurve=function(t,e,i,r){var n=1-r,o=n*e.x+r*i.x-(n*t.x+r*e.x),s=n*e.y+r*i.y-(n*t.y+r*e.y),a=Math.sqrt(o*o+s*s);return this._point(o/a,s/a)},ba.prototype._getTangentOnCubicCurve=function(t,e,i,r,n){var o=1-n,s=o*o,a=n*n,u=s*(e.x-t.x)+2*o*n*(i.x-e.x)+a*(r.x-i.x),l=s*(e.y-t.y)+2*o*n*(i.y-e.y)+a*(r.y-i.y),d=Math.sqrt(u*u+l*l);return this._point(u/d,l/d)},ba.prototype._mixPoints=function(t,e,i){var r=Ke(t.x,e.x,i),n=Ke(t.y,e.y,i);return this._point(r,n)},ba.prototype._getOrthogonal=function(t){return this._point(-t.y,t.x)},ba.prototype._getPointOnLine=function(t,e,i,r,n){return e?i?this._getPointOnCubicCurve(t,e,i,r,n):this._getPointOnQuadraticCurve(t,e,r,n):this._mixPoints(t,r,n)},ba.prototype._getPointOnQuadraticCurve=function(t,e,i,r){var n=_a(t.x,e.x,i.x,r),o=_a(t.y,e.y,i.y,r);return this._point(n,o)},ba.prototype._getPointOnCubicCurve=function(t,e,i,r,n){var o=pa(t.x,e.x,i.x,r.x,n),s=pa(t.y,e.y,i.y,r.y,n);return this._point(o,s)},ba.prototype._getTFromLengthOnCubicCurve=function(t,e,i,r,n){for(var o=t.x,s=t.y,a=0,u=0,l=0;l<41;++l){a+=1/41;var d=pa(t.x,e.x,i.x,r.x,a),h=pa(t.y,e.y,i.y,r.y,a),c=d-o,f=h-s,g=Math.sqrt(c*c+f*f),p=u+g;if(n<p)return a-1/41*((p-n)/g);u=p,o=d,s=h}return 1},ba.prototype._getTFromLengthOnQuadraticCurve=function(t,e,i,r){for(var n=t.x,o=t.y,s=0,a=0,u=0;u<41;++u){s+=1/41;var l=_a(t.x,e.x,i.x,s),d=_a(t.y,e.y,i.y,s),h=l-n,c=d-o,f=Math.sqrt(h*h+c*c),g=a+f;if(r<g)return s-1/41*((g-r)/f);a=g,n=l,o=d}return 1},ba);function ba(t){var e=ya.call(this,t)||this;return e._cachePoints=[],e._nextCachePoint=0,e._tmp={x1:0,y1:0,x2:0,y2:0},e._pointCopies=Array(128),e._clipViewport=!0,e}var Ea,Aa=!bn().__dummy,Sa=(x(wa,Ea=xa),wa.getName=function(){return"Canvas"},wa.isAvailable=function(){return Aa},wa.prototype.getDomElement=function(){return this._canvas},wa.prototype._render=function(t){t.dimensionsChanged&&In(this._canvas,this._width,this._height,this._pixelRatio);var e=this._ctx,i=this._width*this._pixelRatio,r=this._height*this._pixelRatio;e.clearRect(0,0,i,r),this._backgroundColor&&this._renderBackground&&(e.fillStyle=this._backgroundColor,e.fillRect(0,0,i,r));for(var n=this._bufferList.getBuffersByAscendingDepth(),o=0;o<n.length;++o){var s=n[o];this._isBufferDisplayable(s)&&this._displayBuffer(s)}},wa.prototype._drawCircle=function(t,e){var i=this._ctx,r=this._pixelRatio,n=t.x*r,o=t.y*r,s=e*r;i.beginPath(),i.arc(n,o,s,0,2*Math.PI)},wa.prototype._drawPolygon=function(t){var e=this._ctx,i=this._pixelRatio;e.beginPath();var r=t[0];e.moveTo(r.x*i,r.y*i);for(var n=1;n<t.length;++n){var o=t[n];e.lineTo(o.x*i,o.y*i)}e.closePath()},wa.prototype._drawStraightLine=function(t,e){var i=this._ctx,r=this._pixelRatio;i.beginPath(),i.moveTo(t.x*r,t.y*r),i.lineTo(e.x*r,e.y*r)},wa.prototype._drawQuadraticCurve=function(t,e,i){var r=this._ctx,n=this._pixelRatio;r.beginPath(),r.moveTo(t.x*n,t.y*n),r.quadraticCurveTo(e.x*n,e.y*n,i.x*n,i.y*n)},wa.prototype._drawCubicCurve=function(t,e,i,r){var n=this._ctx,o=this._pixelRatio;n.beginPath(),n.moveTo(t.x*o,t.y*o),n.bezierCurveTo(e.x*o,e.y*o,i.x*o,i.y*o,r.x*o,r.y*o)},wa.prototype._fill=function(t){var e=this._ctx;e.fillStyle=t,e.fill()},wa.prototype._stroke=function(t,e,i){var r=this;void 0===i&&(i=[]);var n=this._ctx,o=this._pixelRatio;n.setLineDash(i.map(function(t){return t*r._pixelRatio})),n.lineWidth=e*o,n.strokeStyle=t,n.stroke()},wa.prototype._startClip=function(){this._ctx.save(),this._ctx.clip()},wa.prototype._endClip=function(){this._ctx.restore()},wa.prototype._startReverseClip=function(){this._ctx.save(),this._ctx.rect(0,0,this._canvas.width,this._canvas.height),this._ctx.clip("evenodd")},wa.prototype._endReverseClip=function(){this._ctx.restore()},wa.prototype._displayText=function(t,e,i,r,n,o,s,a,u){var l=this._ctx,d=this._pixelRatio,h=t.x*d,c=t.y*d,f=o*d,g="center"===a?0:-u/2;if(l.save(),l.translate(h,c),l.rotate(-e),l.textAlign=a,l.textBaseline="middle",An(l,n,f,s),l.fillStyle=r,-1!==i.indexOf("\n"))for(var p=i.split("\n"),_=p.length,v=(1-_)/2*f,m=0;m<_;++m)l.fillText(p[m],g,v),v+=f;else l.fillText(i,g,-1);l.restore()},wa.prototype._displayImage=function(t,e,i,r,n,o,s){if(!(this._hideImages||"isDummy"in r)){var a=r;1!==s&&(a=this._blendImageOnBackground(r,s));var u=this._ctx,l=this._pixelRatio,d=t.x*l,h=t.y*l,c=e*l,f=i*l,g=a.width*l,p=a.height*l;if(n)u.drawImage(a,d-c/2,h-f/2,c,f);else if(o){for(var _=d-c/2,v=h-f/2,m=d+c/2,y=h+f/2,x=d-g/2,b=h-p/2;_<x;)x-=g;for(;v<b;)b-=p;for(var E=b;x<m;){for(;b<y;)u.drawImage(a,x,b,g,p),b+=p;x+=g,b=E}}else u.drawImage(a,d-g/2,h-p/2,g,p)}},wa.prototype._displayPieChart=function(t,e,i){var r=this._ctx,n=this._pixelRatio,o=t.x*n,s=t.y*n,a=e*n*2,u=2*a;1===i.length&&(r.fillStyle=i[0],r.fillRect(o-a,s-a,u,u)),1<i.length&&io(r,i,o,s,a)},wa.prototype._blendImageOnBackground=function(t,e){var i=this._backgroundRgba,r="rgb("+Math.round(255*i[0])+","+Math.round(255*i[1])+","+Math.round(255*i[2])+")";return this._imgCanvas.width=t.width,this._imgCanvas.height=t.height,this._imgCtx.clearRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=1,this._imgCtx.fillStyle=r,this._imgCtx.fillRect(0,0,t.width,t.height),this._imgCtx.globalAlpha=e,this._imgCtx.drawImage(t,0,0),this._imgCanvas},wa.prototype.getImageData=function(){return this._ctx.getImageData(0,0,this._canvas.width,this._canvas.height)},wa);function wa(t){var e=Ea.call(this,t)||this;return e._canvas=bn(),e._imgCanvas=bn(),e._initCanvas(e._canvas),e._ctx=e._canvas.getContext("2d"),e._imgCtx=e._imgCanvas.getContext("2d"),e}var Ta=[1/0,1/0,-1/0,-1/0];function Ca(t,e,i,r,n,o){void 0===o&&(o={x:0,y:0});var s=Math.cos(n),a=Math.sin(n),u=t-i,l=e-r;return o.x=s*u-a*l+i,o.y=a*u+s*l+r,o}function distance(t,e,i,r){return Math.sqrt((t-i)*(t-i)+(e-r)*(e-r))}function Ma(t,e,i,r){var n=t-i,o=e-r;return n*n+o*o}function Ia(t){return 180*t/Math.PI}function La(t,e){return t.minX-=e,t.minY-=e,t.maxX+=e,t.maxY+=e,void 0===t.width&&(t.width=t.maxX-t.minX),void 0===t.height&&(t.height=t.maxY-t.minY),t.width+=2*e,t.height+=2*e,t}var Na=!1;try{Na=!!Rt("svg")}catch(t){}var Oa="none",ka={left:"start",center:"middle",right:"end"},Fa="data-element-id";function Ra(t){return Math.round(1e3*t)/1e3}function Pa(t,e,i,r,n,o){var s=Rt("image");return s.setAttribute("width",Ra(r)),s.setAttribute("height",Ra(n)),s.setAttribute("x",Ra(e)),s.setAttribute("y",Ra(i)),s.setAttribute("href",t),o&&o.appendChild(s),s}var Da,za=(x(Ba,Da=xa),Ba.getName=function(){return"SVG"},Ba.isAvailable=function(){return Na},Ba.prototype.getDomElement=function(){return this._svg},Ba.prototype._render=function(t){if(t.dimensionsChanged&&Nt(this._svg,{width:this._width,height:this._height}),this._backgroundColor&&this._renderBackground){var e=this._colorManager.rgbaToRgb(this._backgroundColor);this._background.setAttribute("fill",e.color),this._background.setAttribute("fill-opacity",e.opacity)}var i=this._bufferList.getBuffersByAscendingDepth();this._clear(),this._svg.removeChild(this._container);for(var r=0;r<i.length;++r){var n=i[r];this._isBufferDisplayable(n)&&this._displayBuffer(n)}this._svg.appendChild(this._container)},Ba.prototype._clear=function(){this._container&&this._svg.removeChild(this._container),this._container=Rt("g"),this._svg.appendChild(this._container),this._clipPaths&&this._defs.removeChild(this._clipPaths),this._clipPaths=Rt("g"),this._defs.appendChild(this._clipPaths),this._filters&&this._defs.removeChild(this._filters),this._filters=Rt("g"),this._defs.appendChild(this._filters)},Ba.prototype._displayElement=function(t,e){this._currentElementId=0<=t.id?"n"+t.id:"e"+-t.id,Da.prototype._displayElement.call(this,t,e)},Ba.prototype._addBackgroundBlendingFilter=function(t){var e=this._colorManager.parseColor(this._backgroundColor),i=1-t,r=[t,0,0,0,e[0]*i,0,t,0,0,e[1]*i,0,0,t,0,e[2]*i,0,0,0,1,0].join(" "),n="filter-"+this._currentElementId,o=Rt("filter",{id:n}),s=Rt("feColorMatrix",{in:"SourceGraphic",type:"matrix",values:r});return o.appendChild(s),this._filters.appendChild(o),n},Ba.prototype._drawCircle=function(t,e){var i="M "+(t.x-e)+", "+t.y+" a "+e+","+e+" 0 1,0 "+2*e+",0 a "+e+","+e+" 0 1,0 -"+2*e+",0",r=Rt("path");r.setAttribute("d",i),r.setAttribute("fill",Oa),r.setAttribute(Fa,this._currentElementId),this._container.appendChild(r),this._element=r},Ba.prototype._drawPolygon=function(t){for(var e=Rt("path"),i="",r=0;r<t.length;r++){var n=t[r];i+=(0===r?"M":"L")+n.x+","+n.y+" "}i+="Z",e.setAttribute("d",i),e.setAttribute(Fa,this._currentElementId),e.setAttribute("fill",Oa),this._container.appendChild(e),this._element=e},Ba.prototype._drawStraightLine=function(t,e){var i=Rt("path"),r="M "+t.x+","+t.y+" L"+e.x+","+e.y;i.setAttribute("d",r),i.setAttribute(Fa,this._currentElementId),this._container.appendChild(i),this._element=i},Ba.prototype._drawQuadraticCurve=function(t,e,i){var r=Rt("path"),n="M "+t.x+","+t.y+" Q"+e.x+","+e.y+" "+i.x+","+i.y;r.setAttribute("d",n),r.setAttribute("fill",Oa),r.setAttribute(Fa,this._currentElementId),this._container.appendChild(r),this._element=r},Ba.prototype._drawCubicCurve=function(t,e,i,r){var n=Rt("path"),o="M "+t.x+","+t.y+" C"+e.x+","+e.y+" "+i.x+","+i.y+" "+r.x+","+r.y;n.setAttribute("d",o),n.setAttribute("fill",Oa),n.setAttribute(Fa,this._currentElementId),this._container.appendChild(n),this._element=n},Ba.prototype._fill=function(t){var e=this._colorManager.rgbaToRgb(t);this._element.setAttribute("fill",e.color),this._element.setAttribute("fill-opacity",e.opacity),this._currentClipPathId&&this._element.setAttribute("clip-path","url(#"+this._currentClipPathId+")")},Ba.prototype._stroke=function(t,e,i){void 0===i&&(i=[]);var r=this._element;r.setAttribute("stroke-width",e);var n=this._colorManager.rgbaToRgb(t);r.setAttribute("stroke",n.color),r.setAttribute("stroke-opacity",n.opacity),0<i.length&&r.setAttribute("stroke-dasharray",i.map(Ra).toString())},Ba.prototype._startClip=function(){var t=Rt("clipPath"),e=this._element.cloneNode(!1);this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},Ba.prototype._endClip=function(){this._currentClipPathId=null},Ba.prototype._startReverseClip=function(){var t=Rt("clipPath"),e=this._element.cloneNode(!1),i=e.getAttribute("d");e.setAttribute("clip-rule","evenodd"),e.setAttribute("d",i+" M 0 0 L "+this._width+" 0 L "+this._width+" "+this._height+" L 0 "+this._height),this._currentClipPathId="clip-path-"+this._clipPathCounter++,t.appendChild(e),this._clipPaths.appendChild(t),t.setAttribute("id",this._currentClipPathId)},Ba.prototype._endReverseClip=function(){this._currentClipPathId=null},Ba.prototype._displayText=function(t,e,i,r,n,o,s,a,u){var l=Rt("text");l.setAttribute(Fa,this._currentElementId);var d=this._colorManager.rgbaToRgb(r),h=d.opacity,c=this._colorManager.rgbaToRgb(d.color),f=t.x,g=t.y;s=s||"normal";var p=Ra(f);l.setAttribute("x",p),l.setAttribute("font-family",n),l.setAttribute("font-size",o),"bold"===s?l.setAttribute("font-weight",s):l.setAttribute("font-style",s),l.setAttribute("fill",c.color),l.setAttribute("fill-opacity",h),e&&l.setAttribute("transform","rotate("+Ia(-e)+" "+f+", "+g+")"),l.setAttribute("text-anchor",ka[a]||"middle");var _=i.split("\n"),v=_.length,m=(v+1)/2-1/3;l.setAttribute("y",Ra(g-m*o));for(var y=0;y<v;y++){var x=Rt("tspan");x.appendChild(Pt(_[y])),x.setAttribute("x",p),x.setAttribute("dy",o),l.appendChild(x)}this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(l)},Ba.prototype._displayImage=function(t,e,i,r,n,o,s){var a=t.x,u=t.y;if(!this._hideImages&&("isDummy"in r||r.width&&r.height)){var l,d=r.width,h=r.height;if(n&&(d=e,h=i),o){var c=a-e/2,f=u-i/2,g=a+e/2,p=u+i/2,_=a-d/2,v=u-h/2;for((l=Rt("g")).setAttribute(Fa,this._currentElementId);c<_;)_-=d;for(;f<v;)v-=h;for(var m=v;_<g;){for(;v<p;)Pa(r.src,_,v,d,h,l),v+=h;v=m,_+=d}}else(l=Pa(r.src,a-d/2,u-h/2,d,h)).setAttribute(Fa,this._currentElementId);if(this._currentClipPathId&&l.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),1!==s){var y=this._addBackgroundBlendingFilter(s);l.setAttribute("filter","url(#"+y+")")}this._container.appendChild(l)}},Ba.prototype._displayPieChart=function(t,l,e){var d,i=2*l,r=2*i,h=t.x,c=t.y,f=Rt("g");f.setAttribute(Fa,this._currentElementId),1===e.length&&(d=function(t,e,i,r,n,o,s){void 0===o&&(o=1);var a=Rt("rect");return a.setAttribute("x",t),a.setAttribute("y",e),a.setAttribute("width",i),a.setAttribute("height",r),a.setAttribute("fill",n),a.setAttribute("fill-opacity",o),s&&s.appendChild(a),a}(h-i,c-i,r,r,e[0],1,f)),1<e.length&&eo(e,function(t,e,i){var r=h+l*Math.cos(i),n=c+l*Math.sin(i),o=h+l*Math.cos(e),s=c+l*Math.sin(e),a=i-e<=Math.PI?0:1,u="M "+r+","+n+" A "+l+","+l+" 0 "+a+" 0 "+o+","+s+" L "+h+","+c+" L "+r+","+n;(d=Rt("path")).setAttribute("d",u),d.setAttribute("fill",t),d.setAttribute("stroke-width",0),f.appendChild(d)}),this._currentClipPathId&&f.setAttribute("clip-path","url(#"+this._currentClipPathId+")"),this._container.appendChild(f)},Ba);function Ba(t){var e=Da.call(this,t)||this;return e._svg=Rt("svg"),e._defs=Rt("defs"),e._styles=Rt("g",{class:"styles"}),e._background=Rt("rect",{width:"100%",height:"100%",fill:"none",class:"ogma-svg-background"}),e._currentElementId="0",e._currentClipPathId=null,e._clipPathCounter=1,e._defs.appendChild(e._styles),e._svg.setAttribute("pointer-events","none"),e._svg.style.userSelect="none",e._svg.appendChild(e._defs),e._svg.appendChild(e._background),e._clear(),e}var Ua=(Va.prototype.reset=function(){this._initialize()},Va.prototype._initialize=function(){this._mustUpdate=!0,this.maxCoord=0,this.maxScaledSize=0,this.maxMinVisibleSize=0,this.maxSymbolicSize=0,this.maxDashLength=0,this.maxGapLength=0,this.maxPatternScale=0},Va.prototype.set=function(t){var e=t.maxCoord,i=t.maxScaledSize,r=t.maxMinVisibleSize,n=t.maxSymbolicSize,o=t.maxDashLength,s=t.maxGapLength,a=t.maxPatternScale,u=this.maxCoord<e||this.maxScaledSize<i||this.maxMinVisibleSize<r||this.maxSymbolicSize<n||this.maxDashLength<o||this.maxGapLength<s||this.maxPatternScale<a;return u&&(this.maxCoord=e,this.maxScaledSize=i,this.maxMinVisibleSize=r,this.maxSymbolicSize=n,this.maxDashLength=o,this.maxGapLength=s,this.maxPatternScale=a,this._mustUpdate=!0),u},Va.prototype.update=function(){return this._mustUpdate&&(this._version+=1,this._mustUpdate=!1),this},Va.prototype.getVersion=function(){return this._version},Va);function Va(){this._version=0,this._initialize()}var ja={linear:[0,1,0,0],quadraticIn:[0,0,1,0],quadraticOut:[0,2,-1,0],quadraticInOut:[0,0,2,0,-1,4,-2,0],cubicIn:[0,0,0,1],cubicOut:[0,3,-3,1],cubicInOut:[0,0,0,4,-3,12,-12,4]},Ga=(Ha.prototype.add=function(r){var n=this;Object.keys(r).forEach(function(t){var e=r[t].slice();e.length<8&&(e[4]=e[0],e[5]=e[1],e[6]=e[2],e[7]=e[3]);var i=B(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);n._nameToPolygon[t]=e,n._polygonToName[i]=t})},Ha.prototype.getCoefficients=function(t){return this._nameToPolygon[t]||this._linearEasing},Ha.prototype.getName=function(t,e,i,r,n,o,s,a){var u=B(t,e,i,r,n,o,s,a);return this._polygonToName[u]||"linear"},Ha);function Ha(){this._linearEasing=[0,1,0,0,0,1,0,0],this._nameToPolygon={},this._polygonToName={},this.add(ja)}var Wa=(qa.prototype.resizeBoundaries=function(t,e,i,r,n,o){this._maxScaledSize=t,this._maxMinVisibleSize=e,this._maxSymbolicSize=i,this._maxDashLength=r,this._maxGapLength=n,this._maxPatternScale=o,this._actualScaledSizeToBytes=65535/t,this._actualMinVisibleSizeToBytes=15/e,this._actualSymbolicSizeToBytes=255/i,this._actualDashLengthToBytes=3/r,this._actualGapLengthToBytes=3/n,this._actualPatternScaleToBytes=255/o},qa.prototype.storeGenericObject=function(t,e,i){var r=this._shapeManager.getIdFromName(i.shape),n=i.pieceId,o=this._dashLengthToBytes(i.dashLength),s=this._gapLengthToBytes(i.gapLength),a=+i.hasHead,u=+i.hasTail,l=+i.isBodyTriangle,d=+i.isSelfLoop,h=this._patternScaleToBytes(i.patternScale),c=this._offsetAngleToBytes(i.offsetAngle),f=+i.isText,g=+i.adjustTextAngle,p=+i.isBadge,_=+i.unusedFlag2,v=+i.unusedFlag3,m=this._opacityToBytes(i.opacity),y=this._minVisibleSizeToBytes(i.globalMinVisibleSize),x=this._minVisibleSizeToBytes(i.strokeMinVisibleSize),b=this._minVisibleSizeToBytes(i.patternMinVisibleSize),E=this._symbolicSizeToBytes(i.symbolicSize),A=this._curvatureToBytes(i.curvature),S=this._patternManager.getIdFromDefinition(i.pattern),w=this._colorToBytes(i.fillColor),T=this._colorToBytes(i.strokeColor),C=this._colorToBytes(i.patternColor),M=this._coordToBytes(i.x1),I=this._coordToBytes(i.y1),L=this._coordToBytes(i.x2),N=this._coordToBytes(i.y2),O=this._scaledSizeToBytes(i.rectWidthOrSourceRadiusScaled),k=this._fixedSizeToBytes(i.rectWidthOrSourceRadiusFixed),F=this._scaledSizeToBytes(i.rectHeightOrTargetRadiusScaled),R=this._fixedSizeToBytes(i.rectHeightOrTargetRadiusFixed),P=this._scaledSizeToBytes(i.thicknessOrFontSizeScaled),D=this._fixedSizeToBytes(i.thicknessOrFontSizeFixed),z=this._scaledSizeToBytes(i.strokeWidthScaled),B=this._fixedSizeToBytes(i.strokeWidthFixed),U=this._scaledSizeToBytes(i.offsetScaled),V=this._fixedSizeToBytes(i.offsetFixed),j=r+(n<<4)+(o<<8)+(s<<10)+(a<<12)+(u<<13)+(l<<14)+(d<<15),G=h+(c<<8)+(f<<11)+(g<<12)+(p<<13)+(_<<14)+(v<<15),H=m+(y<<4)+(x<<8)+(b<<12),W=E+(A<<8);this._setUint16(t,e+0,j),this._setUint16(t,e+2,G),this._setUint16(t,e+4,H),this._setUint16(t,e+6,W),this._setUint16(t,e+8,S),this._setUint16(t,e+10,w),this._setUint16(t,e+12,T),this._setUint16(t,e+14,C),this._setFloat32(t,e+16,M),this._setFloat32(t,e+20,I),this._setFloat32(t,e+24,L),this._setFloat32(t,e+28,N),this._setUint16(t,e+32,O),this._setUint16(t,e+34,k),this._setUint16(t,e+36,F),this._setUint16(t,e+38,R),this._setUint16(t,e+40,P),this._setUint16(t,e+42,D),this._setUint16(t,e+44,z),this._setUint16(t,e+46,B),this._setUint16(t,e+48,U),this._setUint16(t,e+50,V)},qa.prototype._setUint16=function(t,e,value){t.setUint16(e,value,this._littleEndian)},qa.prototype._setFloat32=function(t,e,value){t.setFloat32(e,value,this._littleEndian)},qa.prototype._colorToBytes=function(t){var e=this._colorParser(t);return Math.round(15*e[0])+(Math.round(15*e[1])<<4)+(Math.round(15*e[2])<<8)+(Math.round(15*e[3])<<12)},qa.prototype._coordToBytes=function(value){return value},qa.prototype._scaledSizeToBytes=function(value){return Math.ceil(Math.min(value,this._maxScaledSize)*this._actualScaledSizeToBytes)},qa.prototype._fixedSizeToBytes=function(value){return value},qa.prototype._minVisibleSizeToBytes=function(value){return Math.round(Math.min(value,this._maxMinVisibleSize)*this._actualMinVisibleSizeToBytes)},qa.prototype._symbolicSizeToBytes=function(value){return Math.round(Math.min(value,this._maxSymbolicSize)*this._actualSymbolicSizeToBytes)},qa.prototype._dashLengthToBytes=function(value){return Math.round(Math.min(value,this._maxDashLength)*this._actualDashLengthToBytes)},qa.prototype._gapLengthToBytes=function(value){return Math.round(Math.min(value,this._maxGapLength)*this._actualGapLengthToBytes)},qa.prototype._patternScaleToBytes=function(value){return Math.round(Math.min(value,this._maxPatternScale)*this._actualPatternScaleToBytes)},qa.prototype._offsetAngleToBytes=function(value){return Math.round((value+Js)%Js*(8/Js))},qa.prototype._opacityToBytes=function(value){return Math.round(15*Math.min(value,1))},qa.prototype._curvatureToBytes=function(value){return this._signedToUnsignedByte(value)},qa.prototype._signedToUnsignedByte=function(value){return Ye(value,-128,127)+128},qa.prototype.storeAnimationInformation=function(t,e,i,r){var n=i.beginTime,o=i.duration;this._setAnimationBeginTime(t,e,n),this._setAnimationDuration(t,e,o),this._setAnimationEasing(t,e,r)},qa.prototype._setAnimationBeginTime=function(t,e,i){this._setFloat32(t,e,i)},qa.prototype._setAnimationDuration=function(t,e,i){this._setFloat32(t,e+4,i)},qa.prototype._setAnimationEasing=function(t,e,i){this._setUint16(t,e+8,(i[0]+128<<8)+(i[4]+128)),this._setUint16(t,e+10,(i[1]+128<<8)+(i[5]+128)),this._setUint16(t,e+12,(i[2]+128<<8)+(i[6]+128)),this._setUint16(t,e+14,(i[3]+128<<8)+(i[7]+128))},qa.prototype.extractGenericElement=function(t,e,i){var r=t.getElementType(),n=t.isAnimated(),o=t.getDataView(),s=e*t.getElementSize(),a=this._genericObject;if(a.valid=!1,o.getUint16(s)&&(a.valid=!0,this._extractGenericObject(a.end,o,s,i),n&&(this._extractGenericObject(a.start,o,52+s,i),this._extractAnimationInformation(a.animation,o,104+s)),a.id=this._idRecorder.get(t,e),2===r)){var u=t.getSideDataView(),l=e*t.getTotalSideElementsSize(),d=l+t.getTotalSideElementsSize();a.end.pattern=this._textManager.extractTextFromDataView(u,l,d)}return a},qa.prototype._extractGenericObject=function(t,e,i,r){var n=r.bytesToActualCoord,o=r.bytesToActualScaledSize,s=r.bytesToActualMinVisibleSize,a=r.bytesToActualPatternScale,u=r.bytesToActualSymbolicSize,l=r.bytesToActualDashLength,d=r.bytesToActualGapLength,h=e,c=i,f=this._littleEndian,g=h.getUint16(c,f),p=Xa(g,0,4),_=Xa(g,4,8),v=Xa(g,8,10),m=Xa(g,10,12),y=Xa(g,12,13),x=Xa(g,13,14),b=Xa(g,14,15),E=Xa(g,15,16),A=h.getUint16(c+2,f),S=Xa(A,0,8),w=Xa(A,8,11),T=Xa(A,11,12),C=Xa(A,12,13),M=Xa(A,13,14),I=Xa(A,14,15),L=Xa(A,15,16),N=h.getUint16(c+4,f),O=Xa(N,0,4),k=Xa(N,4,8),F=Xa(N,8,12),R=Xa(N,12,16),P=h.getUint16(c+6,f),D=Xa(P,0,8),z=Xa(P,8,16),B=h.getUint16(c+8,f),U=h.getUint16(c+10,f),V=h.getUint16(c+12,f),j=h.getUint16(c+14,f),G=h.getFloat32(c+16,f),H=h.getFloat32(c+20,f),W=h.getFloat32(c+24,f),q=h.getFloat32(c+28,f),X=h.getUint16(c+32,f),Y=h.getUint16(c+34,f),Z=h.getUint16(c+36,f),K=h.getUint16(c+38,f),Q=h.getUint16(c+40,f),J=h.getUint16(c+42,f),$=h.getUint16(c+44,f),tt=h.getUint16(c+46,f),et=h.getUint16(c+48,f),it=h.getUint16(c+50,f);t.pieceId=_,t.shape=this._shapeManager.getNameFromId(p),t.x1=Ya(G,n),t.y1=Ya(H,n),t.x2=Ya(W,n),t.y2=Ya(q,n),t.rectWidthOrSourceRadiusScaled=Ya(X,o),t.rectWidthOrSourceRadiusFixed=Y,t.rectHeightOrTargetRadiusScaled=Ya(Z,o),t.rectHeightOrTargetRadiusFixed=K,t.thicknessOrFontSizeScaled=Ya(Q,o),t.thicknessOrFontSizeFixed=J,t.strokeWidthScaled=Ya($,o),t.strokeWidthFixed=tt,t.offsetScaled=Ya(et,o),t.offsetFixed=it,t.pattern=this._patternManager.getDefinitionFromId(B),t.opacity=O/15,t.fillColor=Ka(U),t.strokeColor=Ka(V),t.patternColor=Ka(j),t.globalMinVisibleSize=Ya(k,s),t.strokeMinVisibleSize=Ya(F,s),t.patternMinVisibleSize=Ya(R,s),t.offsetAngle=w*(2*Math.PI/8),t.patternScale=S*a,t.symbolicSize=D*u,t.curvature=z-128,t.dashLength=v*l,t.gapLength=m*d,t.hasHead=!!y,t.hasTail=!!x,t.isBodyTriangle=!!b,t.isSelfLoop=!!E,t.isText=!!T,t.adjustTextAngle=!!C,t.isBadge=!!M,t.unusedFlag2=!!I,t.unusedFlag3=!!L},qa.prototype._extractAnimationInformation=function(t,e,i){var r=this._littleEndian,n=e.getFloat32(i,r),o=e.getFloat32(i+4,r),s=e.getUint16(i+8,r),a=e.getUint16(i+10,r),u=e.getUint16(i+12,r),l=e.getUint16(i+14,r),d=(s>>8)-128,h=(a>>8)-128,c=(u>>8)-128,f=(l>>8)-128,g=s%256-128,p=a%256-128,_=u%256-128,v=l%256-128;t.beginTime=n,t.duration=o,t.easing=this._easingManager.getName(d,h,c,f,g,p,_,v)},qa);function qa(t,e,i,r,n,o){this._littleEndian=D(),this._maxScaledSize=0,this._maxMinVisibleSize=0,this._maxSymbolicSize=0,this._maxDashLength=0,this._maxGapLength=0,this._maxPatternScale=0,this._actualScaledSizeToBytes=32767,this._actualMinVisibleSizeToBytes=15,this._actualSymbolicSizeToBytes=255,this._actualDashLengthToBytes=3,this._actualGapLengthToBytes=3,this._actualPatternScaleToBytes=255,this._genericObject=Mn(),this._shapeManager=e,this._patternManager=t,this._textManager=i,this._idRecorder=r,this._easingManager=n,this._colorParser=o}function Xa(value,t,e){return value%(1<<e)>>t}function Ya(value,t){return value*t}var Za=new Array(65535);function Ka(value){var t=Za[value];if(!t){var e=Xa(value,0,4)/15,i=Xa(value,4,8)/15,r=Xa(value,8,12)/15,n=Xa(value,12,16)/15;t="rgba("+(255*e|0)+", "+(255*i|0)+", "+(255*r|0)+", "+n+")",e+i+r+n==0&&(t=null),Za[value]=t}return t}var Qa=(Ja.prototype.setDepth=function(t){return this._depth=t,this},Ja.prototype.reset=function(t,e,i,r){return this._elementType=t,this._animated=e,this._depth=i,void 0!==r&&(this._id=r),this._stencilUsage=1,this._size=0,this},Ja.prototype.setStencilUsage=function(t){this._stencilUsage=t},Ja.prototype.next=function(){if(this._size>=this._capacity)throw new Error("internal error: block.next() was called on a full block");return this._list[this._size++]},Ja.prototype.nextAndReset=function(){var t,e=this.next();return e.end=Cn(e.end),e.start=Cn(e.start),e.animation=(void 0===(t=e.animation)&&(t={}),t.duration=0,t.beginTime=-1,t.easing="linear",t),e},Ja.prototype.forEach=function(t){this._list.forEach(t)},Ja.prototype.getElement=function(t){return this._list[t]},Ja.prototype.getCurrentElement=function(){return this._list[this._size-1]},Ja.prototype.getSize=function(){return this._size},Ja.prototype.getDepth=function(){return this._depth},Ja.prototype.getElements=function(){return this._list},Ja.prototype.getType=function(){return this._elementType},Ja.prototype.getId=function(){return this._id},Ja.prototype.isAnimated=function(){return this._animated},Ja.prototype.getStencilUsage=function(){return this._stencilUsage},Ja.prototype.setGlobalAnimation=function(t,e,i){for(var r=0;r<this._size;++r){var n=this._list[r].animation;n.duration=t,n.beginTime=e,n.easing=i}},Ja);function Ja(){this._elementType=1,this._animated=!1,this._size=0,this._capacity=128,this._depth=0,this._id=0,this._stencilUsage=1,this._list=Array(this._capacity);for(var t=0;t<this._capacity;++t)this._list[t]=Mn()}var $a=(tu.prototype.reset=function(){this._maps=[]},tu.prototype.set=function(t,e,i){for(var r=t.getId();this._maps.length<=r;)this._maps.push(new Array(512));this._maps[r][e]=i},tu.prototype.get=function(t,e){return this._maps[t.getId()][e]},tu);function tu(){this._maps=[]}var eu={x:0,y:0,zoom:1,angle:0,width:80,height:60,pixelRatio:1,backgroundColor:null,currentTime:0,isBufferDisplayable:function(){return!0},hideImages:!1,renderBackground:!1},iu={webgl:Ps,canvas:Sa,svg:za},ru=[0,0,0,0],nu={webgl:null,svg:null,canvas:null},ou=(su.createInitData=function(){var t={};for(var e in iu)t[e]=iu[e].createInitData();return t},su.cacheInitData=function(t){nu=t},su.getCachedInitData=function(){return nu},su.clearCachedInitData=function(){nu={webgl:null,svg:null,canvas:null}},su.prototype.addCanvas=function(t){t.style.touchAction="none",t.style.msContentZooming="none",this._resizeCanvas(t),this._additionalCanvases.push(t),this._updateDomElement()},su.prototype.removeCanvas=function(t){t.style.touchAction="",t.style.msContentZooming="",k(this._additionalCanvases,t),this._updateDomElement()},su.prototype._ensureDomElementsFitParent=function(){if(this._domElement.offsetWidth!==this._view.width||this._domElement.offsetHeight!==this._view.height){this._domElement.style.width=this._view.width+"px",this._domElement.style.height=this._view.height+"px";for(var t=0;t<this._additionalCanvases.length;++t)this._resizeCanvas(this._additionalCanvases[t])}},su.prototype._ensureCorrectBackgroundColor=function(){this._backgroundColor!==this._view.backgroundColor&&(this._domElement.style.backgroundColor=this._view.backgroundColor||"",this._backgroundColor=this._view.backgroundColor)},su.prototype.createBlock=function(){return new Qa},su.prototype.parseColor=function(t){return this._colorManager.parseColor(t)},su.prototype.clear=function(){this._blockIdToAddress.fill(0),this._patternManager.reset(),this._boundariesManager.reset(),this._textManager.reset(),this._bufferList.reset(),this._idRecorder.reset()},su.prototype.notifyFontsReloaded=function(){this._patternManager.notifyUpdate(),this._textManager.clear(),this._refreshTexts=!0},su.prototype.notifyPatternUpdate=function(){this._patternManager.notifyUpdate()},su.prototype.getShapePoints=function(t){return this._shapeManager.getDefinitionFromName(t).points},su.prototype.checkShapeHit=function(t,e,i){var r=this._shapeManager.getDefinitionFromName(t),n=r.getDistanceFromStrokeVertically,o=r.getDistanceFromStrokeHorizontally;return 0<=Math.min(n(e,i),o(e,i))},su.prototype.setGlobalBoundaries=function(t){var e=t.maxBlockId,i=void 0===e?0:e,r=t.maxScaledSize,n=t.maxMinVisibleSize,o=t.maxSymbolicSize,s=t.maxDashLength,a=t.maxGapLength,u=t.maxPatternScale;return i>this._blockIdToAddress.length&&this._resizeBlockArray(i),!!this._boundariesManager.set(t)&&(this._memoryManager.resizeBoundaries(r,n,o,s,a,u),!0)},su.prototype._resizeBlockArray=function(t){var e=new Uint32Array(t);e.set(this._blockIdToAddress),this._blockIdToAddress=e},su.prototype.registerShape=function(t,e){this._shapeManager.register(t,e)},su.prototype._bindBlock=function(t,e,i,r,n,o,s){this._checkBlockId(t);var a=this._blockIdToAddress[t],u=this._bufferList.allocateBlock(a,e,i,r,n,o,s);return this._blockIdToAddress[t]=u.address,this._currentDataView=u.buffer.getDataView(),this._currentElementSize=u.buffer.getElementSize(),this._currentBlockOffset=u.offset,this._currentByteOffset=this._currentBlockOffset*this._currentElementSize,this._currentSideDataView=u.buffer.getSideDataView(),this._currentSideElementSize=u.buffer.getTotalSideElementsSize(),this._currentSideByteOffset=this._currentBlockOffset*this._currentSideElementSize,u},su.prototype._setItemIndex=function(t){var e=this._currentBlockOffset+t;this._currentByteOffset=e*this._currentElementSize,this._currentSideByteOffset=e*this._currentSideElementSize},su.prototype._freeBlock=function(t){this._checkBlockId(t);var e=this._blockIdToAddress[t],i=this._bufferList.freeBlock(e);return this._blockIdToAddress[t]=i},su.prototype._checkBlockId=function(t){t>=this._blockIdToAddress.length&&this._resizeBlockArray(qe(t+1))},su.prototype._setTextCharacters=function(t){this._textManager.storeTextInDataView(this._currentSideDataView,this._currentSideByteOffset,this._currentSideByteOffset+this._currentSideElementSize,t)},su.prototype._storeElement=function(t,e){this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset,t.end),e&&(this._memoryManager.storeGenericObject(this._currentDataView,this._currentByteOffset+52,t.start),this._memoryManager.storeAnimationInformation(this._currentDataView,this._currentByteOffset+104,t.animation,this._easingManager.getCoefficients(t.animation.easing)))},su.prototype.storeBlock=function(t,e){if(!e||!e.getSize())return this._freeBlock(t);var i=e.getType(),r=e.getDepth(),n=e.getSize(),o=e.getElements(),s=e.isAnimated(),a=e.getStencilUsage(),u=e.getId(),l=0;if(2===i)for(var d=0;d<n;++d){var h=(_=o[d]).start,c=_.end;if(c.pattern.type===Ur){var f=c.pattern.attributes.text;l=Math.max(l,f.length)}s&&h.pattern.type===Ur&&(f=h.pattern.attributes.text,l=Math.max(l,f.length))}var g=this._bindBlock(t,i,s,r,n,l,a);for(d=0;d<n;++d){var p=o[d];this._setItemIndex(d),this._storeElement(p,s),this._idRecorder.set(g.buffer,g.offset+d,u)}if(2===i)for(d=0;d<n;++d){var _=o[d];this._setItemIndex(d),this._setTextCharacters(_.end.pattern)}return g.address},su.prototype.freeBlock=function(t){return this._freeBlock(t)},su.prototype._refreshTextElements=function(){for(var t=0,e=this._bufferList.getBuffers();t<e.length;t++){var i=e[t];if(i&&2===i.getElementType()){for(var r=i.getSideDataView(),n=i.getTotalSideElementsSize(),o=i.getSize(),s=0,a=n,u=0;u<o;++u){var l=this._textManager.extractTextFromDataView(r,s,a);this._textManager.storeTextInDataView(r,s,a,l),s=a,a+=n}i.triggerUpdate()}}},su.prototype.extractElement=function(t,e){if(void 0===e&&(e=0),!t)return null;var i=this._bufferList.getBlockInfo(t);return this._renderer.extractElement(i.buffer,i.offset+e)},su.prototype.getDomElement=function(){return this._domElement},su.prototype.measureText=function(t,e,i,r){return void 0===r&&(r=1),this._textManager.measureText(t,e,i,r)},su.prototype.setRenderType=function(t){this._renderType!==t&&(this._renderType=t,this._switchMainRenderer=!0)},su.prototype._ensureMainRendererReady=function(){if(this._switchMainRenderer){null===this._renderType&&(this._renderType="canvas");var t=iu[this._renderType];t&&t.isAvailable()||(this._renderType="canvas"),this._renderer=this._renderersByType[this._renderType],this._renderer||(this._renderer=this._instanciateRenderer(this._renderType),this._renderersByType[this._renderType]=this._renderer),this._updateDomElement()}},su.prototype._updateDomElement=function(){for(var t=this._renderer&&this._renderer.getDomElement(),e=this._domElement;e.firstChild;)e.removeChild(e.firstChild);t&&this._appendDomChild(t);for(var i=0;i<this._additionalCanvases.length;++i)this._appendDomChild(this._additionalCanvases[i])},su.prototype._appendDomChild=function(t){t.style.position="absolute",t.style.left="0",t.style.top="0",this._domElement.appendChild(t)},su.prototype._instanciateRenderer=function(t){return new(null===t?Ln:iu[t])({initData:null===t?null:this._initData[t],bufferList:this._bufferList,shapeManager:this._shapeManager,patternManager:this._patternManager,boundariesManager:this._boundariesManager,textManager:this._textManager,colorManager:this._colorManager,easingManager:this._easingManager,memoryManager:this._memoryManager})},su.prototype.setView=function(t){this._view=I(I({},this._view),t)},su.prototype._updateManagers=function(){this._patternManager.setPixelRatio(this._view.pixelRatio),this._shapeManager.update(),this._patternManager.update(),this._textManager.update(),this._boundariesManager.update(),this._bufferList.update(),this._refreshTexts&&(this._refreshTexts=!1,this._refreshTextElements())},su.prototype._resizeCanvas=function(t){In(t,this._view.width,this._view.height,this._view.pixelRatio)},su.prototype.render=function(){this._ensureMainRendererReady(),this._ensureDomElementsFitParent(),this._ensureCorrectBackgroundColor(),this._updateManagers(),this._renderer.renderFrame(this._view)},su.prototype.ensureAnimationsReady=function(){this._ensureMainRendererReady(),this._renderer.ensureAnimationsReady()},su.prototype.export=function(t,e,i){var r=this._instanciateRenderer(t),n=I(I({},this._view),e);return"setViewportClipping"in r&&r.setViewportClipping(!1),n.renderBackground=!0,this._updateManagers(),r.renderFrame(n),r.export(i).then(function(){return r.getDomElement()})},su.prototype.getCurrentTime=function(){return Kt()},su.prototype.getImageData=function(){return this._renderer&&this._renderer.getImageData()},su.prototype.destroy=function(){for(var t=0,e=Object.keys(this._renderersByType);t<e.length;t++){var i=e[t],r=this._renderersByType[i];r&&r.destroy()}},su.prototype.transparentify=function(t){var e=this.parseColor(t)||ru;return"rgba("+Math.round(255*e[0])+","+Math.round(255*e[1])+","+Math.round(255*e[2])+",0)"},su.prototype.initDebugRenderingLoop=function(t){var e=this,i=void 0===t?{}:t,r=i.triggerKey,n=void 0===r?"r":r,o=i.start,s=void 0===o||o;document.addEventListener("keydown",function(t){t.key===n&&(s=!s)});var a=function(force){(s||force)&&(e.setView({currentTime:Kt()}),e.render()),window.requestAnimationFrame(function(){a()})};window.requestAnimationFrame(function(){document.body.appendChild(e.getDomElement()),a(!0)})},su);function su(t){var e=this;this._view=G(eu),this._domElement=ct?document.createElement("div"):St(),this._currentElementSize=0,this._currentBlockOffset=0,this._currentByteOffset=0,this._blockIdToAddress=new Uint32Array(0),this._renderersByType={},this._switchMainRenderer=!0,this._additionalCanvases=[],this._refreshTexts=!1,this._backgroundColor=null,this._initData=t||{},this._colorManager=new kr,this._easingManager=new Ga,this._patternManager=new Xr,this._shapeManager=new un,this._boundariesManager=new Ua,this._textManager=new Ts(this._patternManager),this._idRecorder=new $a,this._memoryManager=new Wa(this._patternManager,this._shapeManager,this._textManager,this._idRecorder,this._easingManager,function(t){return e.parseColor(t)||ru}),this._bufferList=new cn}var au,uu=(x(lu,au=us),Object.defineProperty(lu.prototype,"src",{get:function(){return this._src},set:function(t){var e=this;t&&(this._src=t,setTimeout(function(){e.onload&&e.onload.call(e),e.width=1,e.height=1,e.fire("load")},10))},enumerable:!0,configurable:!0}),lu.prototype.addEventListener=function(t,e){this.on(t,e)},lu);function lu(t,e){var i=au.call(this)||this;return i.isDummy=!0,i.width=0,i.height=0,i}var du=(hu.prototype.setImgCrossOrigin=function(t){this._crossOrigin=t},hu.prototype.clear=function(){this._images={},this._nbLoaded=0,this._nbToLoad=0},hu.prototype.getImage=function(t){var e,i,r=this,n=this._images[t];return void 0===n&&(this._nbToLoad+=1,(n=new("undefined"!=typeof Image?Image:uu)(e,i)).crossOrigin=this._crossOrigin,n.onload=function(){return r._onImgLoad(t)},n.onerror=function(){r._onImgLoad(t),r._images[t]=null},n.src=t,this._images[t]=n),n},hu.prototype._onImgLoad=function(e){this._nbLoaded+=1,this._onFetch.forEach(function(t){return t(e)}),this._nbLoaded===this._nbToLoad&&(this._whenReady.forEach(function(t){return t()}),this._whenReady=[])},hu.prototype.onFetch=function(t){this._onFetch.push(t)},hu.prototype.whenReady=function(){var e=this;return this._nbLoaded===this._nbToLoad?Promise.resolve():new Promise(function(t){return e._whenReady.push(t)})},hu.prototype.destroy=function(){this._whenReady=[],this._onFetch=[]},hu);function hu(){this._images={},this._crossOrigin="anonymous",this._whenReady=[],this._onFetch=[],this._nbLoaded=0,this._nbToLoad=0}function cu(t,e,i,r,n,o,s,a,u){void 0===a&&(a=0),void 0===u&&(u=!1);var l=distance(i,r,n,o),d=(s/2*(u?distance(t,e,n,o)/l:1)+a)/l,h=(n-i)*d,c=(o-r)*d,f=i+c,g=r-h,p=t-f,_=e-g,v=i-c-f,m=r+h-g,y=n+c-f,x=o-h-g,b=p*v+_*m,E=p*y+_*x;return 0<b&&b<v*v+m*m&&0<E&&E<y*y+x*x}function fu(t,e){return t.x===e.x&&t.y===e.y}function gu(t,e,i,r){return Math.atan2(r-e,i-t)}function pu(t,e,i,r,n,o,s,a){var u=t-i,l=e-r,d=n-s,h=o-a,c=u*h-d*l,f=(l*(t-n)-u*(e-o))/c;if(f<0||1<f)return null;var g=(d*(o-e)+h*(t-n))/c;return 0<=g&&g<=1?{x:t-g*u,y:e-g*l}:null}function _u(t,e,i,r,n,o,s,a){var u,l=[];return(u=pu(t,e,i,r,n,o,n,a))&&l.push(u),(u=pu(t,e,i,r,n,a,s,a))&&l.push(u),(u=pu(t,e,i,r,s,a,s,o))&&l.push(u),(u=pu(t,e,i,r,s,o,n,o))&&l.push(u),l}function vu(t,e,i,r,n,o,s,a){var u=((s-n)*(e-o)-(a-o)*(t-n))/((a-o)*(i-t)-(s-n)*(r-e)),l=((i-t)*(e-o)-(r-e)*(t-n))/((a-o)*(i-t)-(s-n)*(r-e));return 0<=u&&u<=1&&0<=l&&l<=1}function mu(t,e,i,r,n,o,s,a){return n<=t&&o<=e&&t<=s&&e<=a||(n<=i&&o<=r&&i<=s&&r<=a||(!!vu(t,e,i,r,n,o,n,a)||(!!vu(t,e,i,r,s,o,s,a)||(!!vu(t,e,i,r,n,o,s,o)||!!vu(t,e,i,r,n,a,s,a)))))}function yu(t,e,i){return Math.sqrt(xu(t.x,t.y,e.x,e.y,i.x,i.y))}function xu(t,e,i,r,n,o){var s=Ma(i,r,n,o);if(0===s)return Ma(t,e,i,r);var a=((t-i)*(n-i)+(e-r)*(o-r))/s;return Ma(t,e,i+(a=Math.max(0,Math.min(1,a)))*(n-i),r+a*(o-r))}function bu(t,e,i,r,n,o){var s=n-i,a=o-r;if(0==s&&0==a)return{x:i,y:r};var u=((t-i)*s+(e-r)*a)/(s*s+a*a);return u<0?{x:i,y:r}:1<u?{x:n,y:o}:{x:i+u*s,y:r+u*a}}var Eu=1e-6,Au=1e-12;function Su(){for(var t=arguments,e=t.length-1,i=e,r=[],n=0;n<=e&&Math.abs(t[n])<=Au;n++)e--;switch(e){case 1:!function(t,e,i){void 0===i&&(i=[]);0!==e&&i.push(-t/e)}(t[i],t[i-1],r);break;case 2:!function(t,e,i,r){void 0===r&&(r=[]);var n=e/i,o=n*n-t/i*4;if(0<o){var s=Math.sqrt(o);r.push(.5*(-n+s)),r.push(.5*(-n-s))}else 0==o&&r.push(.5*-n)}(t[i],t[i-1],t[i-2],r);break;case 3:!function(t,e,i,r,n){void 0===n&&(n=[]);var o,s,a=i/r,u=e/r,l=(3*u-a*a)/3,d=(2*a*a*a-9*u*a+t/r*27)/27,h=a/3,c=d*d/4+l*l*l/27,f=d/2;Math.abs(c)<=Eu&&(c=0);if(0<c){var g=Math.sqrt(c);s=0<=(o=-f+g)?Math.pow(o,1/3):-Math.pow(-o,1/3),0<=(o=-f-g)?s+=Math.pow(o,1/3):s-=Math.pow(-o,1/3),n.push(s-h)}else if(c<0){var distance=Math.sqrt(-l/3),p=Math.atan2(Math.sqrt(-c),-f)/3,_=Math.cos(p),v=Math.sin(p),m=Math.sqrt(3);n.push(2*distance*_-h),n.push(-distance*(_+m*v)-h),n.push(-distance*(_-m*v)-h)}else o=0<=f?-Math.pow(f,1/3):Math.pow(-f,1/3),n.push(2*o-h),n.push(-o-h)}(t[i],t[i-1],t[i-2],t[i-3],r)}return r}function wu(t,e,i,r,n,o,s,a,u,l,d){var h,c,f=Math.min(s,u),g=Math.min(a,l),p=Math.max(s,u),_=Math.max(a,l);for(var v=Su((h=a-l)*(t+-2*i+n)+(c=u-s)*(e+-2*r+o),h*(-2*t+2*i)+c*(-2*e+2*r),h*t+c*e+(s*l-u*a)),m=0;m<v.length;m++){var y=v[m];if(0<=y&&y<=1){var x=t+(i-t)*y,b=e+(r-e)*y,E=x+(i+(n-i)*y-x)*y,A=b+(r+(o-r)*y-b)*y;if(s===u){if(g<=A&&A<=_){if(!d)return 1;d.push(E,A)}}else if(a===l){if(f<=E&&E<=p){if(!d)return 1;d.push(E,A)}}else if(f<=E&&g<=A&&E<=p&&A<=_){if(!d)return 1;d.push(E,A)}}}return d&&d.length/2}function Tu(t,e,i,r,n,o,s,a,u,l,d){return d?(wu(t,e,i,r,n,o,s,a,u,a,d),wu(t,e,i,r,n,o,u,a,u,l,d),wu(t,e,i,r,n,o,s,l,u,l,d),wu(t,e,i,r,n,o,s,a,s,l,d),d.length/2):s<=t&&t<=u&&a<=e&&e<=l||s<=n&&n<=u&&a<=o&&o<=l||wu(t,e,i,r,n,o,s,a,u,a)||wu(t,e,i,r,n,o,u,a,u,l)||wu(t,e,i,r,n,o,s,l,u,l)||wu(t,e,i,r,n,o,s,a,s,l)?1:0}function Cu(t,e,i,r,n,o,s,a,u,l,d,h,c){var f,g,p=Math.min(u,d),_=Math.min(l,h),v=Math.max(u,d),m=Math.max(l,h);for(var y=Su((f=l-h)*(-1*t+3*i+-3*n+s)+(g=d-u)*(-1*e+3*r+-3*o+a),f*(3*t+-6*i+3*n)+g*(3*e+-6*r+3*o),f*(-3*t+3*i)+g*(-3*e+3*r),f*t+g*e+(u*h-d*l)),x=0;x<y.length;x++){var b=y[x];if(0<=b&&b<=1){var E=t+(i-t)*b,A=e+(r-e)*b,S=i+(n-i)*b,w=r+(o-r)*b,T=E+(S-E)*b,C=A+(w-A)*b,M=T+(S+(n+(s-n)*b-S)*b-T)*b,I=C+(w+(o+(a-o)*b-w)*b-C)*b;if(u===d){if(_<=I&&I<=m){if(!c)return 1;c.push(M,I)}}else if(l===h){if(p<=M&&M<=v){if(!c)return 1;c.push(M,I)}}else if(p<=M&&_<=I&&M<=v&&I<=m){if(!c)return 1;c.push(M,I)}}}return c&&c.length/2}function Mu(t,e,i,r,n,o,s,a,u,l,d,h,c){return c?(Cu(t,e,i,r,n,o,s,a,u,l,d,l,c),Cu(t,e,i,r,n,o,s,a,d,l,d,h,c),Cu(t,e,i,r,n,o,s,a,u,h,d,h,c),Cu(t,e,i,r,n,o,s,a,u,l,u,h,c),c.length/2):u<=t&&t<=d&&l<=e&&e<=h||u<=s&&s<=d&&l<=a&&a<=h||Cu(t,e,i,r,n,o,s,a,u,l,d,l)||Cu(t,e,i,r,n,o,s,a,d,l,d,h)||Cu(t,e,i,r,n,o,s,a,u,h,d,h)||Cu(t,e,i,r,n,o,s,a,u,l,u,h)?1:0}function Iu(t,e,i,r,n,o,s,a){return void 0===a&&(a={x:0,y:0}),a.x=(1-t)*(1-t)*e+2*(1-t)*t*o+t*t*r,a.y=(1-t)*(1-t)*i+2*(1-t)*t*s+t*t*n,a}function Lu(t,e,i,r,n,o,s,a,u,l,d){void 0===l&&(l=0),void 0===d&&(d=!1);var h=i-2*s+n,c=r-2*a+o,f=-((i-t)*c-(r-e)*h)/((2*s-2*i)*c-(2*a-2*r)*h);if(f<0||1<f)return!1;var g=u/2;return d&&(g*=1-f),g+=l,distance(_a(i,s,n,f),_a(r,a,o,f),t,e)<=g}function Nu(t,e,i,r,n,o,s,a,u,l){void 0===l&&(l={x:0,y:0});var d=(1-t)*(1-t)*(1-t),h=3*t*(1-t)*(1-t),c=3*t*t*(1-t),f=t*t*t;return l.x=d*e+h*o+c*a+f*r,l.y=d*i+h*s+c*u+f*n,l}function Ou(t,e,i,r,n,o,s,a,u,l,d,h){var c=distance(i,r,s,a);if(Math.abs(t-i)>c||Math.abs(e-r)>c)return!1;for(var f,g=.5,p=distance(t,e,i,r)<distance(t,e,n,o)?-.01:.01,_=100,v=Nu(g,i,r,n,o,s,a,u,l),m=distance(t,e,v.x,v.y),y=d/2+h;0<_--&&0<=g&&g<=1&&y<m&&(.001<p||p<-.001);)f=m,Nu(g,i,r,n,o,s,a,u,l,v),f<(m=distance(t,e,v.x,v.y))?g+=p=-p/2:g+p<0||1<g+p?(p/=2,m=f):g+=p;return m<y}function ku(t,e,i,r,n,o,s){void 0===s&&(s=os());var a=t+2/3*(i-t),u=e+2/3*(r-e);return Fu(t,e,a,u,a+1/3*(n-t),u+1/3*(o-e),n,o,s)}function Fu(t,e,i,r,n,o,s,a,u){void 0===u&&(u=os());var l,d,h,c,f,g=Math.min,p=Math.max,_=Math.sqrt;u.minX=g(t,s),u.maxX=p(t,s),u.minY=g(e,a),u.maxY=p(e,a);for(var v=void 0,m=void 0,y=void 0,x=void 0,b=void 0,E=void 0,A=void 0,S=0;S<2;++S)if(f=0===S?(d=t,h=i,c=n,s):(d=e,h=r,c=o,a),m=6*d-12*h+6*c,v=-3*d+9*h-9*c+3*f,y=3*h-3*d,m|=0,y|=0,0!==(v|=0))(b=m*m-4*y*v)<0||(0<(E=(-m+_(b))/(2*v))&&E<1&&(l=Ru(E,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l))),0<(A=(-m-_(b))/(2*v))&&A<1&&(l=Ru(A,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l))));else{if(0===m)continue;0<(x=-y/m)&&x<1&&(l=Ru(x,d,h,c,f),0===S?(u.minX=g(u.minX,l),u.maxX=p(u.maxX,l)):(u.minY=g(u.minY,l),u.maxY=p(u.maxY,l)))}return u}function Ru(t,e,i,r,n){return Math.pow(1-t,3)*e+3*Math.pow(1-t,2)*t*i+3*(1-t)*Math.pow(t,2)*r+Math.pow(t,3)*n}var Pu={left:{x:-1,y:0},right:{x:1,y:0},top:{x:0,y:-1},bottom:{x:0,y:1},center:{x:0,y:0}};var Du=(zu.prototype.getDefinition=function(){return this._attributesManager.getAttributeLayerDefinition(this._id)},zu.prototype.update=function(t){this._attributesManager.updateAttributeLayer(this._id,t)},zu.prototype.destroy=function(){this._attributesManager.destroyAttributeLayer(this._id)},zu.prototype.updateElements=function(t){this._attributesManager.updateElementsForAttributeLayer(this._id,t)},zu.prototype.updateAll=function(){this._attributesManager.updateAllForAttributeLayer(this._id)},zu.prototype.setAttributeValues=function(t,e,i){this._attributesManager.setAttributeLayerValues(this._id,t,e,i)},zu.prototype.getUsedAttributeNames=function(t){return this._attributesManager.getUsedAttributeLayerAttributes(this._id,t)},zu.prototype.getFlexArrays=function(){return this._attributesManager.getAttributeLayerFlexArrays(this._id)},zu);function zu(t,e){this._attributesManager=t,this._id=e}var Bu={storage:1,default:0},Uu=(Vu.prototype._getAllIndexes=function(){for(var t=this._isNode?this._graph.getNodeMaxIndex():this._graph.getEdgeMaxIndex(),e=new Uint32Array(t),i=1;i<=t;++i)e[i-1]=i;return e},Vu.prototype.addAll=function(){this._all=!0},Vu.prototype.add=function(t){if(!this._all)for(var e=0;e<t._indexes.length;e++){var i=t._indexes[e];this.addIndex(i)}},Vu.prototype.addIndex=function(t){0===this._flexArray.get(t)&&(this._flexArray.set(t,1),this._indexList.push(t))},Vu.prototype.isEmpty=function(){return!this._all&&this._indexList.isEmpty()},Vu.prototype.isFull=function(){return this._all},Vu.prototype.getListAndClear=function(){var t=this.getList();return this.clear(),t},Vu.prototype.getList=function(){var t;if(this._all&&!this._includeRemovedElements)t=this._isNode?this._graph.getNodes("all"):this._graph.getEdges("all");else{var e=this._all?this._getAllIndexes():this._indexList.slice();t=this._eltList(e)}return t},Vu.prototype.clear=function(){this._all=!1,this._indexList.isEmpty()||(this._indexList.reset(),this._flexArray.reset())},Vu.prototype.addSet=function(t){if(t._all)this.addAll();else for(var e=t._indexList.getBuffer(),i=t._indexList.getLength(),r=0;r<i;++r)this.addIndex(e[r])},Vu);function Vu(t){var e=t.graph,i=t.isNode,r=t.includeRemovedElements;this._all=!1,this._isNode=i,this._graph=e,this._includeRemovedElements=r,this._eltList=i?this._graph.nodeList:this._graph.edgeList,this._flexArray=i?this._graph.createNodeAttribute(Bu):this._graph.createEdgeAttribute(Bu),this._all=!1,this._indexList=this._graph.createIndexList(i)}function ju(t){return"string"==typeof t}function Gu(t,e){return t?t+"."+e:e}function Hu(t){return"boolean"==typeof t||0===t||1===t?t:void 0}function Wu(t){return"number"==typeof t&&isFinite(t)?t:void 0}function qu(t){return"number"==typeof t&&isFinite(t)&&0<=t?t:void 0}var Xu=-100,Yu=new Function("x","return (typeof x === 'number' && isFinite(x)\n    && x >= "+Xu+"\n    && x <= 400)\n    ? x : undefined;");function Zu(t){return null===t||"string"==typeof t||"number"==typeof t?t:void 0}function Ku(t){return"fixed"===t||"scaled"===t?t:void 0}function Qu(t,e){return e.parseColor(t)?t:void 0}function Ju(t,e){return"inherit"===t||e.parseColor(t)?t:void 0}function $u(t){return null===t?null:"string"==typeof t?t.split(",").map(function(t){var e=t.trim(),i=-1!==e.indexOf(" "),r=e[0];return i&&'"'!==r&&"'"!==r?'"'+e+'"':e}).join(","):void 0}function tl(t){return"none"===t?"normal":"normal"===t||"italic"===t||"bold"===t||"italic bold"===t||"bold italic"===t?t:void 0}function el(t){return"left"===t||"center"===t?t:void 0}function il(t){return[null,"arrow","circle-hole-arrow","triangle-hole-arrow","short-arrow","sharp-arrow","circle","square"].includes(t)?t:void 0}function rl(t){return new Function("x","if (typeof x === 'number') {\n      return (typeof x === 'number' && isFinite(x) && x >= 0) ? x : undefined;\n    }\n    if (typeof x !== 'string' || x.charAt(x.length - 1) !== '%') {\n      return undefined;\n    }\n    var p = parseFloat(x);\n    return isNaN(p) ? undefined : ("+t+" * p / 100);")}function nl(t){return{_check:Zu,_set:new Function("flexArrays","index","value",["flexArrays.badges."+t+".text.content.set(index, value);","if (value === null || value === undefined) flexArrays.badges."+t+".image.url.set(index, value);"].join("\n")),_get:new Function("flexArrays","index","return flexArrays.badges."+t+".text.content.get(index);"),color:{_flexArray:"white",_check:Ju},scale:{_flexArray:.45,_check:rl(.45)},positionScale:{_flexArray:1,_check:qu},minVisibleSize:{_flexArray:12,_check:rl(12)},image:{_alias:"badges."+t+".image.url",url:{_flexArray:null,_check:Zu},scale:{_flexArray:1,_check:rl(1)}},stroke:{color:{_flexArray:"black",_check:Ju},width:{_flexArray:2,_check:rl(2)},scalingMethod:{_flexArray:"fixed",_check:Ku}},text:{_alias:"badges."+t+".text.content",content:{_flexArray:null,_check:Zu},color:{_flexArray:"black",_check:Ju},font:{_flexArray:"Arial",_check:$u},style:{_flexArray:"normal",_check:tl},scale:{_flexArray:.5,_check:rl(.5)}},threshold:"badges."+t+".minVisibleSize"}}var ol={_check:Hu,_get:function(t,e){return 0===t.opacity.get(e)},_set:function(t,e,value){t.opacity.set(e,void 0===value?void 0:+!value)}},sl={x:{_flexArray:0,_check:Wu,_disableMemoryOptimization:!0},y:{_flexArray:0,_check:Wu,_disableMemoryOptimization:!0},radius:{_flexArray:5,_check:rl(5)},scalingMethod:{_flexArray:"scaled",_check:Ku},color:{_flexArray:"grey",_check:function(t,e){if(e.parseColor(t))return t;if(Array.isArray(t)){if(t.length<1)return;for(var i=0;i<t.length;++i)if(!e.parseColor(t[i]))return;return t}}},opacity:{_flexArray:1,_check:qu},hidden:ol,shape:{_flexArray:"circle",_check:function(t){return"equilateral"===t?"pentagon":"circle"===t||"square"===t||"cross"===t||"diamond"===t||"pentagon"===t||"star"===t?t:void 0}},layer:{_flexArray:0,_check:Yu},detectable:{_flexArray:!0,_check:Hu},draggable:{_flexArray:!0,_check:Hu},layoutable:{_flexArray:!0,_check:Hu},innerStroke:{_alias:"innerStroke.color",width:{_flexArray:2,_check:rl(2)},scalingMethod:{_flexArray:"fixed",_check:Ku},color:{_flexArray:"white",_check:Ju},minVisibleSize:{_flexArray:12,_check:rl(12)},threshold:"innerStroke.minVisibleSize"},outerStroke:{_alias:"outerStroke.color",width:{_flexArray:5,_check:rl(5)},scalingMethod:{_flexArray:"fixed",_check:Ku},color:{_flexArray:null,_check:Ju},minVisibleSize:{_flexArray:0,_check:rl(0)},threshold:"outerStroke.minVisibleSize"},badges:{_check:function(t){return null===t?t:void 0},_set:function(t,e,value){t.badges.topLeft.text.content.set(e,value),t.badges.topLeft.image.url.set(e,value),t.badges.topRight.text.content.set(e,value),t.badges.topRight.image.url.set(e,value),t.badges.bottomLeft.text.content.set(e,value),t.badges.bottomLeft.image.url.set(e,value),t.badges.bottomRight.text.content.set(e,value),t.badges.bottomRight.image.url.set(e,value)},topLeft:nl("topLeft"),topRight:nl("topRight"),bottomLeft:nl("bottomLeft"),bottomRight:nl("bottomRight")},halo:{_alias:"halo.color",color:{_flexArray:null,_check:Qu},width:{_flexArray:50,_check:rl(50)},scalingMethod:{_flexArray:"fixed",_check:Ku},strokeColor:{_flexArray:null,_check:Qu},strokeWidth:{_flexArray:1,_check:rl(1)},clustering:{_flexArray:!1,_check:Hu},hideNonAdjacentEdges:{_flexArray:!1,_check:Hu},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Hu},duration:{_flexArray:1e3,_check:qu},interval:{_flexArray:800,_check:qu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ju},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ju},width:{_flexArray:50,_check:qu},startRatio:{_flexArray:1,_check:qu},endRatio:{_flexArray:2,_check:qu}},icon:{_alias:"icon.content",content:{_flexArray:null,_check:Zu},font:{_flexArray:"Arial",_check:$u},color:{_flexArray:"black",_check:Qu},scale:{_flexArray:.7,_check:rl(.7)},style:{_flexArray:"normal",_check:tl},minVisibleSize:{_flexArray:12,_check:rl(12)},threshold:"icon.minVisibleSize"},image:{_alias:"image.url",url:{_flexArray:null,_check:Zu},scale:{_flexArray:1,_check:rl(1)},fit:{_flexArray:!0,_check:Hu},tile:{_flexArray:!1,_check:Hu},minVisibleSize:{_flexArray:12,_check:rl(12)},rescale:"image.fit",duplicate:"image.tile",threshold:"image.minVisibleSize"},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Hu},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:Qu},minVisibleSize:{_flexArray:12,_check:rl(12)}},text:{_alias:"text.content",content:{_flexArray:null,_check:Zu},font:{_flexArray:"Arial",_check:$u},color:{_flexArray:"black",_check:Ju},size:{_flexArray:12,_check:rl(12)},scale:{_flexArray:.1,_check:qu},style:{_flexArray:"normal",_check:tl},align:{_flexArray:"center",_check:el},margin:{_flexArray:10,_check:rl(10)},padding:{_flexArray:2,_check:rl(2)},backgroundColor:{_flexArray:null,_check:Ju},tip:{_flexArray:!0,_check:Hu},minVisibleSize:{_flexArray:24,_check:rl(24)},scaling:{_flexArray:!1,_check:Hu},position:{_flexArray:"bottom",_check:function(t){return"top"===t||"bottom"===t||"left"===t||"right"===t||"center"===t?t:void 0}},maxLineLength:{_flexArray:0,_check:qu},truncateLength:{_flexArray:0,_check:qu},backgroundArrowBaseSize:"text.margin",backgroundMargin:"text.padding",threshold:"text.minVisibleSize",secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Zu},font:{_flexArray:"Arial",_check:$u},color:{_flexArray:"black",_check:Ju},size:{_flexArray:10,_check:rl(10)},scale:{_flexArray:.08,_check:qu},style:{_flexArray:"normal",_check:tl},align:{_flexArray:"center",_check:el},margin:{_flexArray:5,_check:rl(5)},padding:{_flexArray:2,_check:rl(2)},backgroundColor:{_flexArray:null,_check:Ju},minVisibleSize:{_flexArray:24,_check:rl(24)},backgroundArrowBaseSize:"text.secondary.margin",backgroundMargin:"text.secondary.padding",threshold:"text.secondary.minVisibleSize"}}};var al={width:{_flexArray:1,_check:rl(1)},scalingMethod:{_flexArray:"scaled",_check:Ku},color:{_flexArray:"grey",_check:function(t,e){return"source"===t||"target"===t||e.parseColor(t)?t:void 0}},opacity:{_flexArray:1,_check:qu},hidden:ol,minVisibleSize:{_flexArray:0,_check:qu},threshold:"minVisibleSize",layer:{_flexArray:0,_check:Yu},detectable:{_flexArray:!0,_check:Hu},curvature:{_flexArray:0,_check:Wu},adjustAnchors:{_flexArray:!0,_check:Hu},shape:{_check:function(t){return["line","tapered","arrow","dashed","dotted"].includes(t)?t:void 0},_set:function(t,e,value){var i=void 0,r=void 0,n=void 0,o=void 0;"line"===value?(i="line",r="plain",o=n=null):"arrow"===value?(i="line",r="plain",n="arrow",o=null):"tapered"===value?(i="triangle",r="plain",o=n=null):"dashed"===value?(i="line",r="dashed",o=n=null):"dotted"===value&&(i="line",r="dotted",o=n=null),t.shape.type.set(e,i),t.shape.style.set(e,r),t.shape.head.set(e,n),t.shape.tail.set(e,o)},type:{_flexArray:"line",_check:function(t){return"line"===t||"triangle"===t?t:void 0}},head:{_flexArray:null,_check:il},tail:{_flexArray:null,_check:il},style:{_flexArray:"plain",_check:function(t){return"plain"===t||"dashed"===t||"dotted"===t?t:void 0}}},stroke:{color:{_flexArray:"inherit",_check:Ju},width:{_flexArray:0,_check:rl(0)},scalingMethod:{_flexArray:"fixed",_check:Ku},minVisibleSize:{_flexArray:0,_check:qu}},strokeWidth:"stroke.width",halo:{_alias:"halo.color",color:{_flexArray:null,_check:Qu},width:{_flexArray:10,_check:rl(10)},scalingMethod:{_flexArray:"fixed",_check:Ku},size:"halo.width"},pulse:{enabled:{_flexArray:!1,_check:Hu},duration:{_flexArray:1e3,_check:qu},interval:{_flexArray:800,_check:qu},startColor:{_flexArray:"rgba(0, 0, 0, 0.6)",_check:Ju},endColor:{_flexArray:"rgba(0, 0, 0, 0)",_check:Ju},width:{_flexArray:10,_check:qu},startRatio:{_flexArray:1,_check:qu},endRatio:{_flexArray:2,_check:qu}},outline:{_alias:"outline.enabled",enabled:{_flexArray:!1,_check:Hu},color:{_flexArray:"rgba(0, 0, 0, 0.36)",_check:Qu},minVisibleSize:{_flexArray:0,_check:qu}},text:{_alias:"text.content",content:{_flexArray:null,_check:Zu},font:{_flexArray:"Arial",_check:$u},color:{_flexArray:"black",_check:Qu},size:{_flexArray:12,_check:rl(12)},scale:{_flexArray:1,_check:qu},style:{_flexArray:"normal",_check:tl},align:{_flexArray:"center",_check:el},margin:{_flexArray:2,_check:Wu},padding:{_flexArray:2,_check:rl(2)},backgroundColor:{_flexArray:null,_check:Ju},minVisibleSize:{_flexArray:4,_check:qu},threshold:"text.minVisibleSize",adjustAngle:{_flexArray:!0,_check:Hu},scaling:{_flexArray:!1,_check:Hu},maxLineLength:{_flexArray:0,_check:qu},secondary:{_alias:"text.secondary.content",content:{_flexArray:null,_check:Zu},font:{_flexArray:"Arial",_check:$u},color:{_flexArray:"black",_check:Qu},size:{_flexArray:12,_check:rl(12)},scale:{_flexArray:.8,_check:qu},style:{_flexArray:"normal",_check:tl},align:{_flexArray:"center",_check:el},margin:{_flexArray:2,_check:Wu},padding:{_flexArray:2,_check:rl(2)},backgroundColor:{_flexArray:null,_check:Ju},minVisibleSize:{_flexArray:4,_check:qu},threshold:"text.secondary.minVisibleSize"}}};function ul(){}function ll(){}function dl(t,e){if(!t._check)throw new Error("error somewhere for "+e);return{check:t._check,set:new Function("flexArrays","index","value","flexArrays."+e+".set(index, value);"),get:new Function("flexArrays","index","return flexArrays."+e+".get(index);"),nested:{}}}function hl(t,e,i){if(void 0!==(e=e||t)._flexArray)return dl(e,i);var r={check:null,get:null,set:null,nested:{}};if(ju(e)||e._alias){var n=ju(e)?e:e._alias;r=dl(l=W(t,n),n)}else{if(e._set?(r.set=e._set,r.check=e._check):(r.set=ul,r.check=ll),e._get)r.get=e._get;else{var o="return "+function t(e,i){if(void 0!==e._flexArray)return"flexArrays."+i+".get(index)";for(var r=[],n=0,o=Object.keys(e);n<o.length;n++){var s=o[n],a=e[s];if(!s.startsWith("_")&&$(a)){var u=t(e[s],Gu(i,s));u&&r.push(s+": "+u)}}return r.length?"{\n"+r.join(",\n").split("\n").map(function(t){return"  "+t}).join("\n")+"\n}":""}(e,i)+";";r.get=new Function("flexArrays","index",o)}r.nested={}}if(!ju(e))for(var s=0,a=Object.keys(e);s<a.length;s++){var u=a[s],l=e[u];u.startsWith("_")||(r.nested[u]=hl(t,l,Gu(i,u)))}return r}function cl(t){return t}function fl(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}var gl=hl(sl),pl=hl(al),_l={name:"animationStart",storage:32,default:0},vl={name:"animationDuration",storage:16,default:0},ml={name:"animationEasing",storage:"resource",default:"linear"},yl={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentNodes:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},adjacentEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},xl={self:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},extremities:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},parallelEdges:{attributes:"all",tags:[],selection:!0,hover:!1,data:!0},allNodes:void 0,allEdges:void 0},bl={x:1,y:1,radius:1,"halo.hideNonAdjacentEdges":1},El=Object.freeze({__proto__:null,linear:cl,quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:fl,cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}}),Al=[];function Sl(t){var e=Al;return void 0===t.output?("function"==typeof t.attributes&&(e="all"),$(t.attributes)&&(e=Z(t.attributes))):t.output&&(e=t.output.attributes),Ll(e,t.allAttributePaths)}function wl(t,e,i,r,n,o){!function(t,e,i,r){if(i<r)for(var n=0,o=e.attributes;n<o.length;n++)for(var s=o[n],a=0,u=t.attributes;a<u.length;a++){if(u[a]===s)return 1}for(var l=0,d=e.tags;l<d.length;l++)for(var h=d[l],c=0,f=t.tags;c<f.length;c++){if(h===f[c])return 1}}(i,r,n,o)||t.push(e)}function Tl(t){var e=t.dependencies;void 0===e?e=yl:$(e)||(e={});var i=K(t.attributes).some(function(value){return"function"==typeof value}),r=t.selector&&!t.standaloneSelector,n=!(!i&&!r),o=e.adjacentEdges;return!o&&e.adjacentNodes&&(o=!0),{self:Ml(e.self,n,t.allAttributePaths),adjacentNodes:Ml(e.adjacentNodes,n,t.allAttributePaths),adjacentEdges:Ml(o,n,t.allAttributePaths),allNodes:Ml(e.allNodes,n,t.allAttributePaths),allEdges:Ml(e.allEdges,n,t.allAttributePaths)}}function Cl(t){var e=t.dependencies;void 0===e?e=xl:$(e)||(e={});var i=K(t.attributes).some(function(value){return"function"==typeof value}),r=t.selector&&!t.standaloneSelector,n=!(!i&&!r);return{self:Ml(e.self,n,t.allAttributePaths),extremities:Ml(e.extremities,n,t.allAttributePaths),parallelEdges:Ml(e.parallelEdges,n,t.allAttributePaths),allNodes:Ml(e.allNodes,n,t.allAttributePaths),allEdges:Ml(e.allEdges,n,t.allAttributePaths)}}function Ml(t,e,i){if(!e)return{attributes:[],tags:[]};if(!0===t)return{attributes:[],tags:[ai]};var value,r={attributes:Ll((t=t||{}).attributes,i),tags:(value=t.tags,Array.isArray(value)?value.filter(ju):[])};return t.data&&r.tags.push(ui),t.selection&&r.tags.push(hi),t.hover&&r.tags.push(li),r}function Il(t){return Array.isArray(t)?t.join("."):t}function Ll(value,t){if("all"===value)return t.slice();if(!Array.isArray(value))return[];var i=function(value){return value.map(Il).filter(ju)}(value);return t?t.filter(function(e){return i.some(function(t){return e.startsWith(t)})}):i}var Nl=(Ol.prototype.clear=function(){this._elementsToRedraw.clear(),this._elementsUpdated.clear(),this._updatedAttributes.clear(),this._updatedAttributesTmp.clear()},Ol.prototype.getAttributeFlexArrays=function(){return this._finalFlexArraysWrapped},Ol.prototype.getPrevAttributeFlexArrays=function(){return this._prevFlexArrays},Ol.prototype.getAnimationInformation=function(t){for(var e=t._indexes,i=Array(e.length),r=0;r<e.length;r++){var n=e[r];i[r]={duration:this._finalFlexArraysWrapped.animationDuration.get(n),start:this._finalFlexArraysWrapped.animationStart.get(n),easing:this._finalFlexArraysWrapped.animationEasing.get(n)}}return i},Ol.prototype.startUpdate=function(){},Ol.prototype.prepareFlexArraysUpdate=function(t){this._currentFlexArrays=t.inputFlexArrays},Ol.prototype.setLastFlexArrays=function(t){this._lastFlexArrays=t},Ol.prototype.updateFlexArrays=function(t){var e=t.attributes,i=t.selector,r=t.context,n=t.outputFlexArrays,o=t.toUpdate,s=t.formattedOutput;this._elementsUpdated.addSet(o),this._elementsToRedraw.addSet(o);var a=o.getListAndClear();if(e&&a.size){for(var u=Bi(this._graph,a,i,r),l=u.valid,d=u.invalid,h=0,c=s.attributes;h<c.length;h++)for(var f=W(n,c[h]),g=0;g<d._indexes.length;g++){var p=d._indexes[g];f.set(p,void 0)}this._assignAttributesToFlexArrays(this._accessors,n,l,e,r),this._addUpdatedAttributes(t)}},Ol.prototype.endUpdate=function(){for(var t=this._elementsUpdated.getList(),e=0,i=Fo(this._updatedAttributesTmp);e<i.length;e++)for(var r=i[e],n=W(this._lastFlexArrays,r),o=W(this._finalFlexArrays,r),s=0;s<t._indexes.length;s++){var a=t._indexes[s];o.set(a,n.get(a))}this._updatedAttributesTmp.clear(),this._currentFlexArrays=this._finalFlexArrays},Ol.prototype.setAttributeValues=function(t,e,i,r,n){var o=t.outputFlexArrays,s=this._accessors;this._assignAttributesToFlexArrays(s,o,e,i,null),this._addUpdatedAttributes(t,r),this._elementsUpdated.add(e),this._elementsToRedraw.add(e)},Ol.prototype.notifyLayerDestroyed=function(t){this._addUpdatedAttributes(t)},Ol.prototype._addUpdatedAttributes=function(t,e){for(var i=t.outputFlexArrays,r=t.formattedOutput,n=0,o=Array.isArray(e)?Ll(e):r.attributes;n<o.length;n++){var s=o[n];W(i,s).isInitialized()&&(this._updatedAttributes.add(s),this._updatedAttributesTmp.add(s),this._allUsedAttributes.add(s))}},Ol.prototype.addUpdatedAttribute=function(t){this._updatedAttributes.add(t),this._updatedAttributesTmp.add(t),this._allUsedAttributes.add(t)},Ol.prototype.getUsedAttributeNames=function(t){return function e(i,r,n){return void 0===r&&(r=[]),void 0===n&&(n=""),i.constructor===je?i.isInitialized()&&r.push(n):i.constructor===Object&&Object.keys(i).forEach(function(t){e(i[t],r,Gu(n,t))}),r}(t.outputFlexArrays)},Ol.prototype.redrawElements=function(t){this._elementsToRedraw.add(t)},Ol.prototype.redrawAll=function(){this._elementsToRedraw.addAll()},Ol.prototype.getAndResetElementsToRedraw=function(){return this._elementsToRedraw.getListAndClear()},Ol.prototype.getAndResetElementsUpdated=function(){return this._elementsUpdated.getListAndClear()},Ol.prototype.getAndResetAttributesUpdated=function(){var t=Fo(this._updatedAttributes);return this._updatedAttributes.clear(),t},Ol.prototype.getUpdatedAttributes=function(){return this._updatedAttributes},Ol.prototype.getUpdatedElementsList=function(){return this._elementsUpdated.getList()},Ol.prototype.getUpdatedAttributesSet=function(){return new Set(this._updatedAttributes)},Ol.prototype.createFlexArrays=function(){return this._createFlexArrays(this._graph,{named:!1,useDefaultValues:!1})},Ol.prototype.getAttributeValues=function(t,e,i,r){var n=r?this._prevFlexArrays:this._currentFlexArrays;return i?this._getMultipleAttributeValues(t,e,n):this._getSingleAttributeValues(t,e,n)},Ol.prototype._getAccessor=function(t){void 0===t&&(t="");for(var e=this._accessors,i=R(t),r=0,n=i;r<n.length;r++){var o=n[r];if(!(e=e.nested[o]))throw new Error(this._eltName+' attribute "'+i.join("")+'" does not exist')}return e},Ol.prototype._getSingleAttributeValues=function(t,e,i){for(var r=this._getAccessor(e),n=t._indexes,o=Array(n.length),s=0;s<n.length;s++)o[s]=r.get(i,n[s]);return o},Ol.prototype._getMultipleAttributeValues=function(t,e,i){if(!e||"all"===e)return this._getSingleAttributeValues(t,"",i);for(var r=Array(t.size),n=0;n<r.length;++n)r[n]={};for(n=0;n<e.length;n++)for(var o=e[n],s=this._getSingleAttributeValues(t,o,i),a=0;a<r.length;++a)H(r[a],o,s[a]);return r},Ol.prototype.setAnimationAttributes=function(t,e){var i=e.duration,r=e.startTime,n=e.easing,o=t._indexes,s=this._finalFlexArraysWrapped.animationDuration,a=this._finalFlexArraysWrapped.animationStart,u=this._finalFlexArraysWrapped.animationEasing,l=Fo(this._allUsedAttributes);if(i){for(var d=!1,h=0,c=l;h<c.length;h++){var f=c[h];if("x"!==f&&"y"!==f)for(var g=W(this._finalFlexArrays,f),p=W(this._prevFlexArrays,f),_=0;_<o.length;_++){var v=o[_];p.set(v,g.get(v))}else d=!0}if(d){var m=Kt(),y=this._finalFlexArrays.x,x=this._finalFlexArrays.y,b=this._prevFlexArrays.x,E=this._prevFlexArrays.y;for(_=0;_<o.length;_++){v=o[_];var A=s.get(v);if(A){var S=a.get(v),w=u.get(v),T=(El[w]||cl)(Math.min((m-S)/A,1)),C=Ze(b.get(v),y.get(v),T),M=Ze(E.get(v),x.get(v),T);b.set(v,C),E.set(v,M)}else b.set(v,y.get(v)),E.set(v,x.get(v))}}}s.fill(o,i),a.fill(o,r),u.fill(o,n)},Ol.prototype.resetAnimationAttributes=function(t){this._finalFlexArraysWrapped.animationDuration.fill(t._indexes,0)},Ol.prototype.getUsedAttributes=function(){return Fo(this._allUsedAttributes)},Ol.prototype.getDefaultFlexArrays=function(){return this._defaultFlexArrays},Ol.prototype._assignAttributesToFlexArrays=function(t,e,i,r,n,o){if(void 0===o&&(o=[]),"function"==typeof r){for(var s=o.join("."),a=0;a<i.size;++a)if(p=i.get(a)){var u=r(p,n,s);this._assignSingleValueToFlexArray(e,p,t,u,o)}}else if($(r)){var l=Object.keys(r);for(a=0;a<l.length;++a){var d=l[a];o.push(d);var h=this._getNestedAccessor(t,d,o),c=r[d];this._assignAttributesToFlexArrays(h,e,i,c,n,o),o.pop()}}else if((Array.isArray(r)||ArrayBuffer.isView(r))&&"color"!==o[0])if(o.length)for(a=0;a<i.size;++a){var f=i._indexes[a],g=t.check(r[a],this._colorManager);t.set(e,f,g)}else for(var a=0;a<i.size;++a)this._assignSingleValueToFlexArray(e,i.get(a),t,r[a],o);else for(g=t.check(r,this._colorManager),a=0;a<i.size;++a){var p=i.get(a);t.set(e,p._index,g)}},Ol.prototype._getNestedAccessor=function(t,e,i){var r=t.nested[e];if(!r)throw new Error(this._eltName+' attribute "'+i.join(".")+'" does not exist');return r},Ol.prototype._assignSingleValueToFlexArray=function(t,e,i,value,r){if($(value))for(var n=0,o=Object.keys(value);n<o.length;n++){var s=o[n];r.push(s);var a=value[s],u=this._getNestedAccessor(i,s,r);this._assignSingleValueToFlexArray(t,e,u,a,r),r.pop()}else{var l=i.check(value,this._colorManager);i.set(t,e._index,l)}},Ol);function Ol(t,e,i,r){this._updatedAttributes=new Set,this._updatedAttributesTmp=new Set,this._allUsedAttributes=new Set,this._colorManager=e,this._graph=t,this._eltName=i?"node":"edge",this._accessors=i?gl:pl,this._createFlexArrays=r,this._finalFlexArrays=this._createFlexArrays(t,{named:!0,useDefaultValues:!0}),this._prevFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._defaultFlexArrays=this._createFlexArrays(t,{named:!1,useDefaultValues:!0}),this._currentFlexArrays=this._defaultFlexArrays,this.setLastFlexArrays(this._defaultFlexArrays),this._elementsToRedraw=new Uu({graph:t,isNode:i,includeRemovedElements:!0}),this._elementsUpdated=new Uu({graph:t,isNode:i,includeRemovedElements:!1}),this._finalFlexArraysWrapped=I(I(I({},this._finalFlexArrays),{excluded:t.getAttribute(i,"excluded"),textHidden:t.getAttribute(i,"textHidden"),animationStart:t.createAttribute(i,_l),animationDuration:t.createAttribute(i,vl),animationEasing:t.createAttribute(i,ml),id:this._graph.getAttribute(i,"id")}),!i&&{source:t.getEdgeAttribute("source"),target:t.getEdgeAttribute("target")})}function kl(t,e){var i=e.named,r=e.useDefaultValues,n="resource";return{x:t.createAttribute(!0,{storage:"any",default:r?0:void 0,name:i?"x":void 0}),y:t.createAttribute(!0,{storage:"any",default:r?0:void 0,name:i?"y":void 0}),radius:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"radius":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"scaled":void 0,name:i?"scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"grey":void 0,name:i?"color":void 0}),opacity:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"opacity":void 0}),shape:t.createAttribute(!0,{storage:n,default:r?"circle":void 0,name:i?"shape":void 0}),layer:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"layer":void 0}),detectable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"detectable":void 0}),draggable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"draggable":void 0}),layoutable:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"layoutable":void 0}),innerStroke:{width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"innerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"innerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"innerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"innerStroke.minVisibleSize":void 0})},outerStroke:{width:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"outerStroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"outerStroke.scalingMethod":void 0}),color:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"outerStroke.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"outerStroke.minVisibleSize":void 0})},badges:{topLeft:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.topLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.topLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.topLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.topLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.topLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.topLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.topLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.topLeft.text.scale":void 0})}},topRight:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.topRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.topRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.topRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.topRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.topRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.topRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.topRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.topRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.topRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.topRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.topRight.text.scale":void 0})}},bottomLeft:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.bottomLeft.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.bottomLeft.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomLeft.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.bottomLeft.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomLeft.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomLeft.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomLeft.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.bottomLeft.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.bottomLeft.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomLeft.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomLeft.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.bottomLeft.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.bottomLeft.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.bottomLeft.text.scale":void 0})}},bottomRight:{color:t.createAttribute(!0,{storage:n,default:r?"white":void 0,name:i?"badges.bottomRight.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.45:void 0,name:i?"badges.bottomRight.scale":void 0}),positionScale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomRight.positionScale":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"badges.bottomRight.minVisibleSize":void 0}),image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomRight.image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"badges.bottomRight.image.scale":void 0})},stroke:{color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomRight.stroke.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"badges.bottomRight.stroke.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"badges.bottomRight.stroke.scalingMethod":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"badges.bottomRight.text.content":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"badges.bottomRight.text.color":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"badges.bottomRight.text.font":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"badges.bottomRight.text.style":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.5:void 0,name:i?"badges.bottomRight.text.scale":void 0})}}},halo:{color:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"halo.color":void 0}),width:t.createAttribute(!0,{storage:n,default:r?50:void 0,name:i?"halo.width":void 0}),scalingMethod:t.createAttribute(!0,{storage:n,default:r?"fixed":void 0,name:i?"halo.scalingMethod":void 0}),strokeColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"halo.strokeColor":void 0}),strokeWidth:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"halo.strokeWidth":void 0}),clustering:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"halo.clustering":void 0}),hideNonAdjacentEdges:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"halo.hideNonAdjacentEdges":void 0})},pulse:{enabled:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"pulse.enabled":void 0}),duration:t.createAttribute(!0,{storage:n,default:r?1e3:void 0,name:i?"pulse.duration":void 0}),interval:t.createAttribute(!0,{storage:n,default:r?800:void 0,name:i?"pulse.interval":void 0}),startColor:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0.6)":void 0,name:i?"pulse.startColor":void 0}),endColor:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0)":void 0,name:i?"pulse.endColor":void 0}),width:t.createAttribute(!0,{storage:n,default:r?50:void 0,name:i?"pulse.width":void 0}),startRatio:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"pulse.endRatio":void 0})},icon:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"icon.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"icon.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"icon.color":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.7:void 0,name:i?"icon.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"icon.style":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"icon.minVisibleSize":void 0})},image:{url:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"image.url":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?1:void 0,name:i?"image.scale":void 0}),fit:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"image.fit":void 0}),tile:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"image.tile":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"image.minVisibleSize":void 0})},outline:{enabled:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"outline.enabled":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"rgba(0, 0, 0, 0.36)":void 0,name:i?"outline.color":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"text.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"text.color":void 0}),size:t.createAttribute(!0,{storage:n,default:r?12:void 0,name:i?"text.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.1:void 0,name:i?"text.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"text.style":void 0}),align:t.createAttribute(!0,{storage:n,default:r?"center":void 0,name:i?"text.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:r?10:void 0,name:i?"text.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"text.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.backgroundColor":void 0}),tip:t.createAttribute(!0,{storage:n,default:!!r||void 0,name:i?"text.tip":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?24:void 0,name:i?"text.minVisibleSize":void 0}),scaling:t.createAttribute(!0,{storage:n,default:!r&&void 0,name:i?"text.scaling":void 0}),position:t.createAttribute(!0,{storage:n,default:r?"bottom":void 0,name:i?"text.position":void 0}),maxLineLength:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"text.maxLineLength":void 0}),truncateLength:t.createAttribute(!0,{storage:n,default:r?0:void 0,name:i?"text.truncateLength":void 0}),secondary:{content:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.secondary.content":void 0}),font:t.createAttribute(!0,{storage:n,default:r?"Arial":void 0,name:i?"text.secondary.font":void 0}),color:t.createAttribute(!0,{storage:n,default:r?"black":void 0,name:i?"text.secondary.color":void 0}),size:t.createAttribute(!0,{storage:n,default:r?10:void 0,name:i?"text.secondary.size":void 0}),scale:t.createAttribute(!0,{storage:n,default:r?.08:void 0,name:i?"text.secondary.scale":void 0}),style:t.createAttribute(!0,{storage:n,default:r?"normal":void 0,name:i?"text.secondary.style":void 0}),align:t.createAttribute(!0,{storage:n,default:r?"center":void 0,name:i?"text.secondary.align":void 0}),margin:t.createAttribute(!0,{storage:n,default:r?5:void 0,name:i?"text.secondary.margin":void 0}),padding:t.createAttribute(!0,{storage:n,default:r?2:void 0,name:i?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!0,{storage:n,default:r?null:void 0,name:i?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!0,{storage:n,default:r?24:void 0,name:i?"text.secondary.minVisibleSize":void 0})}}}}function Fl(t,e){var i=e.named,r=e.useDefaultValues,n="resource";return{width:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"scaled":void 0,name:i?"scalingMethod":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"grey":void 0,name:i?"color":void 0}),opacity:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"opacity":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"minVisibleSize":void 0}),layer:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"layer":void 0}),detectable:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"detectable":void 0}),curvature:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"curvature":void 0}),adjustAnchors:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"adjustAnchors":void 0}),shape:{type:t.createAttribute(!1,{storage:n,default:r?"line":void 0,name:i?"shape.type":void 0}),head:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"shape.head":void 0}),tail:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"shape.tail":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"plain":void 0,name:i?"shape.style":void 0})},stroke:{color:t.createAttribute(!1,{storage:n,default:r?"inherit":void 0,name:i?"stroke.color":void 0}),width:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"stroke.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"fixed":void 0,name:i?"stroke.scalingMethod":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"stroke.minVisibleSize":void 0})},halo:{color:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"halo.color":void 0}),width:t.createAttribute(!1,{storage:n,default:r?10:void 0,name:i?"halo.width":void 0}),scalingMethod:t.createAttribute(!1,{storage:n,default:r?"fixed":void 0,name:i?"halo.scalingMethod":void 0})},pulse:{enabled:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"pulse.enabled":void 0}),duration:t.createAttribute(!1,{storage:n,default:r?1e3:void 0,name:i?"pulse.duration":void 0}),interval:t.createAttribute(!1,{storage:n,default:r?800:void 0,name:i?"pulse.interval":void 0}),startColor:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0.6)":void 0,name:i?"pulse.startColor":void 0}),endColor:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0)":void 0,name:i?"pulse.endColor":void 0}),width:t.createAttribute(!1,{storage:n,default:r?10:void 0,name:i?"pulse.width":void 0}),startRatio:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"pulse.startRatio":void 0}),endRatio:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"pulse.endRatio":void 0})},outline:{enabled:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"outline.enabled":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"rgba(0, 0, 0, 0.36)":void 0,name:i?"outline.color":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"outline.minVisibleSize":void 0})},text:{content:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.content":void 0}),font:t.createAttribute(!1,{storage:n,default:r?"Arial":void 0,name:i?"text.font":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"black":void 0,name:i?"text.color":void 0}),size:t.createAttribute(!1,{storage:n,default:r?12:void 0,name:i?"text.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:r?1:void 0,name:i?"text.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"normal":void 0,name:i?"text.style":void 0}),align:t.createAttribute(!1,{storage:n,default:r?"center":void 0,name:i?"text.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?4:void 0,name:i?"text.minVisibleSize":void 0}),adjustAngle:t.createAttribute(!1,{storage:n,default:!!r||void 0,name:i?"text.adjustAngle":void 0}),scaling:t.createAttribute(!1,{storage:n,default:!r&&void 0,name:i?"text.scaling":void 0}),maxLineLength:t.createAttribute(!1,{storage:n,default:r?0:void 0,name:i?"text.maxLineLength":void 0}),secondary:{content:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.secondary.content":void 0}),font:t.createAttribute(!1,{storage:n,default:r?"Arial":void 0,name:i?"text.secondary.font":void 0}),color:t.createAttribute(!1,{storage:n,default:r?"black":void 0,name:i?"text.secondary.color":void 0}),size:t.createAttribute(!1,{storage:n,default:r?12:void 0,name:i?"text.secondary.size":void 0}),scale:t.createAttribute(!1,{storage:n,default:r?.8:void 0,name:i?"text.secondary.scale":void 0}),style:t.createAttribute(!1,{storage:n,default:r?"normal":void 0,name:i?"text.secondary.style":void 0}),align:t.createAttribute(!1,{storage:n,default:r?"center":void 0,name:i?"text.secondary.align":void 0}),margin:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.secondary.margin":void 0}),padding:t.createAttribute(!1,{storage:n,default:r?2:void 0,name:i?"text.secondary.padding":void 0}),backgroundColor:t.createAttribute(!1,{storage:n,default:r?null:void 0,name:i?"text.secondary.backgroundColor":void 0}),minVisibleSize:t.createAttribute(!1,{storage:n,default:r?4:void 0,name:i?"text.secondary.minVisibleSize":void 0})}}}}function Rl(t,e){return new Du(t,e)}var Pl=(Dl.prototype._getLayerById=function(t){for(var e=0;e<this._layers.length;++e){var i=this._layers[e];if(i.id===t)return i.index=e,i}throw new Error("usage of a destroyed style rule or class")},Dl.prototype._fetch=function(t){return t.isNode?this._nodes:this._edges},Dl.prototype.getFlexArrays=function(){return{nodes:{current:this._nodes.getAttributeFlexArrays(),previous:this._nodes.getPrevAttributeFlexArrays()},edges:{current:this._edges.getAttributeFlexArrays(),previous:this._edges.getPrevAttributeFlexArrays()}}},Dl.prototype.createFlexArrays=function(){return{nodes:this._nodes.createFlexArrays(),edges:this._edges.createFlexArrays()}},Dl.prototype.clear=function(){this._updateOngoing=!1,this._needUpdate=!1,this._destroyedLayers=[],this._nodes.clear(),this._edges.clear(),this.updateAllForAllAttributeLayers()},Dl.prototype.redrawElements=function(t){t.size&&(this._fetch(t).redrawElements(t),this._dom.refresh())},Dl.prototype.redrawAll=function(){this._nodes.redrawAll(),this._edges.redrawAll(),this._dom.refresh()},Dl.prototype._triggerUpdate=function(){this._needUpdate=!0,this._dom.refresh()},Dl.prototype._reconstructAttributeLayersIfNecessary=function(){return!!this._layersNeedUpdate&&(this._reconstructAttributeLayers(),this._layersNeedUpdate=!1,this._dom.refresh(),!0)},Dl.prototype.getAnimationInformation=function(t){return this._fetch(t).getAnimationInformation(t)},Dl.prototype.update=function(){if(!this._needUpdate||this._updateOngoing||!this._ogma._token)return!1;this._reconstructAttributeLayersIfNecessary(),this._updateOngoing=!0,this._nodes.startUpdate(),this._edges.startUpdate();for(var t=0,e=this._destroyedLayers;t<e.length;t++)(n=e[t]).initialized&&(this._nodes.notifyLayerDestroyed(n.nodes),this._edges.notifyLayerDestroyed(n.edges));for(var i=0,r=this._layers;i<r.length;i++){var n,o=(n=r[i]).nodes,s=n.edges;this._nodes.prepareFlexArraysUpdate(o),this._edges.prepareFlexArraysUpdate(s),"function"==typeof n.onBeforeUpdate&&n.onBeforeUpdate(n,this,this._nodes,this._edges),this._nodes.updateFlexArrays(o),this._edges.updateFlexArrays(s)}return this._nodes.endUpdate(),this._edges.endUpdate(),this._updateOngoing=!1,!(this._needUpdate=!1)},Dl.prototype.setAttributeLayerValues=function(t,e,i,r){var n=this._getLayerById(t),o=e.isNode?n.nodes:n.edges;this._reconstructAttributeLayersIfNecessary(),this._fetch(e).setAttributeValues(o,e,i,r,n),this._updateElementsForAttributeLayers([n],e)},Dl.prototype.getAttributeLayerFlexArrays=function(t){var e=this._getLayerById(t);return{nodes:e.nodes.outputFlexArrays,edges:e.edges.outputFlexArrays}},Dl.prototype.getUsedAttributeLayerAttributes=function(t,e){var i=this._getLayerById(t);return this._fetch(e).getUsedAttributeNames(e.isNode?i.nodes:i.edges)},Dl.prototype.getAndResetElementsUpdated=function(){var t=this._nodes,e=this._edges;return{nodes:t.getAndResetElementsUpdated(),edges:e.getAndResetElementsUpdated(),nodeAttributesSet:t.getUpdatedAttributesSet(),nodeAttributes:t.getAndResetAttributesUpdated(),edgeAttributes:e.getAndResetAttributesUpdated()}},Dl.prototype.getAndResetElementsToRedraw=function(){return{nodes:this._nodes.getAndResetElementsToRedraw(),edges:this._edges.getAndResetElementsToRedraw()}},Dl.prototype.addAttributeLayer=function(t){var e=t.name,i=t.tag,r=void 0===i?null:i,n=t.onBeforeUpdate,o=t.standaloneSelectors,s=t.layerFactory,a=void 0===s?Rl:s;if(!e)throw new Error("Attribute layer must have a name");if(e&&this._layers.find(function(t){return t.name===e}))throw new Error('attribute layer with name "'+t.name+'" already exists');var u=!!o,l={index:-1,id:++this._layerIdCounter,name:e,tag:r,priority:0,depsNodeSelf:[],depsNodeAdjacentNodes:[],depsNodeAdjacentEdges:[],depsNodeAllNodes:[],depsNodeAllEdges:[],depsEdgeSelf:[],depsEdgeExtremities:[],depsEdgeParallelEdges:[],depsEdgeAllNodes:[],depsEdgeAllEdges:[],initialized:!1,onBeforeUpdate:n,nodes:{type:"node",name:e,standaloneSelector:u,toUpdate:new Uu({graph:this._graph,isNode:!0,includeRemovedElements:!1}),outputFlexArrays:this._nodes.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null},edges:{type:"edge",name:e,standaloneSelector:u,toUpdate:new Uu({graph:this._graph,isNode:!1,includeRemovedElements:!1}),outputFlexArrays:this._edges.createFlexArrays(),inputFlexArrays:null,formattedDependencies:null,formattedOutput:null}};return this._layers.push(l),this._updateLayer(l,t),a(this,this._layerIdCounter)},Dl.prototype._reconstructAttributeLayers=function(){this._layers.sort(function(t,e){return t.priority-e.priority});for(var t=G(this._nodes.getDefaultFlexArrays()),e=G(this._edges.getDefaultFlexArrays()),i=Z(t),r=Z(e),n=0,o=this._layers;n<o.length;n++)(M=o[n]).nodes.allAttributePaths=i,M.edges.allAttributePaths=r,M.nodes.formattedDependencies=Tl(M.nodes),M.edges.formattedDependencies=Cl(M.edges),M.nodes.formattedOutput={attributes:Sl(M.nodes),tags:M.tag?[M.tag]:[]},M.edges.formattedOutput={attributes:Sl(M.edges),tags:M.tag?[M.tag]:[]},M.nodes.redrawAdjacentEdges=M.nodes.formattedOutput.attributes.some(function(t){return bl[t]}),M.initialized=!0;for(var s=0,a=this._layers;s<a.length;s++){(M=a[s]).nodes.inputFlexArrays=G(t),M.edges.inputFlexArrays=G(e),M.depsNodeSelf=[],M.depsNodeAdjacentNodes=[],M.depsNodeAdjacentEdges=[],M.depsNodeAllNodes=[],M.depsNodeAllEdges=[],M.depsEdgeSelf=[],M.depsEdgeExtremities=[],M.depsEdgeParallelEdges=[],M.depsEdgeAllNodes=[],M.depsEdgeAllEdges=[],M.nodes.toUpdate.addAll(),M.edges.toUpdate.addAll();for(var u=M.nodes.formattedOutput,l=M.edges.formattedOutput,d=0,h=u.attributes;d<h.length;d++){var c=W(t,p=h[d]);(_=W(M.nodes.outputFlexArrays,p)).setFallback(c),H(t,p,_)}for(var f=0,g=l.attributes;f<g.length;f++){var p,_;c=W(e,p=g[f]),(_=W(M.edges.outputFlexArrays,p)).setFallback(c),H(e,p,_)}for(var v=0,m=this._layers;v<m.length;v++){var y=m[v];if(M!==y){var x=M.priority,b=y.priority,E=M.nodes.formattedOutput,A=M.edges.formattedOutput,S=y.nodes.formattedDependencies,w=y.edges.formattedDependencies;wl(M.depsNodeSelf,y,E,S.self,x,b),wl(M.depsNodeAdjacentNodes,y,E,S.adjacentNodes,x,b),wl(M.depsNodeAdjacentEdges,y,A,w.extremities,x,b),wl(M.depsNodeAllNodes,y,E,S.allNodes,x,b),wl(M.depsNodeAllEdges,y,A,w.allNodes,x,b),wl(M.depsEdgeSelf,y,A,w.self,x,b),wl(M.depsEdgeExtremities,y,E,S.adjacentEdges,x,b),wl(M.depsEdgeParallelEdges,y,A,w.parallelEdges,x,b),wl(M.depsEdgeAllNodes,y,E,S.allEdges,x,b),wl(M.depsEdgeAllEdges,y,A,w.allEdges,x,b)}}}this._nodes.setLastFlexArrays(t),this._edges.setLastFlexArrays(e);for(var T=0,C=this._layers;T<C.length;T++){var M;(M=C[T]).nodes.needAdjacentElements=M.nodes.redrawAdjacentEdges||0<M.depsNodeAdjacentNodes.length||0<M.depsNodeAdjacentEdges.length,M.edges.needAdjacentElements=0<M.depsEdgeExtremities.length||0<M.depsEdgeParallelEdges.length}},Dl.prototype._updateLayer=function(t,e){var i=void 0===e?{}:e,r=i.priority,n=i.fullOverwrite,o=i.nodeAttributes,s=i.nodeSelector,a=i.nodeContext,u=i.nodeDependencies,l=i.nodeOutput,d=i.edgeAttributes,h=i.edgeSelector,c=i.edgeContext,f=i.edgeDependencies,g=i.edgeOutput;void 0!==o&&(t.nodes.attributes=n?o:tt(t.nodes.attributes,o)),void 0!==s&&(t.nodes.selector=s),void 0!==a&&(t.nodes.context=a),void 0!==u&&(t.nodes.dependencies=u),void 0!==l&&(t.nodes.output=l),void 0!==d&&(t.edges.attributes=n?d:tt(t.edges.attributes,d)),void 0!==h&&(t.edges.selector=h),void 0!==c&&(t.edges.context=c),void 0!==f&&(t.edges.dependencies=f),void 0!==g&&(t.edges.output=g),void 0!==r&&(t.priority=r),this._triggerLayerUpdate()},Dl.prototype._triggerLayerUpdate=function(){this._layersNeedUpdate=!0,this._triggerUpdate()},Dl.prototype.updateAllForAttributeLayer=function(t){var e=this._getLayerById(t);this._updateAllForAttributeLayer(e)},Dl.prototype.updateAllForAllAttributeLayers=function(){for(var t=0,e=this._layers;t<e.length;t++){var i=e[t];this._updateAllForAttributeLayer(i)}},Dl.prototype._updateAllForAttributeLayer=function(t,e,i){if(void 0===e&&(e=!0),void 0===i&&(i=!0),e&&!t.nodes.toUpdate.isFull()){t.nodes.toUpdate.addAll();for(var r=0,n=t.depsNodeSelf;r<n.length;r++){var o=n[r];this._updateAllForAttributeLayer(o,!0,!1)}for(var s=0,a=t.depsNodeAdjacentNodes;s<a.length;s++)o=a[s],this._updateAllForAttributeLayer(o,!0,!1);for(var u=0,l=t.depsNodeAdjacentEdges;u<l.length;u++)o=l[u],this._updateAllForAttributeLayer(o,!1,!0);for(var d=0,h=t.depsNodeAllNodes;d<h.length;d++)o=h[d],this._updateAllForAttributeLayer(o,!0,!1);for(var c=0,f=t.depsNodeAllEdges;c<f.length;c++)o=f[c],this._updateAllForAttributeLayer(o,!1,!0)}if(i&&!t.edges.toUpdate.isFull()){t.edges.toUpdate.addAll();for(var g=0,p=t.depsEdgeSelf;g<p.length;g++)o=p[g],this._updateAllForAttributeLayer(o,!1,!0);for(var _=0,v=t.depsEdgeExtremities;_<v.length;_++)o=v[_],this._updateAllForAttributeLayer(o,!0,!1);for(var m=0,y=t.depsEdgeParallelEdges;m<y.length;m++)o=y[m],this._updateAllForAttributeLayer(o,!1,!0);for(var x=0,b=t.depsEdgeAllNodes;x<b.length;x++)o=b[x],this._updateAllForAttributeLayer(o,!0,!1);for(var E=0,A=t.depsEdgeAllEdges;E<A.length;E++)o=A[E],this._updateAllForAttributeLayer(o,!1,!0)}this._triggerUpdate()},Dl.prototype.updateElementsForAttributeLayer=function(t,e){var i=this._getLayerById(t);this._updateElementsForAttributeLayers([i],e)},Dl.prototype.updateForAllAttributeLayers=function(t){this._updateElementsForAttributeLayers(this._layers,t)},Dl.prototype._updateElementsForAttributeLayers=function(t,e){var i=this._emptySubgraph;if(e.isNode){for(var r=0,n=t;r<n.length;r++)if(!(m=n[r]).nodes.toUpdate.isFull()){m.nodes.needAdjacentElements&&(i=i===this._emptySubgraph?e.fastGetAdjacentElements():i),m.nodes.toUpdate.add(e);for(var o=0,s=m.depsNodeSelf;o<s.length;o++)(f=s[o]).nodes.toUpdate.add(e);for(var a=0,u=m.depsNodeAdjacentNodes;a<u.length;a++)(f=u[a]).nodes.toUpdate.add(i.nodes);for(var l=0,d=m.depsNodeAdjacentEdges;l<d.length;l++)(f=d[l]).edges.toUpdate.add(i.edges);for(var h=0,c=m.depsNodeAllNodes;h<c.length;h++){var f=c[h];this._updateAllForAttributeLayer(f,!0,!1)}for(var g=0,p=m.depsNodeAllEdges;g<p.length;g++)f=p[g],this._updateAllForAttributeLayer(f,!1,!0);m.nodes.redrawAdjacentEdges&&this._edges.redrawElements(i.edges)}}else for(var _=0,v=t;_<v.length;_++){var m;if(!(m=v[_]).edges.toUpdate.isFull()){m.edges.needAdjacentElements&&(i=i===this._emptySubgraph?e.fastGetAdjacentElements():i),m.edges.toUpdate.add(e);for(var y=0,x=m.depsEdgeSelf;y<x.length;y++)(f=x[y]).edges.toUpdate.add(e);for(var b=0,E=m.depsEdgeExtremities;b<E.length;b++)(f=E[b]).nodes.toUpdate.add(i.nodes);for(var A=0,S=m.depsEdgeParallelEdges;A<S.length;A++)(f=S[A]).edges.toUpdate.add(i.edges);for(var w=0,T=m.depsEdgeAllNodes;w<T.length;w++)f=T[w],this._updateAllForAttributeLayer(f,!0,!1);for(var C=0,M=m.depsEdgeAllEdges;C<M.length;C++)f=M[C],this._updateAllForAttributeLayer(f,!1,!0)}}this._triggerUpdate()},Dl.prototype.destroyAttributeLayer=function(t){var e=this._getLayerById(t);this._destroyedLayers.push(e),this._layers.splice(e.index,1),this._triggerLayerUpdate()},Dl.prototype.updateAttributeLayer=function(t,e){var i=this._getLayerById(t);this._updateLayer(i,e)},Dl.prototype.getAttributeLayerDefinition=function(t){var e=this._getLayerById(t),i=e.priority,r=e.nodes,n=e.edges;return{priority:i,nodeAttributes:r.attributes,nodeSelector:r.selector,nodeContext:r.context,nodeDependencies:r.dependencies,nodeOutput:r.output,edgeAttributes:n.attributes,edgeSelector:n.selector,edgeContext:n.context,edgeDependencies:n.dependencies,edgeOutput:n.output}},Dl.prototype.getAttributeValues=function(t,e,i,r){return this.update(),this._fetch(t).getAttributeValues(t,e,i,r)},Dl.prototype.setAnimationAttributes=function(t,e){var i=t.nodes,r=t.edges;this._nodes.setAnimationAttributes(i,e),this._edges.setAnimationAttributes(r,e)},Dl.prototype.resetAnimationAttributes=function(t){var e=t.nodes,i=t.edges;this._nodes.resetAnimationAttributes(e),this._edges.resetAnimationAttributes(i)},Dl.prototype.setTextHidden=function(t,value){var e=this._textHiddenSet.addOrRemoveElements(t,value);this.redrawElements(e)},Dl.prototype.resetTextHidden=function(){var t=this._textHiddenSet.getElements(),e=t.nodes,i=t.edges;this._textHiddenSet.clear(),this._nodes.redrawElements(e),this._edges.redrawElements(i)},Dl.prototype.getUsedNodeAttributes=function(){return this._nodes.getUsedAttributes()},Dl.prototype.getUsedEdgeAttributes=function(){return this._edges.getUsedAttributes()},Object.defineProperty(Dl.prototype,"nodes",{get:function(){return this._nodes},enumerable:!0,configurable:!0}),Object.defineProperty(Dl.prototype,"edges",{get:function(){return this._edges},enumerable:!0,configurable:!0}),Dl);function Dl(t,e,i){this._colorManager=new kr,this._layerIdCounter=0,this._layers=[],this._destroyedLayers=[],this._layersNeedUpdate=!1,this._updateOngoing=!1,this._needUpdate=!1,this._ogma=i,this._graph=t,this._dom=e,this._emptySubgraph={nodes:i.nodeList(),edges:i.edgeList()},this._textHiddenSet=new rs(this._graph,"textHidden"),this._nodes=new Nl(t,this._colorManager,!0,kl),this._edges=new Nl(t,this._colorManager,!1,Fl)}function zl(t,e,i){return void 0===i&&(i=0),"inherit"===t?Array.isArray(e)?e[i/(2*Math.PI)*e.length|0]:e:t}function Bl(t,e){var i=t(),r=Z(i).map(function(t){var value=W(i,t);return Array.isArray(value)?"for (var i = 0; i < "+value.length+"; ++i) {\n        target."+t+"[i] = source."+t+"[i]."+e+";\n      }\n      return target;":"target."+t+" = source."+t+"."+e+";"}).join("\n");return new Function("source, target",r)}function Ul(t){var e=t(),i=Z(e).map(function(t){var value=W(e,t);return Array.isArray(value)?"for (var i = 0; i < "+value.length+"; ++i) {\n        target."+t+"[i] = target."+t+"[i] || source."+t+"[i];\n      }":"target."+t+" = target."+t+" || source."+t+";"}).join("\n");return new Function("target","source",i)}function Vl(t){var e=(t.getDepth()-Gs)%Ks;return 0<=e&&e!==Hs&&e!==Xs}function jl(t,e,i,r){var n,o,s,a,u,l,d,h,c,f;n=t,o=e,a=r,u=+("scaled"===(s=i).scalingMethod.get(a)),l=2*s.radius.get(a),d=s.innerStroke.width.get(a),h=+("scaled"===s.innerStroke.scalingMethod.get(a)),c=s.outerStroke.width.get(a),f=+("scaled"===s.outerStroke.scalingMethod.get(a)),o.x=s.x.get(a),o.y=s.y.get(a),o.shape=s.shape.get(a),o.color=s.color.get(a),o.opacity=s.opacity.get(a),o.diameterScaled=l*u,o.diameterFixed=l*(1-u),o.innerStroke.color=zl(s.innerStroke.color.get(a),o.color),o.innerStroke.widthScaled=d*h,o.innerStroke.widthFixed=d*(1-h),o.innerStroke.minVisibleSize=s.innerStroke.minVisibleSize.get(a),o.outerStroke.color=zl(s.outerStroke.color.get(a),o.color),o.outerStroke.widthScaled=c*f,o.outerStroke.widthFixed=c*(1-f),o.halo.color=s.halo.color.get(a),o.halo.strokeColor=s.halo.strokeColor.get(a),o.icon.content=n.formatText(s.icon.content.get(a)),o.image.url=s.image.url.get(a),o.outline.enabled=s.outline.enabled.get(a),o.textHidden=!!s.textHidden.get(a),Gl(t,e.texts.primary,i.text,r,e),Gl(t,e.texts.secondary,i.text.secondary,r,e),Hl(t,e.badges.topLeft,i.badges.topLeft,r),Hl(t,e.badges.topRight,i.badges.topRight,r),Hl(t,e.badges.bottomLeft,i.badges.bottomLeft,r),Hl(t,e.badges.bottomRight,i.badges.bottomRight,r)}function Gl(t,e,i,r,n){if(e.hidden=n.textHidden,e.content=t.formatText(i.content.get(r)),e.backgroundColor=zl(i.backgroundColor.get(r),n.color),e===n.texts.primary){var o=i;e.tip=o.tip.get(r),e.position=o.position.get(r)}else e.position="bottom"}function Hl(t,e,i,r){var n=i.text.content.get(r);e.textContent=t.formatText(n),e.imageUrl=i.image.url.get(r)}function Wl(){return{x:0,y:0,shape:"",color:"",opacity:0,diameterScaled:0,diameterFixed:0,innerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},outerStroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},icon:{content:"",font:"",color:"",scale:0,size:0,style:"none",minVisibleSize:0},image:{url:"",content:null,scale:0,rescale:!1,duplicate:!1,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,strokeWidthScaled:0,strokeWidthFixed:0,color:"",strokeColor:""},outline:{enabled:!1,color:"",minVisibleSize:0},badges:{topLeft:ql($s),topRight:ql(ta),bottomLeft:ql(ea),bottomRight:ql(ia)},textHidden:!1,texts:{primary:Xl(),secondary:Xl()}}}function ql(t){return{angle:t,color:"",scale:0,positionScale:0,minVisibleSize:0,strokeColor:"",strokeWidthScaled:0,strokeWidthFixed:0,textContent:"",textFont:"",textColor:"",textScale:0,textStyle:"none",imageUrl:"",imageContent:null,imageScale:0}}function Xl(){return{hidden:!1,content:"",position:"",backgroundColor:"",tip:!1,font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",align:"left",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,isPositionCenter:!1,isPositionVertical:!1,isPositionHorizontal:!1}}function Yl(){return{edgeHalo:0,nodeHaloStroke:0,nodeHalo:0,edgeBody:0,edgeTextBackground:0,edgeText:0,nodeBody:0,nodeTextBackground:0,nodeText:0}}function Zl(t,e){void 0===e&&(e=Yl());var i=(t-Xu)*Ks+Gs;return e.edgeHalo=Us,e.nodeHaloStroke=Vs,e.nodeHalo=js,e.edgeBody=i+Hs,e.edgeTextBackground=i+Ws,e.edgeText=i+qs,e.nodeBody=i+Xs,e.nodeTextBackground=i+Ys,e.nodeText=i+Zs,e}function Kl(t,e){var i,r;r=e,(i=t).body=!0,i.icon=!!r.icon.content,i.image=!!r.image.url,i.pieChart=Array.isArray(r.color),i.outerStroke=!!r.outerStroke.color,i.outline=!!r.outline.enabled,i.halo=!!r.halo.color,i.haloStroke=i.halo&&!!r.halo.strokeColor,Ql(t.texts.primary,e.texts.primary),Ql(t.texts.secondary,e.texts.secondary),Jl(t.badges.topLeft,e.badges.topLeft),Jl(t.badges.topRight,e.badges.topRight),Jl(t.badges.bottomLeft,e.badges.bottomLeft),Jl(t.badges.bottomRight,e.badges.bottomRight)}function Ql(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor,t.tip=t.background&&e.tip&&"center"!==e.position}function Jl(t,e){t.text=!!e.textContent,t.image=!!e.imageUrl}function $l(t,e){t.pieceId=Vr,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=e.diameterScaled,t.rectWidthOrSourceRadiusFixed=e.diameterFixed,t.rectHeightOrTargetRadiusScaled=e.diameterScaled,t.rectHeightOrTargetRadiusFixed=e.diameterFixed,t.shape=e.shape,t.opacity=e.opacity,t.symbolicSize=e.diameterScaled,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=null,t.strokeColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function td(t,e,i){var r=i.diameterScaled*e.scale,n=i.diameterFixed*e.scale,o=i.diameterScaled*e.positionScale/2,s=i.diameterFixed*e.positionScale/2;t.pieceId=Vr,t.shape="circle",t.x1=i.x,t.y1=i.y,t.x2=i.x,t.y2=i.y,t.rectWidthOrSourceRadiusScaled=r,t.rectWidthOrSourceRadiusFixed=n,t.rectHeightOrTargetRadiusScaled=r,t.rectHeightOrTargetRadiusFixed=n,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.strokeWidthScaled,t.strokeWidthFixed=e.strokeWidthFixed,t.offsetScaled=o,t.offsetFixed=s,t.pattern.type=0,t.opacity=i.opacity,t.fillColor=e.color,t.strokeColor=e.strokeColor,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.angle,t.patternScale=0,t.symbolicSize=i.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function ed(t,e,i){var r,n=0,o=0;if(e.isPositionCenter||(n+=i.innerStroke.widthScaled+i.outerStroke.widthScaled+i.diameterScaled/2,o+=i.innerStroke.widthFixed+i.outerStroke.widthFixed+i.diameterFixed/2+e.margin+e.padding),e.isPositionVertical){if(n+=e.heightScaled/2,o+=e.heightFixed/2,e===i.texts.secondary&&"bottom"===i.texts.primary.position){var s=i.texts.primary;n+=s.heightScaled,o+=s.heightFixed+s.margin+2*s.padding}}else e.isPositionHorizontal&&(n+=e.widthScaled/2,o+=e.widthFixed/2);r=mi,t.pieceId=Vr,t.shape="square",t.x1=i.x,t.y1=i.y,t.x2=i.x,t.y2=i.y,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=o,t.pattern.type=0,t.pattern.attributes.size=r,t.opacity=i.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.positionAngle,t.patternScale=1,t.symbolicSize=i.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}function id(t,e,i,r,n,o){var s=n.badges,a=r.badges,u=o.badges;!function(t,e,i,r,n){if(r.halo){var o=i.halo.width.get(e),s=+("scaled"===i.halo.scalingMethod.get(e));n.halo.widthScaled=o*s,n.halo.widthFixed=o*(1-s),function(t,e){var i=e.diameterScaled+2*e.halo.widthScaled,r=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Vr,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.halo.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.halo,n),r.haloStroke&&(n.halo.strokeWidthScaled=0,n.halo.strokeWidthFixed=i.halo.strokeWidth.get(e),function(t,e){var i=e.diameterScaled+2*e.halo.widthScaled,r=e.diameterFixed+2*e.halo.widthFixed;t.pieceId=Vr,t.shape="circle",t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.halo.strokeWidthScaled,t.strokeWidthFixed=e.halo.strokeWidthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.halo.strokeColor,t.patternColor=null,t.globalMinVisibleSize=0,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.haloStroke,n))}r.outline&&(n.outline.color=i.outline.color.get(e),n.outline.minVisibleSize=i.outline.minVisibleSize.get(e),function(t,e){var i=e.diameterScaled*ra,r=e.diameterFixed*ra,n=e.diameterScaled*na,o=e.diameterFixed*na+oa;e.outerStroke.color&&(n+=e.outerStroke.widthScaled/2,o+=e.outerStroke.widthFixed/2),t.pieceId=Vr,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=n,t.offsetFixed=o,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=e.outline.color,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.outline.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=1.5707963267948966,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.outline,n));r.outerStroke&&(n.outerStroke.minVisibleSize=i.outerStroke.minVisibleSize.get(e),function(t,e){var i=e.diameterScaled+2*e.innerStroke.widthScaled,r=e.diameterFixed+2*e.innerStroke.widthFixed;t.pieceId=Vr,t.shape=e.shape,t.x1=e.x,t.y1=e.y,t.x2=e.x,t.y2=e.y,t.rectWidthOrSourceRadiusScaled=i,t.rectWidthOrSourceRadiusFixed=r,t.rectHeightOrTargetRadiusScaled=i,t.rectHeightOrTargetRadiusFixed=r,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=e.outerStroke.widthScaled,t.strokeWidthFixed=e.outerStroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=e.outerStroke.color,t.patternColor=null,t.globalMinVisibleSize=e.outerStroke.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.diameterScaled,t.curvature=0,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=!1,t.isText=!1}(r.outerStroke,n));r.pieChart&&function(t,e){$l(t,e),Array.isArray(e.color)&&(t.pattern.type=Dr,t.pattern.attributes.colors=e.color.join(";"),t.patternScale=1,t.patternMinVisibleSize=0,t.patternColor=null)}(r.pieChart,n);r.image&&(n.image.content=t.imageManager.getImage(n.image.url),n.image.fit=i.image.fit.get(e),n.image.tile=i.image.tile.get(e),n.image.scale=i.image.scale.get(e),n.image.minVisibleSize=i.image.minVisibleSize.get(e),function(t,e){var i=e.image.fit&&!e.image.tile;$l(t,e),t.pattern.type=Pr,t.pattern.attributes.image=e.image.content,t.pattern.attributes.scaled=i,t.pattern.attributes.duplicated=e.image.tile,t.patternScale=i?e.image.scale:0,t.patternMinVisibleSize=e.image.minVisibleSize,t.patternColor=null}(r.image,n));r.icon&&(n.icon.font=t.fontManager.getFont(i.icon.font.get(e)),n.icon.style=i.icon.style.get(e),n.icon.color=i.icon.color.get(e),n.icon.scale=i.icon.scale.get(e),n.icon.minVisibleSize=i.icon.minVisibleSize.get(e),function(t,e){$l(t,e),t.pattern.type=zr,t.pattern.attributes.text=e.icon.content,t.pattern.attributes.font=e.icon.font,t.pattern.attributes.style=e.icon.style,t.pattern.attributes.size=mi,t.patternMinVisibleSize=e.icon.minVisibleSize,t.patternColor=e.icon.color,t.patternScale=e.icon.scale}(r.icon,n));if(r.body){var a=!r.pieChart&&!r.image&&!r.icon;!function(t,e,i){$l(t,e),t.fillColor=Array.isArray(e.color)?null:e.color,t.strokeColor=e.innerStroke.color,t.strokeMinVisibleSize=e.innerStroke.minVisibleSize,t.strokeWidthScaled=e.innerStroke.widthScaled,t.strokeWidthFixed=e.innerStroke.widthFixed,i&&(t.pattern.type=0)}(r.body,n,a)}}(e,i,r,n,o),nd(t,e,i,r.text,n.texts.primary,o.texts.primary,o),nd(t,e,i,r.text.secondary,n.texts.secondary,o.texts.secondary,o),rd(t,e,i,a.topLeft,s.topLeft,u.topLeft,o),rd(t,e,i,a.topRight,s.topRight,u.topRight,o),rd(t,e,i,a.bottomLeft,s.bottomLeft,u.bottomLeft,o),rd(t,e,i,a.bottomRight,s.bottomRight,u.bottomRight,o)}function rd(t,e,i,r,n,o,s){if(n.image||n.text){var a=r.stroke.width.get(i),u=+("scaled"===r.stroke.scalingMethod.get(i));o.color=zl(r.color.get(i),s.color,o.angle),o.strokeColor=r.stroke.color.get(i),o.strokeWidthScaled=a*u,o.strokeWidthFixed=a*(1-u),o.minVisibleSize=r.minVisibleSize.get(i),o.positionScale=r.positionScale.get(i),o.scale=r.scale.get(i)}var l,d,h,c;if(n.image&&(o.imageContent=e.imageManager.getImage(o.imageUrl),o.imageScale=r.image.scale.get(i),td(l=n.image,d=o,s),null!==d.imageContent?(l.pattern.type=Pr,l.pattern.attributes.image=d.imageContent,l.pattern.attributes.scaled=!0,l.pattern.attributes.duplicated=!1,l.patternScale=d.imageScale,l.patternMinVisibleSize=0,l.patternColor=null):(l.fillColor=null,l.strokeColor=null)),n.text){if(o.textFont=e.fontManager.getFont(r.text.font.get(i)),o.textStyle=r.text.style.get(i),o.textColor=zl(r.text.color.get(i),s.color),o.textScale=r.text.scale.get(i),1<t.measureText(o.textContent,o.textFont,o.textStyle,o.textScale).width){for(var f=0,g=0;g<o.textContent.length&&f<1;)f+=t.measureText(o.textContent[g],o.textFont,o.textStyle,o.textScale).width,g+=1;g!==o.textContent.length&&(o.textContent=o.textContent.substring(0,g-1)+"")}td(h=n.text,c=o,s),c.textContent&&(h.pattern.type=Br,h.pattern.attributes.text=c.textContent,h.pattern.attributes.font=c.textFont,h.pattern.attributes.style=c.textStyle,h.pattern.attributes.size=mi,h.patternMinVisibleSize=0,h.patternColor=c.textColor,h.patternScale=c.textScale,h.isBadge=!0),!c.imageUrl&&c.textContent||(h.fillColor=null,h.strokeColor=null)}}function nd(t,e,i,r,n,o,s){if(n.text){var a=r,u=a.scaling.get(i);if(o.font=e.fontManager.getFont(a.font.get(i)),o.color=zl(a.color.get(i),s.color),o.style=a.style.get(i),o.align=a.align.get(i),o.minVisibleSize=a.minVisibleSize.get(i),o.margin=a.margin.get(i),o.padding=a.padding.get(i),o.maxLineLength=a.maxLineLength.get(i),o.content=ys(o.content,o.maxLineLength),u){var l=a.scale.get(i);o.sizeScaled=s.diameterScaled*l,o.sizeFixed=s.diameterFixed*l}else o.sizeFixed=a.size.get(i),o.sizeScaled=0;var d=t.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.positionAngle=fa[o.position],o.isPositionCenter="center"===o.position,o.isPositionVertical="top"===o.position||"bottom"===o.position,o.isPositionHorizontal="left"===o.position||"right"===o.position,ed(E=n.text,A=o,s),E.pattern.type=Ur,E.pattern.attributes.text=A.content,E.pattern.attributes.font=A.font,E.pattern.attributes.style=A.style,E.pattern.attributes.align=A.align,E.patternMinVisibleSize=0,E.patternColor=A.color,E.thicknessOrFontSizeScaled=A.sizeScaled,E.thicknessOrFontSizeFixed=A.sizeFixed,E.isText=!0,n.background&&(ed(x=n.background,b=o,s),x.fillColor=b.backgroundColor,n.tip&&(h=n.tip,c=o,f=s,g=Math.ceil(c.margin/2)+1,p=f.diameterScaled/2+f.innerStroke.widthScaled+f.outerStroke.widthScaled,_=f.diameterFixed/2+f.innerStroke.widthFixed+f.outerStroke.widthFixed+g,v=ga[c.position],m=Math.cos(v),y=Math.sin(v),h.pieceId=Vr,h.shape="triangle",h.x1=f.x-m,h.y1=f.y-y,h.x2=f.x+m,h.y2=f.y+y,h.rectWidthOrSourceRadiusScaled=0,h.rectWidthOrSourceRadiusFixed=c.margin,h.rectHeightOrTargetRadiusScaled=0,h.rectHeightOrTargetRadiusFixed=c.margin*ha,h.thicknessOrFontSizeScaled=0,h.thicknessOrFontSizeFixed=0,h.strokeWidthScaled=0,h.strokeWidthFixed=0,h.offsetScaled=p,h.offsetFixed=_,h.pattern.type=0,h.opacity=f.opacity,h.fillColor=c.backgroundColor,h.strokeColor=null,h.patternColor=null,h.globalMinVisibleSize=c.minVisibleSize,h.strokeMinVisibleSize=0,h.patternMinVisibleSize=0,h.offsetAngle=c.positionAngle,h.patternScale=0,h.symbolicSize=f.diameterScaled,h.curvature=0,h.dashLength=0,h.gapLength=0,h.hasHead=!1,h.hasTail=!1,h.isSelfLoop=!1))}var h,c,f,g,p,_,v,m,y,x,b,E,A}var od=Bl(hd,"start"),sd=Bl(hd,"end"),ad=Ul(hd),ud=(ld.prototype.drawNode=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,i=this._helper,r=t,n=Zl(this._attributes.layer.get(t),this._depthInfo),o=this._attributes.animationDuration.get(t),s=0<o;if(this._prepareBlocks(s,n,r),jl(i,this._endInput,this._attributes,t),Kl(this._endFlags,this._endInput),s&&(jl(i,this._startInput,this._attributesPrev,t),Kl(this._startFlags,this._startInput),ad(this._endFlags,this._startFlags)),this._initComponents(this._fullComponents,this._endFlags,this._blocks),sd(this._fullComponents,this._endComponents),id(e,i,t,this._attributes,this._endComponents,this._endInput),s&&(od(this._fullComponents,this._startComponents),id(e,i,t,this._attributesPrev,this._startComponents,this._startInput)),s){var a=this._attributes.animationStart.get(t),u=this._attributes.animationEasing.get(t);this._setBlocksAnimation(o,a,u)}this._endFlags.halo&&this._attributes.halo.hideNonAdjacentEdges.get(t)&&(this._blocks.halo.setStencilUsage(2),this._blocks.haloStroke.setStencilUsage(2)),this._storeBlocks()},ld.prototype._computeBlockIds=function(t){var e=10*t,i=this._blockIds;i.body=0+e,i.text=1+e,i.textBg=2+e,i.halo=3+e,i.haloStroke=4+e},ld.prototype._prepareBlocks=function(t,e,i){var r=this._blocks;r.body.reset(1,t,e.nodeBody,i),r.text.reset(2,t,e.nodeText,i),r.textBg.reset(1,t,e.nodeTextBackground,i),r.halo.reset(1,t,e.nodeHalo,i),r.haloStroke.reset(1,t,e.nodeHaloStroke,i)},ld.prototype._storeBlocks=function(){var t=this._engine,e=this._blocks,i=this._blockIds;t.storeBlock(i.body,e.body),t.storeBlock(i.text,e.text),t.storeBlock(i.textBg,e.textBg),t.storeBlock(i.halo,e.halo),t.storeBlock(i.haloStroke,e.haloStroke)},ld.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.text),t.freeBlock(e.textBg),t.freeBlock(e.halo),t.freeBlock(e.haloStroke)},ld.prototype._setBlocksAnimation=function(t,e,i){var r=this._blocks;r.body.setGlobalAnimation(t,e,i),r.text.setGlobalAnimation(t,e,i),r.textBg.setGlobalAnimation(t,e,i),r.halo.setGlobalAnimation(t,e,i),r.haloStroke.setGlobalAnimation(t,e,i)},ld.prototype._initComponents=function(t,e,i){this._nodePatternAssigned=!1,this._initBaseComponents(t,e,i),this._initBadgeComponents(t.badges.topLeft,e.badges.topLeft,i),this._initBadgeComponents(t.badges.topRight,e.badges.topRight,i),this._initBadgeComponents(t.badges.bottomLeft,e.badges.bottomLeft,i),this._initBadgeComponents(t.badges.bottomRight,e.badges.bottomRight,i),this._initTextComponents(t.texts.primary,e.texts.primary,i),this._initTextComponents(t.texts.secondary,e.texts.secondary,i)},ld.prototype._initBaseComponents=function(t,e,i){t.haloStroke=this._nextElement(e.haloStroke,i.haloStroke),t.halo=this._nextElement(e.halo,i.halo),t.outline=this._nextElement(e.outline,i.body),t.outerStroke=this._nextElement(e.outerStroke,i.body),t.body=this._nextElement(e.body,i.body),t.pieChart=this._getNodePatternElement(e.pieChart,i),t.image=this._getNodePatternElement(e.image,i),t.icon=this._getNodePatternElement(e.icon,i)},ld.prototype._initBadgeComponents=function(t,e,i){t.image=this._nextElement(e.image,i.body),t.text=this._nextElement(e.text,i.body)},ld.prototype._initTextComponents=function(t,e,i){t.background=this._nextElement(e.background,i.textBg),t.tip=this._nextElement(e.tip,i.textBg),t.text=this._nextElement(e.text,i.text)},ld.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},ld.prototype._getNodePatternElement=function(t,e){return t?this._nodePatternAssigned?e.body.next():(this._nodePatternAssigned=!0,e.body.getCurrentElement()):this._nullElt},ld);function ld(t){var e=t.engine,i=t.imageManager,r=t.fontManager,n=t.formatText,o=t.attributes,s=t.attributesPrev;this._fullComponents=hd(),this._startComponents=hd(),this._endComponents=hd(),this._startFlags=hd(),this._endFlags=hd(),this._startInput=Wl(),this._endInput=Wl(),this._depthInfo=Yl(),this._nodePatternAssigned=!1,this._nullElt={id:-1,valid:!0},this._engine=e,this._attributes=o,this._attributesPrev=s,this._helper={imageManager:i,fontManager:r,formatText:n},this._blocks=dd(function(){return e.createBlock()}),this._blockIds=dd(function(){return 0})}function dd(t){return{body:t(),text:t(),textBg:t(),halo:t(),haloStroke:t()}}function hd(){return{haloStroke:void 0,halo:void 0,outline:void 0,outerStroke:void 0,body:void 0,pieChart:void 0,image:void 0,icon:void 0,badges:{topLeft:{text:void 0,image:void 0},topRight:{text:void 0,image:void 0},bottomLeft:{text:void 0,image:void 0},bottomRight:{text:void 0,image:void 0}},texts:{primary:{text:void 0,background:void 0,tip:void 0},secondary:{text:void 0,background:void 0,tip:void 0}}}}function circleCircleIntersection(t,e,i,r,n,o){var s,a,u,l,d,h,c,f,g;return a=r-t,u=n-e,i+o<(l=Math.sqrt(a*a+u*u))||l<Math.abs(i-o)?null:(g=e+u*(s=(i*i-o*o+l*l)/(2*l))/l,[[(f=t+a*s/l)+(h=(d=Math.sqrt(i*i-s*s))/l*-u),g+(c=d/l*a)],[f-h,g-c]])}function circleSortCompare(t,e,i,r,n,o){if(0<=t-n&&i-n<0)return 1;if(t-n<0&&0<=i-n)return-1;if(t-n==0&&i-n==0)return 0<=e-r||0<=r-o?e-r:r-e;var s=(t-n)*(r-o)-(i-n)*(e-o);return s<0?1:0<s?-1:(t-n)*(t-n)+(e-o)*(e-o)-((i-n)*(i-n)+(r-o)*(r-o))}function cd(t,e,i){var r=t[0],n=t[1],o=t[2],s=Math.abs(r-e),a=Math.abs(n-i);return s+a<=o||!(o<s||o<a)&&Math.sqrt(s*s+a*a)<o+1e-12}function fd(t,e,i,r){var n=t[0]-e,o=t[1]-i,s=t[2]-r;return n*n+o*o<s*s+1e-6}function gd(t,e,i,r,n,o,s){var a=t-Math.max(r,Math.min(o,t)),u=e-Math.max(n,Math.min(s,e));return a*a+u*u<i*i}function pd(t,e,i,r,n,o,s,a){void 0===a&&(a={x:0,y:0});var u,l,d,h,c=a||{x:0,y:0};if(i===t){var f=t-n,g=s*s-f*f;if(g<0)return null;var p=Math.sqrt(g);d=u=t,l=o+p,h=o-p}else{var _=(r-e)/(i-t),v=e-_*t,m=v-o,y=_*_+1,x=2*(_*m-n),b=x*x-4*y*(n*n+m*m-s*s);if(b<0)return null;var E=-x,A=Math.sqrt(b),S=2*y;l=_*(u=(E+A)/S)+v,h=_*(d=(E-A)/S)+v}var w=t-u,T=e-l,C=t-d,M=e-h;return w*w+T*T<C*C+M*M?(c.x=u,c.y=l):(c.x=d,c.y=h),c}function _d(t,e,i,r,n,o){!function(t,e,i,r,n){var o=r.source,s=r.target,a=e.source.get(i),u=e.target.get(i),l=o.x.get(a),d=o.y.get(a),h=o.radius.get(a),c=o.color.get(a),f=+("scaled"===o.scalingMethod.get(a)),g=s.x.get(u),p=s.y.get(u),_=s.radius.get(u),v=s.color.get(u),m=+("scaled"===s.scalingMethod.get(u)),y=function(t,e,i){return"source"===t?e:"target"===t?i:t}(e.color.get(i),c,v),x=e.width.get(i),b=+("scaled"===e.scalingMethod.get(i)),E=e.stroke.width.get(i),A=+("scaled"===e.stroke.scalingMethod.get(i)),S=ca[e.shape.style.get(i)],w=e.adjustAnchors.get(i);if(t.source=a,t.target=u,t.sourceX=l,t.sourceY=d,t.targetX=g,t.targetY=p,t.sourceRadiusScaled=h*f,t.sourceRadiusFixed=h*(1-f),t.targetRadiusScaled=_*m,t.targetRadiusFixed=_*(1-m),t.widthScaled=x*b,t.widthFixed=x*(1-b),t.curvature=e.curvature.get(i),t.isSelfLoop=a===u,t.color=y,t.opacity=e.opacity.get(i),t.minVisibleSize=e.minVisibleSize.get(i),t.shape.type=e.shape.type.get(i),t.shape.head=e.shape.head.get(i),t.shape.tail=e.shape.tail.get(i),t.shape.dashLength=S.dash,t.shape.gapLength=S.gap,t.shape.isBodyTriangle="triangle"===t.shape.type,t.stroke.color=zl(e.stroke.color.get(i),y),t.stroke.widthScaled=E*A,t.stroke.widthFixed=E*(1-A),t.stroke.minVisibleSize=e.stroke.minVisibleSize.get(i),t.halo.color=e.halo.color.get(i),t.outline.enabled=e.outline.enabled.get(i),t.textHidden=1===e.textHidden.get(i),w&&(t.shape.head||t.shape.tail||"triangle"===t.shape.type)){var T=t,C=T.curvature,M=T.sourceX,I=T.sourceY,L=T.targetX,N=T.targetY,O=1,k=1;if(C){if(!T.isSelfLoop){var F=va(M,I,L,N,C/2);O=md(T,n,o,a,M,I,F.x,F.y),k=md(T,n,s,u,L,N,F.x,F.y)}}else O=md(T,n,o,a,M,I,L,N),k=md(T,n,s,u,L,N,M,I);t.sourceRadiusScaled*=O,t.sourceRadiusFixed*=O,t.targetRadiusScaled*=k,t.targetRadiusFixed*=k}}(e,i,r,n,o),vd(t,e.texts.primary,i.text,r,e),vd(t,e.texts.secondary,i.text.secondary,r,e)}function vd(t,e,i,r,n){e.hidden=n.textHidden,e.content=t.formatText(i.content.get(r)),e.backgroundColor=zl(i.backgroundColor.get(r),n.color)}function md(t,e,i,r,n,o,s,a){var u,l=e.angle||0,d=Math.atan2(a-o,s-n)-l,h=1,c=0;d<-Qs?d+=Js:Qs<d&&(d-=Js),u=d<-Qs/2?(c=$s,i.badges.topLeft):d<0?(c=ta,i.badges.topRight):d<Qs/2?(c=ia,i.badges.bottomRight):(c=ea,i.badges.bottomLeft),c+=l;var f,g=u.text.content&&u.text.content.get(r),p=u.image.url&&u.image.url.get(r);if((f=g)||0===f||p){var _=u.positionScale.get(r),v=u.scale.get(r),m=pd(s,a,n,o,n+(b=Math.cos(c))*_,o+(E=Math.sin(c))*_,v);if(m){var y=m.x-n,x=m.y-o,distance=Math.sqrt(y*y+x*x);h=Math.max(h,distance)}}if("square"===i.shape.get(r)){var b=Math.abs(Math.cos(d)),E=Math.abs(Math.sin(d)),A=1/Math.max(b,E);h=Math.max(h,A)}return h}function yd(){return{source:0,target:0,sourceX:0,sourceY:0,targetX:0,targetY:0,sourceRadiusScaled:0,sourceRadiusFixed:0,targetRadiusScaled:0,targetRadiusFixed:0,widthScaled:0,widthFixed:0,curvature:0,isSelfLoop:!1,color:"",opacity:0,minVisibleSize:0,shape:{type:"line",head:null,tail:null,dashLength:0,gapLength:0,isBodyTriangle:!1},stroke:{color:"",widthScaled:0,widthFixed:0,minVisibleSize:0},halo:{widthScaled:0,widthFixed:0,color:""},outline:{enabled:!1,color:"",minVisibleSize:0},textHidden:!1,texts:{primary:xd(),secondary:xd()}}}function xd(){return{align:"left",hidden:!1,content:"",backgroundColor:"",font:"",color:"",sizeScaled:0,sizeFixed:0,style:"none",minVisibleSize:0,margin:0,padding:0,maxLineLength:0,widthScaled:0,widthFixed:0,heightScaled:0,heightFixed:0,positionAngle:0,adjustAngle:!1,offsetAngle:0}}function bd(t,e){Ed(t.body,e,!0,!0),Ed(t.outline,e,e.outline.enabled,!0),Ed(t.halo,e,!!e.halo.color,!1),Ad(t.texts.primary,e.texts.primary),Ad(t.texts.secondary,e.texts.secondary)}function Ed(t,e,value,i){t.body=value,t.head=value&&i&&!!e.shape.head,t.tail=value&&i&&!!e.shape.tail}function Ad(t,e){t.text=!e.hidden&&!!e.content,t.background=t.text&&!!e.backgroundColor}function Sd(t,e,i,r){wd(t,e,i,r),t.thicknessOrFontSizeScaled=e.widthScaled,t.thicknessOrFontSizeFixed=e.widthFixed,t.strokeWidthScaled=e.stroke.widthScaled,t.strokeWidthFixed=e.stroke.widthFixed,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.color,t.strokeColor=e.stroke.color,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=e.stroke.minVisibleSize,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function wd(t,e,i,r){t.pieceId=i,t.shape=r,t.x1=e.sourceX,t.y1=e.sourceY,t.x2=e.targetX,t.y2=e.targetY,t.rectWidthOrSourceRadiusScaled=e.sourceRadiusScaled,t.rectWidthOrSourceRadiusFixed=e.sourceRadiusFixed,t.rectHeightOrTargetRadiusScaled=e.targetRadiusScaled,t.rectHeightOrTargetRadiusFixed=e.targetRadiusFixed,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.pattern.type=0,t.opacity=e.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=0,t.patternScale=0,t.symbolicSize=e.widthScaled,t.curvature=e.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=e.isSelfLoop,t.isText=!1}function Td(t,e,i){var r=e.widthScaled+2*e.halo.widthScaled,n=e.widthFixed+2*e.halo.widthFixed;wd(t,e,i,"line"),t.thicknessOrFontSizeScaled=r,t.thicknessOrFontSizeFixed=n,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=0,t.offsetFixed=0,t.fillColor=e.halo.color,t.strokeColor=null,t.globalMinVisibleSize=e.minVisibleSize,t.strokeMinVisibleSize=0,t.offsetAngle=0,t.symbolicSize=e.widthScaled,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isBodyTriangle=!1}function Cd(t,e,i,r){wd(t,e,i,r);var n=e.widthFixed*aa+ua;t.thicknessOrFontSizeScaled=e.widthScaled*sa,t.thicknessOrFontSizeFixed=e.widthFixed*sa,t.strokeWidthScaled=0,t.strokeWidthFixed=0,t.offsetScaled=e.widthScaled*aa,t.offsetFixed=n,t.fillColor=e.outline.color,t.strokeColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,e.outline.minVisibleSize),t.strokeMinVisibleSize=0,t.offsetAngle=Math.PI/2,t.symbolicSize=e.widthScaled,t.dashLength=e.shape.dashLength,t.gapLength=e.shape.gapLength,t.hasHead=!!e.shape.head,t.hasTail=!!e.shape.tail,t.isBodyTriangle=e.shape.isBodyTriangle}function Md(t,e,i){var r=(i.widthScaled+e.heightScaled)/2+i.stroke.widthScaled,n=(i.widthFixed+e.heightFixed)/2+i.stroke.widthFixed+e.padding+e.margin;t.pieceId=Wr,t.shape="square",t.x1=i.sourceX,t.y1=i.sourceY,t.x2=i.targetX,t.y2=i.targetY,t.rectWidthOrSourceRadiusScaled=e.widthScaled,t.rectWidthOrSourceRadiusFixed=e.widthFixed+2*e.padding+1,t.rectHeightOrTargetRadiusScaled=e.heightScaled,t.rectHeightOrTargetRadiusFixed=e.heightFixed+2*e.padding,t.thicknessOrFontSizeScaled=0,t.thicknessOrFontSizeFixed=0,t.strokeWidthScaled=i.sourceRadiusScaled+i.targetRadiusScaled,t.strokeWidthFixed=i.sourceRadiusFixed+i.targetRadiusFixed,t.offsetScaled=r,t.offsetFixed=n,t.pattern.type=0,t.opacity=i.opacity,t.fillColor=null,t.strokeColor=null,t.patternColor=null,t.globalMinVisibleSize=Math.max(e.minVisibleSize,i.minVisibleSize),t.strokeMinVisibleSize=0,t.patternMinVisibleSize=0,t.offsetAngle=e.offsetAngle,t.patternScale=0,t.symbolicSize=i.widthScaled,t.curvature=i.curvature,t.dashLength=0,t.gapLength=0,t.hasHead=!1,t.hasTail=!1,t.isSelfLoop=i.isSelfLoop,t.isText=!1,t.adjustTextAngle=e.adjustAngle}function Id(t,e,i,r,n,o){!function(t,e,i,r){if(Ld(i.body,r,Sd),i.halo.body){var n=e.halo.width.get(t),o=+("scaled"===e.halo.scalingMethod.get(t));r.halo.widthScaled=n*o,r.halo.widthFixed=n*(1-o),Ld(i.halo,r,Td)}i.outline.body&&(r.outline.color=e.outline.color.get(t),r.outline.minVisibleSize=e.outline.minVisibleSize.get(t),Ld(i.outline,r,Cd))}(i,r,n,o),Nd(t,e,i,r.text,n.texts.primary,o.texts.primary,o),Nd(t,e,i,r.text.secondary,n.texts.secondary,o.texts.secondary,o)}function Ld(t,e,i){i(t.body,e,jr,e.shape.type),t.head&&i(t.head,e,Gr,e.shape.head),t.tail&&i(t.tail,e,Hr,e.shape.tail)}function Nd(t,e,i,r,n,o,s){if(n.text){var a=r,u=a.scaling.get(i);if(o.font=e.fontManager.getFont(a.font.get(i)),o.color=zl(a.color.get(i),s.color),o.style=a.style.get(i),o.minVisibleSize=a.minVisibleSize.get(i),o.margin=a.margin.get(i),o.padding=a.padding.get(i),o.maxLineLength=a.maxLineLength.get(i),o.content=ys(o.content,o.maxLineLength),o.adjustAngle=a.adjustAngle.get(i),o.align=a.align.get(i),u){var l=a.scale.get(i);o.sizeScaled=s.widthScaled*l,o.sizeFixed=s.widthFixed*l}else o.sizeFixed=a.size.get(i),o.sizeScaled=0;var d=t.measureText(o.content,o.font,o.style);o.widthScaled=d.width*o.sizeScaled,o.widthFixed=d.width*o.sizeFixed,o.heightScaled=d.height*o.sizeScaled,o.heightFixed=d.height*o.sizeFixed,o.offsetAngle=o===s.texts.primary?la:da,Md(f=n.text,g=o,s),f.pattern.type=Ur,f.pattern.attributes.text=g.content,f.pattern.attributes.size=mi,f.pattern.attributes.font=g.font,f.pattern.attributes.style=g.style,f.pattern.attributes.align=g.align,f.patternColor=g.color,f.patternScale=1,f.thicknessOrFontSizeScaled=g.sizeScaled,f.thicknessOrFontSizeFixed=g.sizeFixed,f.isText=!0,n.background&&(Md(h=n.background,c=o,s),h.fillColor=c.backgroundColor)}var h,c,f,g}var Od=Bl(zd,"start"),kd=Bl(zd,"end"),Fd=Ul(zd),Rd=(Pd.prototype.drawEdge=function(t){if(this._computeBlockIds(t),this._attributes.excluded.get(t))return this._freeBlocks();var e=this._engine,i=this._helper,r=-t,n=Zl(this._attributes.layer.get(t),this._depthInfo),o=this._attributes,s=o.source.get(t),a=o.target.get(t),u=o.curvature.get(t),l=this._attributesPrev.curvature.get(t),d=o.animationDuration.get(t),h=o.animationStart.get(t),c=o.animationEasing.get(t),f=0<d,g=0!==u||f&&0!==l;this._prepareBlocks(f,n,r,g);var p=this._extremitiesAttributes={source:this._nodeAttributes,target:this._nodeAttributes};if(_d(i,this._endInput,o,t,p,this._view),bd(this._endFlags,this._endInput),f){var _=0<this._nodeAttributes.animationDuration.get(s),v=0<this._nodeAttributes.animationDuration.get(a);p.source=_?this._nodeAttributesPrev:this._nodeAttributes,p.target=v?this._nodeAttributesPrev:this._nodeAttributes,_d(i,this._startInput,this._attributesPrev,t,p,this._view),bd(this._startFlags,this._startInput),Fd(this._endFlags,this._startFlags)}this._initComponents(this._fullComponents,this._endFlags,this._blocks),kd(this._fullComponents,this._endComponents),Id(e,i,t,this._attributes,this._endComponents,this._endInput),f&&(Od(this._fullComponents,this._startComponents),Id(e,i,t,this._attributesPrev,this._startComponents,this._startInput),this._setBlocksAnimation(d,h,c)),this._setupHaloMasking(s,a),this._storeBlocks()},Pd.prototype._setupHaloMasking=function(t,e){var i=this._nodeAttributes.halo,r=this._blocks,n=i.color.get(t)&&i.hideNonAdjacentEdges.get(t),o=i.color.get(e)&&i.hideNonAdjacentEdges.get(e),s=n||o?1:3;r.body.setStencilUsage(s),r.text.setStencilUsage(s),r.textBg.setStencilUsage(s)},Pd.prototype._computeBlockIds=function(t){var e=10*t,i=this._blockIds;i.body=5+e,i.halo=8+e,i.text=6+e,i.textBg=7+e},Pd.prototype._prepareBlocks=function(t,e,i,r){var n=this._blocks;n.body.reset(r?3:1,t,e.edgeBody,i),n.halo.reset(r?3:1,t,e.edgeHalo,i),n.text.reset(2,t,e.edgeText,i),n.textBg.reset(1,t,e.edgeTextBackground,i)},Pd.prototype._storeBlocks=function(){var t=this._engine,e=this._blocks,i=this._blockIds;t.storeBlock(i.body,e.body),t.storeBlock(i.halo,e.halo),t.storeBlock(i.text,e.text),t.storeBlock(i.textBg,e.textBg)},Pd.prototype._freeBlocks=function(){var t=this._engine,e=this._blockIds;t.freeBlock(e.body),t.freeBlock(e.halo),t.freeBlock(e.text),t.freeBlock(e.textBg)},Pd.prototype._setBlocksAnimation=function(t,e,i){var r=this._blocks;r.body.setGlobalAnimation(t,e,i),r.halo.setGlobalAnimation(t,e,i),r.text.setGlobalAnimation(t,e,i),r.textBg.setGlobalAnimation(t,e,i)},Pd.prototype._initComponents=function(t,e,i){this._initEdgeComponents(t.halo,e.halo,i.halo),this._initEdgeComponents(t.outline,e.outline,i.body),this._initEdgeComponents(t.body,e.body,i.body),this._initTextComponents(t.texts.primary,e.texts.primary,i),this._initTextComponents(t.texts.secondary,e.texts.secondary,i)},Pd.prototype._initEdgeComponents=function(t,e,i){t.head=this._nextElement(e.head,i),t.tail=this._nextElement(e.tail,i),t.body=this._nextElement(e.body,i)},Pd.prototype._initTextComponents=function(t,e,i){t.background=this._nextElement(e.background,i.textBg),t.text=this._nextElement(e.text,i.text)},Pd.prototype._nextElement=function(t,e){return t?e.next():this._nullElt},Pd);function Pd(t){var e=t.engine,i=t.imageManager,r=t.fontManager,n=t.formatText,o=t.view,s=t.attributes,a=t.attributesPrev,u=t.nodeAttributes,l=t.nodeAttributesPrev;this._fullComponents=zd(),this._startComponents=zd(),this._endComponents=zd(),this._startFlags=zd(),this._endFlags=zd(),this._startInput=yd(),this._endInput=yd(),this._depthInfo=Yl(),this._nullElt={id:-1,valid:!0},this._engine=e,this._view=o,this._helper={imageManager:i,fontManager:r,formatText:n},this._attributes=s,this._attributesPrev=a,this._nodeAttributes=u,this._nodeAttributesPrev=l,this._blocks=Dd(function(){return e.createBlock()}),this._blockIds=Dd(function(){return 0})}function Dd(t){return{body:t(),halo:t(),text:t(),textBg:t()}}function zd(){return{halo:{body:void 0,head:void 0,tail:void 0},outline:{body:void 0,head:void 0,tail:void 0},body:{body:void 0,head:void 0,tail:void 0},texts:{primary:{text:void 0,background:void 0},secondary:{text:void 0,background:void 0}}}}function Bd(t){var e,i,r,n,o,s=t.graph,a=t.elements,u=t.engine,l=t.imageManager,d=t.fontManager,h=t.view,c=t.attributes,f=t.boundaries,g=t.formatText,p=(i=tt((e=c).nodes.current,{text:{secondary:{scaling:e.nodes.current.text.scaling,maxLineLength:e.nodes.current.text.maxLineLength}}}),r=tt(e.nodes.previous,{textHidden:i.textHidden,text:{secondary:{scaling:e.nodes.previous.text.scaling,maxLineLength:e.nodes.previous.text.maxLineLength}}}),n=tt(e.edges.current,{text:{secondary:{scaling:e.edges.current.text.scaling,maxLineLength:e.edges.current.text.maxLineLength,adjustAngle:e.edges.current.text.adjustAngle}}}),o=tt(e.edges.previous,{source:e.edges.current.source,target:e.edges.current.target,textHidden:e.edges.current.textHidden,text:{secondary:{scaling:e.edges.previous.text.scaling,maxLineLength:e.edges.previous.text.maxLineLength,adjustAngle:e.edges.previous.text.adjustAngle}}}),{nodeAttributes:i,nodeAttributesPrev:r,edgeAttributes:n,edgeAttributesPrev:o}),_=p.nodeAttributes,v=p.nodeAttributesPrev,m=p.edgeAttributes,y=p.edgeAttributesPrev,x=a.nodes,b=a.edges,E=f.maxSize,A=f.maxMinVisibleSize;if(x.size||b.size){var S=10*(Math.max(s.getNodeMaxIndex(),s.getEdgeMaxIndex())+1),w=u.setGlobalBoundaries({maxBlockId:qe(S),maxScaledSize:qe(8*E),maxMinVisibleSize:qe(A),maxSymbolicSize:qe(E),maxDashLength:3,maxGapLength:1,maxPatternScale:2,maxCoord:-1/0}),T=(w?s.getNodes("_all"):x)._indexes,C=(w?s.getEdges("_all"):b)._indexes;if(T.length)for(var M=new ud({engine:u,imageManager:l,fontManager:d,formatText:g,attributes:_,attributesPrev:v}),I=0;I<T.length;++I)M.drawNode(T[I]);if(C.length){var L=new Rd({engine:u,imageManager:l,fontManager:d,formatText:g,view:h,attributes:m,attributesPrev:y,nodeAttributes:_,nodeAttributesPrev:v});for(I=0;I<C.length;++I)L.drawEdge(C[I])}}}var Ud=pt&&document.fonts,Vd="/qwerty/ [HELLO] ",jd=(Gd.prototype._measureText=function(t,e){return this._ctx.font="12px "+e,this._ctx.measureText(t).width},Gd.prototype.check=function(t){if(this._checkReliable)return this._fontFaceSet.check("12px "+t);var e=this._measureText(Vd,"serif");return this._measureText(Vd,t)!==e},Gd.prototype.load=function(t){return this._fontFaceSet&&this._fontFaceSet.load?this._fontFaceSet.load("12px "+t):(this._ctx.font="12px "+t,this._ctx.fillText(Vd,10,50),Promise.resolve())},Gd);function Gd(){this._fontFaceSet=Ud?document.fonts:null,this._canvas=bn(),this._ctx=this._canvas.getContext("2d"),this._checkReliable=!0===(this._fontFaceSet&&this._fontFaceSet.check&&!this._fontFaceSet.check("12px FontThatDoesNotExist")),this._ctx=this._canvas.getContext("2d")}var Hd=(Wd.prototype._setLoaded=function(){this._loaded=!0,this._value=this._fontName},Wd.prototype.getValue=function(){return this._value},Wd.prototype.isLoaded=function(){return this._loaded},Wd.prototype.destroy=function(){clearTimeout(this._timeout)},Wd.prototype.load=function(){var t=this;return this._tryLoad(200).then(function(){t._setLoaded()})},Wd.prototype._tryLoad=function(e){var i=this;return this._fontFaceSet.load(this._fontName).then(function(){if(!i._fontFaceSet.check(i._fontName)&&i._fontLoaderCounter<16)return new Promise(function(t){e<6e4&&(i._timeout=setTimeout(t,e))}).then(function(){return i._fontLoaderCounter++,i._tryLoad(1.5*e)})})},Wd);function Wd(t,e){this._fontLoaderCounter=0,this._loaded=!1,this._value=null,this._timeout=0,this._fontFaceSet=t,this._fontName=e,this._loaded=!1,this._value=null,this._timeout=0,pt&&!this._fontFaceSet.check(this._fontName)||this._setLoaded()}var qd=(Xd.prototype.setHideUntilFontsLoaded=function(value){this._hideUntilFontsLoaded=value},Xd.prototype.getFont=function(t){var e=this,i=this._fonts[t];return i||(i=new Hd(this._fontFaceSet,t),(this._fonts[t]=i).isLoaded()||i.load().then(function(){return e._triggerFontLoaded(t)})),!this._hideUntilFontsLoaded&&t||i.getValue()},Xd.prototype.onFontLoaded=function(t){this._onFontLoaded.push(t)},Xd.prototype.destroy=function(){var e=this;this._onFontLoaded=[],Object.keys(this._fonts).forEach(function(t){return e._fonts[t].destroy()})},Xd.prototype._triggerFontLoaded=function(e){this._onFontLoaded.forEach(function(t){return t(e)})},Xd);function Xd(){this._fontFaceSet=new jd,this._fonts={},this._onFontLoaded=[],this._hideUntilFontsLoaded=!0}function Yd(t,e,i){for(var r=i.length,n=r-1,o=!1,s=0;s<r;++s)(i[s].y<e&&i[n].y>=e||i[n].y<e&&i[s].y>=e)&&(i[s].x<=t||i[n].x<=t)&&(o=o!==i[s].x+(e-i[s].y)/(i[n].y-i[s].y)*(i[n].x-i[s].x)<t),n=s;return o}function Zd(t){var e=t.x*t.x+t.y*t.y;return{x:t.x/e,y:t.y/e}}function Kd(t,e){for(var i=1/0,r=-1/0,n=0,o=t.length;n<o;n++){var s=t[n],a=s.x*e.x+s.y*e.y;a<i&&(i=a),r<a&&(r=a)}return{x:i,y:r}}function Qd(t,e){for(var i=function(t,e){var i=t[1],r=t[0],n=Zd({x:i.x-r.x,y:i.y-r.y}),o=n.x;n.x=-n.y,n.y=o;var s=n;i=t[2],r=t[1],o=(n=Zd({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o;var a=n;i=e[1],r=e[0],o=(n=Zd({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o;var u=n;return i=e[2],r=e[1],o=(n=Zd({x:i.x-r.x,y:i.y-r.y})).x,n.x=-n.y,n.y=o,[s,a,u,n]}(t,e),r=0,n=i.length;r<n;r++){var o=i[r],s=Kd(t,o),a=Kd(e,o);if(0==(s.x<=a.y&&s.y>=a.x?Math.min(s.y,a.y)-Math.max(s.x,a.x):0))return!1}return!0}function Jd(t){var e=0,i=0,r=t.length;if(0===r)throw new Error("Compute centroid: at least one point is required");for(var n=0;n<r;++n){var o=t[n];e+=o.x,i+=o.y}return{x:e/=r,y:i/=r}}var $d=hh(4),th=hh(5),eh=hh(10,.4),ih=1/3,rh=[{x:-.6,y:-.3},{x:.1,y:0},{x:-.6,y:.3}],nh={circle:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.sqrt(t*t+e*e)},points:[{x:0,y:0,r:1}],isSimple:!0},square:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:1,y:-1},{x:1,y:1},{x:-1,y:1}],isSimple:!0},line:{getDistanceFromStrokeVertically:function(t,e){return 1-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:0},{x:1,y:0}],isSimple:!0},triangle:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},arrow:{getDistanceFromStrokeVertically:function(t,e){return(1-t)/2-Math.abs(e)},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],isSimple:!0},"circle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){return Math.min(Math.sqrt((t+.4)*(t+.4)+e*e)-.27,(1-t)/2-Math.abs(e))},getDistanceFromStrokeHorizontally:function(t,e){return 1-Math.abs(t)},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:[{x:-.4,y:0,r:.3}],isSimple:!0},"triangle-hole-arrow":{getDistanceFromStrokeVertically:function(t,e){var i=Math.min((1-t)/2-Math.abs(e),1-Math.abs(t)),r=-dh(t,e,rh);return Math.min(i,r)},getDistanceFromStrokeHorizontally:function(t,e){return 1},points:[{x:-1,y:-1},{x:-1,y:1},{x:1,y:0}],hole:rh,isSimple:!0},"short-arrow":ch([{x:-1,y:-ih},{x:0,y:-ih},{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:0,y:ih},{x:-1,y:ih}],!1),"sharp-arrow":ch([{x:-1,y:-ih},{x:-.55,y:-ih},{x:-1,y:-1},{x:1,y:0},{x:-1,y:1},{x:-.55,y:ih},{x:-1,y:ih}],!1),cross:{getDistanceFromStrokeVertically:function(t,e){return 1},getDistanceFromStrokeHorizontally:function(t,e){var i=Math.abs(t),r=Math.abs(e),n=.31-Math.min(i,r),o=1-Math.max(i,r);return Math.min(n,o)},points:[{x:-1,y:.31},{x:-1,y:-.31},{x:-.31,y:-.31},{x:-.31,y:-1},{x:.31,y:-1},{x:.31,y:-.31},{x:1,y:-.31},{x:1,y:.31},{x:.31,y:.31},{x:.31,y:1},{x:-.31,y:1},{x:-.31,y:.31}],isSimple:!1},diamond:ch($d),pentagon:ch(th),star:ch(eh)},oh=["circle","square","triangle","line"],sh=["cross","diamond","pentagon","star"],ah=["arrow","triangle-hole-arrow","circle-hole-arrow","short-arrow","sharp-arrow"];function uh(t,e){for(var i=0,r=oh;i<r.length;i++){lh(t,r[i])}for(var n=e.nodes.current.shape.getValues(),o=e.edges.current.shape.head.getValues(),s=e.edges.current.shape.tail.getValues(),a=0,u=sh;a<u.length;a++){var l=u[a];n.includes(l)&&lh(t,l)}for(var d=0,h=ah;d<h.length;d++){var c=h[d];c&&(o.includes(c)||s.includes(c))&&lh(t,c)}}function lh(t,e){t.registerShape(e,nh[e])}function dh(t,e,i){for(var r=1/0,n={x:t,y:e},o=0;o<i.length;++o){var s=i[o],a=i[(o+1)%i.length];r=Math.min(r,yu(n,s,a))}return r*(Yd(t,e,i)?1:-1)}function hh(t,e){void 0===e&&(e=1);for(var i=-Math.PI/2+1e-6,r=[],n=2*Math.PI/t,o=i,s=0;s<t;++s){var a=s%2==1?e:1;r.push({x:Math.cos(o)*a,y:Math.sin(o)*a}),o+=n}return r}function ch(i,t){return void 0===t&&(t=!1),{getDistanceFromStrokeVertically:function(){return 1},getDistanceFromStrokeHorizontally:function(t,e){return dh(t,e,i)},points:i,isSimple:t}}function fh(t){var e=t.graphWidth,i=t.graphHeight,r=t.viewWidth,n=t.viewHeight;return.2*Math.min(r/e,n/i)}function gh(t){var e=t.smallestNodeSize,i=t.viewWidth,r=t.viewHeight;return e===1/0?1/0:Math.min(i,r)/e*.5}var ph,_h;(_h=ph=ph||{}).ROTATION="rotation",_h.PAN="pan",_h.ZOOM="zoom",_h.GESTURE="gesture";var vh,mh=(x(yh,vh=Ae),yh.prototype._setupInteractions=function(){var a=this;this._interactions.onMouseWheel({priority:"zoom",check:function(){return!!a._settings.get("interactions.zoom.enabled")},handler:P(function(t){var e=t.x,i=t.y,r=t.delta;return a._smoothZoom(r,e,i)},50)}),this._interactions.onDoubleClick({priority:"zoom",check:function(){var t=a._settings.get("interactions.zoom.enabled"),e=a._settings.get("interactions.zoom.onDoubleClick");return!(!t||!e)},handler:function(t){var e=t.x,i=t.y;return a._smoothZoom(1,e,i)}}),this._interactions.onDrag({priority:"panning",disableDetection:!0,check:function(t){var e=t.button,i=!!a._settings.get("interactions.pan.enabled");return"left"===e&&i},onStart:function(){return a._updateVisibility(ph.PAN,!0)},onProgress:function(t){var e=t.dx,i=t.dy;return a._camera.move({x:-e,y:-i})},onStop:function(){return a._updateVisibility(ph.PAN,!1)}}),this._interactions.onDrag({priority:"rotation",disableDetection:!0,check:function(t){var e=t.button,i=t.domEvent;return("right"===e||i&&2===i.buttons)&&!!a._settings.get("interactions.rotation.enabled")},onStart:function(t){var e=t.x,i=t.y;a._rotationStart={x:e,y:i},a._updateVisibility(ph.ROTATION,!0)},onProgress:function(t){var e=t.x,i=t.y;return a._rotate({x:e,y:i})},onStop:function(){return a._updateVisibility(ph.ROTATION,!1)}}),this._interactions.onGesture({priority:"gesture",disableDetection:!0,check:function(){return!!a._settings.get("interactions.gesture.enabled")},onStart:function(){return a._updateVisibility(ph.GESTURE,!0)},onProgress:function(t){var e=t.dx,i=t.dy,r=t.rotation,n=t.scale,o=t.x,s=t.y;a._settings.get("interactions.rotation.enabled")&&a._camera.rotate(-r),a._camera.zoomIn(n,void 0,{refX:o,refY:s}),a._camera.move({x:-e,y:-i})},onStop:function(){return a._updateVisibility(ph.GESTURE,!0)}})},yh.prototype._rotate=function(t){var e=t.x,i=t.y,r=this._camera.getSize(),n=r.width/2,o=r.height/2,s=this._rotationStart.x-n,a=this._rotationStart.y-o,u=e-n,l=i-o,d=Math.atan2(a,s)-Math.atan2(l,u);this._rotationStart.x=e,this._rotationStart.y=i,this._camera.rotate(d)},yh.prototype._updateVisibility=function(t,e){var value=!e,i=this._settings,r=i.get("interactions."+t+".hideNodes"),n=i.get("interactions."+t+".hideEdges"),o=i.get("interactions."+t+".hideNodeTexts"),s=i.get("interactions."+t+".hideEdgeTexts");r&&this._graphics.setNodesVisibility(value),o&&this._graphics.setNodeTextsVisibility(value),n&&this._graphics.setEdgesVisibility(value),s&&this._graphics.setEdgeTextsVisibility(value)},yh.prototype._smoothZoom=function(t,e,i){var r=this,n=this._settings,o=n.get("interactions.zoom.modifier")||1.8,s=n.get("interactions.zoom.duration"),a=n.get("interactions.zoom.easing"),u=this._camera.getZoom()*(0<t?o:1/o),l={duration:s,easing:a};this._zooming||(this._zooming=!0,this._updateVisibility(ph.ZOOM,!0)),this._camera.setZoom(u,l,{refX:e,refY:i}).then(function(){r._zooming&&(r._zooming=!1,r._updateVisibility(ph.ZOOM,!1))})},yh);function yh(t,e){t.locate,t.dom;var i=t.camera,r=t.graphics,n=t.settings,o=t.interactions,s=vh.call(this)||this;return s._zooming=!1,s._camera=i,s._settings=n,s._interactions=o,s._graphics=r,n.register("interactions.zoom.enabled",!0),n.register("interactions.zoom.onDoubleClick",!1),n.register("interactions.zoom.duration",150),n.register("interactions.zoom.modifier",1.8),n.register("interactions.zoom.easing","quadraticOut"),n.register("interactions.zoom.minValue",e?null:fh),n.register("interactions.zoom.maxValue",e?null:gh),n.register("interactions.zoom.hideNodes",!1),n.register("interactions.zoom.hideEdges",!1),n.register("interactions.zoom.hideNodeTexts",!1),n.register("interactions.zoom.hideEdgeTexts",!1),n.register("interactions.pan.enabled",!0),n.register("interactions.pan.hideNodes",!1),n.register("interactions.pan.hideEdges",!1),n.register("interactions.pan.hideNodeTexts",!1),n.register("interactions.pan.hideEdgeTexts",!1),n.register("interactions.rotation.enabled",!0),n.register("interactions.rotation.hideNodes",!1),n.register("interactions.rotation.hideEdges",!1),n.register("interactions.rotation.hideNodeTexts",!1),n.register("interactions.rotation.hideEdgeTexts",!1),n.register("interactions.gesture.enabled",!0),n.register("interactions.gesture.hideNodes",!1),n.register("interactions.gesture.hideEdges",!1),n.register("interactions.gesture.hideNodeTexts",!1),n.register("interactions.gesture.hideEdgeTexts",!1),s._setupInteractions(),s}var xh,bh;(bh=xh=xh||{}).ZOOM="zoom",bh.ROTATE="rotate";var Eh={duration:0,easing:"linear",startAfter:0,ignoreZoomLimits:!(bh.PAN="pan"),callback:function(){}};function Ah(t){return Math.abs(t)<1e-9}var Sh,wh=(x(Th,Sh=Ae),Object.defineProperty(Th.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(Th.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(Th.prototype,"zoom",{get:function(){return this._zoom},enumerable:!0,configurable:!0}),Object.defineProperty(Th.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(Th.prototype,"width",{get:function(){return this._dimensions.width},enumerable:!0,configurable:!0}),Object.defineProperty(Th.prototype,"height",{get:function(){return this._dimensions.height},enumerable:!0,configurable:!0}),Th.prototype.moveEnd=function(t){var e=this;this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){e._timeout=0,e._events.fire(be.VIEW_CHANGED,{type:t})},80)},Th.prototype.getSize=function(){return{width:this._dimensions.width,height:this._dimensions.height}},Th.prototype.getCenter=function(){return{x:this._x,y:this._y}},Th.prototype.setCenter=function(t,e){var i=this,r=t.x,n=t.y,o=I(I({},Eh),e),s=this._x,a=this._y,u=r-this._x,l=n-this._y;return Ah(u)&&Ah(l)?Promise.resolve():new Promise(function(t){o.callback=function(){i.moveEnd(xh.PAN),t()},i._moveAnimation&&i._animations.end(i._moveAnimation,!1);var e=i._animations.play(function(t){i._x=s+u*t,i._y=a+l*t,i._events.fire(be.CAMERA_MOVE),i._events.fire(be.CAMERA_PAN)},o);e&&(i._moveAnimation=e)})},Th.prototype.move=function(t,e){var i=Ch({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle);return this.setCenter({x:this._x+i.x,y:this._y+i.y},e)},Th.prototype.getZoom=function(){return this._zoom},Th.prototype.setZoom=function(t,c,e){var f=this;void 0===e&&(e={refX:void 0,refY:void 0});var g=I(I({},Eh),c),p=e.refX,_=e.refY,v=Ye(t,this._minZoom,this._maxZoom);return g.ignoreZoomLimits||(v=this._applyZoomLimits(v)),Ah(this._zoom-v)?Promise.resolve():new Promise(function(t){var e=f._dimensions.width/2,i=f._dimensions.height/2,r=f._zoom,n=e/r-e/v;if(g.callback=function(){f.moveEnd(xh.ZOOM),t()},void 0!==p&&void 0!==_){var o=(p-e)/r-(p-e)/v,s=(_-i)/r-(_-i)/v,a=f._cosAngle,u=f._sinAngle,l=a*o-u*s,d=u*o+a*s;f.setCenter({x:f._x+l,y:f._y+d},c)}f._zoomAnimation&&f._animations.end(f._zoomAnimation,!1),f._dom.setTimeout(function(){f._events.fire(be.START_ZOOM,{duration:g.duration,easing:g.easing,startZoom:r,endZoom:v})});var h=f._animations.play(function(t){f._zoom=e/(e/r-n*t),f._events.fire(be.CAMERA_MOVE),f._events.fire(be.CAMERA_ZOOM)},g);h&&(f._zoomAnimation=h)})},Th.prototype._applyZoomLimits=function(t){var e=this._settings.get("interactions.zoom.minValue"),i=this._settings.get("interactions.zoom.maxValue"),r=this._modules.locate.getGraphBoundingBox(),n=r.minScaledSize,o=r.maxScaledSize,s=r.width,a=r.height,u=r.cx,l=this._zoom,d=this.getSize(),h=t;if(!isNaN(u)){var c={smallestNodeSize:n,biggestNodeSize:o,graphWidth:s+o,graphHeight:a+o,viewWidth:d.width,viewHeight:d.height},f=e&&e(c),g=i&&i(c);Mh(f)&&h<f?h<l&&(h=Math.min(l,f)):Mh(g)&&g<h&&l<h&&(h=Math.max(l,g))}return h},Th.prototype.zoomIn=function(t,e,i){void 0===i&&(i={refX:void 0,refY:void 0});var r=1;return r="number"!=typeof t?(i=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom*r,e,i)},Th.prototype.zoomOut=function(t,e,i){void 0===i&&(i={refX:void 0,refY:void 0});var r=1;return r="number"!=typeof t?(i=e,e=t,this._settings.get("interactions.zoom.modifier")||1.8):t,this.setZoom(this._zoom/r,e,i)},Th.prototype.getAngle=function(){return this._angle},Th.prototype.setAngle=function(t,e){var i=this,r=I(I({},Eh),e),n=this._angle,o=t-n;return Ah(o)?Promise.resolve():new Promise(function(t){r.callback=function(){i.moveEnd(xh.ROTATE),t()},i._rotateAnimation&&i._animations.end(i._rotateAnimation,!1);var e=i._animations.play(function(t){for(i._angle=n+o*t;i._angle>Math.PI;)i._angle-=2*Math.PI;for(;i._angle<-Math.PI;)i._angle+=2*Math.PI;i._sinAngle=Math.sin(i._angle),i._cosAngle=Math.cos(i._angle),i._events.fire(be.CAMERA_MOVE),i._events.fire(be.CAMERA_ROTATE)},r);e&&(i._rotateAnimation=e)})},Th.prototype.rotate=function(t,e){return this.setAngle(this._angle+t,e)},Th.prototype.getScreenCenter=function(){return{x:this._dimensions.width/2,y:this._dimensions.height/2}},Th.prototype.graphToScreenCoordinates=function(t,e){var i=t.x,r=t.y;void 0===e&&(e={x:0,y:0});var n=this._dimensions.width/2,o=this._dimensions.height/2;return Ca((i-this._x)*this._zoom+n,(r-this._y)*this._zoom+o,n,o,-this._angle,e)},Th.prototype.screenToGraphCoordinates=function(t,e){var i=t.x,r=t.y;return void 0===e&&(e={x:0,y:0}),Ca(this._x+(i-this._dimensions.width/2)/this._zoom,this._y+(r-this._dimensions.height/2)/this._zoom,this._x,this._y,this._angle,e)},Th.prototype.projectBounds=function(t,e){void 0===e&&(e=t);for(var i=t[0],r=t[1],n=t[2],o=t[3],s=this._x,a=this._y,u=this._dimensions.width/2,l=this._dimensions.height/2,d=this._sinAngle,h=this._cosAngle,c=1/this._zoom,f=1/0,g=1/0,p=-1/0,_=-1/0,v=[i,r,i,o,n,o,n,r],m=0;m<v.length;m+=2){var y=v[m],x=v[m+1],b=(y=s+(y-u)*c)-s,E=(x=a+(x-l)*c)-a;(y=h*b-d*E+s)<f&&(f=y),p<y&&(p=y),(x=d*b+h*E+a)<g&&(g=x),_<x&&(_=x)}return e[0]=f,e[1]=g,e[2]=p,e[3]=_,e},Th.prototype.screenToGraphVector=function(t){return Ch({x:t.x,y:t.y},this._zoom,this._sinAngle,this._cosAngle)},Th.prototype.getView=function(){return{x:this._x,y:this._y,zoom:this._zoom,angle:this._angle,width:this._dimensions.width,height:this._dimensions.height}},Th.prototype.setView=function(t,e){var i=I({x:this._x,y:this._y,zoom:this._zoom,angle:this._angle},t),r=i.x,n=i.y,o=i.zoom,s=i.angle;return Promise.all([this.setCenter({x:r,y:n},e),this.setZoom(o,e),this.setAngle(s,e)]).then(function(){})},Th.prototype._reloadDimensions=function(){this._dimensions=this._dom.getDimensions()},Th.prototype.animationInProgress=function(){var t=this._moveAnimation,e=this._zoomAnimation;return t&&!t.done||e&&!e.done},Th.prototype.getProjectedScreenBounds=function(t){void 0===t&&(t=0);var e=this._dimensions,i=e.width,r=e.height,n=Math.max(i,r)*t;return this.projectBounds([0-n,0-n,i+n,r+n])},Th.prototype._reset=function(){this._zoom=1,this._x=0,this._y=0,this._angle=0,this._sinAngle=0,this._cosAngle=1,this._dimensions=this._dom.getDimensions()},Th);function Th(t){var e,i=Sh.call(this)||this;i._minZoom=1e-8,i._maxZoom=1e8,i._timeout=0;var r=t.events,n=t.settings;return i._modules=t,i._events=r,i._dom=t.dom,i._animations=t.animations,i._settings=n,i._reset(),n.register("minZoom",1e-8,function(t){i._minZoom=t,i._zoom<t&&(i._zoom=t,i._events.fire(be.CAMERA_MOVE))}),n.register("maxZoom",1e8,function(t){i._maxZoom=t,i._zoom>t&&(i._zoom=t,i._events.fire(be.CAMERA_MOVE))}),r.on(((e={})[be.SET_CONTAINER]=function(){i._reset(),i._events.fire(be.CAMERA_MOVE)},e[be.RESIZE]=function(){i._reloadDimensions(),i._events.fire(be.CAMERA_MOVE)},e)),i}function Ch(t,e,i,r){var n=t.x,o=t.y;return{x:r*(n/=e)-i*(o/=e),y:i*n+r*o}}function Mh(value){return"number"==typeof value&&isFinite(value)}function Ih(){}var Lh,Nh={maxBlockId:1024,maxCoord:-1/0,maxScaledSize:16,maxPixelSize:255,maxMinVisibleSize:64,maxDashOffset:4,maxDashLength:3,maxGapLength:1,maxSymbolicSize:0,maxPatternScale:0},Oh=gt?"webgl":null,kh=(x(Fh,Lh=Ae),Fh.prototype.onMounted=function(t,e){var i=this;void 0!==e.renderer&&t.setOptions({renderer:e.renderer}),void 0!==e.imgCrossOrigin&&t.setOptions({imgCrossOrigin:e.imgCrossOrigin}),this._dom.addWindowEventListener("unload",function(){i.destroy()})},Fh.prototype.getTransparentBackgroundColor=function(){var t=this._settings.get("backgroundColor");return t?this._engine.transparentify(t):null},Fh.prototype._render=function(){var t=this._dom.getDimensions(),e=this._camera.getView(),i=wt(),r=Kt(),n=this._settings.get("backgroundColor"),o=this._isBufferDisplayable;this._engine.setView({x:e.x,y:e.y,zoom:e.zoom,angle:e.angle,width:t.width,height:t.height,pixelRatio:i,currentTime:r,backgroundColor:n,isBufferDisplayable:o});try{this._engine.render(),"requested"===this._rendererState.state&&this._updateRendererState({state:"ok"})}catch(t){if(this._debug)throw t;var s=t.message,a=t.code,u=void 0===a?"OTHER":a,l=this._rendererState.type,d=function(t){return null===t?"none":"webgl"===t?"WebGL":"svg"===t?"SVG":"canvas"===t?"Canvas":t}(l),h="requested"===this._rendererState.state?"Error while initializing the "+d+" renderer":"The "+d+" renderer encountered an unexpected runtime error",c=null;"webgl"===l&&(h+="; fallbacking on canvas renderer",c="canvas"),Ci(s||""),Ci(h),this._updateRendererState({state:"error",code:u,message:s}),this._settings.set("renderer",c)}},Fh.prototype._fireRendererStateChangeEvent=function(){var t=this._rendererState;this._events.fire(be.RENDERER_STATE_CHANGE,{type:t.type,state:t.state,code:t.code,message:t.message})},Fh.prototype._updateRendererState=function(t){var e=t.type,i=t.state,r=t.code,n=t.message,o=!1;void 0!==e&&this._rendererState.type!==e&&(this._rendererState.type=e,o=!0),void 0!==i&&this._rendererState.state!==i&&(this._rendererState.state=i,o=!0),void 0!==r&&this._rendererState.code!==r&&(this._rendererState.code=r,o=!0),void 0!==n&&this._rendererState.message!==n&&(this._rendererState.message=n,o=!0),o&&this._initDone&&this._fireRendererStateChangeEvent()},Fh.prototype.getImageData=function(){var t=this;return this._dom.afterNextFrame().then(function(){return t._engine.getImageData()})},Fh.prototype.addCanvas=function(t){this._engine.addCanvas(t)},Fh.prototype.removeCanvas=function(t){this._engine.removeCanvas(t)},Fh.prototype.getNodeAttributes=function(){return this._attributesManager.getFlexArrays().nodes.current},Fh.prototype.getEdgeAttributes=function(){return this._attributesManager.getFlexArrays().edges.current},Fh.prototype.getGraphicsEngine=function(){return this._engine},Fh.prototype.getImageManager=function(){return this._imageManager},Fh.prototype.getFontManager=function(){return this._fontManager},Fh.prototype.allocateGraphicsEngineBlockId=function(){return this._availableGeIndexes.length?this._availableGeIndexes.pop():10*this._nextGeIndex+++9},Fh.prototype.releaseGraphicsEngineBlockId=function(t){this._engine.freeBlock(t),this._availableGeIndexes.push(t),this._dom.refresh()},Fh.prototype.addCursorStyle=function(t){t&&(this._cursorStyle.push(t),this._applyCursorStyle())},Fh.prototype.removeCursorStyle=function(t){if(t){var e=this._cursorStyle.lastIndexOf(t);-1!==e&&(this._cursorStyle.splice(e,1),this._applyCursorStyle())}},Fh.prototype.reloadFonts=function(){this._events.fire(be.RELOAD_FONTS),this._engine.notifyFontsReloaded(),this._dom.refresh()},Fh.prototype.getDomElement=function(){return this._domElement},Fh.prototype.setTextHidden=function(t,e){this._attributesManager.setTextHidden(t,e)},Fh.prototype.resetTextHidden=function(){this._attributesManager.resetTextHidden(),this._dom.refresh()},Fh.prototype.getAttributesManager=function(){return this._attributesManager},Fh.prototype._checkFontsNewlyLoaded=function(){return!!this._fontsNewlyLoaded.length&&(this._fontsNewlyLoaded=[],!0)},Fh.prototype._loadGraphInGraphicsEngine=function(){this._attributesManager.update(),this._checkFontsNewlyLoaded()&&this._attributesManager.redrawAll();var t=this._attributesManager.getAndResetElementsToRedraw(),e=this._attributesManager.getAndResetElementsUpdated(),i=0<e.nodes.size||0<e.edges.size;(e.nodeAttributesSet.has("radius")||e.edgeAttributes.includes("width"))&&(this._boundaries.maxSize=function(t){for(var e=t.getNodeAttribute("radius"),i=t.getEdgeAttribute("width"),r=t.getNodes(),n=t.getEdges(),o=0,s=0,a=0;a<r._indexes.length;a++){var u=r._indexes[a],l=e.get(u);o<l&&(o=l)}for(a=0;a<n._indexes.length;a++){u=n._indexes[a];var d=i.get(u);s<d&&(s=d)}return Math.max(2*o,s)}(this._graph)),(e.nodeAttributesSet.has("shape")||e.edgeAttributes.includes("shape.head")||e.edgeAttributes.includes("shape.tail"))&&uh(this._engine,this._attributesManager.getFlexArrays()),Bd({graph:this._graph,elements:t,engine:this._engine,imageManager:this._imageManager,fontManager:this._fontManager,view:this._camera.getView(),attributes:this._attributesManager.getFlexArrays(),boundaries:this._boundaries,formatText:this._formatText}),i&&this._events.fire(be.UPDATE_ATTRIBUTES,e)},Fh.prototype._forceCompleteGraphRefresh=function(){this._attributesManager.redrawAll(),this._loadGraphInGraphicsEngine()},Fh.prototype.export=function(e,i,n,r){var o,s=this;return Promise.all([this._graph.getNodes().addClass(pi),this._graph.getEdges().addClass(pi)]).then(function(){return s.resolveAtNextFrame()}).then(function(){return s._imageManager.whenReady()}).then(function(){var t;return"all"===n?(t=s._graph,o={nodes:Rh(t,!0),edges:Rh(t,!1)},s._forceCompleteGraphRefresh()):s._loadGraphInGraphicsEngine(),s._engine.export(e,i,r)}).then(function(t){return Promise.all([s._graph.getNodes().removeClass(pi),s._graph.getEdges().removeClass(pi)]).then(function(){return t})}).then(function(t){var e,i,r;return"all"===n&&(i=(e=o).nodes,r=e.edges,Ph(i),Ph(r),s._forceCompleteGraphRefresh()),t})},Fh.prototype.addAttributeLayer=function(t){return this._attributesManager.addAttributeLayer(t)},Fh.prototype.createFlexArrays=function(){return this._attributesManager.createFlexArrays()},Fh.prototype.getAttributeValues=function(t,e,i,r){return this._attributesManager.getAttributeValues(t,e,i,r)},Fh.prototype.forceAttributesComputation=function(){this._attributesManager.update()},Fh.prototype.resolveAtNextFrame=function(t){return this._dom.afterNextFrame().then(function(){return t})},Fh.prototype.animate=function(t,e,i){var r=function(t){return"number"==typeof t?t={duration:t}:"object"==typeof t&&null!==t||(t={duration:0}),{duration:function(t){return"number"!=typeof t||!isFinite(t)||t<0?0:t}(t.duration),easing:t.easing||"linear",chain:!!t.chain}}(i);return r.duration&&this._engine.ensureAnimationsReady(),this._animate(t,e,r)},Fh.prototype.isAnimating=function(){return 0<this._animations.length},Fh.prototype.getAnimationInformation=function(t){return this._attributesManager.getAnimationInformation(t)},Fh.prototype._toSubGraph=function(t){if(t instanceof mr||t instanceof _r)return{nodes:t.toList(),edges:t.getAdjacentEdges()};if(t instanceof $i||t instanceof Qi)return{nodes:this._graph.nodeList(),edges:t.toList()};var e=t,i={nodes:e.nodes||this._graph.nodeList(),edges:e.edges||this._graph.edgeList()};return i.nodes.size&&(i.edges.size?i.edges=i.edges.concat(i.nodes.getAdjacentEdges()).dedupe():i.edges=i.nodes.getAdjacentEdges()),i},Fh.prototype._animate=function(e,t,i){var r=i.duration,n=i.easing;if(!this._animations.length&&!r)return t(e),Promise.resolve(e);var o=this._toSubGraph(e),s=o.nodes,a=o.edges;if(0===s.size&&0===a.size)return Promise.resolve(e);s.size&&this._events.fire(be.ANIMATE,{elements:s,duration:r,easing:n}),a.size&&this._events.fire(be.ANIMATE,{elements:a,duration:r,easing:n});for(var u={id:this._nextAnimationId++,startTime:-1,finished:!1,func:function(){return t(e)},duration:r,easing:n,nodes:s,edges:a,resolve:Ih},l=new Promise(function(t){return u.resolve=function(){return t(e)}}),d=0;d<s._indexes.length;d++)this._nodeAnimationList.set(s._indexes[d],u.id);for(d=0;d<a._indexes.length;d++)this._edgeAnimationList.set(a._indexes[d],u.id);return this._animations.push(u),this._dom.refresh(),r||this._processAnimations(),l},Fh.prototype._removeFinishedAnimations=function(){this._animations=this._animations.filter(function(t){return!t.finished})},Fh.prototype._getAnimationElements=function(t){for(var e=[],i=[],r=0;r<t.nodes._indexes.length;r++){var n=t.nodes._indexes[r];this._nodeAnimationList.get(n)===t.id&&e.push(n)}for(r=0;r<t.edges._indexes.length;r++)n=t.edges._indexes[r],this._edgeAnimationList.get(n)===t.id&&i.push(n);return{nodes:this._graph.nodeList(new Uint32Array(e)),edges:this._graph.edgeList(new Uint32Array(i))}},Fh.prototype._resetAnimationAttributes=function(t){var e=t.nodes,i=t.edges;this._attributesManager.resetAnimationAttributes({nodes:e,edges:i}),this._nodeAnimationList.fill(e._indexes,0),this._edgeAnimationList.fill(i._indexes,0)},Fh.prototype._processAnimations=function(){if(this._animations.length){var t=Kt(),e=[];this._attributesManager.update();for(var i=0,r=this._animations;i<r.length;i++)-1===(u=r[i]).startTime&&(u.startTime=t,e.push(u.func),0<u.duration&&this._attributesManager.setAnimationAttributes(this._getAnimationElements(u),u));for(var n=0,o=e;n<o.length;n++)(0,o[n])();for(var s=0,a=this._animations;s<a.length;s++){var u;t>=(u=a[s]).startTime+u.duration&&(this._resetAnimationAttributes(this._getAnimationElements(u)),u.resolve(u.elements),u.finished=!0)}this._removeFinishedAnimations(),this._animations.length&&this._dom.refresh()}},Fh.prototype.hideTexts=function(){this.setNodeTextsVisibility(!1),this.setEdgeTextsVisibility(!1)},Fh.prototype.showTexts=function(){this.setNodeTextsVisibility(!0),this.setEdgeTextsVisibility(!0)},Fh.prototype.setNodesVisibility=function(value){return this._updateVisibilityCounter("nodes",value)},Fh.prototype.setNodeTextsVisibility=function(value){return this._updateVisibilityCounter("nodeTexts",value)},Fh.prototype.setEdgesVisibility=function(value){return this._updateVisibilityCounter("edges",value)},Fh.prototype.setEdgeTextsVisibility=function(value){return this._updateVisibilityCounter("edgeTexts",value)},Fh.prototype._updateVisibilityCounter=function(t,value){this._visibility[t]+=value?-1:1,this._dom.refresh()},Fh.prototype.detectNode=function(t){return function(t,e,i,r,n,o){var s=t.x,a=t.y,u=t.margin,l=t.texts,d=t.indexes;d=d||e.getNodes()._indexes;var h=r.getZoom(),c=e.getObjectList(!0),f=i.getFlexArrays().nodes.current,g=1/0,p=0;i.update();for(var _=0;_<d.length;++_){var v=d[_];if(!f.excluded.get(v)&&f.detectable.get(v)&&0===f.animationDuration.get(v)){var m=f.x.get(v),y=f.y.get(v),x=r.graphToScreenCoordinates({x:m,y:y}),b=x.x,E=x.y,A=f.shape.get(v),S="scaled"===f.scalingMethod.get(v),w=f.radius.get(v)*(S?h:1),T=w+u,C=(s-b)/T,M=(a-E)/T;if(n.checkShapeHit(A,C,M))T<=g&&(g=T,p=v);else if(l){var I=o(f.text.content.get(v)||null),L=f.textHidden.get(v),N=f.text.minVisibleSize.get(v);if(!L&&I&&N<=(S?2*w:1/0)){var O=ys(I,f.text.maxLineLength.get(v)),k=f.innerStroke.width.get(v),F=f.outerStroke.width.get(v),R=f.text.margin.get(v),P=f.text.padding.get(v),D=f.text.size.get(v),z=f.text.scale.get(v),B=f.text.scaling.get(v),U=f.text.font.get(v),V=f.text.style.get(v),j=f.text.position.get(v),G=n.measureText(O,U,V,1),H=B?z*w:D,W=G.width*H/2+P+u,q=G.height*H/2+P+u,X=Pu[j],Y=k+F+R+w,Z=b+(Y+W)*X.x,K=E+(Y+q)*X.y;Z-W<s&&s<Z+W&&K-q<a&&a<K+q&&(p=v)}}}}return c.get(p)||null}(t,this._graph,this._attributesManager,this._camera,this._engine,this._formatText)},Fh.prototype.detectEdge=function(t){return function(t,e,i,r){var n=t.margin,o=(t.texts,t.indexes),s=void 0===o?e.getEdges()._indexes:o,a=e.getObjectList(!1),u=r.getFlexArrays(),l=u.edges.current,d=u.nodes.current,h=i.getZoom(),c=n/h,f=i.screenToGraphCoordinates(t),g=f.x,p=f.y,_=0;r.update();for(var v=0;v<s.length;++v){var m=s[v],y=l.source.get(m),x=l.target.get(m),b=l.excluded.get(m),E=l.detectable.get(m),A=0!==l.animationDuration.get(m),S=0!==d.animationDuration.get(y),w=0!==d.animationDuration.get(x);if(!b&&E&&!A&&!S&&!w){var T=y===x,C=l.curvature.get(m),M="triangle"===l.shape.type.get(m),I="scaled"===l.scalingMethod.get(m),L=l.width.get(m)/(I?1:h),N=d.x.get(y),O=d.y.get(y),k=d.x.get(x),F=d.y.get(x);if(T){var R="scaled"===d.scalingMethod.get(y);Ou(g,p,N,O,N,O,(P=ma(N,O,C,d.radius.get(y)/(R?1:h),0)).x1,P.y1,P.x2,P.y2,L,c)&&(_=m)}else if(0!==C){var P;Lu(g,p,N,O,k,F,(P=va(N,O,k,F,C)).x,P.y,L,c,M)&&(_=m)}else cu(g,p,N,O,k,F,L,c,M)&&(_=m)}}return a.get(_)||null}(t,this._graph,this._camera,this._attributesManager)},Fh.prototype.getVisibilityCounters=function(){return this._visibility},Fh.prototype.destroy=function(){this.getGraphicsEngine().destroy(),this.getImageManager().destroy(),this.getFontManager().destroy()},Fh);function Fh(t,e){var i,r=t.dom,n=t.graph,o=t.camera,s=t.events,a=t.settings,u=Lh.call(this)||this;return u._debug=!1,u._initDone=!1,u._boundaries={maxSize:10,maxMinVisibleSize:64},u._visibility={nodes:0,edges:0,nodeTexts:0,edgeTexts:0},u._nextAnimationId=1,u._animations=[],u._rendererState={type:null,code:null,state:"ok",message:""},u._cursorStyle=[],u._fontsNewlyLoaded=[],u._nextGeIndex=1,u._availableGeIndexes=[],u._isBufferDisplayable=function(t){var e,i=(e=t.getDepth())===js||e===Vs||Xs<=(e-Gs)%Ks,r=Vl(t),n=i?u._visibility.nodes:u._visibility.edges,o=i?u._visibility.nodeTexts:u._visibility.edgeTexts;return 0===n&&(!r||0===o)},u._applyCursorStyle=function(){var t=u._cursorStyle[u._cursorStyle.length-1]||u._settings.get("cursor.default");Vt(u._domElement,t)},u._updateImageCrossOrigin=function(){u._imageManager.setImgCrossOrigin(u._settings.get("imgCrossOrigin")||null)},u._debug=e.isDebug(),u._events=s,u._dom=r,u._graph=n,u._camera=o,u._events=s,u._settings=a,u._formatText=As().applyArabicShaping,u._attributesManager=new Pl(n,r,e),u._imageManager=new du,u._fontManager=new qd,u._engine=new ou(ou.getCachedInitData()),u._domElement=u._engine.getDomElement(),u._nodeAnimationList=u._graph.createNodeAttribute({storage:32,default:0}),u._edgeAnimationList=u._graph.createEdgeAttribute({storage:32,default:0}),u._events.register([be.RELOAD_FONTS,be.RENDERER_STATE_CHANGE,be.BEFORE_UPDATE_ATTRIBUTES,be.UPDATE_ATTRIBUTES,be.ANIMATE,be.CAMERA_MOVE,be.CAMERA_PAN,be.CAMERA_ZOOM,be.CAMERA_ROTATE,be.VIEW_CHANGED,be.START_ZOOM]),a.register("renderer",Oh,function(t){u._updateRendererState({type:t,state:"requested",code:null,message:void 0}),u._engine.setRenderType(t),u._dom.refresh()}),a.register("backgroundColor","white",function(t){u._engine.parseColor(t)?r.refresh():(Ci('Invalid background color "'+t+'" specified; will default to black.'),a.set("backgroundColor","black"))}),a.register("texts.hideUntilFontsLoaded",!0,function(t){u._fontManager.setHideUntilFontsLoaded(!!t)}),a.register("imgCrossOrigin","anonymous",u._updateImageCrossOrigin),a.register("cursor.default","default",u._applyCursorStyle),r.setLayer("graphics",u._domElement),u._engine.setGlobalBoundaries(Nh),r.beforeNextFrame().then(function(){u._initDone=!0,u._fireRendererStateChangeEvent()}),u._imageManager.onFetch(function(){u._engine.notifyPatternUpdate(),u._dom.refresh()}),u._fontManager.onFontLoaded(function(t){u._fontsNewlyLoaded.push(t),u._engine.notifyPatternUpdate(),u._engine.notifyFontsReloaded(),u._dom.refresh()}),r.addMediaListener("(min-resolution: 2dppx)",function(){return r.refresh()}),u._visibleAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal("+ai+")",tag:ai,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),u._dataAttributeLayer=u._attributesManager.addAttributeLayer({priority:0,name:"internal("+ui+")",tag:ui,nodeDependencies:void 0,edgeDependencies:void 0}),uh(u._engine,u._attributesManager.getFlexArrays()),s.on(((i={})[be.CAMERA_MOVE]=function(){return u._dom.refresh()},i[be.NEW_FRAME]=function(){u._processAnimations(),u._loadGraphInGraphicsEngine(),u._render()},i[be.CLEAR_GRAPH]=function(){u._nextGeIndex=1,u._availableGeIndexes=[],u._engine.clear(),u._attributesManager.clear(),u._dom.refresh()},i[be.VIEW_CHANGED]=function(t){if(t.type===xh.ROTATE){var e=u._graph.getEdges().filter(function(t){return t.getAttribute("adjustAnchors")});u._attributesManager.redrawElements(e)}},i[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){u._attributesManager.updateForAllAttributeLayers(t.nodes||t.edges)},i[be.EXCLUDED_STATE_CHANGE]=function(t){u._visibleAttributeLayer.updateElements(t.elements)},i[be.SET_DATA]=function(t){u._dataAttributeLayer.updateElements(t.elements)},i)),ou.clearCachedInitData(),u}function Rh(t,e){var i=e?t.getNodeAttribute("excluded"):t.getEdgeAttribute("excluded"),r=(e?t.getNodes("all"):t.getEdges("all"))._indexes,n=i.getMultiple(r);return i.fill(r,0),{excludedList:i,indexes:r,values:n}}function Ph(t){var e=t.excludedList,i=t.indexes,r=t.values;e.setMultiple(i,r)}var Dh,zh=(x(Bh,Dh=Ae),Bh.prototype.register=function(t,e){var i=this;void 0===e&&(e=[]),t.forEach(function(t){if(i._events[t])throw new Error('event "'+t+'" already exists');i._events[t]=new Uh(!1,t)}),e.forEach(function(t){if(i._events[t])throw new Error('event "'+t+'" already exists');i._events[t]=new Uh(!0,t)})},Bh.prototype.onAnyEvent=function(t){this._onAnyEvents.push(t)},Bh.prototype.on=function(t,e){var i=this;if("string"==typeof t){var r=e;t.split(" ").filter(function(t){return!!t}).forEach(function(t){return i._getEvent(t).on(r)})}else j(t,function(t,e){return i.on(e,t)});return this},Bh.prototype.removeListener=function(e){j(this._events,function(t){t.off(e)})},Bh.prototype.fire=function(e,i){void 0===i&&(i=null);var t=this._getEvent(e);return this._onAnyEvents.forEach(function(t){return t(e,i)}),t.trigger(i),this},Bh.prototype.once=function(t,e){var i=this,r=function(){e.apply(null,arguments),i.removeListener(r)};this.on(t,r)},Bh.prototype._getEvent=function(t){if(!(t in this._events))throw new Error("Event "+t+" does not exist");return this._events[t]},Bh);function Bh(){var t=null!==Dh&&Dh.apply(this,arguments)||this;return t._events={},t._onAnyEvents=[],t}var Uh=(Vh.prototype.trigger=function(t){for(var e=0,i=this._handlers;e<i.length;e++)(0,i[e])(t,this._name);return this},Vh.prototype.on=function(t){if("function"!=typeof t)throw new Error("handler is not a function");var e=this._reverseOrder?0:this._subscribers.length;return this._handlers.splice(e,0,t),this._subscribers.splice(e,0,t),this},Vh.prototype.off=function(t){for(var e;-1!==(e=this._subscribers.indexOf(t));)this._subscribers.splice(e,1),this._handlers.splice(e,1);return this},Vh);function Vh(t,e){this._subscribers=[],this._handlers=[],this._reverseOrder=t,this._name=e}var jh,Gh=(x(Hh,jh=Ae),Hh.prototype.getOriginalAttributes=function(){return this._originalAttributesLayer.getFlexArrays()},Hh.prototype.setMultipleAttributes=function(t,e,i,r){var n=this;return this._graphics.animate(t,function(){n._individualAttributesLayer.setAttributeValues(t,e,r)},i)},Hh.prototype.setSingleAttribute=function(t,e,i,r){var n={};return H(n,e,i),this.setMultipleAttributes(t,n,r)},Hh.prototype.resetMultipleAttributes=function(t,e,i){var r=this;e=e||this._individualAttributesLayer.getUsedAttributeNames(t);for(var n={},o=0,s=e;o<s.length;o++){var a=s[o];H(n,a,void 0)}return this._graphics.animate(t,function(){r._individualAttributesLayer.setAttributeValues(t,n)},i)},Hh.prototype.getMultipleAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!1)},Hh.prototype.getSingleAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!1)},Hh.prototype.replaceOriginalAttributes=function(t,e,i){void 0===i&&(i=[]);for(var r={},n=this._originalAttributesLayer.getUsedAttributeNames(t).filter(function(t){return!i.includes(t)}),o=0;o<n.length;++o)H(r,n[o],void 0);this._originalAttributesLayer.setAttributeValues(t,r),this._originalAttributesLayer.setAttributeValues(t,e)},Hh.prototype.getSinglePreviousAttribute=function(t,e){return this._graphics.getAttributeValues(t,e,!1,!0)},Hh.prototype.getMultiplePreviousAttributes=function(t,e){return this._graphics.getAttributeValues(t,e,!0,!0)},Hh);function Hh(t){var e,i=t.events,r=t.graphics,o=jh.call(this)||this;return o._events=i,o._graphics=r,i.on(((e={})[be.ADD_NODES+" "+be.ADD_EDGES]=function(t){var e=t.nodes,i=t.edges,r=e||i,n=t.objects.map(function(t){return t.attributes});o._originalAttributesLayer.setAttributeValues(r,n)},e)),o._originalAttributesLayer=o._graphics.addAttributeLayer({name:"original-attributes",priority:1,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),o._individualAttributesLayer=o._graphics.addAttributeLayer({name:"individual-attributes",priority:4,nodeOutput:{attributes:"all"},edgeOutput:{attributes:"all"},nodeDependencies:void 0,edgeDependencies:void 0}),o}var Wh,qh=(x(Xh,Wh=Ae),Xh.prototype.onMounted=function(t,e){e.renderer&&this.update({renderer:e.renderer}),e.options&&this.update(e.options)},Xh.prototype.register=function(t,e,i,r){return void 0===r&&(r=!0),this._keys.push(t),this._currentValue[t]=e,this._defaultValues[t]=e,this._onChange[t]=i||function(){},i&&r&&i(e),this},Xh.prototype.update=function(t){t=q(t);for(var e=this._keys,i={},r=this._currentValue,n=0;n<e.length;++n){var o=e[n];if(o in t){var value=t[o];void 0===value&&(value=this._defaultValues[o]),i[o]=r[o],r[o]=value}}var s=Object.keys(i);for(n=0;n<s.length;++n){var a=s[n],u=this._currentValue[a],l=i[a];u!==l&&this._onChange[a](u,l)}return Y(i)},Xh.prototype.get=function(t){return arguments.length?this._currentValue[t]:Y(this._currentValue)},Xh.prototype.set=function(t,value){var e=this._currentValue[t],i=this._onChange[t];this._currentValue[t]=value,i&&i(value,e)},Xh);function Xh(){var t=null!==Wh&&Wh.apply(this,arguments)||this;return t._currentValue={},t._onChange={},t._defaultValues={},t._keys=[],t}var Yh=(Zh.prototype.getName=function(){return this._name},Zh.prototype.getIndex=function(){return this._classes.getIndex(this._name)},Zh.prototype.setIndex=function(t){return this._classes.setIndex(this._name,t)},Zh.prototype.update=function(t){return this._classes.update(this._name,t),this},Zh.prototype.getDefinition=function(){return this._classes.getDefinition(this._name)},Zh.prototype.getNodes=function(t){return this._classes.getElementsByClass(this._name,t).nodes},Zh.prototype.getEdges=function(t){return this._classes.getElementsByClass(this._name,t).edges},Zh.prototype.clearNodes=function(t){this.getNodes(t).removeClass(this._name)},Zh.prototype.clearEdges=function(t){this.getEdges(t).removeClass(this._name)},Zh.prototype.add=function(t){t.addClass(this._name)},Zh.prototype.remove=function(t){t.removeClass(this._name)},Zh);function Zh(t,e){this._classes=t,this._name=e}var Kh,Qh=(x(Jh,Kh=Ae),Jh.prototype._getClassList=function(t){return t?this._builtinClasses:this._userClasses},Jh.prototype.createClass=function(t){var e=void 0===t?{}:t,i=e.name,r=e.isBuiltin,n=void 0!==r&&r,o=e.after,s=e.nodeAttributes,a=e.nodeDependencies,u=e.nodeOutput,l=e.edgeAttributes,d=e.edgeDependencies,h=e.edgeOutput;if("string"!=typeof i)throw new Error('the "name" argument should be a string');var c=this._getClassList(n),f=o?function(t,e){for(var i=0;i<t.length;++i)if(t[i].name===e)return i;return-1}
/* eslint-disable */(c,o)+1:c.length;if(-1===f)throw new Error('createClass: class specified as `after` parameter "'+o+'" does not exist');if(n&&!i.startsWith("_"))throw new Error('invalid builtin class name "'+i+"\": builtin classes should start with '_'");var g=new rs(this._graph),p=new Yh(this,i),_={name:i,elementSet:g,attributeLayer:this._graphics.addAttributeLayer({name:"class("+i+")",tag:i,standaloneSelectors:!0,nodeAttributes:s||void 0,edgeAttributes:l||void 0,nodeSelector:function(t,e){return e.hasElement(t)},edgeSelector:function(t,e){return e.hasElement(t)},nodeContext:g,edgeContext:g,nodeOutput:u,edgeOutput:h,nodeDependencies:a,edgeDependencies:d}),isBuiltin:n,wrapper:p};return c.splice(f,0,_),n&&c.sort(function(t,e){return bi.indexOf(t.name)-bi.indexOf(e.name)}),this._updatePriorities(n),this._classesByName[i]=_,this._events.register([$h(i,!0,!0),$h(i,!0,!1),$h(i,!1,!0),$h(i,!1,!1)]),p},Jh.prototype._updatePriorities=function(t){for(var e=this._getClassList(t),i=5+(t?.5:0),r=0;r<e.length;++r){var n=i+5e-4*r;e[r].attributeLayer.update({priority:n})}},Jh.prototype._get=function(t){var e=this._classesByName[t];if(!e)throw new Error('class "'+t+'" does not exist');return e},Jh.prototype.getIndex=function(t){var e=this._get(t);return this._getClassList(e.isBuiltin).indexOf(e)},Jh.prototype.setIndex=function(t,e){var i=this._get(t),r=this._getClassList(i.isBuiltin),n=r.indexOf(i),o=Ye(e,0,r.length-1);r.splice(n,1),r.splice(o,0,i),this._updatePriorities(i.isBuiltin)},Jh.prototype.update=function(t,e){var i=void 0===e?{}:e,r=i.nodeAttributes,n=i.edgeAttributes,o=i.nodeDependencies,s=i.edgeDependencies,a=i.nodeOutput,u=i.edgeOutput,l=i.fullOverwrite;this._get(t).attributeLayer.update({nodeAttributes:r,edgeAttributes:n,nodeDependencies:o,edgeDependencies:s,nodeOutput:a,edgeOutput:u,fullOverwrite:l})},Jh.prototype.getDefinition=function(t){var e=this._get(t).attributeLayer.getDefinition(),i=e.nodeAttributes,r=e.nodeDependencies,n=e.nodeOutput;return{nodeAttributes:i||void 0,edgeAttributes:e.edgeAttributes||void 0,nodeDependencies:r,edgeDependencies:e.edgeDependencies,nodeOutput:n,edgeOutput:e.edgeOutput}},Jh.prototype._addOrRemoveClassesToElements=function(t,e,i){for(var r=e.isNode,n=0;n<t.length;++n){var o=t[n],s=this._get(o),a=s.elementSet,u=s.attributeLayer,l=a.addOrRemoveElements(e,i),d=$h(o,r,i);l.size&&(u.updateElements(l),this._events.fire(d,r?{nodes:l}:{edges:l}))}},Jh.prototype.addClassesToElements=function(t,e,i){var r=this,n=e.toList();return this._graphics.animate(e,function(){r._addOrRemoveClassesToElements(t,n,!0)},i)},Jh.prototype.removeClassesFromElements=function(t,e,i){var r=this,n=e.toList();return this._graphics.animate(e,function(){r._addOrRemoveClassesToElements(t,n,!1)},i)},Jh.prototype.hasSingleElementClass=function(t,e){return this._get(t).elementSet.hasElement(e)},Jh.prototype.getElementsClassList=function(t,e){void 0===e&&(e={});for(var i=e.includeBuiltinClasses,r=void 0!==i&&i,n=new Array(t.size),o=0;o<n.length;++o)n[o]=[];return this._addClassNamesToList(n,t,this._userClasses),r&&this._addClassNamesToList(n,t,this._builtinClasses),n},Jh.prototype._addClassNamesToList=function(t,e,i){for(var r=e.toList(),n=0;n<i.length;++n)for(var o=this._userClasses[n],s=o.name,a=o.elementSet,u=0;u<r.size;++u){var l=r.get(u);a.hasElement(l)&&t[u].push(s)}},Jh.prototype.getClassByName=function(t,e){void 0===e&&(e=!1);var i=this._classesByName[t]||null;if(e&&!i)throw new Error('class "'+t+'" does not exist');return i&&i.wrapper},Jh.prototype.getClassList=function(){return this._userClasses.map(function(t){return t.wrapper})},Jh.prototype.getElementsByClass=function(t,e){void 0===e&&(e="visible");var i=this._get(t).elementSet.getElements(),r=i.nodes,n=i.edges;return"visible"===e?(r=r.filter(function(t){return t.isVisible()}),n=n.filter(function(t){return t.isVisible()})):"raw"===e&&(r=r.filter(function(t){return!t.isVirtual()}),n=n.filter(function(t){return!t.isVirtual()})),{nodes:r,edges:n}},Jh.prototype._onClassEvent=function(t,e,i,r){var n=$h(t,i,r);this._events.on(n,e)},Jh.prototype.onNodeClassAdded=function(t,e){this._onClassEvent(t,e,!0,!0)},Jh.prototype.onNodeClassRemoved=function(t,e){this._onClassEvent(t,e,!0,!1)},Jh.prototype.onEdgeClassAdded=function(t,e){this._onClassEvent(t,e,!1,!0)},Jh.prototype.onEdgeClassRemoved=function(t,e){this._onClassEvent(t,e,!1,!1)},Jh);function Jh(t){var e,i=t.events,r=t.graphics,n=t.graph,o=Kh.call(this)||this;return o._builtinClasses=[],o._userClasses=[],o._classesByName={},o._events=i,o._graphics=r,o._graph=n,i.on(((e={})[be.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;if(t.value){var i=o._builtinClasses.map(function(t){return t.name});o._addOrRemoveClassesToElements(i,e,!1)}},e[be.CLEAR_GRAPH]=function(){o._builtinClasses.concat(o._userClasses).forEach(function(t){return t.elementSet.clear()})},e)),o}function $h(t,e,i){return(e?"node":"edge")+"Class"+(i?"Added":"Removed")+"_"+t}for(var tc,ec,ic=[0,1],rc=[0,2],nc=4;nc<65535;nc<<=2)for(var oc=0,sc=ic.length;oc<sc;oc++)ic.push(ic[oc]|nc),rc.push((ic[oc]|nc)<<1);function ac(t,e){return(rc[255&e]|ic[255&t])+65536*(rc[e>>8&255]|ic[t>>8&255])+4294967296*(rc[e>>16&255]|ic[t>>16&255])}function uc(t,e){if(void 0===e&&(e=[]),0xffffffffffff<t)throw"Only morton codes up to 48 bits are supported.";if(!tc){tc={},ec={};for(var i=0;i<256;i++)tc[ac(i,0)]=i,ec[ac(0,i)]=i}var r=tc[21845&t],n=ec[43690&t];return 65535<t&&(r|=tc[21845&(t/=65536)]<<8,n|=ec[43690&t]<<8,65535<t&&(r|=tc[21845&(t/=65536)]<<16,n|=ec[43690&t]<<16)),e[0]=r,e[1]=n,e}ac.code=function(t,e,i){if(24<t)throw"Morton codes are only supported up to Z=24";var r=1<<24-t;return ac(e*r,i*r)},ac.range=function(t,e,i){if(24<t)throw"Morton ranges are only supported up to Z=24";var r=1<<24-t,n=ac(e*r,i*r);return[n,n+r*r-1]},ac.reverse=uc,ac.decode=function(t,e){var i=uc(e),r=1<<24-t;return[i[0]/r,i[1]/r]},ac.min=function(t,e){var i=1431655765&t,r=1431655765&e,n=2863311530&t,o=2863311530&e;return Math.min(i,r)+Math.min(n,o)};function lc(t,e,i){void 0===t&&(t=Int32Array),void 0===e&&(e=16),void 0===i&&(i=8),this._BIG_LIST=new Uint8Array([-1])[0],this._ArrayType=t,this._capacity=e,this._MAX_LIST_SIZE=i,this._freeIndex=-1,this.clear()}var dc={averageSize:{configurable:!0}};function hc(t,e){var i=new t.constructor(e);return i.set(t),i}lc.prototype.clear=function(){this._buffer=new this._ArrayType(this._capacity*this._MAX_LIST_SIZE),this._sizes=new Uint8Array(this._capacity),this._bigLists=[],this._nextIndex=0,this._idToIndex={},this._constList=new Array(this._MAX_LIST_SIZE)},lc.prototype.addEntry=function(t){var e;return-1===this._freeIndex?e=this._nextIndex++:(e=this._freeIndex,this._freeIndex=-1),(this._idToIndex[t]=e)>=this._capacity&&this._expand(e+1),this._sizes[e]=0,e},lc.prototype.getItems=function(t){var e=this._idToIndex[t];if(void 0!==e){var i=this._sizes[e],r=this._MAX_LIST_SIZE*e;if(i<=this._MAX_LIST_SIZE){for(var n=0,o=this._constList.length=i;n<o;++n)this._constList[n]=this._buffer[r+n];return this._constList}if(i===this._BIG_LIST){var s=this._buffer[r];return this._bigLists[s]}}},lc.prototype.removeEntry=function(t){var e=this._idToIndex[t];if(this._sizes[e]===this._BIG_LIST){var i=this._MAX_LIST_SIZE*e,r=this._buffer[i];this._bigLists[r].length=0}this._sizes[e]=0,this._freeIndex=e},lc.prototype.size=function(t){var e=this._idToIndex[t],i=this._sizes[e];return i<=this._MAX_LIST_SIZE?i:this._bigLists[this._buffer[e*this._MAX_LIST_SIZE]].length},lc.prototype.sizes=function(t){for(var e=this._sizes,i=this._bigLists,r=this._buffer,n=this._MAX_LIST_SIZE,o=t.length,s=new Array(o),a=0;a<o;a++){var u=this._idToIndex[t[a]],l=e[u];s[a]=l<=n?l:i[r[u*n]].length}return s},lc.prototype.addTo=function(t,value){var e=this._idToIndex[t],i=this._sizes[e],r=e*this._MAX_LIST_SIZE;if(i<this._MAX_LIST_SIZE)this._buffer[r+i]=value,this._sizes[e]=i+1;else if(i===this._BIG_LIST){var n=this._buffer[r];this._bigLists[n].push(value)}else{for(var o=new Array(this._MAX_LIST_SIZE),s=0;s<this._MAX_LIST_SIZE;++s)o[s]=this._buffer[r+s];o.push(value),this._bigLists.push(o),this._sizes[e]=this._BIG_LIST,this._buffer[r]=this._bigLists.length-1}},lc.prototype.removeFrom=function(t,value){this.removeFromAndGetSize(t,value)},lc.prototype.removeFromAndGetSize=function(t,value){var e=this._idToIndex[t],i=this._sizes[e],r=this._MAX_LIST_SIZE*e;if(i<=this._MAX_LIST_SIZE){for(var n=r,o=r+i;n<o;++n)if(this._buffer[n]===value)return--i,this._buffer[n]=this._buffer[o-1],this._sizes[e]=i}else if(i===this._BIG_LIST){var s=this._buffer[r],a=this._bigLists[s],u=a.indexOf(value);if(-1!==u)return a.splice(u,1),a.length}},lc.prototype.reserve=function(t){this._capacity<t&&this._expand(t)},lc.prototype._expand=function(t){this._capacity=Math.pow(2,Math.ceil(Math.log2(t))),this._buffer=hc(this._buffer,this._capacity*this._MAX_LIST_SIZE),this._sizes=hc(this._sizes,this._capacity)},lc.prototype.has=function(t){var e=this._idToIndex[t];return!(void 0===e||e>=this._capacity)&&0!==this._sizes[e]},dc.averageSize.get=function(){for(var t=0,e=0;e<this._capacity;e++)t+=this._sizes[e];return t/this._capacity},Object.defineProperties(lc.prototype,dc);function cc(t,e,i){return i|ac(t,e)<<4}function fc(t,e){return void 0===e&&(e=[]),ac.reverse(t>>4,e),e[2]=t&vc,e}function gc(t,e,i,r,n){void 0===i&&(i=16),void 0===r&&(r=65536),void 0===n&&(n=Int32Array),this._intersects=t,this._getBounds=e,this._occupied=0,this._cells=new lc(n),this._objectsAtLevel=new Array(16).fill(0),this._idToCode=new pc,this._codeCache=[],this._offset=r,this._min=-r,this._max=r,this._resolution=65535/(this._max-this._min),this._minCellSize=i*this._resolution,this._bounds=new Array(64);for(var o=0;o<16;o++)this._bounds[4*o]=1/0,this._bounds[4*o+1]=1/0,this._bounds[4*o+2]=-1/0,this._bounds[4*o+3]=-1/0}var pc="undefined"==typeof Map?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.set=function(t,value){t in this._values||this._size++,this._values[t]=value},t.prototype.get=function(t){return this._values[t]},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Map,_c="undefined"==typeof Set?function(){function t(){this._values={},this._size=0}var e={size:{configurable:!0}};return e.size.get=function(){return this._size},t.prototype.has=function(t){return!!this._values[t]},t.prototype.add=function(t){t in this._values||this._size++,this._values[t]=!0},t.prototype.delete=function(t){t in this._values&&(delete this._values[t],this._size--)},t.prototype.keys=function(){return Object.keys(this._values)},t.prototype.clear=function(){this._values={},this._size=0},Object.defineProperties(t.prototype,e),t}():Set,vc=(1<<Math.log2(16))-1,mc={averageCellOccupancy:{configurable:!0},size:{configurable:!0}};gc.prototype.setMinCellSize=function(t){return this._minCellSize=t,this},gc.prototype.setOffset=function(t){return this._offset=t,this._min=-t,this._max=t,this._resolution=65535/(this._max-this._min),this},gc.prototype.setIntersector=function(t){return this._intersects=t,this},gc.prototype.setBoundsGetter=function(t){return this._getBounds=t,this},gc.prototype.insert=function(t,e){void 0===e&&(e=this._getBounds(t));var i,r=Math.max(e[2]-e[0],e[3]-e[1]),n=this._minCellSize;for(i=0;n<r&&i<16;i++)n*=2;var o=this._resolution,s=this._min,a=o*(.5*(e[2]+e[0])-s)/n|0,u=o*(.5*(e[3]+e[1])-s)/n|0,l=cc(a,u,i);this._cells.has(l)||this._cells.addEntry(l),this._cells.addTo(l,t),this._objectsAtLevel[i]++,this._occupied|=1<<i;var d=4*i,h=this._bounds;return a<h[d]&&(h[d]=a),u<h[1+d]&&(h[1+d]=u),a>h[2+d]&&(h[2+d]=a),u>h[3+d]&&(h[3+d]=u),this._idToCode.set(t,l),l},gc.prototype.has=function(t){return this._idToCode.has(t)},gc.prototype.update=function(t,e){return this.remove(t),this.insert(t,e)},gc.prototype.remove=function(t){var e=this._idToCode.get(t);fc(e,this._codeCache);var i=this._codeCache[2];return 0==--this._objectsAtLevel[i]&&(this._occupied&=~(1<<i),this._bounds[4*i]=1/0,this._bounds[4*i+1]=1/0,this._bounds[4*i+2]=-1/0,this._bounds[4*i+3]=-1/0),this._cells.removeFrom(e,t),this._idToCode.delete(t),this},gc.prototype.query=function(t){var e=t[0],i=t[1],r=t[2],n=t[3],o=this._cells,s=this._bounds,a=this._intersects,u=this._min,l=this._resolution,d=this._minCellSize,h=this._occupied,c=[];e=l*(e-u),i=l*(i-u),r=l*(r-u),n=l*(n-u);for(var f=0;f<16&&0!==h;d*=2,h>>=1,f++)if(0!=(1&h))for(var g=1/d,p=4*f,_=Math.max(s[p],e*g-1>>0),v=Math.max(s[1+p],i*g-1>>0),m=Math.min(s[2+p],r*g+1>>0),y=Math.min(s[3+p],n*g+1>>0),x=_;x<=m;x++)for(var b=v;b<=y;b++){var E=cc(x,b,f),A=o.getItems(E);if(void 0!==A)for(var S=0;S<A.length;S++){var w=A[S];a(w,t)&&c.push(w)}}return c},gc.prototype.collisions=function(t,e){if(void 0===e&&(e=this._getBounds),"function"!=typeof e)throw new Error("getBounds function is required to get the object bounds");for(var i=Array.from(this._idToCode.keys()),r=this._min,n=this._resolution,o=this._cells,s=new pc,a=[],u=0;u<i.length;u++){var l=0,d=this._minCellSize,h=this._occupied,c=i[u],f=e(c),g=f[0],p=f[1],_=f[2],v=f[3],m=Math.max(_-g,v-p);for(l=0;d<m;l++)d*=2,h>>=1;g=n*(g-r),p=n*(p-r),_=n*(_-r),v=n*(v-r);for(var y=l;y<16&&0!==h;d*=2,h>>=1,y++)if(0!=(1&h))for(var x=1/d,b=p*x-1>>0,E=_*x+1>>0,A=v*x+1>>0,S=g*x-1>>0;S<=E;S++)for(var w=b;w<=A;w++){var T=cc(S,w,y);if(s.get(T)!==u){s.set(T,u);var C=o.getItems(T);if(void 0!==C)for(var M=0;M<C.length;M++){var I=C[M];I!==c&&t(c,I)&&a.push(c,I)}}}}return function(t){for(var e=new _c,i=[],r=0;r<t.length;r+=2){var n=t[r],o=t[r+1],s=n<o?n*o+(o-n-1)*(o-n-1)/4:n*o+(n-o-1)*(n-o-1)/4;e.has(s)||(e.add(s),i.push(n,o))}return i}(a)},gc.prototype.clear=function(){this._occupied=0,this._cells.clear(),this._idToCode.clear(),this._objectsAtLevel=new Array(16).fill(0),this._bounds=new Array(64);for(var t=0;t<16;t++)this._bounds[4*t]=1/0,this._bounds[4*t+1]=1/0,this._bounds[4*t+2]=-1/0,this._bounds[4*t+3]=-1/0;return this},gc.prototype.keyToBBox=function(t){var e=fc(t),i=e[0],r=e[1],n=e[2],o=this._minCellSize*(1<<n),s=this._min,a=this._resolution;return[i*o/a+s,r*o/a+s,(i+1)*o/a+s,(r+1)*o/a+s]},gc.prototype.keys=function(){return Object.keys(this._cells._idToIndex)},mc.averageCellOccupancy.get=function(){return this._cells.averageSize},mc.size.get=function(){return this._idToCode.size},Object.defineProperties(gc.prototype,mc),gc.code=cc,gc.decode=fc;var yc=function(){return{x:0,y:0,x1:0,y1:0,x2:0,y2:0}};function xc(r,t,e,i,n,o){function s(t,e){return{x:(t-y)*_,y:(e-b)*_}}var a=void 0===o?{}:o,u=a.cells,l=void 0===u||u,d=a.boxes,h=void 0===d||d,c=a.query,f=void 0===c||c,g=wt(),p=-e.getAngle(),_=e.getZoom()*g,v=e.getView(),m=v.x,y=void 0===m?0:m,x=v.y,b=void 0===x?0:x,E=v.width,A=void 0===E?0:E,S=v.height,w=A*g/2,T=(void 0===S?0:S)*g/2,C=i.keys().map(function(t){return i.keyToBBox(t)}),M=Array.from(i._idToCode.keys()).map(function(t){return i._getBounds(t)});if(r.clearRect(0,0,t.width,t.height),r.save(),r.translate(w,T),r.rotate(p),l&&(r.beginPath(),r.lineWidth=1,r.strokeStyle="#707070",C.forEach(function(t){var e=s(t[0],t[1]),i=s(t[2],t[3]);r.rect(e.x,e.y,i.x-e.x,i.y-e.y)}),r.stroke()),h&&(r.beginPath(),r.lineWidth=1,r.strokeStyle="#ff7070",M.forEach(function(t){var e=s(t[0],t[1]),i=s(t[2],t[3]);r.rect(e.x,e.y,i.x-e.x,i.y-e.y)}),r.closePath(),r.stroke()),f&&n){var I=n;r.beginPath(),r.lineWidth=2,r.strokeStyle="#3030ff";var L=s(I[0],I[1]),N=s(I[2],I[3]);r.rect(L.x,L.y,N.x-L.x,N.y-L.y),r.closePath(),r.stroke()}r.restore()}var bc,Ec=["x","y","radius"],Ac=["width","curvature"],Sc=(x(wc,bc=Ae),wc.prototype._getIntersector=function(){var t=this._graph,e=t.getNodeAttributes(["x","y","radius"]),d=e[0],h=e[1],c=e[2],i=t.getEdgeAttributes(["source","target","width","curvature"]),f=i[0],g=i[1],p=i[2],_=i[3],v=yc();return function(t,e){if(t<0){t=-t;var i=f.get(t),r=g.get(t),n=_.get(t),o=p.get(t)/2,s=d.get(i),a=h.get(i),u=d.get(r),l=h.get(r);return i===r?(ma(s,a,n,c.get(i),0,v),Mu(s,a,v.x1,v.y1,v.x2,v.y2,u,l,e[0]-o,e[1]-o,e[2]+o,e[3]+o)):0===n?mu(s,a,u,l,e[0]-o,e[1]-o,e[2]+o,e[3]+o):(va(s,a,u,l,n,v),Tu(s,a,v.x,v.y,u,l,e[0]-o,e[1]-o,e[2]+o,e[3]+o))}return gd(d.get(t),h.get(t),c.get(t),e[0],e[1],e[2],e[3])}},wc.prototype.reindex=function(){this._graphics.forceAttributesComputation(),this._index.clear(),this._elementsToUpdate.clear(),this._updateItems(this._graph.getNodes("all")._indexes,this._graph.getEdges("all")._indexes)},wc.prototype.getSize=function(){return this._index.size},wc.prototype._updateIndex=function(){if(!this._elementsToUpdate.isEmpty()){var t=this._elementsToUpdate.getElements(),e=t.nodes,i=t.edges;this._updateItems(e._indexes,i._indexes),this._elementsToUpdate.clear()}},wc.prototype._updateItems=function(t,e){var i=this._index,r=this._removedNodes,n=this._removedEdges,o=this._excludedNodes,s=this._excludedEdges,a=[],u=[];if(r&&o)for(var l=0;l<t.length;l++){var d=t[l];0!==r.get(d)||0!==o.get(d)?a.push(d):(i.has(d)&&a.push(d),u.push(d))}if(n&&s)for(l=0;l<e.length;l++)d=-e[l],0!==n.get(-d)||0!==s.get(-d)?a.push(d):(i.has(d)&&a.push(d),u.push(d));for(var h=0,c=a;h<c.length;h++)d=c[h],i.remove(d);for(var f=0,g=u;f<g.length;f++)d=g[f],i.insert(d)},wc.prototype.getNodesInScreenByDistance=function(e){var t=e.getPositionOnScreen(),n=t.x,o=t.y;return this._graph.getNodes().filter(function(t){return t.isInScreen()&&t!==e}).sort(function(t,e){var i=t.getPositionOnScreen(),r=e.getPositionOnScreen();return distance(i.x,i.y,n,o)-distance(r.x,r.y,n,o)})},wc.prototype.getNearestNodesForNode=function(t,e,i){void 0===e&&(e=240);var r=t.getPosition(),n=r.x,o=r.y;return this.getNearestNodes(n,o,e,i,t)},wc.prototype.getNearestNodes=function(t,e,i,r,n){if(this._updateIndex(),r){var o=this._camera.screenToGraphVector({x:i,y:i});i=distance(0,0,o.x,o.y)}return this._getNearestNodes(t,e,i,n)},wc.prototype._getNearestNodes=function(t,e,i,r){for(var n=[],o=i*i,s=r?r._index:0,a=this._graph.getNodes()._indexes,u=this._graph.getNodeAttributes(["x","y"]),l=u[0],d=u[1],h=0,c=a.length;h<c;h++){var f=a[h];if(f!==s){var g=t-l.get(f),p=e-d.get(f);g*g+p*p<=o&&n.push(f)}}return this._graph.nodeList(new Uint32Array(n))},wc.prototype.queryRaw=function(t,e,i,r){this._updateIndex();var n=this._queryBounds;n[0]=t,n[1]=e,n[2]=i,n[3]=r;var o=this._index.query(n),s=this._queryResult,a=s.nodes,u=s.edges;a.length=u.length=0;for(var l=0;l<o.length;l++){var d=o[l];d<0?u.push(-d):a.push(d)}return this._queryResult},wc.prototype.queryRawProjected=function(t,e,i,r){var n=this._queryBounds;return n[0]=t,n[1]=e,n[2]=i,n[3]=r,this._camera.projectBounds(n),this.queryRaw(n[0],n[1],n[2],n[3])},wc.prototype.query=function(t,e,i,r){var n=this._graph,o=this.queryRaw(t,e,i,r),s=o.nodes,a=o.edges;return{nodes:n.nodeList(new Uint32Array(s.slice())),edges:n.edgeList(new Uint32Array(a.slice()))}},wc.prototype.queryProjected=function(t,e,i,r){var n=this._graph,o=this.queryRawProjected(t,e,i,r),s=o.nodes,a=o.edges;return{nodes:n.nodeList(new Uint32Array(s.slice())),edges:n.edgeList(new Uint32Array(a.slice()))}},wc.prototype.getNodesByBoundingBox=function(t,e,i,r,n){if(this._updateIndex(),n){var o=void 0;t=(o=this._camera.screenToGraphVector({x:t,y:e})).x,e=o.y,i=(o=this._camera.screenToGraphVector({x:i,y:r})).x,r=o.y}for(var s=this._graph,a=s.getNodes()._indexes,u=[],l=s.getNodeAttribute("excluded"),d=s.getNodeAttributes(["x","y"]),h=d[0],c=d[1],f=0,g=a.length;f<g;f++){var p=a[f];if(!l||!l.get(p)){var _=h&&h.get(p),v=c&&c.get(p);t<=_&&_<=i&&e<=v&&v<=r&&u.push(p)}}return s.nodeList(new Uint32Array(u))},wc.prototype.toggleDebug=function(t){t?(this._canvas=bn(),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d")):this._canvas&&(this._graphics.removeCanvas(this._canvas),this._canvas=this._ctx=null)},wc.prototype.renderDebug=function(t){if(!this._canvas||!this._ctx)return this.toggleDebug(!0);xc(this._ctx,this._canvas,this._camera,this._index,this._queryBounds,t)},wc);function wc(t){var e,i,r,h,c,f,n,g,p,_,v,m,o=t.graph,s=t.camera,a=t.graphics,u=t.events,l=bc.call(this)||this;return l._minCellSize=8,l._clear=function(){l._index.clear(),l._elementsToUpdate.clear()},l._onGraphUpdate=function(t){if(t.nodes&&(!t.nodeAttributes||t.nodeAttributes.some(function(t){return Ec.includes(t)}))){var e=t.nodes.fastGetAdjacentElements().edges;l._elementsToUpdate.addElements(t.nodes),l._elementsToUpdate.addElements(e)}t.edges&&(t.edgeAttributes&&!t.edgeAttributes.some(function(t){return Ac.includes(t)})||l._elementsToUpdate.addElements(t.edges))},l._graph=o,l._camera=s,l._graphics=a,l._index=new gc(l._getIntersector(),(i=l._graph,r=i.getNodeAttributes(["x","y","radius"]),h=r[0],c=r[1],f=r[2],n=i.getEdgeAttributes(["source","target","curvature"]),g=n[0],p=n[1],_=n[2],v=yc(),m=os(),function(t){if(t<0){t=-t;var e=g.get(t),i=p.get(t),r=_.get(t),n=h.get(e),o=c.get(e),s=h.get(i),a=c.get(i);e===i?(ma(n,o,r,f.get(e),0,v),Fu(n,o,v.x1,v.y1,v.x2,v.y2,s,a,m)):0===r?(m.minX=Math.min(n,s),m.minY=Math.min(o,a),m.maxX=Math.max(n,s),m.maxY=Math.max(o,a)):(va(n,o,s,a,r,v),ku(n,o,v.x,v.y,s,a,m))}else{var u=h.get(t),l=c.get(t),d=f.get(t);m.minX=u-d,m.minY=l-d,m.maxX=u+d,m.maxY=l+d}return[m.minX,m.minY,m.maxX,m.maxY]}),l._minCellSize,1e6),l._elementsToUpdate=new rs(l._graph),l._removedNodes=o.getNodeAttribute("removed"),l._removedEdges=o.getEdgeAttribute("removed"),l._excludedNodes=o.getNodeAttribute("excluded"),l._excludedEdges=o.getEdgeAttribute("excluded"),l._queryResult={edges:[],nodes:[]},l._queryBounds=[0,0,0,0],u.on(((e={})[[be.ADD_NODES,be.ADD_EDGES,be.REMOVE_NODES,be.REMOVE_EDGES,be.UPDATE_ATTRIBUTES].join(" ")]=l._onGraphUpdate,e[be.EXCLUDED_STATE_CHANGE]=function(t){var e=t.elements;l._elementsToUpdate.addElements(e)},e[be.CLEAR_GRAPH]=l._clear,e)),l}var Tc,Cc,Mc,Ic=(x(Lc,Tc=Ae),Lc.prototype.onMounted=function(){this.locateGraph({},!0)},Lc.prototype.locateGraph=function(t,force){var e=this;return void 0===force&&(force=!1),force?this._locateGraph(t):this._transformations.whenApplied().then(function(){return e._locateGraph(t)})},Lc.prototype._locateGraph=function(t){return this._locateBoundingBox(this.getGraphBoundingBox(),t)},Lc.prototype.locateElements=function(t,e){var i=this;return this._transformations.whenApplied().then(function(){return i._locateBoundingBox(i.getBoundingBox(t),e)})},Lc.prototype.locateRawGraph=function(t,e){return this._locateBoundingBox(this.getRawGraphBoundingBox(t),e)},Lc.prototype.getGraphBoundingBox=function(){return this._cacheValid||this._updateCache(),Object.assign({},this._cachedGraphBoundingBox)},Lc.prototype.forceInvalidCache=function(){this._invalidCache()},Lc.prototype._updateCache=function(){this._cacheValid=!0,this._cachedGraphBoundingBox=this.getBoundingBox(this._graph.getNodes())},Lc.prototype.getBoundingBox=function(t,e){return t.isNode?this._getNodesBoundingBox(t.toList()):this._getEdgesBoundingBox(t.toList(),e)},Lc.prototype._getNodesBoundingBox=function(t){this._graphics.forceAttributesComputation();for(var e=this._graphics.getNodeAttributes(),i=[],r=[],n=[],o=[],s=0;s<t.size;++s){var a=t._indexes[s];if(0===e.excluded.get(a)){var u=e.x.get(a),l=e.y.get(a),d=2*e.radius.get(a);"scaled"===e.scalingMethod.get(a)?n.push(d):o.push(d),i.push(u),r.push(l)}}return new ss({xValues:i,yValues:r,scaledSizeValues:n,fixedSizeValues:o})},Lc.prototype._getEdgesBoundingBox=function(t,e){void 0===e&&(e=!1),this._graphics.forceAttributesComputation();for(var i=this._graphics.getEdgeAttributes(),r=this._graphics.getNodeAttributes(),n={x1:0,y1:0,x2:0,y2:0},o={x:0,y:0},s={minX:0,minY:0,maxX:0,maxY:0},a=[],u=[],l=[],d=[],h=0;h<t.size;++h){var c=t._indexes[h],f=i.source.get(c),g=i.target.get(c),p=i.curvature.get(c),_=r.x.get(f),v=r.y.get(f),m="scaled"===r.scalingMethod.get(f),y=2*r.radius.get(f),x=r.x.get(g),b=r.y.get(g),E="scaled"===r.scalingMethod.get(g),A=2*r.radius.get(g);m?l.push(y):d.push(y),E?l.push(A):d.push(A),e||0===p?(a.push(_,x),u.push(v,b)):(f===g?(ma(_,v,p,y/2,0,n),Fu(_,v,n.x1,n.y1,n.x2,n.y2,x,b,s)):(va(_,v,x,b,p,o),ku(_,v,o.x,o.y,x,b,s)),a.push(s.minX,s.maxX),u.push(s.minY,s.maxY))}return new ss({xValues:a,yValues:u,scaledSizeValues:l,fixedSizeValues:d})},Lc.prototype.getRawGraphBoundingBox=function(t){for(var e=t.nodes.length,i=new Array(e),r=new Array(e),n=new Array(e),o=0;o<e;o++){var s=t.nodes[o].attributes||{};i[o]=s.x||0,r[o]=s.y||0,n[o]=s.radius||5}return new ss({xValues:i,yValues:r,scaledSizeValues:n})},Lc.prototype._computeCameraConfig=function(t,e,i){"number"==typeof e&&(e={left:e,right:e,top:e,bottom:e});var r,n=void 0===e.left?40:e.left,o=void 0===e.right?40:e.right,s=void 0===e.top?40:e.top,a=void 0===e.bottom?40:e.bottom,u=this._dom.getDimensions(),l=n+o,d=s+a,h=0===t.width?t.maxFixedSize:t.width,c=0===t.height?t.maxFixedSize:t.height,f=(u.width-l)/(h+t.maxScaledSize),g=(u.height-d)/(c+t.maxScaledSize),p=(u.width-l-t.maxFixedSize)/h,_=(u.height-d-t.maxFixedSize)/c,v=i/t.maxScaledSize||NaN,m=(r=[f,g,p,_,v].filter(function(t){return isFinite(t)&&0<t})).length?Je(r):1;return{x:t.cx+(o-n)/(2*m),y:t.cy+(a-s)/(2*m),zoom:m}},Lc.prototype._locateBoundingBox=function(t,e){if(void 0===e&&(e={}),isNaN(t.cx))return Promise.resolve();var i=e.padding,r=void 0===i?{}:i,n=e.easing,o=void 0===n?"quadraticInOut":n,s=e.duration,a=void 0===s?0:s,u=e.maxNodeSizeOnScreen,l=void 0===u?200:u,d=e.ignoreZoomLimits,h=void 0!==d&&d,c=this._computeCameraConfig(t,r,l),f=c.x,g=c.y,p=c.zoom,_=p/this._camera.getZoom();return this._moveCamera(f,g,p,a,o,_,h)},Lc.prototype._moveCamera=function(t,e,i,r,n,o,s){return 1.01<o?(this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:s}),this._camera.setZoom(i,{duration:r,easing:n,ignoreZoomLimits:s,startAfter:.5})):o<.99?(this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:s,startAfter:.5}),this._camera.setZoom(i,{duration:r,easing:n,ignoreZoomLimits:s})):this._camera.setCenter({x:t,y:e},{duration:r,easing:n,ignoreZoomLimits:s})},Lc.prototype.computeConfigForBounds=function(t,e){void 0===e&&(e={});var i=e.padding,r=void 0===i?{}:i,n=e.maxNodeSizeOnScreen,o=void 0===n?200:n;return this._computeCameraConfig(t,r,o)},Lc.prototype.layoutDataBoundingBox=function(t){for(var e=t.x,i=t.y,r=t.indexes,n=this._graphics.getNodeAttributes(),o=[],s=[],a=[],u=[],l=0;l<r.length;++l){var d=r[l],h=e[l],c=i[l],f=2*n.radius.get(d),g="scaled"===n.scalingMethod.get(d);o.push(h),s.push(c),g?a.push(f):u.push(f)}return new ss({xValues:o,yValues:s,scaledSizeValues:a,fixedSizeValues:u})},Lc.prototype.isEdgeInPolygon=function(t,e){var i=t.getSource(),r=t.getTarget(),n=i.getPositionOnScreen(),o=r.getPositionOnScreen();if(Yd(n.x,n.y,e)||Yd(o.x,o.y,e))return!0;for(var s=Nc(t,this._camera.getZoom()),a=0;a<s.length-1;++a)for(var u=s[a],l=s[a+1],d=0;d<e.length-1;++d){var h=e[d],c=e[d+1];if(vu(u.x,u.y,l.x,l.y,h.x,h.y,c.x,c.y))return!0}return!1},Lc.prototype.isElementInView=function(t,e){var i=(void 0===e?{}:e).margin,r=void 0===i?0:i,n=this._camera.getSize(),o={minX:-r,minY:-r,maxX:n.width+r,maxY:n.height+r};return t.isNode?this.isNodeInRectangle(t,o):this.isEdgeInRectangle(t,o)},Lc.prototype.isNodeInRectangle=function(t,e){var i=t.getPositionOnScreen(),r=t.getAttribute("radius")*this._camera.getZoom(),n=i.x-r,o=i.y-r,s=i.x+r,a=i.y+r;return s>=e.minX&&n<=e.maxX&&a>=e.minY&&o<=e.maxY},Lc.prototype.isNodeInPolygon=function(t,e){var i=t.getPositionOnScreen();return Yd(i.x,i.y,e)},Lc.prototype.isEdgeInRectangle=function(t,e){for(var i=Nc(t,this._camera.getZoom()),r=0;r<i.length-1;++r){var n=i[r],o=i[r+1];if(mu(n.x,n.y,o.x,o.y,e.minX,e.minY,e.maxX,e.maxY))return!0}return!1},Lc);function Lc(t){var e,i=t.dom,r=t.events,n=t.camera,o=t.graphics,s=t.graph,a=t.transformations,u=Tc.call(this)||this;return u._cacheValid=!0,u._cachedGraphBoundingBox=new ss,u._invalidCache=function(){u._cacheValid=!1},u._dom=i,u._events=r,u._camera=n,u._graph=s,u._graphics=o,u._transformations=a,u._events.on(((e={})[[be.ADD_NODES,be.REMOVE_NODES,be.ADD_EDGES,be.REMOVE_EDGES,be.EXCLUDED_STATE_CHANGE,be.CLEAR_GRAPH,be.UPDATE_ATTRIBUTES].join(" ")]=u._invalidCache,e)),u}function Nc(t,e){var i=t.getAttribute("curvature"),r=t.getSource(),n=t.getTarget(),o=r.getPositionOnScreen();if(r===n){var s=(i+r.getAttribute("radius"))*sn*e,a=o.x,u=o.y,l=a-s,d=u,h=a,c=u+s;return E([o],[.2,.4,.6,.8].map(function(t){return Nu(t,a,u,a,u,l,d,h,c)}),[o])}var f=n.getPositionOnScreen();if(0===i)return[o,f];var g=f.x-o.x,p=f.y-o.y,distance=Math.sqrt(g*g+p*p),_=(o.x+f.x)/2,v=(o.y+f.y)/2,m=i*(distance/on)*2,y=_+p/distance*m,x=v+-g/distance*m;return E([o],[.25,.5,.75].map(function(t){return Iu(t,o.x,o.y,f.x,f.y,y,x)}),[f])}(Mc=Cc=Cc||{}).LEFT="left",Mc.MIDDLE="middle",Mc.RIGHT="right";var Oc=ft&&"msLaunchUri"in navigator&&!("documentMode"in document);var kc,Fc=(x(Rc,kc=Ae),Object.defineProperty(Rc.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"left",{get:function(){return this._left},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"right",{get:function(){return this._right},enumerable:!0,configurable:!0}),Object.defineProperty(Rc.prototype,"middle",{get:function(){return this._middle},enumerable:!0,configurable:!0}),Rc.prototype._isEnabled=function(){return this._settings.get("mouse.enabled")},Rc.prototype._isWheelEnabled=function(){return this._settings.get("mouse.wheelEnabled")},Rc.prototype._disableWheelUntilMouseDown=function(){return this._settings.get("mouse.disableWheelUntilMouseDown")},Rc.prototype._getDoubleClickTimer=function(){return this._settings.get("mouse.doubleClickTimer")},Rc.prototype._resetClickCounter=function(t,value){void 0===value&&(value=0),t?this._clickCounter[t]=value:(this._clickCounter.left=value,this._clickCounter.middle=value,this._clickCounter.right=value),this._dom.clearTimeout(this._dbclickTimer),this._lastMouseDownTarget=null},Rc.prototype._setXY=function(t){var e=this._domElt.getBoundingClientRect();return!!(this._bounds=e)&&(this._evt=t,this._button=Wt[t.button],this._px=this._position.x,this._py=this._position.y,this._position.x=t.clientX-e.left,this._position.y=t.clientY-e.top,this._left=this._buttons.left,this._right=this._buttons.right,this._middle=this._buttons.middle,!0)},Rc.prototype._applyMouseWheelZoom=function(t){var e;this._setXY(t)&&this._events.fire(be.MOUSE_WHEEL,{delta:(e=t,Oc?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/wt():e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0),x:this._position.x,y:this._position.y,domEvent:this._evt})},Rc.prototype._initializeListeners=function(){var e=this,t=this._domElt,i=this._dom;pt&&this._dom.addElementEventListener(document,"contextmenu",function(t){e._lastMouseDownTarget&&t.target!==e._lastMouseDownTarget&&t.preventDefault()}),i.addElementEventListener(t,"contextmenu",function(t){e._setXY(t),e._dom.hasFocus()&&e._settings.get("mouse.enabled")&&t.preventDefault()},!1);var r="onwheel"in t?"wheel":void 0!==t.onmousewheel?"mousewheel":"DOMMouseScroll";i.addElementEventListener(t,r,this._onMouseWheel),i.addElementEventListener(t,"mousemove",this._onMouseMove),i.addElementEventListener(t,"mouseleave",function(){e._isEnabled()&&(e._dom.blur(),e._events.fire(be.MOUSE_LEAVE,{domEvent:e._evt}))}),i.addElementEventListener(t,"mousedown",this._onMouseDown),i.addElementEventListener(t,"mouseup",this._onMouseUp),i.addElementEventListener(t,"dragover",function(t){t.preventDefault()}),i.addElementEventListener(t,"drop",this._onDrop)},Rc);function Rc(t){var e=t.dom,i=t.position,r=t.settings,n=t.events,o=t.graphics,s=t.camera,a=kc.call(this)||this;return a._px=0,a._py=0,a._pressX=0,a._pressY=0,a._left=!1,a._middle=!1,a._right=!1,a._clickCounter={left:0,middle:0,right:0},a._buttons={left:!1,middle:!1,right:!1},a._skipNextMove=!1,a._onMouseWheel=function(t){a._isEnabled()&&a._isWheelEnabled()&&(!a._disableWheelUntilMouseDown()||a._dom.hasFocus())&&(t.preventDefault(),t.stopPropagation(),a._applyMouseWheelZoom(t))},a._onMouseMove=function(t){if(a._isEnabled()&&a._setXY(t)){var e=a._position.x,i=a._position.y,r=e-a._px,n=i-a._py;0==r&&0==n||(a._skipNextMove?a._skipNextMove=!1:6<=distance(e,i,a._pressX,a._pressY)&&(a._resetClickCounter(),a._events.fire(be.MOUSE_MOVE,{x:e,y:i,dx:r,dy:n,domEvent:a._evt})))}},a._onDocumentMouseMove=function(t){if(a._isEnabled()&&a._setXY(t)){var e=a._position.x,i=a._position.y,r=a._bounds,n=e-a._px,o=i-a._py;(e<0||e>r.width||i<0||i>r.height)&&a._events.fire(be.DOCUMENT_MOUSE_MOVE,{x:e,y:i,dx:n,dy:o,domEvent:a._evt})}},a._onMouseUp=function(t){if(a._isEnabled()&&a._setXY(t)){var e=a._position.x,i=a._position.y,r=a._button,n=a._evt;a._buttons[r]=!1,1===a._clickCounter[a._button]?a._events.fire(be.MOUSE_CLICK,{button:r,x:e,y:i,domEvent:n}):1<a._clickCounter[r]&&(a._events.fire(be.MOUSE_DOUBLE_CLICK,{button:r,x:e,y:i,domEvent:n}),a._resetClickCounter(r)),a._events.fire(be.MOUSE_UP,{button:r,x:e,y:i,domEvent:n})}},a._onDocumentMouseup=function(t){if(a._isEnabled()&&a._setXY(t)){var e=a._position.x,i=a._position.y,r=a._button;a._buttons[r]=!1;var n=a._dom;a._events.fire(be.DOCUMENT_MOUSE_UP,{button:r,x:e,y:i,domEvent:a._evt}),n.removeDirectWindowEventListener("mousemove",a._onDocumentMouseMove),n.removeDirectWindowEventListener("mouseup",a._onDocumentMouseup)}},a._onMouseDown=function(t){if(a._isEnabled()&&a._setXY(t)){var e=a._position.x,i=a._position.y,r=a._button,n=a._dom;a._skipNextMove=!0,a._pressX=e,a._pressY=i,a._lastMouseDownTarget=t.target,n.focus(),a._buttons[r]=!0,a._clickCounter[r]+=1;var o=r;a._dbclickTimer=n.setTimeout(function(){a._resetClickCounter(o,0)},a._getDoubleClickTimer()),a._events.fire(be.MOUSE_DOWN,{button:r,x:e,y:i,domEvent:a._evt}),n.addDirectWindowEventListener("mousemove",a._onDocumentMouseMove),n.addDirectWindowEventListener("mouseup",a._onDocumentMouseup)}},a._onDrop=function(t){if(a._isEnabled()&&a._setXY(t)){t.preventDefault();var e=a._camera.screenToGraphCoordinates(a._position),i=e.x,r=e.y;a._events.fire(be.DROP,{domEvent:a._evt,x:i,y:r})}},a._dom=e,a._settings=r,a._events=n,a._graphics=o,a._position=i,a._camera=s,a._domElt=a._graphics.getDomElement(),r.register("mouse.enabled",!0),r.register("mouse.wheelEnabled",!0),r.register("mouse.disableWheelUntilMouseDown",!1),r.register("mouse.doubleClickTimer",500),n.register([be.MOUSE_DOWN,be.MOUSE_UP,be.MOUSE_MOVE,be.MOUSE_WHEEL,be.MOUSE_CLICK,be.MOUSE_DOUBLE_CLICK,be.MOUSE_LEAVE,be.DOCUMENT_MOUSE_UP,be.DOCUMENT_MOUSE_MOVE,be.DROP]),e.afterNextFrame().then(function(){return a._initializeListeners()}),a}var Pc,Dc=500,zc=(x(Bc,Pc=Ae),Object.defineProperty(Bc.prototype,"x",{get:function(){return this._position.x},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"y",{get:function(){return this._position.y},enumerable:!0,configurable:!0}),Object.defineProperty(Bc.prototype,"pressed",{get:function(){return this._pressed},enumerable:!0,configurable:!0}),Bc.prototype._listen=function(t,e,i){if(re){if(e===te.START)return _e(this._addEvent,t,i);if(e===te.MOVE)return me(this._addWinEvent,t,i);if(e===te.END)return ye(this._addWinEvent,t,i);if(e===te.CANCEL)return ve(this._addWinEvent,t,i)}return this._dom.addElementEventListener(t,e,i)},Bc.prototype._initialize=function(t){function p(){_._position.x=v,_._position.y=m,_._pressed=l}function s(t,e){var i=_._domElt.getBoundingClientRect();if(!i||null==t.touches)return null;var r=t.touches[0].clientX-i.left,n=t.touches[0].clientY-i.top,o=t.touches[1].clientX-i.left,s=t.touches[1].clientY-i.top,a=(r+o)/2,u=(n+s)/2,l=a-v,d=u-m,h=distance(r,n,o,s),c=h/y,f=gu(r,n,o,s),g={dx:l,dy:d,rotation:f-x,scale:c};return y=h,x=f,v=a,m=u,p(),g}function r(t){if(d=Wt[t.button],t.touches){if(1!==t.touches.length)return l=!1,1<t.touches.length&&_._events.fire(be.TOUCH_UP,{x:v,y:m,domEvent:g,button:d}),0;var e=_._domElt.getBoundingClientRect();return e&&(a=v,u=m,v=t.touches[0].clientX-e.left|0,m=t.touches[0].clientY-e.top|0,l=!0,g=t,p()),1}}function n(){h=0,_._dom.clearTimeout(b)}function i(t){if(t.preventDefault(),t.touches){if(2!==t.touches.length&&f&&(f=!1,_._events.fire(be.TOUCH_END_GESTURE,{domEvent:g})),r(t),0===t.touches.length){var e={x:v,y:m,domEvent:g,button:d};1===h&&_._events.fire(be.TOUCH_TAP,e),1<h&&(_._events.fire(be.TOUCH_DOUBLE_TAP,e),n()),_._events.fire(be.TOUCH_UP,e)}var i=xt().documentElement;xe(_._removeWinEvent,i,te.MOVE,_._onMove),xe(_._removeWinEvent,i,te.END,_._onEnd)}}function o(t){!function(t){if(t.touches&&2===t.touches.length&&f){var e=s(t);if(e){var i=e.dx,r=e.dy,n=e.rotation,o=e.scale;_._events.fire(be.TOUCH_PROGRESS_GESTURE,{dx:i,dy:r,rotation:n,scale:o,x:v,y:m,domEvent:g,button:d})}}}(t),c?c=!1:(n(),r(t)&&_._events.fire(be.TOUCH_MOVE,{x:v,y:m,dx:v-a,dy:m-u,domEvent:g,button:d}))}var _=this,v=0,m=0,a=0,u=0,l=!1,d=Cc.LEFT,h=0,c=!1,f=!1,y=1,x=0,g=null,b=null;this._listen(this._domElt,te.START,function(t){if(t.touches){2!==t.touches.length||f||s(t)&&(f=!0,_._events.fire(be.TOUCH_START_GESTURE,{domEvent:g})),r(t)&&(_._dom.focus(),_._events.fire(be.TOUCH_DOWN,{x:v,y:m,domEvent:g,button:d}),h+=1,b=_._dom.setTimeout(n,Dc),c=!0);var e=xt().documentElement;_._onMove=_._listen(e,te.MOVE,o),_._onEnd=_._listen(e,te.END,i)}})},Bc);function Bc(t){var e=t.dom,i=t.events,r=t.settings,n=t.graphics,o=t.position,s=Pc.call(this)||this;return s._pressed=!1,s._addEvent=function(t,e,i,r){s._dom.addElementEventListener(t,e,i,r)},s._addWinEvent=function(t,e,i,r){s._dom.addDirectWindowEventListener(e,i,r)},s._removeWinEvent=function(t,e,i){s._dom.removeDirectWindowEventListener(e,i)},s._dom=e,s._events=i,s._settings=r,s._graphics=n,s._position=o,s._domElt=s._graphics.getDomElement(),s._settings.register("touch.enabled",!0),s._events.register([be.TOUCH_DOWN,be.TOUCH_UP,be.TOUCH_TAP,be.TOUCH_DOUBLE_TAP,be.TOUCH_MOVE,be.TOUCH_START_GESTURE,be.TOUCH_PROGRESS_GESTURE,be.TOUCH_END_GESTURE,be.DOCUMENT_TOUCH_MOVE,be.DOCUMENT_TOUCH_UP]),s._dom.afterNextFrame().then(function(){s._initialize(s)}),s}function minDisk(t,e,i,r){var n;if(r)n=r;else{n=new Uint32Array(t.length);for(var o=0,s=t.length;o<s;o++)n[o]=o}var a=i?function(t,e,i,r,n,o){var s=i-t,a=r-e,u=o-n,l=Math.sqrt(s*s+a*a);return[(t+i+s/l*u)/2,(e+r+a/l*u)/2,(l+n+o)/2]}:function(t,e,i,r){var n=t-i,o=e-r;return[(t+i)/2,(e+r)/2,Math.sqrt(n*n+o*o)/2]},u=i?function(t,e,i,r,n,o,s,a,u){var l=2*(t-i),d=2*(e-r),h=2*(a-s),c=t*t+e*e-s*s-i*i-r*r+a*a,f=2*(t-n),g=2*(e-o),p=2*(u-s),_=t*t+e*e-s*s-n*n-o*o+u*u,v=f*d-l*g,m=(d*_-g*c)/v-t,y=(g*h-d*p)/v,x=(f*c-l*_)/v-e,b=(l*p-f*h)/v,E=y*y+b*b-1,A=2*(m*y+x*b+s),S=m*m+x*x-s*s,w=(-A-Math.sqrt(A*A-4*E*S))/(2*E);return[m+y*w+t,x+b*w+e,w]}:function(t,e,i,r,n,o){var s=2*(t*(r-o)+i*(o-e)+n*(e-r));if(0==s)return null;var a=((t*t+e*e)*(r-o)+(i*i+r*r)*(o-e)+(n*n+o*o)*(e-r))/s,u=((t*t+e*e)*(n-i)+(i*i+r*r)*(t-n)+(n*n+o*o)*(i-t))/s,l=a-t,d=u-e;return[a,u,Math.sqrt(l*l+d*d)]},l=i?fd:cd;return i=i||[],function t(e,i,r,n,o,s,a,u,l){if(0===r||3===i.length)return h=n,c=o,f=s,g=u,p=l,1===(y=(d=i).length)?[h[_=d[0]],c[_],f[_]||0]:2===y?(_=d[0],v=d[1],g(h[_],c[_],h[v],c[v],f[_],f[v])):3===y?(_=d[0],v=d[1],m=d[2],p(h[_],c[_],h[v],c[v],h[m],c[m],f[_],f[v],f[m])):null;var d,h,c,f,g,p,_,v,m,y,x=e[r-1],b=t(e,i,r-1,n,o,s,a,u,l);return null!==b&&a(b,n[x],o[x],s[x])||(i.push(x),b=t(e,i,r-1,n,o,s,a,u,l),i.pop()),b}(n=function(t){for(var e=t.length-1;0<=e;e--){var i=Math.floor(Math.random()*(e+1));i=Math.max(Math.min(i,e),0);var r=t[e];t[e]=t[i],t[i]=r}return t}(n),[],n.length,t,e,i,l,a,u)}var Uc,Vc=["x","y","radius"],jc=(x(Gc,Uc=Ae),Gc.prototype.resetOffsets=function(){var t=this._graph.getNodes(),e=this._topologyLayer.getFlexArrays().nodes;t.setAttribute("x",e.x.getMultiple(t._indexes)),t.setAttribute("y",e.y.getMultiple(t._indexes)),e.x.reset(),e.y.reset()},Gc.prototype.addVisibleGroup=function(t,e){this._visualGroupsLayers.set(t._index,e),this._visibleGroups.add(t._index)},Gc.prototype.getNodeDepth=function(t){return this._visualGroupsLayers.get(t._index)||0},Gc.prototype.removeVisibleGroup=function(t){var e=t._index;this._visibleGroups.delete(e),this._groupsToHide.push(e),this._visualGroupsLayers.delete(e)},Gc.prototype._getAllSubNodes=function(t){for(var e=Array.from(t._indexes),i=[],r=this._visibleGroups,n=this._subNodesList;0!==e.length;){var o=e.pop();if(null!=o&&r.has(o)){var s=n.get(o),a=Array.from(s._indexes);i.push.apply(i,a),e.unshift.apply(e,a)}}return this._graph.nodeList(new Uint32Array(i))},Gc.prototype._getAllMetaNodes=function(t){for(var e=Array.from(t._indexes),i=this._visibleGroups,r=this._metaNodeList,n=[],o=new Set;0!==e.length;){var s=e.pop();if(null!=s){var a=r.get(s);null!==a&&!o.has(a._index)&&i.has(a._index)&&(o.add(a._index),n.push(a._index),e.unshift(a._index))}}return this._graph.nodeList(new Uint32Array(n))},Gc.prototype.isVisibleGroup=function(t){return this._visibleGroups.has(t._index)},Gc.prototype.getSubNodeOffset=function(t){return{x:this._subNodeOffsetX.get(t._index),y:this._subNodeOffsetY.get(t._index)}},Gc.prototype._fetchSubEltsList=function(t){return t?this._subNodesList:this._subEdgesList},Gc.prototype._fetchMetaEltList=function(t){return t?this._metaNodeList:this._metaEdgeList},Gc.prototype.setSubElements=function(t,e){this._fetchSubEltsList(t.isNode).setMultiple(t._indexes,e)},Gc.prototype.setMetaElement=function(t,e){this._fetchMetaEltList(t.isNode).setMultiple(t._indexes,e)},Gc.prototype.getSubElements=function(t){return this._fetchSubEltsList(t.isNode).getMultiple(t._indexes)},Gc.prototype.getMetaElement=function(t){return this._fetchMetaEltList(t.isNode).getMultiple(t._indexes)},Gc);function Gc(t){var e=t.graph,i=t.graphics,r=t.dom,n=t.events,u=Uc.call(this)||this;return u._visibleGroups=new Set,u._visualGroupsLayers=new Map,u._groupsToHide=[],u._updateVisualGroups=function(t,e,i){var r=i.getUpdatedElementsList(),h=t.nodes.outputFlexArrays,c=t.nodes.inputFlexArrays,f=u._visibleGroups;if(0===r.size||0===f.size)return t.nodes.toUpdate.clear(),t.edges.toUpdate.clear(),t.nodes.formattedOutput&&(t.nodes.formattedOutput.attributes=[]),void(t.nodes.output&&(t.nodes.output.attributes=[]));for(var n=i.getUpdatedAttributes();0<u._groupsToHide.length;){var o=u._groupsToHide.pop();h.radius.set(o,void 0),h.x.set(o,void 0),h.y.set(o,void 0)}if(n.has("x")||n.has("y")||n.has("radius")){var s=u._getAllSubNodes(r),a=u._getAllMetaNodes(r),g=t.nodes.toUpdate,p=t.edges.toUpdate,_=u._subNodeOffsetX,v=u._subNodeOffsetY;t.nodes.formattedOutput&&t.nodes.output&&(t.nodes.formattedOutput.attributes=Vc,t.nodes.output.attributes=Vc);var m=new Set;r.forEach(function(t){var e=t._index;h.x.set(e,void 0),h.y.set(e,void 0),m.add(e)}),s.forEach(function(t){if(c){var e=t.getMetaNode(),i=t._index,r=c.x.get(i),n=c.y.get(i);if(e&&f.has(e._index)){var o=_.get(i),s=v.get(i),a=h.x.get(e._index),u=h.y.get(e._index),l=r-a,d=n-u;if(-1e7===o||-1e7===s)return _.set(i,l),void v.set(i,d);if(g.addIndex(i),p.add(t.getAdjacentEdges()),!m.has(i)&&(o!==l||s!==d))r+=o-l,n+=s-d,h.x.set(i,r),h.y.set(i,n);_.set(i,r-a),v.set(i,n-u)}}}),a.forEach(function(t){var e=t.getSubNodes();if(e){var i=h.x.getMultiple(e._indexes),r=h.y.getMultiple(e._indexes),n=h.radius.getMultiple(e._indexes),o=minDisk(i,r,n),s=o[0],a=o[1],u=o[2];e.forEach(function(t,e){_.set(t._index,i[e]-s),v.set(t._index,r[e]-a)}),h.x.set(t._index,s),h.y.set(t._index,a),h.radius.set(t._index,u),g.addIndex(t._index),p.add(t.getAdjacentEdges())}}),i.addUpdatedAttribute("radius"),i.addUpdatedAttribute("x"),i.addUpdatedAttribute("y"),i.redrawElements(a)}},u._graph=e,u._graphics=i,u._dom=r,u._subNodesList=e.createNodeAttribute({storage:"any",default:null}),u._subEdgesList=e.createEdgeAttribute({storage:"any",default:null}),u._metaNodeList=e.createNodeAttribute({storage:"any",default:null}),u._metaEdgeList=e.createEdgeAttribute({storage:"any",default:null}),u._subNodeOffsetX=e.createNodeAttribute({storage:"float",default:-1e7}),u._subNodeOffsetY=e.createNodeAttribute({storage:"float",default:-1e7}),n.on(be.ANIMATE,function(t){var e=t.elements,i=t.duration;if(0!==i&&0!==u._visibleGroups.size&&e.isNode){var r=u._getAllSubNodes(e),n=r.getAdjacentEdges();r.setVisible(!1),n.setVisible(!1),u._dom.setTimeout(function(){r.setVisible(!0),n.setVisible(!0)},i)}}),u._groupAttributeLayer=i.addAttributeLayer({name:"internal(_compound)",priority:7,nodeSelector:function(t){return u._visibleGroups.has(t._index)},edgeSelector:function(t){return t.isVirtual()},nodeAttributes:{layer:function(t){return u._visualGroupsLayers.get(t._index)}},nodeOutput:{attributes:["layer"]},nodeDependencies:{self:{data:!1,hover:!0},adjacentNodes:{attributes:"all"},adjacentEdges:{attributes:"all"}}}),u._topologyLayer=u._graphics.addAttributeLayer({name:"internal(position-forcer)",priority:6.9,nodeDependencies:{self:{attributes:["x","y","radius"]},adjacentNodes:{attributes:"all"}},onBeforeUpdate:u._updateVisualGroups,nodeOutput:{attributes:["x","y","radius","layer"]}}),u}var Hc=(Wc.prototype.getName=function(){return this._module.getName(this._id)},Wc.prototype.getId=function(){return this._id},Wc.prototype.whenApplied=function(){return this._whenApplied},Wc.prototype.isEnabled=function(){return this._module.isEnabled(this._id)},Wc.prototype.enable=function(t){return this._module.enable(this._id,t)},Wc.prototype.disable=function(t){return this._module.disable(this._id,t)},Wc.prototype.toggle=function(t){return this._module.toggle(this._id,t)},Wc.prototype.getIndex=function(){return this._module.getIndex(this._id)},Wc.prototype.setIndex=function(t){var e=this;return this._module.setIndex(this._id,t).then(function(){return e})},Wc.prototype.destroy=function(t){return this._module.remove(this._id,t||0)},Wc.prototype.refresh=function(){return this._module.refresh()},Wc.prototype.delete=function(t){return this.destroy(t)},Wc);function Wc(t,e){var i=this;this._module=t,this._id=e,this._whenApplied=t.whenApplied().then(function(){return i})}var qc=(Xc.prototype.cleanup=function(t){return Promise.resolve()},Xc);function Xc(t){}var Yc,Zc=(x(Kc,Yc=Ae),Kc.prototype._invalidState=function(){var t=this;this._afterCurrentUpdate.then(function(){(t._list.length||t._currentPipeline.length)&&(t._mustRefresh=!0,t._dom.refresh())})},Kc.prototype._onUpdate=function(){var i=this;return this._afterCurrentUpdate.then(function(){return i._dom.refresh(),new Promise(function(t,e){return i._resolvers.push({resolve:t,reject:e})})})},Kc.prototype._assignTransformationIds=function(t,e,i){null!==e&&this._nodeTransformationIdList.setMultiple(e._indexes,t),null!==i&&this._nodeTransformationIdList.setMultiple(i._indexes,t)},Kc.prototype._resolveTransformations=function(i,r,t){var n=this;t||(i.forEach(function(t){return t.duration=0}),r.forEach(function(t){return t.duration=0}));for(var e=this._selection.getSelectedNodes().getId(),o=this._selection.getSelectedEdges().getId(),s=Promise.resolve(),a=function(t){var e=i[t];null!==e.context&&(s=s.then(function(){return e.methods.undo(e)})),r.some(function(t){return t.id===e.id})||(s=s.then(function(){return e.methods.cleanup(e)}).then(function(){e.context=null}))},u=i.length-1;0<=u;--u)a(u);var l=function(t){var i=r[t];s=s.then(function(){return i.methods.run(i)}).catch(function(t){return i.error=t,!0}).then(function(t){if(!0!==t){var e=t;return n._assignTransformationIds(i.id,e.virtualNodes,e.virtualEdges),i.context=e,i.methods.cleanup(i)}})};for(u=0;u<r.length;++u)l(u);return s=s.then(function(){n._destroyed||(n._graph.getNodes(e).setSelected(!0),n._graph.getEdges(o).setSelected(!0))})},Kc.prototype.getList=function(){return this._list.map(function(t){return t.wrapper})},Kc.prototype.clear=function(){var t=this;return this._list=[],this._invalidState(),this._onUpdate().then(function(){return t._dom.afterNextFrame()})},Kc.prototype._get=function(t,e){void 0===e&&(e=!0);for(var i=0;i<this._list.length;++i){var r=this._list[i];if(r.id===t)return r.index=i,r}if(e)throw new Error("calling a method on a destroyed transformation");return null},Kc.prototype.getName=function(t){var e=this._get(t);if(e)return e.methods.getName()},Kc.prototype.enable=function(e,i){var r=this;return this._afterCurrentUpdate.then(function(){var t=r._get(e);return t&&!t.enabled&&(t.enabled=!0,t.duration=i,r._invalidState()),r._onUpdate()})},Kc.prototype._setRemovalDuration=function(t,e){for(var i=0;i<this._currentPipeline.length;++i){var r=this._currentPipeline[i];r.id===t&&(r.duration=e)}},Kc.prototype.disable=function(e,i){var r=this;return this._afterCurrentUpdate.then(function(){var t=r._get(e);return t&&t.enabled&&(t.enabled=!1,r._setRemovalDuration(e,i),r._invalidState()),r._onUpdate()})},Kc.prototype.remove=function(e,i){var r=this;return this._afterCurrentUpdate.then(function(){var t=r._get(e);return t&&(r._list.splice(t.index,1),r._setRemovalDuration(e,i),r._invalidState()),r._onUpdate()})},Kc.prototype.toggle=function(e,i){var r=this;return this._afterCurrentUpdate.then(function(){var t=r._get(e);return t&&t.enabled?r.disable(e,i):r.enable(e,i)})},Kc.prototype.setIndex=function(e,i){var r=this;return this._afterCurrentUpdate.then(function(){var t=r._get(e);return t&&(r._list.splice(t.index,1),r._list.splice(Ye(i,0,r._list.length),0,t),r._invalidState()),r._onUpdate()})},Kc.prototype.getIndex=function(t){var e=this._get(t);return e?e.index:-1},Kc.prototype.add=function(t,e){var i=void 0===e?{}:e,r=i.duration,n=void 0===r?0:r,o=i.enabled,s=void 0===o||o;t.cleanup||(t.cleanup=function(){return Promise.resolve()});var a={ogma:this._ogma,id:++this._idCounter,methods:t,duration:n,enabled:s,context:null,wrapper:new Hc(this,this._idCounter),index:-1,error:null};return this._list.push(a),this._invalidState(),a.wrapper},Kc.prototype.whenApplied=function(){return this._onUpdate()},Kc.prototype.refresh=function(){return this._invalidState(),this._onUpdate()},Kc.prototype.isEnabled=function(t){var e=this._get(t);return e&&e.enabled||!1},Kc.prototype._getElementTransformationId=function(t){return(t.isNode?this._nodeTransformationIdList:this._edgeTransformationIdList).get(t._index)},Kc.prototype.isElementVirtual=function(t){return 0!==this._graph.getAttribute(t.isNode,"virtual").get(t._index)},Kc.prototype.getElementTransformation=function(t){var e=this._get(this._getElementTransformationId(t),!1);return e&&e.wrapper},Kc.prototype.destroy=function(){this._destroyed=!0},Kc);function Kc(t,e){var i,r=t.settings,n=t.dom,o=t.events,s=t.captor,a=t.selection,u=t.classes,l=t.graph,d=Yc.call(this)||this;return d._list=[],d._currentPipeline=[],d._idCounter=0,d._mustRefresh=!1,d._safeGuard=!1,d._resolvers=[],d._afterCurrentUpdate=Promise.resolve(),d._destroyed=!1,d._computeTransformations=function(){if(d._safeGuard)return Promise.resolve();if(d._safeGuard=!0,d._afterCurrentUpdate=Promise.resolve(),d._mustRefresh){d._captor.setDetectionEnabled(!1);var t,e,i=d._currentPipeline.filter(function(t){return t.enabled}),r=d._list.filter(function(t){return t.enabled}),n=!1;if(i.length===r.length+1&&Qc(i,r,r.length)){var o=i.pop();t=o?[o]:[],e=[],n=!0}else if(r.length===i.length+1&&Qc(i,r,i.length)){t=[];var s=r.pop();e=s?[s]:[],n=!0}else t=i,e=r,n=!1;d._afterCurrentUpdate=d._afterCurrentUpdate.then(function(){return d._resolveTransformations(t,e,n)}).then(function(){return d._captor.setDetectionEnabled(!0),d._currentPipeline=d._list.map(function(t){return I({},t)}),d._mustRefresh=!1,d._dom.afterNextFrame()})}return d._afterCurrentUpdate=d._afterCurrentUpdate.then(function(){d._safeGuard=!1,d._resolvers.forEach(function(t,e){var i=t.resolve,r=t.reject,n=d._list[e];return n&&n.error?r(n.error):i()}),d._resolvers=[]}),d._afterCurrentUpdate},d._settings=r,d._dom=n,d._events=o,d._graph=l,d._captor=s,d._classes=u,d._selection=a,d._ogma=e,u.createClass({name:_i,isBuiltin:!0,nodeAttributes:{opacity:0,radius:0},edgeAttributes:{opacity:0,width:0}}),d._classes.createClass({name:vi,isBuiltin:!0,nodeAttributes:{opacity:0},edgeAttributes:{opacity:0}}),d._nodeTransformationIdList=l.createNodeAttribute({storage:16,default:0}),d._edgeTransformationIdList=l.createEdgeAttribute({storage:16,default:0}),r.register("transformations.updateOnDataChange",!0),o.on(((i={})[[be.ADD_NODES,be.ADD_EDGES,be.REMOVE_NODES,be.REMOVE_EDGES].join(" ")]=function(t){t.virtual||d._invalidState()},i[be.UPDATE_NODE_DATA+" "+be.UPDATE_EDGE_DATA]=function(){d._settings.get("transformations.updateOnDataChange")&&!d._safeGuard&&d._invalidState()},i[be.AFTER_NEW_FRAME]=d._computeTransformations,i)),d}function Qc(t,e,i){for(var r=0;r<i;++r)if(t[r].id!==e[r].id)return;return 1}var Jc,$c={layer:2,outline:!0,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},tf={layer:2,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0},stroke:{width:2}},ef=(x(rf,Jc=Ae),rf.prototype.onMounted=function(t){function e(){i._selectionExtremityHighlightedClass.clearNodes(),i._selectedClass.getEdges().getExtremities().addClass(ci)}var i=this;t.events.onEdgesClassAdded(hi,e),t.events.onEdgesClassRemoved(hi,e)},rf.prototype.setNodeAttributes=function(t,e){this._selectedClass.update({nodeAttributes:t,fullOverwrite:e}),this._selectionExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},rf.prototype.setEdgeAttributes=function(t,e){this._selectedClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},rf.prototype._updateExtremityHighlightLayer=function(){var t=this._selectedClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._selectionExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},rf.prototype.setActive=function(t,i){if(L(i)){var r=[],n=[];t.toList().forEach(function(t,e){(i[e]?r:n).push(t.getId())}),0!==r.length&&this._graph.getElements(t.isNode,r).addClass(hi),0!==n.length&&this._graph.getElements(t.isNode,n).removeClass(hi)}else t[i?"addClass":"removeClass"](hi)},rf.prototype.areActive=function(t){return t.hasClass(hi)},rf.prototype.getSelectedNodes=function(){return this._selectedClass.getNodes()},rf.prototype.getSelectedEdges=function(){return this._selectedClass.getEdges()},rf.prototype.getNonSelectedNodes=function(){return this._graph.getNodes().filter(function(t){return!t.hasClass(hi)})},rf.prototype.getNonSelectedEdges=function(){return this._graph.getEdges().filter(function(t){return!t.hasClass(hi)})},rf.prototype.clear=function(){this._selectedClass.clearNodes(),this._selectedClass.clearEdges()},rf);function rf(t){var e=t.events,i=t.settings,r=t.graph,n=t.keyboard,o=t.graphics,s=t.interactions,a=t.classes,u=Jc.call(this)||this;return u._events=e,u._settings=i,u._graph=r,u._keyboard=n,u._graphics=o,u._selectionExtremityHighlightedClass=a.createClass({name:ci,isBuiltin:!0,nodeAttributes:$c}),u._selectedClass=a.createClass({name:hi,isBuiltin:!0,nodeAttributes:$c,edgeAttributes:tf}),i.register("interactions.selection.enabled",!0),i.register("interactions.selection.multiSelectionKey","ctrl"),s.onClick({priority:"selection",check:function(t){var e=t.button,i=u._settings.get("interactions.selection.enabled");return"left"===e&&i&&!u._graphics.isAnimating()},handler:function(t){var e=t.target;if(e){var i=u._settings.get("interactions.selection.multiSelectionKey"),r=i&&u._keyboard.isPressed(i);if(e.isNode?u._selectedClass.clearEdges():u._selectedClass.clearNodes(),r)e.hasClass(hi)?e.removeClass(hi):e.addClass(hi);else(e.isNode?u._selectedClass.getNodes():u._selectedClass.getEdges()).filter(function(t){return t!==e}).removeClass(hi),e.hasClass(hi)||e.addClass(hi)}else u._selectedClass.clearNodes(),u._selectedClass.clearEdges()}}),u._events.on(be.BEFORE_REMOVE_EDGES,function(t){return t.edges.setSelected(!1)}),u}var nf,of=(x(sf,nf=Ae),sf.prototype._nextTimeIdle=function(t){var e=this,i=new af(this._dom,this._idIdle,t);return this._delayedCalls.push(i),i.whenDone().then(function(){e._delayedCalls.splice(e._delayedCalls.indexOf(i),1)})},sf.prototype.debounceIdle=function(e,i){var r=this;function n(){var t=s;o=!1,s=[],e(),t.forEach(function(t){return t()})}void 0===i&&(i=0);var o=!1,s=[];return function(){return new Promise(function(t){s.push(t),o||(o=!0,r._nextTimeIdle(i).then(n))})}},sf);function sf(t){var e,i=t.dom,r=t.events,n=t.captor,o=nf.call(this)||this;return o._dom=i,o._events=r,o._captor=n,o._delayedCalls=[],o._idIdle=function(){return!o._captor.isAnyButtonPressed()&&!o._dom.isPlayingFrame()},o._events.on(((e={})[[be.DOWN,be.UP,be.BEFORE_NEW_FRAME,be.NEW_FRAME].join(" ")]=function(){o._delayedCalls.forEach(function(t){return t.reset()})},e)),o}var af=(uf.prototype._startTimeout=function(){var t=this;this._timeout=this._dom.setTimeout(function(){t._isIdle()?(t._done=!0,t._resolve()):t._startTimeout()},this._delay)},uf.prototype.reset=function(){this._done||(this._dom.clearTimeout(this._timeout),this._startTimeout())},uf.prototype.whenDone=function(){return this._promise},uf);function uf(t,e,i){var r=this;this._timeout=null,this._done=!1,this._dom=t,this._promise=new Promise(function(t){return r._resolve=t}),this._isIdle=e,this._delay=i,this._startTimeout()}var lf,df={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:50,startRatio:1,endRatio:2,enabled:!1},hf={number:1,duration:1e3,interval:800,startColor:"rgba(0,0,0,0.6)",endColor:"rgba(0,0,0,0.0)",width:10,startRatio:1,endRatio:2,enabled:!1},cf=(x(ff,lf=Ae),ff.prototype._onElementsAttributeChange=function(t,e){if(e.includes("pulse.enabled")){var i=Bi(this._graph,t,function(t){return t.getAttribute("pulse.enabled")}),r=i.valid,n=i.invalid;this._hasPulses.removeElements(n),this._hasPulses.addElements(r),this._removePulses(n)}},ff.prototype._removePulses=function(t){for(var e=t.isNode?this._nodePulses:this._edgePulses,i=0;i<t._indexes.length;i++){var r=t._indexes[i],n=e.get(r);if(n){for(var o=0;o<n.length;o++){var s=n[o];this._graphics.releaseGraphicsEngineBlockId(s.blockId)}e.set(r,null)}}},ff.prototype._refreshElementsPulses=function(t,e){for(var i=t.isNode,r=i?this._nodePulses:this._edgePulses,n=i?this._nodeFlexArrays.pulse.duration:this._edgeFlexArrays.pulse.duration,o=i?"_createNodePulseBlock":"_createEdgePulseBlock",s=i?this._nodeFlexArrays.pulse.interval:this._edgeFlexArrays.pulse.interval,a=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=0;u<t._indexes.length;u++){var l=t._indexes[u],d=r.get(l);d||(d=[],r.set(l,d));for(var h=0;h<d.length;h++){var c=d[h],f=c.startTime,g=c.duration,p=c.blockId;f+g<=e&&(this._graphics.releaseGraphicsEngineBlockId(p),d.splice(h--,1))}var _=d[d.length-1];if(!_||e>=_.startTime+s.get(l)){g=n.get(l);var v=a.get(l);0!==v&&d.push({blockId:this[o](l,e,g),startTime:e,duration:g}),0<v&&a.set(l,v-1)}}},ff.prototype._createNodePulseBlock=function(t,e,i){var r=this._nodeFlexArrays,n=r.color.get(t),o=r.layer.get(t),s=r.x.get(t),a=r.y.get(t),u=r.radius.get(t),l="scaled"===r.scalingMethod.get(t),d=r.pulse.startRatio.get(t),h=r.pulse.endRatio.get(t),c=r.pulse.width.get(t),f=2*u*d,g=2*u*h,p=Zl(o).nodeBody,_=r.pulse.startColor.get(t),v=r.pulse.endColor.get(t),m=this._graphics.allocateGraphicsEngineBlockId(),y=this._block.reset(1,!0,p),x=y.nextAndReset(),b=zl(_,n),E=zl(v,n);return x.end.shape="circle",x.end.pieceId=Vr,x.end.x1=s,x.end.y1=a,x.end.x2=s,x.end.y2=a,x.end.rectWidthOrSourceRadiusScaled=l?g:0,x.end.rectHeightOrTargetRadiusScaled=l?g:0,x.end.rectWidthOrSourceRadiusFixed=l?0:g,x.end.rectHeightOrTargetRadiusFixed=l?0:g,x.end.strokeWidthFixed=c,x.end.strokeColor=E,x.start.shape="circle",x.start.pieceId=Vr,x.start.x1=s,x.start.y1=a,x.start.x2=s,x.start.y2=a,x.start.rectWidthOrSourceRadiusScaled=l?f:0,x.start.rectHeightOrTargetRadiusScaled=l?f:0,x.start.rectWidthOrSourceRadiusFixed=l?0:f,x.start.rectHeightOrTargetRadiusFixed=l?0:f,x.start.strokeWidthFixed=c,x.start.strokeColor=b,x.animation.duration=i,x.animation.beginTime=e,this._engine.storeBlock(m,y),m},ff.prototype._createEdgePulseBlock=function(t,e,i){var r=this._edgeFlexArrays,n=this._nodeFlexArrays,o=r.pulse.startRatio.get(t),s=r.pulse.endRatio.get(t),a=r.pulse.startColor.get(t),u=r.pulse.endColor.get(t),l=Zl(r.layer.get(t)).edgeBody,d=this._edgeSourceList.get(t),h=this._edgeTargetList.get(t),c=r.curvature.get(t),f=0!==c,g=this._graphics.allocateGraphicsEngineBlockId(),p=this._block.reset(f?3:1,!0,l),_=p.nextAndReset(),v={isSelfLoop:d===h,curvature:c,sourceX:n.x.get(d),sourceY:n.y.get(d),targetX:n.x.get(h),targetY:n.y.get(h),sourceRadius:n.radius.get(d),targetRadius:n.radius.get(h),isSourceRadiusScaled:"scaled"===n.scalingMethod.get(d),isTargetRadiusScaled:"scaled"===n.scalingMethod.get(h),width:r.width.get(t),isWidthScaled:"scaled"===r.scalingMethod.get(t),strokeWidth:r.pulse.width.get(t)};return gf(_.start,v),gf(_.end,v),_.start.strokeColor=a,_.end.strokeColor=u,_.start.thicknessOrFontSizeScaled*=o,_.start.thicknessOrFontSizeFixed*=o,_.end.thicknessOrFontSizeScaled*=s,_.end.thicknessOrFontSizeFixed*=s,_.animation.duration=i,_.animation.beginTime=e,this._engine.storeBlock(g,p),g},ff.prototype.pulse=function(t,e){var i=t.isNode,r=I(I({},i?df:hf),e),n=r.number,o=r.interval,s=r.duration,a=i?this._nodeNbPulsesRemaining:this._edgeNbPulsesRemaining,u=(n-1)*o+s;delete r.number,r.enabled=!0,t.setAttributes({pulse:r}),a.setMultiple(t._indexes,n),this._dom.setTimeout(function(){t.setAttribute("pulse.enabled",!1),a.setMultiple(t._indexes,-1)},u)},ff);function ff(t){var e,i=t.graphics,r=t.graph,n=t.dom,o=t.events,s=lf.call(this)||this;return s._onAttributeChange=function(t){var e=t.nodes,i=t.edges,r=t.nodeAttributes,n=t.edgeAttributes;s._onElementsAttributeChange(e,r),s._onElementsAttributeChange(i,n)},s._refreshPulses=function(){var t=s._hasPulses.getElements(),e=t.nodes,i=t.edges;if(0!==e.size||0!==i.size){var r=s._engine.getCurrentTime();s._refreshElementsPulses(e,r),s._refreshElementsPulses(i,r),s._dom.refresh()}},s._graph=r,s._dom=n,s._graphics=i,o.on(((e={})[be.UPDATE_ATTRIBUTES]=s._onAttributeChange,e[be.NEW_FRAME]=s._refreshPulses,e[be.BEFORE_REMOVE_NODES+" "+be.BEFORE_REMOVE_EDGES]=function(t){var e=t.nodes,i=t.edges;(e||i).setAttribute("pulse.enabled",!1)},e[be.CLEAR_GRAPH]=function(){return s._hasPulses.clear()},e)),s._engine=s._graphics.getGraphicsEngine(),s._block=s._engine.createBlock(),s._nodePulses=r.createNodeAttribute({storage:"any"}),s._edgePulses=r.createEdgeAttribute({storage:"any"}),s._nodeNbPulsesRemaining=r.createNodeAttribute({storage:"int16",default:-1}),s._edgeNbPulsesRemaining=r.createEdgeAttribute({storage:"int16",default:-1}),s._nodeFlexArrays=s._graphics.getNodeAttributes(),s._edgeFlexArrays=s._graphics.getEdgeAttributes(),s._edgeSourceList=r.getEdgeAttribute("source"),s._edgeTargetList=r.getEdgeAttribute("target"),s._hasPulses=new rs(s._graph),s}function gf(t,e){var i=e.sourceX,r=e.sourceY,n=e.targetX,o=e.targetY,s=e.isSourceRadiusScaled,a=e.isTargetRadiusScaled,u=e.targetRadius,l=e.sourceRadius,d=e.isWidthScaled,h=e.width,c=e.strokeWidth,f=e.curvature,g=e.isSelfLoop;t.pieceId=jr,t.shape="line",t.x1=i,t.y1=r,t.x2=n,t.y2=o,t.rectWidthOrSourceRadiusScaled=s?l:0,t.rectWidthOrSourceRadiusFixed=s?0:l,t.rectHeightOrTargetRadiusScaled=a?u:0,t.rectHeightOrTargetRadiusFixed=a?0:u,t.thicknessOrFontSizeScaled=d?h:0,t.thicknessOrFontSizeFixed=d?0:h,t.strokeWidthFixed=c,t.curvature=f,t.isSelfLoop=g}var pf,_f={duration:0,easing:"linear",callback:function(){},startAfter:0},vf=(x(mf,pf=Ae),mf.prototype.play=function(t,e){var i=J(e,_f),r=i.duration,n=i.easing,o=i.callback,s=i.startAfter,a=null;return r<=0?(t(1),o()):(a={func:t,easing:"function"==typeof n?n:El[n],duration:r,callback:o,startAfter:s,creationDate:Kt(),done:!1},this._animationList.push(a),this._dom.refresh()),a},mf.prototype.end=function(t,e){void 0===e&&(e=!0);var i=this._animationList.indexOf(t);-1!==i&&(t.func(1),this._animationList.splice(i,1),t.done=!0,e&&t.callback(!0))},mf);function mf(t){var e=t.dom,i=t.events,u=pf.call(this)||this;return u._animationList=[],u._update=function(){if(0!==u._animationList.length){for(var t=Kt(),e=[],i=0;i<u._animationList.length;++i){var r=u._animationList[i],n=(t-r.creationDate)/r.duration,o=r.startAfter,s=r.easing(n);if(1<=n)r.func(1),r.done=!0,u._animationList.splice(i,1),--i,e.push(r.callback);else if(o<=s){s=(s-o)*(1/(1-o)),r.func(s)}}for(var a=0;a<e.length;++a)e[a](!1);u._dom.refresh()}},u._dom=e,u._events=i,u._animationList=[],u._events.on(be.BEFORE_NEW_FRAME,u._update),u}function yf(t){return t+(-1===t.indexOf("?")?"?":"&")+"noCache="+Date.now()}var xf={tileLayers:function(e,s,t,o,a){var u=t._getMapPanePos(),i=e.getContainer();if(!i)throw new Error("Trying to access the container of "+e+" but it does not exist.");var l=o.DomUtil.getPosition(i);t.removeLayer(e),e.options.crossOrigin="anonymous";var d=[],h=[];return e.on("tileload",function(t){var e=t.tile,i=o.DomUtil.getPosition(e),r=i.x,n=i.y;d.push(e),h.push({x:r-l.x+u.x-a.x,y:n-l.y+u.y-a.y})}),t.addLayer(e),new Promise(function(t){e.once("load",function(){var o=e.getTileSize();d.forEach(function(t,e){var i=h[e],r=i.x,n=i.y;s.drawImage(t,r,n,o.x,o.y)}),t()})})},imageOverlays:function(s,a,u,t,l){return new Promise(function(o){u.removeLayer(s),s.setUrl(yf(s.getUrl())),s.options.crossOrigin="anonymous",s.once("load",function(){var t=s.getBounds(),e=u.latLngToContainerPoint(t.getNorthWest()),i=u.latLngToContainerPoint(t.getSouthEast()),r=i.x-e.x,n=i.y-e.y;a.drawImage(s._image,e.x-l.x,e.y-l.y,r,n),o()}),u.addLayer(s)})},vectorLayers:function(s,a,u,l,d,h){return new Promise(function(t){var e=s.options.renderer;u.removeLayer(s),s.options.renderer=h,u.addLayer(s),h._updatePaths();var i=u._getMapPanePos(),r=h._container,n=l.DomUtil.getPosition(r),o=wt();a.drawImage(h._container,n.x+i.x-d.x,n.y+i.y-d.y,r.width/o,r.height/o),u.removeLayer(s),s.options.renderer=e,u.addLayer(s),t()})},markers:function(g,p,_,t,v){return new Promise(function(t){var e=_.getPixelBounds().min,i=_.project(g.getLatLng(),_.getZoom()),r=/^data\:/.test(g._icon.src),n=r?g._icon.src:yf(g._icon.src),o=new Image,s=g.options.icon;if(s){var a=s.options,u=a.iconSize||[24,24],l=i.subtract(e),d=a.iconAnchor||[0,0];Array.isArray(u)||(u=[u.x,u.y]),Array.isArray(d)||(d=[d.x,d.y]);var h=Math.round(l.x-u[0]+d[0])-v.x,c=Math.round(l.y-d[1])-v.y;o.crossOrigin="";var f=function(){p.drawImage(o,h,c,u[0],u[1]),t()};o.onload=f,o.src=n,r&&f()}})},vectorMap:function(t,i,e,r,n){var o=e._getMapPanePos(),s=t.getMapboxMap(),a=t.getCanvas(),u=t.getSize().round(),l=r.DomUtil.getPosition(t.getContainer()),d=l.x+o.x-n.x,h=l.y+o.y-n.y;return new Promise(function(t){function e(){i.drawImage(a,d,h,u.x,u.y),t()}if(s.loaded())return e();s.once("idle",e)})}};function bf(o,s,a,u,l,d){var h={vectorMap:[],tileLayers:[],vectorLayers:[],imageOverlays:[],markers:[]};return s.eachLayer(function(t){if(t!==o){var e=(r=t)instanceof(n=u).TileLayer?"tileLayers":r instanceof n.ImageOverlay?"imageOverlays":r instanceof n.Path?"vectorLayers":r instanceof n.Marker?"markers":"MapboxGL"in n&&r instanceof n.MapboxGL?"vectorMap":void 0;if(e&&e in h){var i=xf[e];h[e].push(function(){return i(t,a,s,u,l,d)})}}var r,n}),h}function Ef(t,e,i,u){var r=t.filter(function(t){return t.isVisible()}),n=0===r.size,o=r.reduce(function(t,e){var i=e.getGeoCoordinates(),r=i.latitude,n=i.longitude,o=u(r,n),s=o.x,a=o.y;return t.mapX.push(s),t.mapY.push(a),t},{mapX:[],mapY:[]}),s=o.mapX,a=o.mapY,l=r.getAttribute("x"),d=r.getAttribute("y"),h=r.getAttribute("radius"),c=new ss({xValues:l,yValues:d,scaledSizeValues:h}),f=new ss({xValues:s,yValues:a});n&&(c.cx=c.cy=0,c.width=c.height=0),isFinite(f.width)&&isFinite(f.height)||(f.cx=f.cy=0,f.width=f.height=0);var g=f.cx-c.cx,p=f.cy-c.cy,_=n?1:Math.max(f.width,f.height)/Math.max(c.width,c.height),v=h.reduce(function(t,e){return t[0]=Math.min(t[0],e*_),t[1]=Math.max(t[1],e*_),t},[1/0,0]),m=v[0],y=v[1];f.pad(y),f.minScaledSize=m,f.maxScaledSize=y;var x,b=i.computeConfigForBounds(f),E=e.zoom/(x=b.zoom,Math.pow(2,Math.ceil(Math.log2(x))));g+=(c.cx-e.x)*E,p+=(c.cy-e.y)*E;var A=c.cx+g,S=c.cy+p;return{offsetChanges:{name:"graph-to-geo",nodeAttributes:{radius:function(t){return t.getAttribute("radius")*E},x:function(t){return(t.getAttribute("x")+g-A)*E+A},y:function(t){return(t.getAttribute("y")+p-S)*E+S}},edgeAttributes:{width:function(t){return t.getAttribute("width")*E}}},camera:I({zoom:e.zoom/E,x:(e.x+g-A)*E+A,y:(e.y+p-S)*E+S,angle:0},e.getSize())}}var Af,Sf={"top-left":"left","bottom-left":"left","top-right":"right","bottom-right":"right"},wf={"top-left":"top","bottom-left":"bottom","top-right":"top","bottom-right":"bottom"},Tf={position:"bottom-right",horizontalMargin:0,verticalMargin:0,className:void 0},Cf=(x(Mf,Af=Ae),Mf.prototype.set=function(t,e){var i=I(I({},Tf),e),r=i.position,n=i.horizontalMargin,o=i.verticalMargin,s=i.className;Sf[r]||(r=Tf.position),this.remove();var a=document.createElement("div");return a.innerHTML=t,a.style.position="absolute",If(a,r,n,o),a.style.padding="0px 0px 0px 0px",a.style.zIndex="10",s&&a.setAttribute("class",s),this._brand=a,this._dom.setLayer("brand",this._brand),a},Mf.prototype.remove=function(){this._dom.setLayer("brand",null),this._brand=null},Mf);function Mf(t){var e=t.dom,i=Af.call(this)||this;return i._dom=e,i._brand=null,i}function If(t,e,i,r){var n=void 0===i?"":i+"px",o=void 0===r?"":r+"px";t.style[Sf[e]]=n,t.style[wf[e]]=o}var Lf,Nf=(x(Of,Lf=Ae),Of.prototype._onDataChange=function(t){var i=this,e=t.filter(function(t){var e=t.property;return e===i.latitudePath||e===i.longitudePath});if(e.length){var r=e.reduce(function(t,e){var i=e.nodes,r=e.newValues;if(!i)return t;var n=i.filter(function(t,e){return null!=r[e]});return t?t.concat(n):n},null);r&&this._refreshOrAddNodes(r)}},Of.prototype._refreshOrAddNodes=function(t){this._updateNodesCoordinates(t),this._enabled&&(this._filter.refresh(),this._updatePrevNodesCoordinates(t))},Of.prototype._updatePrevNodesCoordinates=function(t){gr(this._graph,t,er,"geo.prevLat"),gr(this._graph,t,ir,"geo.prevLng")},Of.prototype._restorePrevNodesCoordinates=function(t){gr(this._graph,t,"geo.prevLat",er),gr(this._graph,t,"geo.prevLng",ir)},Of.prototype._updateNodesCoordinates=function(t){!function(t,e,i){for(var r=i.longitudePath,n=i.latitudePath,o=i.wrapCoordinates,s=t.getAttributes(!0,[er,ir]),a=s[0],u=s[1],l=e._indexes,d=e.getId(),h=l.length,c=e.getData(n),f=e.getData(r),g=0;g<h;g++){var p=f[g],_=c[g],v=l[g],m=d[g];null!=_&&null!=p&&(dr(m,p),hr(m,_),o&&(p%=180,_=Ye(+_,-rr,rr)),u.set(v,p),a.set(v,_))}}(this._graph,t,this._settings)},Of.prototype._createMapTileLayer=function(t,e){if(t&&!$(t))return t;var i,r=t.wms?this.L.tileLayer.wms:this.L.tileLayer,n=(i=t,(null==e&&i.url===or.tiles.url?'Map data &copy; <a target="_blank" href="http://osm.org/copyright">OpenStreetMap contributors</a>':null)||"");return r(t.url,I({attribution:n},t))},Of.prototype._setupTileLayer=function(t,e){var i=this,r=this._createMapTileLayer(t,e);return r.once("load",function(){i._events.fire(be.GEO_LOADED)}),r.addTo(this._map),r},Of.prototype._onSettingsChanged=function(t,e){var i,r,n=t.wrapCoordinates!==e.wrapCoordinates,o=t.latitudePath!==e.latitudePath||t.longitudePath!==e.longitudePath;(n||o)&&this._updateNodesCoordinates(this._graph.getNodes("all")),this._enabled&&(r=e,(i=t).attribution===r.attribution&&i.tiles===r.tiles||!this._map||(this._map.removeLayer(this._tileLayer),this._tileLayer=this._setupTileLayer(e.tiles,e.attribution)),t.sizeRatio!==e.sizeRatio&&this._updateSizes(),t.maxZoomLevel!==e.maxZoomLevel&&this._settingsModule.update({minZoom:1,maxZoom:Math.pow(2,e.maxZoomLevel)}),t.disableNodeDragging!==e.disableNodeDragging&&this._setDragging(!e.disableNodeDragging),t.attributionOptions!==e.attributionOptions&&this._setAttributionOptions(e.attributionOptions,e.attribution))},Of.prototype._setMapDragging=function(t){if(this._map){var e=t?"enable":"disable";this._map.dragging[e]()}},Of.prototype._fromLatLngToPoint=function(t,e){return this._map.options.crs.latLngToPoint(this.L.latLng(t,e),nr)},Of.prototype._fromPointToLatLng=function(t,e){var i=this._map.options.crs.pointToLatLng(this.L.point({x:t,y:e}),nr);return{latitude:i.lat,longitude:i.lng}},Of.prototype._updateSizes=function(){this._enabled&&this._projection&&this._projection.updateAll()},Of.prototype.enable=function(t){return this.setEnabled(!0,t)},Of.prototype.getMap=function(){if(this._enabled)return this._map},Of.prototype.getOptions=function(){if(this._enabled)return I(I({},this._settings),{tiles:I({},this._settings.tiles)})},Of.prototype.setOptions=function(t){if(this._enabled){!function(t,e){void 0===t&&(t={});var i=t.tileUrlSubdomains,r=t.tileUrlTemplate,n=t.attribution,o=t.attributionOptions,s=t.latitudePath,a=t.longitudePath,u=t.sizeRatio,l=t.tiles;if(null!=r&&"string"!=typeof r)throw new TypeError("Geo mode: tileUrlTemplate must be a URL string");if(null!=i&&"string"!=typeof i)throw new TypeError("Geo mode: tileUrlTemplate must be a string");if(null!=l){if(!($(l)||l instanceof e.Layer))throw new TypeError("Geo mode: tiles must be a object or L.Layer instance");var d=l;if(null!=d.url&&"string"!=typeof d.url)throw new TypeError("Geo mode: tiles.url must be a string");if(null!=d.subdomains&&"string"!=typeof d.subdomains)throw new TypeError("Geo mode: tiles.subdomains must be a string");if(d.tms&&"boolean"!=typeof d.tms)throw new TypeError("Geo mode: tiles.tms must be a boolean");if(d.wms&&"boolean"!=typeof d.wms)throw new TypeError("Geo mode: tiles.wms must be a boolean")}if(null!=n&&"string"!=typeof n)throw new TypeError("Geo mode: Map attribution must be a string");if(null!=o&&!$(o))throw new TypeError("Geo mode: attributionOptions must to be a BrandOptions object");if(null!=s&&"string"!=typeof s&&!Array.isArray(s))throw new TypeError("Geo mode: Latitude path must be a valid property path: a string or an array of strings.");if(null!=a&&"string"!=typeof a&&!Array.isArray(a))throw new TypeError("Geo mode: Longitude path must be a valid property path: a string or an array of strings.");if(null!=u&&(!isFinite(u)||u<=0))throw new TypeError("Geo mode: sizeRatio must be a positive number.")}(t,this.L);var e=this._settings;this._settings=I(I(I({},or),t),{tiles:function(t,e){if(void 0===e&&(e={}),void 0===e.tiles||e.tileUrlTemplate||e.tileUrlSubdomains){var i=or.tiles;return I(I(I({},e.tiles||{}),or.tiles),{url:e.tileUrlTemplate||i.url,subdomains:e.tileUrlSubdomains||i.subdomains})}return $(e.tiles)?I(I({},t.tiles),e.tiles):e.tiles}(or,t)}),this._onSettingsChanged(e,this._settings)}},Of.prototype.disable=function(t){return this.setEnabled(!1,t)},Of.prototype.isEnabled=function(){return this._enabled},Of.prototype.toggle=function(t){return void 0===t&&(t={}),this.setEnabled(!this._enabled,t)},Of.prototype.getContainerCoords=function(t){var r=this;return t.getGeoCoordinates().map(function(t){var e=t.latitude,i=t.longitude;return r._map.latLngToContainerPoint([e,i])})},Of.prototype.setEnabled=function(value,t){var e=this;if(!ar())throw new Error("Ogma Geo cannot be used outside a browser");if(!this.L)throw new Error("You are trying to use Geo mode but Leaflet has not been found. Please follow our migration guide: https://bit.ly/2SYkF8A");if(this._transition||value===this._enabled)return Promise.resolve();this._enabled=value,this._transition=!0,this.setOptions(t);var i=this._settingsModule,r=this._settings;return value?(this._nodeDraggingSetting=i.get("interactions.drag.enabled"),this._setDragging(!r.disableNodeDragging),this._show().then(function(){return e._registerTextStyle(),e._setDragging(!r.disableNodeDragging),e._setMapDragging(r.disableNodeDragging),e._transition=!1,e._updating=!1,e._events.fire(be.GEO_ENABLED),e._events.fire(be.GEO_READY),e._adjustMinvisibleSizes()})):this._hide().then(function(){return e._transition=!1,e._events.fire(be.GEO_DISABLED),e._setDragging(e._nodeDraggingSetting,!0),e._restoreTextStyle()})},Of.prototype._registerTextStyle=function(){var o,t,s,n,e,a,i=this;this._edgesOriginalTextStyle=(o=this._graph.getEdges(),t=o.getAttributes(["text.minVisibleSize","text.size","text.scale","minVisibleSize","width"]),s={},t.forEach(function(t,e){var i=t.text,r=t.minVisibleSize,n=t.width;s[o.get(e).getId()]={"text.minVisibleSize":i.minVisibleSize,"text.size":i.size,"text.scale":i.scale,minVisibleSize:r,size:Math.max(1,n)}}),s),this._nodesOriginalTextStyle=(n=this._graph.getNodes(),e=n.getAttributes(["text.minVisibleSize","text.size","text.scale","radius"]),a={},e.forEach(function(t,e){var i=t.text,r=t.radius;a[n.get(e).getId()]={"text.minVisibleSize":i.minVisibleSize,"text.size":i.size,"text.scale":i.scale,minVisibleSize:i.minVisibleSize,size:Math.max(1,r)}}),a);var r=this._hover.getHoverClassDefinition(),u=r.nodeAttributes,l=r.edgeAttributes;this._hoverEdgesOriginalTextStyle=l||void 0,this._hoverNodesOriginalTextStyle=u||void 0,this._hover.updateEdgeAttributes({text:{size:function(t){return i._edgesOriginalTextStyle[t.getId()]["text.size"]}}}),this._hover.updateNodeAttributes({text:{size:function(t){return i._nodesOriginalTextStyle[t.getId()]["text.size"]}}})},Of.prototype._restoreTextStyle=function(){return this._hoverEdgesOriginalTextStyle&&this._hover.updateEdgeAttributes(this._hoverEdgesOriginalTextStyle),Promise.all([(t=this._graph.getEdges(),e=this._edgesOriginalTextStyle,i=t.getId().map(function(t){return+(e[t]||{})["text.size"]}),t.setAttribute("text.size",i))]);var t,e,i},Of.prototype._setDragging=function(t,e){void 0===e&&(e=!1),this._settingsModule.update({interactions:{drag:{enabled:t,applyResult:e}}})},Of.prototype._setAttributionOptions=function(t,e){if(this._attribution&&(this._attribution.remove(),this._attribution=null),this._attribution=this.L.control.attribution({prefix:!1}).addTo(this._map),$(t)){this._attribution.setPrefix(""),t.position=t.position||"bottom-right";var i=t.position.replace("-","");this._attribution.setPosition(i);var r=this._attribution.getContainer();r&&(t.className&&this.L.DomUtil.addClass(r,t.className),If(r,t.position||"bottom-right",t.horizontalMargin,t.verticalMargin))}null!=e&&this._attribution.addAttribution(e)},Of.prototype._nodeIsVisible=function(t){return e=t,i=this._settings,r=this._hasCustomProjection(),n=i.longitudePath,o=i.latitudePath,s=i.wrapCoordinates,a=e.getData(n),u=e.getData(o),null!=a&&null!=u&&(!(!s&&!r)||Math.abs(u)<=rr&&Math.abs(a)<=180);var e,i,r,n,o,s,a,u},Of.prototype._updateSettingsForMap=function(){var t=this._graphics.getGraphicsEngine().parseColor(this._settings.backgroundColor);t[3]=0,this._prevSettings=this._settingsModule.update({backgroundColor:Lr(t),minZoom:1e-6,interactions:{rotation:{enabled:!1},drag:{enabled:!1},pan:{enabled:!1},zoom:{enabled:!1,onDoubleClick:!1}},mouse:{wheelEnabled:!1}})},Of.prototype.getGraphPosition=function(t){var e,i=this.L.latLngBounds((e=[[1/0,1/0],[-1/0,-1/0]],t.getGeoCoordinates().reduce(function(t,e){var i=e.latitude,r=e.longitude,n=t[0],o=t[1];return n[0]=Math.min(n[0],i),n[1]=Math.min(n[1],r),o[0]=Math.max(o[0],i),o[1]=Math.max(o[1],r),t},e)));return{center:0<t.size?i.getCenter():this.L.latLng([0,0]),zoom:this._clampZoom(this._map.getBoundsZoom(i))}},Of.prototype._initMap=function(){this._updateSettingsForMap(),this._mapContainer=function(t){var e=xt().createElement("div");e.className="ogma-geo-container",e.style.width=e.style.height="100%";var i=t||fr;return i.insertBefore(e,i.firstChild),e}(this._dom.getContainer());var t=I(I({},sr),{minZoom:this._settings.minZoomLevel,maxZoom:this._settings.maxZoomLevel});this._hasCustomProjection()&&(t.crs=this._settings.crs,t.worldCopyJump=!1,t.maxBoundsViscosity=0),this._map=new this.L.Map(this._mapContainer,t),this._hasCustomProjection()||this._map.setMaxBounds(this.L.latLngBounds([[rr,-180],[-rr,180]])),this._setAttributionOptions(this._settings.attributionOptions,this._settings.attribution),this._setupLayers()},Of.prototype._clampZoom=function(t){var e=this._tileLayer.options.maxZoom;return void 0===e&&(e=1/0),Math.min(t,e)},Of.prototype._show=function(){var u=this;return this._filter=this._filters.addNodeFilter(function(t){return u._nodeIsVisible(t)}),this._filter.whenApplied().then(function(){u._initMap();var t=u._graph.getNodes(),e=u._graph.getEdges(),i=u.getGraphPosition(t),r=i.center,n=i.zoom;u._zoom=n;var o=u._transformToGeo(),s=o.offset,a=o.newCameraView;return u._camera.setView(a,{ignoreZoomLimits:!0}).then(function(){return u._updatePrevNodesCoordinates(t),u._map.setView(r,n),u._zoom=n,u._graphics.animate({nodes:t,edges:e},function(){u._projection=u._createFinalPositionLayer()},u._settings.duration)}).then(function(){return s.destroy()})})},Of.prototype._hasCustomProjection=function(){return null!=this._settings.crs},Of.prototype._setupLayers=function(){var t=this;this._settings.tiles&&(this._tileLayer=this._setupTileLayer(this._settings.tiles,this._settings.attribution)),this._layer=new this.L.OgmaOverlay({container:this._graphics.getDomElement(),mapContainer:this._mapContainer,onUpdate:function(){return t._onMapUpdate()}}),this._layer.addTo(this._map)},Of.prototype._onMapUpdate=function(){var t=this,e=this._map.getCenter(),i=e.lat,r=e.lng,n=this._fromLatLngToPoint(i,r);this._x=n.x,this._y=n.y;var o,s=(o=this._map.getZoom(),Math.pow(2,o-nr));return this._camera.setView({zoom:s,x:n.x,y:n.y},{ignoreZoomLimits:!0}).then(function(){return t._adjustMinvisibleSizes()})},Of.prototype._adjustMinvisibleSizes=function(){return Promise.all([function(t,s,a){if(!s)return Promise.resolve();var e=t.getId().map(function(t){var e=+s[t]["text.minVisibleSize"],i=+s[t].minVisibleSize,r=+s[t]["text.size"],n=+s[t]["text.scale"],o=s[t].size*n*a;return o<=i||o<=e?0:r});return t.setAttribute("text.size",e)}(this._graph.getEdges(),this._edgesOriginalTextStyle,this._map.getZoom())])},Of.prototype._hide=function(){var e=this;if(!this._map)return Promise.resolve();this._settingsModule.update(this._prevSettings),this._map.removeLayer(this._layer);var t=this._dom.getContainer(),i=this._graphics.getDomElement();t&&t.appendChild(i),this._map.getContainer().style.zIndex=0;var r=this._graph.getNodes("all"),n=this._graph.getEdges("all"),o=this._transformToGraph(),s=o.offset,a=o.newCameraView;return this._camera.setView(a||{}).then(function(){return Promise.all([Xt(e._map.getContainer(),1,0,e._settings.duration/2).then(function(){e._map.remove();var t=e._mapContainer.parentNode;t&&t.removeChild(e._mapContainer)}),e._graphics.animate({nodes:r,edges:n},function(){return s&&s.destroy()},e._settings.duration)])}).then(function(){return e._map=null,e._filter.delete()})},Of.prototype._transformToGeo=function(){var i=this,t=Ef(this._graph.getNodes(),this._camera,this._locate,function(t,e){return i._fromLatLngToPoint(t,e)}),e=t.offsetChanges,r=t.camera;return{offset:this._addGraphAttributesLayer(e),newCameraView:r}},Of.prototype._addGraphAttributesLayer=function(t){return this._graphics.addAttributeLayer(I({priority:6,nodeSelector:function(t){return t.isVisible()},edgeSelector:function(t){return t.isVisible()}},t))},Of.prototype._transformToGraph=function(){var t=this,e=function(t,e,i,r){var n=t.getAttributes(["x","y","radius"]),o=t.getBoundingBox(),s=0===t.size,a=t.reduce(function(t,e,i){return t[e._index]=i,t},{});r();var u=t.getAttribute("x"),l=t.getAttribute("y"),d=t.getAttribute("radius"),h=new ss({xValues:u,yValues:l,scaledSizeValues:d.map(function(t){return 2*t})});s&&(o.reset(),h.reset());var c,f,g=h.cx-o.cx,p=h.cy-o.cy,_=0,v=0,m=i.computeConfigForBounds(h),y=e.zoom/m.zoom;return f=isNaN(o.cx)||isNaN(o.cy)?(o.cx=e.x,o.cy=e.y,c=m.x,m.y):(g+=(o.cx-e.x)*y,p+=(o.cy-e.y)*y,_=o.cx+g,v=o.cy+p,c=(e.x+g-_)*y+_,(e.y+p-v)*y+v),{offsetChanges:{name:"geo-to-graph",nodeAttributes:{x:function(t){return(n[a[t._index]].x+g-_)*y+_},y:function(t){return(n[a[t._index]].y+p-v)*y+v}}},camera:I({zoom:m.zoom,x:c,y:f,angle:0},e.getSize())}}(this._graph.getNodes("all"),this._camera,this._locate,function(){t._projection&&(t._projection.destroy(),t._projection=null)}),i=e.offsetChanges,r=e.camera;return{offset:this._addGraphAttributesLayer(i),newCameraView:r}},Of.prototype.getPointFromLatLng=function(t){var e=t.getGeoCoordinates(),i=e.latitude,r=e.longitude;return null==i?t.getAttributes(["x","y"]):this._fromLatLngToPoint(i,r)},Of.prototype._createFinalPositionLayer=function(){var e=this;return this._addGraphAttributesLayer({name:"graph-2-geo-animation",nodeAttributes:{scalingMethod:"fixed",radius:function(t){return t.getAttribute("radius")*e._settings.sizeRatio},x:function(t){return e.getPointFromLatLng(t).x},y:function(t){return e.getPointFromLatLng(t).y}},edgeAttributes:{scalingMethod:"fixed",width:function(t){return t.getAttribute("width")*e._settings.sizeRatio}}})},Of.prototype.destroy=function(){return Promise.resolve()},Of.prototype.setCenter=function(t,e){return this._enabled?this.setView(t,e,ur(this._camera.getZoom())):Promise.resolve()},Of.prototype.setZoom=function(t){return this._enabled?(t=this._clampZoom(t),this._zoom=t,this._map.setZoom(t),this._onMapUpdate()):Promise.resolve()},Of.prototype.setView=function(t,e,i){return this._enabled?(i=this._clampZoom(i),this._map.setView(this.L.latLng([t,e]),i,{animate:!1}),this._zoom=i,this._onMapUpdate()):Promise.resolve()},Of.prototype.getView=function(){if(this._enabled){var t=this._map.getCenter();return{zoom:this._zoom,latitude:t.lat,longitude:t.lng}}},Of.prototype.getCenter=function(){if(this._enabled){var t=this._map.getCenter();return{latitude:t.lat,longitude:t.lng}}},Of.prototype.getZoom=function(){if(this._enabled)return this._zoom},Of.prototype.resetCoordinates=function(){if(this._enabled&&this._projection){var t=this._graph.getNodes();this._restorePrevNodesCoordinates(this._graph.getNodes());var e=this._graph.getNodeAttribute(er).getMultiple(t._indexes),i=this._graph.getNodeAttribute(ir).getMultiple(t._indexes);t.setData(this._settings.latitudePath,e),t.setData(this._settings.longitudePath,i),this._projection.update()}},Of.prototype.updateCoordinates=function(){Ci("The ogma.geo.updateCoordinates() API has been deprecated. The coordinates are updated by default now.")},Of.prototype.getUnprojectedCoordinates=function(t){Ci("The ogma.geo.getUnprojectedCoordinates() API has been deprecated. Original graph coordinates are only available when in graph mode."),this._projection&&this._projection.destroy();var e=t.getPosition();return this._projection=this._createFinalPositionLayer(),e},Object.defineProperty(Of.prototype,"latitudePath",{get:function(){return this._settings.latitudePath},enumerable:!0,configurable:!0}),Object.defineProperty(Of.prototype,"longitudePath",{get:function(){return this._settings.longitudePath},enumerable:!0,configurable:!0}),Of.prototype.exportBackground=function(t){var e=this,i=bn();i.width=t.width,i.height=t.height;var r=i.getContext("2d");if(!r)throw new Error("Unable to get 2d context from  "+i);var n=this._map.getSize(),o=this.getView(),s=I({zoom:ur(t.zoom)},this._fromPointToLatLng(t.x,t.y)),a={x:(n.x-t.width)/2,y:(n.y-t.height)/2},u=new this.L.Canvas;this._map.addLayer(u);var l=bf(this._layer,this._map,r,this.L,a,u),d=l.vectorMap,h=l.tileLayers,c=l.vectorLayers,f=l.imageOverlays,g=l.markers,p=this._map.options.zoomSnap;return this.setView(s.latitude,s.longitude,s.zoom).then(function(){return e._map._onResize()}).then(function(){return z(E(d,h,f,c,g))}).then(function(){e._map._onResize(),e.setView(o.latitude,o.longitude,o.zoom),e._map.options.zoomSnap=p}).then(function(){return new Promise(function(t){return e.L.Util.requestAnimFrame(t)})}).then(function(){return e._map.removeLayer(u)}).then(function(){return i})},Of);function Of(t){var e,i=t.camera,r=t.graph,n=t.settings,o=t.filters,s=t.events,a=t.hover,u=t.dom,l=t.graphics,d=t.locate,h=Lf.call(this)||this;return h._enabled=!1,h._settings=I({},or),h._zoom=0,h._nodeDraggingSetting=!1,h._transition=!1,h._attribution=null,h._updating=!1,h._updateRate=50,h._x=0,h._y=0,h._onCameraUpdate=function(){if(h.L&&h._enabled&&h._map&&h._map._loaded){var t=h._x-h._camera.x,e=h._y-h._camera.y;if(t||e){h._updating||(h._updating=!0,h._layer.setLocked(!0),h._map._moveStart(!0,!1));var i=h._fromPointToLatLng(h._camera.x,h._camera.y),r=ur(h._camera.zoom),n=h.L.latLng(i.latitude,i.longitude);h._map._move(n,r,{pinch:!0,round:!1}),clearTimeout(h._updateRequest),h._updateRequest=h._dom.setTimeout(function(){h._updating=!1,h._layer.setLocked(!1),h._map&&h._map._move(n,r,{pinch:!0})._moveEnd(!0)},h._updateRate)}}},h._onNodesDragStart=function(){h._enabled&&(h._setMapDragging(!1),h._nodeDragOffsetX=h._nodeDragOffsetY=0)},h._onNodesDragged=function(t){var e=t.nodes,n=t.dx,o=t.dy;if(h._enabled){var i=e.map(function(t){var e=t.getAttributes(["x","y"]),i=e.x,r=e.y;return h._fromPointToLatLng(i+n-h._nodeDragOffsetX,r+o-h._nodeDragOffsetY)});return h._nodeDragOffsetX=n,h._nodeDragOffsetY=o,e.setGeoCoordinates(i)}return Promise.resolve(h._graph.nodeList())},h._graph=r,h._camera=i,h._settingsModule=n,h._filters=o,h._events=s,h._dom=u,h._graphics=l,h._locate=d,h._hover=a,h._events.register(["geoEnabled","geoDisabled","geoLoaded","geoReady"]),ar()&&(h.L=M("L")||M("leaflet"),h.L&&function(s){s.TileLayer.prototype.getUrl=function(){return this._url},s.ImageOverlay.prototype.getUrl=function(){return this._url};var i="leaflet-zoom-animated";s.OgmaOverlay||(s.OgmaOverlay=s.Layer.extend({options:{pane:"overlayPane",padding:0,onUpdate:function(){}},initialize:function(t){var e=t.container;s.Util.setOptions(this,t),this._container=e},setLocked:function(value){return this._locked=value,this},onAdd:function(t){this._map=t,this.getPane().appendChild(this._container),this._wgsOrigin=s.latLng([0,0]),this._wgsInitialShift=t.project(this._wgsOrigin,this._initialZoom),s.DomUtil.addClass(this._container,"leaflet-layer"),this._zoomAnimated&&(s.DomUtil.addClass(this._container,i),this._container.style.position="absolute",this._container.style.zIndex=9999),this._initialZoom=(this._map.getMaxZoom()+this._map.getMinZoom())/2,this._mapInitialZoom=this._map.getZoom(),this._updateBounds(),this._update({})},_updateBounds:function(){var t=this.options.padding,e=this._map.getSize(),i=this._map.containerPointToLayerPoint(e.multiplyBy(-t));this._bounds=new s.Bounds(i,i.add(e.multiplyBy(1+2*t))),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()},_update:function(t){var e=this;this._updateBounds(),this._redraw(this._bounds.min,t),this._positionTimer=s.Util.requestAnimFrame(function(){return s.DomUtil.setPosition(e._container,e._bounds.min)})},_redraw:function(t,e){this.options.onUpdate()},_updateTransform:function(t,e){if(!this._locked){var i=this._map.getZoomScale(e,this._zoom),r=this._map.getSize().multiplyBy(.5+this.options.padding),n=this._map.project(this._center,e),o=r.multiplyBy(-i).add(n).subtract(this._map._getNewPixelOrigin(t,e));s.Browser.any3d?s.DomUtil.setTransform(this._container,o,i):s.DomUtil.setPosition(this._container,o)}},_onZoom:function(t){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_onMoveEnd:function(t){this._update(t)},_onAnimZoom:function(t){var e=t.center,i=t.zoom;this._updateTransform(e,i)},bringToFront:function(){s.DomUtil.toFront(this._container)},getEvents:function(){return{zoom:this._onZoom,moveend:this._onMoveEnd,zoomanim:this._onAnimZoom,layeradd:this.bringToFront,zoomend:this.options.onUpdate}},onRemove:function(){s.DomUtil.removeClass(this._container,i);var e=this._container;["transform","webkitTransform","OTransform","MozTransform","msTransform","zIndex","position"].forEach(function(t){return e.style[t]=null}),s.Util.cancelAnimFrame(this._positionTimer),this._container=null}}))}(h.L)),h._graph.createNodeAttribute({name:"geo.prevLat",storage:"float"}),h._graph.createNodeAttribute({name:"geo.prevLng",storage:"float"}),h._graph.createNodeAttribute({name:er,storage:"float"}),h._graph.createNodeAttribute({name:ir,storage:"float"}),h._events.on(((e={})[be.ADD_NODES]=function(t){return h._refreshOrAddNodes(t.nodes)},e[be.UPDATE_NODE_DATA]=function(t){h._enabled&&h._onDataChange(t.changes)},e[be.NODES_DRAG_PROGRESS]=h._onNodesDragged,e[be.NODES_DRAG_START]=h._onNodesDragStart,e[be.NODES_DRAG_END]=function(){return h._setMapDragging(!0)},e[be.CAMERA_MOVE]=h._onCameraUpdate,e[be.VIEW_CHANGED]=h._onCameraUpdate,e)),h}function kf(t,e,i,r,n){for(var o=new Array(t.length),s=0;s<e.length;s++){var a=r[e[s]],u=r[i[s]];o[a]=o[a]||[],o[a].push(u),n&&(o[u]=o[u]||[],o[u].push(a))}return o}function Ff(t,e){return-1===t[e]?e:Ff(t,t[e])}function Rf(t,e,i,r,n,o,s,a){if(r[t]=n,i[t])return 1;if(!e[t]){e[t]=1,i[t]=1;var u=o[t];if(u)for(var l=0,d=u;l<d.length;l++){var h=d[l];if(Rf(h,e,i,r,t,o,s,a))return s.push(a[h]),1}i[t]=0}}function Pf(t,e,i){for(var r=t.length,n=new Uint8Array(r),o=new Uint8Array(r),s=new Int32Array(r),a={},u=0;u<r;u++)a[t[u]]=u;var l=kf(t,e,i,a,!1);for(u=0;u<r;u++){var d=[];if(Rf(u,n,o,s,-1,l,d,t)&&1<d.length){for(var h=d[0],c=1;c<d.length;c++)if(d[c]===h){d.length=c;break}return d.push(h),d.reverse()}}return!1}function Df(t,e,i,r,n,o,s){e[t]=1,r[t]=i;var a=n[t];if(a)for(var u=0,l=a;u<l.length;u++){var d=l[u];if(e[d]){if(d!==i)return r[d]=t,o.push(s[d]),1}else if(Df(d,e,t,r,n,o,s))return o.push(s[d]),1}}var zf=(Bf.prototype.getCycles=function(){this.visited=new Uint8Array(this.nodes.length),this.visitedStack=[];for(var t=0;t<this.nodes.length;t++)for(this.backtrack(t,t);0!==this.visitedLength;){var e=this.visitedStack.pop();void 0!==e&&this.visited[e]&&(this.visited[e]=0,this.visitedLength--)}return this.cycles},Bf.prototype.backtrack=function(t,e){var i=!1;this.stack.push(e),this.visited[e]||(this.visited[e]=1,this.visitedLength++),this.visitedStack.push(e);for(var r=0,n=this.adjacency[e]||[];r<n.length;r++){var o=n[r];if(this.removed[e]=this.removed[e]||{},!this.removed[e][o])if(o<t)this.removed[e][o]=!0;else if(o===t){for(var s=[],a=0,u=!(i=!0);a<this.stack.length;a++){var l=this.stack[a];t===l&&(u=!0),u&&s.push(this.nodes[l])}this.cycles.push(s)}else if(!this.visited[o]){var d=this.backtrack(t,o);i=i||d}}if(i)for(var h=void 0;h=this.visitedStack.pop(),this.visited[h]&&(this.visited[h]=0,this.visitedLength--),h!==e;);return this.stack.pop(),i},Bf);function Bf(t,e,i){this.cycles=[],this.visitedLength=0,this.visitedStack=[],this.stack=[],this.idToIndex={},this.removed={},this.nodes=t,this.visited=new Uint8Array(this.nodes.length);for(var r=0;r<t.length;r++)this.idToIndex[t[r]]=r;this.adjacency=kf(t,e,i,this.idToIndex)}var Uf,Vf=(x(jf,Uf=Ae),jf.prototype.shortestPath=function(t){void 0===t&&(t={source:void 0,target:void 0});var e=t.source,i=t.target,r=t.directed,n=void 0!==r&&r,o=t.filter,s=void 0===o?"visible":o,a=t.edgeCostFunction,u=void 0===a?function(){return 1}:a,l=t.heuristicFunction,d=void 0===l?function(){return 0}:l,h=this._graph.getNode(e),c=this._graph.getNode(i);if(!h)throw new Error("the source is not a node");if(!c)throw new Error("the target is not a node");var f=h._index,g=c._index,p=null;if(f===g)p={nodes:h.toList(),edges:this._graph.edgeList()};else{var _=this._graph.getNodeMaxIndex()+1,v=new Int32Array(_),m=new Float32Array(_),y=new Float32Array(_),x=new Set,b=new es(y);for(m.fill(1/0),y.fill(1/0),v.fill(-1),b.add(f),m[f]=0,y[f]=d(h,c);!b.isEmpty();){var E=b.removeMin();if(E===g){p=this._constructPath(v,f,g);break}x.add(E);var A=this._graph.getAdjacentDirections(E);if(A)for(var S=0;S<A.length;++S){for(var w=A[S],T=this._graph.getEdgeIndexesInDirection(w),C=-1,M=0,I=-1,L=0;L<T.length;++L){var N=T[L],O=this._sourceList.get(N),k=this._targetList.get(N);if(O!==k&&!(n&&E!==O||"visible"===s&&this._excludedList.get(N)||"raw"===s&&this._virtualList.get(N))){var F=u(this._edgeList.get(N));(-1===C||F<M)&&(C=N,M=F,I=O===E?k:O)}}if(-1!==I||x.has(I)){var R=m[E]+M;if(!b.has(I)||R<m[I]){var P=this._nodeList.get(E);v[I]=C,m[I]=R,y[I]=R+d(P,c),b.add(I)}}}}}return Promise.resolve(p)},jf.prototype._constructPath=function(t,e,i){for(var r=[i],n=[],o=i;o!==e;){var s=t[o],a=this._sourceList.get(s),u=this._targetList.get(s);o=o===a?u:a,r.push(o),n.push(s)}return r.reverse(),n.reverse(),{nodes:this._graph.nodeList(new Uint32Array(r)),edges:this._graph.edgeList(new Uint32Array(n))}},jf.prototype.detectCycle=function(t,e){var i=e.getSource(),r=e.getTarget(),n=Pf(t._indexes,i._indexes,r._indexes);return n?this._graph.nodeList(new Uint32Array(n)).dedupe():this._graph.nodeList()},jf.prototype.getAllSimpleCycles=function(t,e){var i=this,r=e.getSource(),n=e.getTarget();return new zf(t._indexes,r._indexes,n._indexes).getCycles().map(function(t){return i._graph.nodeList(new Uint32Array(t))})},jf);function jf(t){var e=t.graph,i=Uf.call(this)||this;return i._graph=e,i._nodeList=e.getNodeAttribute("object"),i._edgeList=e.getEdgeAttribute("object"),i._sourceList=e.getEdgeAttribute("source"),i._targetList=e.getEdgeAttribute("target"),i._excludedList=e.getEdgeAttribute("excluded"),i._virtualList=e.getEdgeAttribute("virtual"),i}var Gf,Hf=(x(Wf,Gf=Ae),Wf.prototype._addAttributeLayer=function(){return this._graphics.addAttributeLayer({name:"curvature",priority:2,edgeDependencies:{parallelEdges:!0},edgeContext:this._context,edgeAttributes:{curvature:function(t,e){var i,r=e.edgesAlwaysCurvy,n=e.directedEdges,o=t.getSource()===t.getTarget(),s=t.getParallelEdges(),a=s.indexOf(t);if(-1===a)return 0;if(o)i=a+1;else{var u=t.getSource(),l=s.size;if(1===l&&!r)return 0;if(n){for(var d=0,h=0;h<a;++h)s.get(h).getSource()===u&&(d+=1);i=d+1}else{var c=u!==s.get(0).getSource();i=l%2!=1||r?(1+(a/2|0))*(a%2==0?1:-1)*(c?-1:1):0===a?0:((a+1)/2|0)*(a%2==0?1:-1)*(c?-1:1)}}return i}}})},Wf);function Wf(t){var e=t.settings,i=t.graphics,r=Gf.call(this)||this;return r._context={edgesAlwaysCurvy:!1,directedEdges:!1},r._settings=e,r._graphics=i,r._attributeLayer=r._addAttributeLayer(),e.register("edgesAlwaysCurvy",!1,function(value){r._context.edgesAlwaysCurvy=value,r._attributeLayer.updateAll()}),e.register("directedEdges",!1,function(value){r._context.directedEdges=value,r._attributeLayer.updateAll()}),r}function qf(){return{}}function Xf(){}function Yf(){return!1}function Zf(){}function Kf(){}function Qf(){}var Jf,$f=(x(tg,Jf=us),tg.prototype.configure=function(t){this._onStart=t.onStart||Kf,this._onEnd=t.onEnd||Qf,this._update=t.update||Xf,this._onUpdate=t.onUpdate||Zf,this._createContext=t.context||qf,this._isRunning=t.isRunning||Yf},tg.prototype.setData=function(t){this._data=t},tg.prototype.getData=function(){return this._data},tg.prototype.onStart=function(){return this.fire("start",{target:this}),this._onStart.call(this),this},tg.prototype.stop=function(){},tg);function tg(t,e,i){var r=Jf.call(this)||this;return r._complete=!1,r._data=null,r._dependencies=e,r._dom=i,r.configure(t),r}var eg,ig=(x(rg,eg=$f),rg.prototype.sync=function(t){var e=t.data.isRunning,i=t.data.result,r=this._onUpdate.call(this,i,this._dependencies,e);return this.fire("update",{target:this,isRunning:e}),e?this.send(r):this.stop(i)},rg.prototype.stop=function(t){return this._complete||(this._onEnd.call(this,t,this._dependencies),this._worker.terminate(),this.fire("stop",{target:this})),this._complete=!0,this},rg.prototype.send=function(t){return this._worker.postMessage(Do(t)),this},rg);function rg(t,e,i){var r=eg.call(this,t,e,i)||this,n=[function(t){void 0===t&&(t={});for(var e=Object.keys(t),i=[],r=0,n=e.length;r<n;r++){var o=e[r],s=t[o];if("function"!=typeof s)throw new Error('Asynchronous task: dependency "'+o+'" is not found');var a=sg(s);a?(i.push(og(s,o)),a!==o&&i.push("var "+o+" = "+a+";")):i.push("var "+o+" = "+og(s,o)+";")}return i.join("\n")}(t.imports),"","","var __CONTEXT = ("+r._createContext.toString()+")();","var __UPDATE_FUNC = "+r._update.toString()+";","var __IS_RUNNING_FUNC = "+r._isRunning.toString()+";","",'self.addEventListener("message", function (evt) {',"  var result    = __UPDATE_FUNC(evt.data, __CONTEXT);","  var isRunning = __IS_RUNNING_FUNC(__CONTEXT, evt.data);","  self.postMessage({ result: result, isRunning: isRunning });","});"].join("\n");return r._worker=zo(n),r._worker.addEventListener("message",function(t){r._dom.isDestroyed()||r.sync(t)}),r}var ng=/^function\s*\(/;function og(t,e){var i=t.toString();return ng.test(i)?"function "+(t.name||e)+" "+i.substring(i.indexOf("(")):i}function sg(t){var e=t.toString();return t.name?t.name:ng.test(e)?null:e.substring("function ".length,e.indexOf("(")).trim()}var ag,ug=(x(lg,ag=$f),lg.prototype.sync=function(t){var e=this._update(t,this._context),i=this._isRunning(this._context,t),r=this._onUpdate.call(this,e,this._dependencies,i);this.fire("update",{target:this,isRunning:i}),i?this.send(r):this.stop(e)},lg.prototype.send=function(t){var e=this;return this._complete||this._dom.setTimeout(function(){return e.sync(t)},0),this},lg.prototype.stop=function(t){return this._complete||(this._onEnd(t,this._dependencies),this._complete=!0),this},lg);function lg(t,e,i){var r=ag.call(this,t,e,i)||this;return r._context=r._createContext(),r}var dg,hg=(x(cg,dg=Ae),cg.prototype.run=function(t,e,i,r){var n=i,o=function(t,e,i){var r=t(e,i);return void 0===r&&(r=e),r}(t.configure||function(t){return t},e,r);return new(n?ig:ug)(t,r,this._dom).onStart().send(o)},cg);function cg(t){var e=t.dom,i=dg.call(this)||this;return i._dom=e,i}function fg(t,e,i){void 0===e&&(e={}),void 0===i&&(i=!0),i||(e.edges=void 0);var r=function(t,e,i,r){if(void 0===r&&(r=t.getNodes()),!e)return i?t.nodeList():r.filter(function(t){return null===t.getMetaNode()});if(e instanceof mr)return e;if(Array.isArray(e)&&0<e.length)return t.getNodes(e);throw Error("[Layout]: 'nodes' must be a NodeList or an NodeId[]")}(t,e.nodes,e.edges),n=function(t,e,i){if(void 0===i&&(i=t.getEdges()),!e)return i;if(e instanceof $i)return e;if(Array.isArray(e)&&0<e.length)return t.getEdges(e);throw Error("[Layout]: 'edges' must be a EdgeList or a valid EdgeId[]")}(t,e.edges,function(t){if(t.size){for(var e=new Set,i=0,r=t.getId();i<r.length;i++){var n=r[i];e.add(n)}return t.getAdjacentEdges().filter(function(t){return t.getExtremities().getId().every(function(t){return e.has(t)})})}}(r));return I(I({},e),{nodes:r.concat(n.getExtremities()).dedupe(),edges:n})}var gg,pg="complete",_g=500,vg=!0,mg=!0,yg=!1,xg=(x(bg,gg=Ae),bg.prototype.register=function(t,e){if(t in this._layouts)throw new Error("Layout "+t+" already exists");var i=I(I({},e),{name:t});this._layouts[t]=i},bg.prototype.getAvailableLayouts=function(){return Object.keys(this._layouts)},bg.prototype.start=function(u,t){var l=this;void 0===t&&(t={});var d=this._layouts[u],h=fg(this._graph,t,-1===["radial","grid"].indexOf(u));return new Promise(function(r){if(!d)throw new Error("layout "+u+" does not exist");h.duration="number"==typeof h.duration?h.duration:_g;var o=d.onSync;h.skipTextDrawing=void 0===h.skipTextDrawing?!!vg:!!h.skipTextDrawing;var t=h.locate||yg;t&&"boolean"==typeof t&&(t={}),h.locate=t;var e=l._onTaskStart,s=l._onTaskUpdate,n=l._onTaskComplete,i={name:u,update:d.update,isRunning:d.isRunning,configure:d.configure,context:d.context,imports:d.imports,onStart:function(){e(d,h,this)},onUpdate:function(t,e,i){var r=t.lastUpdate||-1/0,n=Kt();i&&n-r<40||(t.lastUpdate=n,s(this,u,t,i,o,h))},onEnd:function(e){var i=this;this.once(pg,function(t){n(i,e,t,d,h,r,i.getData())})}};l._graphics.forceAttributesComputation();var a=void 0===h.useWebWorker?!!mg:!!h.useWebWorker;l._running.push(l._tasks.run(i,h,a,l._modules))})},bg.prototype._animateCamera=function(t,e,i){if(0===t.indexes.length)return Promise.resolve();var r=this._locate.layoutDataBoundingBox(t),n=this._locate.computeConfigForBounds(r,e);return this._camera.setView(n,{duration:i,easing:e.easing})},bg.prototype.stop=function(){for(;0!==this._running.length;){var t=this._running.pop();t.stop(),t.fire(pg,null)}return Promise.resolve()},bg.prototype.isRunning=function(){return 0!==this._running.length},bg.prototype._assignNodePositions=function(t,e,i){if(!t||i){var r=t?new Uint32Array(t.indexes):void 0,n=this._graph.nodeList(r);return Promise.resolve(n)}for(var o=t.indexes,s=t.x,a=t.y,u=this._graph.nodeList(new Uint32Array(o)),l=Eg(t),d=0;d<l.length;d++)l[d]={x:s[d],y:a[d]};return u.setAttributes(l,e)},bg);function bg(t){var f=gg.call(this)||this;return f._running=[],f._onTaskUpdate=function(t,e,i,r,n,o){var s=o.duration,a=o.onSync,u=o.onUpdate,l=o.dryRun,d=o.locate;if(a&&f._dom.setTimeout(function(){return a(i,f._modules,r)},s),n){var h=n(i,f._modules,r);f._events.fire(be.LAYOUT_COMPUTED,{type:be.LAYOUT_COMPUTED,name:e,positions:h}),u&&u(i,h,r);var c=f._assignNodePositions(h,s,l);r||(d&&f._animateCamera(h,d,o.duration),c.then(function(){return t.fire(pg,h)}))}else r||t.fire(pg,i)},f._onTaskComplete=function(t,e,i,r,n,o,s){for(var a=0;a<f._running.length;a++){if(f._running[a]===t){f._running.splice(a,1);break}}r.onEnd&&e&&r.onEnd(e,f._modules),n.skipTextDrawing&&f._dom.setTimeout(function(){return f._graphics.showTexts()},50);var u=f._graph.nodeList(new Uint32Array(s.indexes)),l=n.dryRun&&e?i:Ag(u,f._graph),d=u.getId(),h={before:Eg(s),current:Eg(l)};f._events.fire(be.LAYOUT_END,{type:be.LAYOUT_END,name:r.name,positions:h,ids:d}),f._dom.setTimeout(function(){n.onEnd&&n.onEnd(e),o({name:r.name,positions:h,ids:d})})},f._onTaskStart=function(t,e,i){e.skipTextDrawing&&f._graphics.hideTexts();var r=Ag(f._graph.getNodes(e.nodes),f._graph),n=r.ids;i.setData(r),f._events.fire(be.LAYOUT_START,{type:be.LAYOUT_START,name:t.name,ids:n,task:i})},f._modules=t,f._dom=t.dom,f._events=t.events,f._graph=t.graph,f._graphics=t.graphics,f._tasks=t.tasks,f._locate=t.locate,f._camera=t.camera,f._layouts={},f._events.register([be.LAYOUT_START,be.LAYOUT_END,be.LAYOUT_COMPUTED]),f._events.on(be.CLEAR_GRAPH,function(){return f.stop()}),f}function Eg(t){for(var e=t.x,i=t.y,r=t.indexes.length,n=new Array(r),o=0;o<r;o++)n[o]={x:e[o],y:i[o]};return n}function Ag(t,e){var i=t._indexes,r=e.getNodeAttribute("x").getMultiple(i),n=e.getNodeAttribute("y").getMultiple(i);return{ids:t.getId(),indexes:i,x:r,y:n}}function Sg(value){return"number"==typeof value&&isFinite(value)}var wg=(Tg.prototype.onUpdate=function(t){this._onUpdateHandlers.push(t)},Tg.prototype.getPropertyInfo=function(){return this._info},Tg.prototype.getPath=function(){return this._path.slice()},Tg.prototype.destroy=function(){this._module.unwatchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)},Tg.prototype.kill=function(){return this.destroy()},Tg);function Tg(t,e,i){var r=this,n=i.path,o=i.filter,s=i.unwindArrays;this._module=t,this._isNode=e,this._path=n||[],this._filter=o,this._unwindArrays=s,this._onUpdateHandlers=[],this._triggerUpdate=function(t){for(var e=0;e<r._onUpdateHandlers.length;++e)r._onUpdateHandlers[e](t)},this._info=t.watchPropertyInformation(this._isNode,this._path,this._triggerUpdate,this._filter,this._unwindArrays)}var Cg=(Object.defineProperty(Mg.prototype,"path",{get:function(){return this._path},enumerable:!0,configurable:!0}),Mg.prototype.onPropertyAdded=function(t){return this._onAddHandlers.push(t),this},Mg.prototype.onPropertyRemoved=function(t){return this._onRemoveHandlers.push(t),this},Mg.prototype.onPropertyUpdated=function(t){return this._onUpdateHandlers.push(t),this},Mg.prototype.getPath=function(){return this._path.slice()},Mg.prototype.getProperties=function(){return this._propertyList.slice()},Mg.prototype.getPropertyInfo=function(t){var e=this._properties[t];return e?e.info:null},Mg.prototype.destroy=function(){var n=this;j(this._properties,function(t,e){var i=t.handler,r=n._path.concat([e]);n._module.unwatchPropertyInformation(n._isNode,r,i,n._filter,n._unwindArrays)}),this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[];var t=this._module._objectPropertyWatchers.indexOf(this);this._module._objectPropertyWatchers.splice(t,1)},Mg.prototype.kill=function(){return this.destroy()},Mg.prototype.updateSubPropertiesToWatch=function(t,e){if(t===this._isNode)for(var i=e.getData(this._path),r=0;r<i.length;r++){var n=i[r];if(U(n))for(var o=Object.keys(n),s=0;s<o.length;s++)this._addSubPropertyToWatch(o[s])}},Mg.prototype._addSubPropertyToWatch=function(t){var e=this;if(!this._properties[t]){var i=this._path.concat([t]),r=function(){return e._triggerPropertyUpdate(t)},n=this._unwindArrays,o=this._isNode,s=this._filter,a=this._module.watchPropertyInformation(o,i,r,s,n);this._properties[t]={handler:r,info:a},this._triggerPropertyUpdate(t)}},Mg.prototype._triggerPropertyUpdate=function(t){var e=this._properties[t].info,i=this._propertyList.indexOf(t),r=-1!==i,n="undefined"!==e.getType();!r&&n?(this._propertyList.push(t),this._triggerHandlers("_onAddHandlers",t,e),this._triggerHandlers("_onUpdateHandlers",t,e)):r&&!n?(this._propertyList.splice(i,1),this._triggerHandlers("_onUpdateHandlers",t,e),this._triggerHandlers("_onRemoveHandlers",t,e)):r&&n&&this._triggerHandlers("_onUpdateHandlers",t,e)},Mg.prototype._triggerHandlers=function(t,e,i){for(var r=this[t],n=0,o=r.length;n<o;n++)r[n](e,i)},Mg);function Mg(t,e,i){var r=i.path,n=i.filter,o=i.unwindArrays;this._module=t,this._isNode=e,this._path=r,this._filter=n,this._unwindArrays=o,this._propertyList=[],this._properties={},this._onAddHandlers=[],this._onRemoveHandlers=[],this._onUpdateHandlers=[]}var Ig=(Lg.prototype.setWatcher=function(t){this._watcher=t},Lg.prototype.isNode=function(){return this._watcher.isNode},Lg.prototype.getPath=function(){return this._watcher.property.slice()},Lg.prototype.getBoundaries=function(){var t=this._watcher.boundaries;return t?{min:t.min,max:t.max}:null},Lg.prototype.getValues=function(){return this._watcher.values.keys()},Lg.prototype.getValueCount=function(value){return this._watcher.values.get(value)||0},Lg.prototype.getCount=function(){return this._watcher.total},Lg.prototype.getType=function(){return 0<this._watcher.any?"any":0<this._watcher.numbers?"number":"undefined"},Lg);function Lg(){}function Ng(t){return"number"==typeof t&&isNaN(t)}var Og=(kg.prototype.set=function(t,value){var e=this._getIndex(t);return-1===e?(this._keys.push(t.slice()),this._values.push(value),!0):(this._values[e]=value,!1)},kg.prototype.get=function(t){var e=this._getIndex(t);return-1===e?void 0:this._values[e]},kg.prototype.has=function(t){return-1!==this._getIndex(t)},kg.prototype.delete=function(t){var e=this._getIndex(t);return-1!==e&&(this._keys.splice(e,1),this._values.splice(e,1),!0)},kg.prototype.keys=function(){return this._keys.map(function(t){return t.slice()})},kg.prototype.values=function(){return this._values.slice()},kg.prototype._getIndex=function(t){for(var e=0;e<this._keys.length;e++){var i=this._keys[e];if(i.length===t.length){for(var r=!0,n=0;n<t.length;n++){var o=i[n],s=t[n];if(!(o===s||Ng(o)&&Ng(s))){r=!1;break}}if(r)return e}}return-1},Object.defineProperty(kg.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),kg);function kg(){this._keys=[],this._values=[]}var Fg=(Rg.prototype.clear=function(){return this._arrays=new Og,this._map.clear()},Rg.prototype.delete=function(t){return L(t)?this._arrays.delete(t):this._map.delete(t)},Rg.prototype.get=function(t){return L(t)?this._arrays.get(t):this._map.get(t)},Rg.prototype.set=function(t,value){return L(t)?this._arrays.set(t,value):this._map.set(t,value),this},Rg.prototype.keys=function(){return E(Eo(this._map),this._arrays.keys())},Rg.prototype.values=function(){return E(Ao(this._map),this._arrays.values())},Object.defineProperty(Rg.prototype,"size",{get:function(){return this._map.size+this._arrays.size},enumerable:!0,configurable:!0}),Rg);function Rg(){this._map=new Map,this._arrays=new Og}var Pg,Dg=(x(zg,Pg=Ae),zg.prototype.watchNodeObjectProperty=function(t){return this._watchObjectProperty(!0,Wg(t))},zg.prototype.watchEdgeObjectProperty=function(t){return this._watchObjectProperty(!1,Wg(t))},zg.prototype.watchNodeNonObjectProperty=function(t){return this._watchNonObjectProperty(!0,Wg(t))},zg.prototype.watchEdgeNonObjectProperty=function(t){return this._watchNonObjectProperty(!1,Wg(t))},zg.prototype.watchPropertyInformation=function(t,e,i,r,n){var o=this._findWatcher(t,e,r,n)||this._createWatcher(t,e,r,n);return i&&o.onChange.push(i),o.info},zg.prototype.unwatchPropertyInformation=function(t,e,i,r,n){var o=this._findWatcher(t,e,r,n);if(o){var s=o.onChange,a=s.indexOf(i);if(-1!==a&&(s.splice(a,1),0===s.length)){var u=this._propertyWatchers.indexOf(o);this._propertyWatchers.splice(u,1)}}},zg.prototype._watchObjectProperty=function(t,e){var i=new Cg(this,t,e);return this._objectPropertyWatchers.push(i),i.updateSubPropertiesToWatch(t,this._graph[t?"getNodes":"getEdges"](e.filter)),i},zg.prototype._watchNonObjectProperty=function(t,e){return new wg(this,t,e)},zg.prototype._findWatcher=function(t,e,i,r){for(var n=0;n<this._propertyWatchers.length;++n){var o=this._propertyWatchers[n];if(o.isNode===t&&o.filter===i&&o.unwindArrays===r&&Vg(o.property,e))return o}return null},zg.prototype._createWatcher=function(t,e,i,r){var n={isNode:t,property:e,numbers:0,any:0,total:0,values:new Fg,boundaries:null,onChange:[],filter:i,unwindArrays:r,info:new Ig};return n.info.setWatcher(n),Gg(n,this._graph[t?"getNodes":"getEdges"](i).getData(e)),this._propertyWatchers.push(n),n},zg);function zg(t){var e,i=t.graph,r=t.events,m=Pg.call(this)||this;return m._onExcludedStateChange=function(t){for(var e=t.elements,i=!t.value,r=0,n=m._propertyWatchers.length;r<n;r++){var o=m._propertyWatchers[r];o.isNode===e.isNode&&"visible"===o.filter&&((i?Gg:Hg)(o,e.getData(o.property)),Ug(o))}},m._onDataChange=function(t){for(var e=t.isNode,a=t.changes,i=0;i<m._propertyWatchers.length;++i){var r=(p=m._propertyWatchers[i]).property,n="all"===p.filter;if(p.isNode===e)for(var o=0;o<a.length;++o){var s=a[o],u=jg(s.property||[],r);if(u){var l=s.nodes||s.edges,d=[],h=[];if(l)for(var c=0;c<l.size;++c){var f=l.get(c);(n||f.isVisible())&&(d.push(W(s.newValues[c],u)),h.push(W(s.previousValues[c],u)))}d.length&&(Gg(p,d),Hg(p,h),Ug(p))}}}i=0;for(var g=m._objectPropertyWatchers.length;i<g;i++){var p,_=(p=m._objectPropertyWatchers[i]).path,v=function(t){var e=a[t],i=e.property,r=e.nodes,n=e.edges,o=r||n;if(o){var s=o.isNode;(!i||i.length<=_.length+1&&_.every(function(t,e){return t===i[e]}))&&p.updateSubPropertiesToWatch(s,o)}};for(o=0;o<a.length;++o)v(o)}},m._onElementsAdded=function(t){for(var e=t.nodes||t.edges,i=0;i<m._propertyWatchers.length;++i){var r=m._propertyWatchers[i];if(r.isNode===e.isNode){var n=e.getData(r.property);n.length&&(Gg(r,n),Ug(r))}}for(i=0;i<m._objectPropertyWatchers.length;i++)m._objectPropertyWatchers[i].updateSubPropertiesToWatch(e.isNode,e)},m._onElementsRemoved=function(t){for(var e=t.nodes||t.edges,i=0;i<m._propertyWatchers.length;++i){var r=m._propertyWatchers[i],n="all"===r.filter;if(r.isNode===e.isNode&&n){var o=e.getData(r.property);o.length&&(Hg(r,o),Ug(r))}}},m._onGraphClear=function(){m._propertyWatchers.forEach(function(t){t.numbers=0,t.any=0,t.total=0,t.boundaries=null,t.values.clear()})},m._graph=i,m._propertyWatchers=[],m._objectPropertyWatchers=[],r.on(((e={})[be.EXCLUDED_STATE_CHANGE]=m._onExcludedStateChange,e[be.UPDATE_NODE_DATA+" "+be.UPDATE_EDGE_DATA]=m._onDataChange,e[be.ADD_NODES+" "+be.ADD_EDGES]=m._onElementsAdded,e[be.REMOVE_NODES+" "+be.REMOVE_EDGES]=m._onElementsRemoved,e[be.CLEAR_GRAPH]=m._onGraphClear,e)),m}function Bg(value){return null==value?[]:R(value)}function Ug(t){for(var e=0;e<t.onChange.length;++e)t.onChange[e](t.info)}function Vg(t,e){if(t.length===e.length){for(var i=0;i<t.length;++i)if(t[i]!==e[i])return;return 1}}function jg(t,e){if(t.length>e.length)return null;for(var i=0;i<t.length;++i)if(t[i]!==e[i])return null;return e.slice(i)}function Gg(t,e,i){for(var r=t.values,n=!i&&t.unwindArrays,o=0;o<e.length;++o){var value=e[o];if(i||void 0===value||(t.total+=1),n&&Array.isArray(value))Gg(t,value,!0);else{var s=r.get(value);s?r.set(value,s+1):(r.set(value,1),Sg(value)?(t.boundaries?value<t.boundaries.min?t.boundaries.min=value:value>t.boundaries.max&&(t.boundaries.max=value):t.boundaries={min:value,max:value},t.numbers+=1):void 0!==value&&(t.any+=1))}}}function Hg(t,e,i){for(var r=t.values,n=!i&&t.unwindArrays,o=t.boundaries,s=!1,a=0;a<e.length;++a){var value=e[a];if(i||void 0===value||--t.total,n&&Array.isArray(value))s=s||Hg(t,value,!0);else{var u=r.get(value);1<u?r.set(value,u-1):(r.delete(value),Sg(value)?(--t.numbers,!o||o.min!==value&&o.max!==value||(s=!0)):void 0!==value&&--t.any)}}return!i&&s&&(t.boundaries=function(t){for(var e=null,i=null,r=0;r<t.length;++r){var value=t[r];Sg(value)&&((null==e||value<e)&&(e=value),(null==i||i<value)&&(i=value))}return null==e||null==i?null:{min:e,max:i}}(r.keys())),s}function Wg(t){return"object"!=typeof t||null===t||Array.isArray(t)?{path:Bg(t),filter:"visible",unwindArrays:!1}:{path:Bg(t.path),filter:"all"===(t.filter||"visible")?"all":"visible",unwindArrays:!!t.unwindArrays}}function minHeap(o,s,a,u){void 0===o&&(o=function(t,e){return t-e}),void 0===s&&(s=[]),void 0===a&&(a={}),void 0===u&&(u=function(t){return t});var l=s.length;function e(t){for(;;){var e=2*t+1,i=1+e,r=t;if(e<l&&o(s[e],s[r])<0&&(r=e),i<l&&o(s[i],s[r])<0&&(r=i),r===t)return t;var n=s[r];s[r]=s[t],s[t]=n,a[u(s[r])]=r,a[u(n)]=t,t=r}}return{get keys(){return a},get size(){return l},heapify:e,pop:function(){if(!(l<=0)){if(1===l)return l--,s[0];var t=s[0];return s[0]=s[l-1],l--,e(0),t}},decreaseKey:function(t,value){for(void 0!==value&&(s[t]=value,a[u(value)]=t);0<t;){var e=t-1>>1;if(!(0<o(s[e],s[t])))break;var i=s[t];s[t]=s[e],s[e]=i,a[u(s[t])]=t,t=a[u(i)]=e}return t},min:function(){return s[0]},remove:function(t){return this.decreaseKey(t,Number.NEGATIVE_INFINITY),this.pop()},push:function(t){var e=++l-1;for(s[e]=t;0<e;){var i=e-1>>1;if(!(0<o(s[i],s[e])))break;var r=s[e];s[e]=s[i],s[i]=r,a[u(s[e])]=e,e=a[u(r)]=i}return e},empty:function(){return l<=0},toArray:function(){return s.slice(0,l)}}}function dijkstra(t,e,i,r,n,o,s){var a=(r=r||t.map(function(t,e){return e+1})).length,u=new Float32Array(a),l=new Int32Array(a),d=new Uint32Array(a),h=Number.POSITIVE_INFINITY,c={};if(0===a)return{distances:u,path:null,pathLength:null};if(!n){n={};for(var f=0;f<a;f++)n[r[f]]=f}for(f=0;f<a;f++)u[f]=h,l[f]=-1,d[f]=c[f]=f;var g=minHeap(function(t,e){return u[t]-u[e]},d,c);for(u[n[e]]=0,g.decreaseKey(c[n[e]]);0!==g.size;){var p=g.pop(),_=u[p],v=t[p];if(_===h)break;f=0;for(var m=v.nodes.length;f<m;f++){var y=v.nodes[f],x=o?1:s?s(r[p],y):v.weights?v.weights[f]:1,b=n[y];if(void 0!==b){var E=_+x;E<u[b]&&(u[b]=E,l[b]=p,g.decreaseKey(c[b]))}}}var A=null,S=null;if(void 0!==i){var w=n[i];if(u[w]!==h){A=[];for(f=w;-1!==f;f=l[f])A.push(r[f]);A.reverse(),S=u[i]}}return{distances:u,path:A,pathLength:S}}function qg(t,e){var i=t.getPosition(),r=e.getPosition();return distance(i.x,i.y,r.x,r.y)}var Xg,Yg={pathLengthFunction:qg,heuristicLengthFunction:qg},Zg={pathLengthFunction:function(){return 1},heuristicLengthFunction:function(){return 0}},Kg=(x(Qg,Xg=Ae),Qg.prototype.astar=function(t,e,i){return Jg(this._graph,t,e,this._cachedObjectList,I(I({},Yg),i))},Qg.prototype.dijkstra=function(t,e,i){return Jg(this._graph,t,e,this._cachedObjectList,I(I({},Zg),i))},Qg.prototype.dijkstraBig=function(t,e,i){var r=this._graph.getNode(t),n=this._graph.getNode(e);if(!r||!n)return this._graph.nodeList();var o=this._graph.getNodes(),s=dijkstra(this._graph.getAdjacencyList({directed:i.directed,weight:1,nodes:o}),r._index,n._index,o._indexes,void 0,!1);return s.path?this._graph.nodeList(new Uint32Array(s.path)):this._graph.nodeList()},Qg);function Qg(t){var e=t.graph,i=Xg.call(this)||this;return i._graph=e,i._cachedObjectList=e.getNodeAttribute("object"),i}function Jg(t,e,i,r,n){var o=void 0===n?{}:n,s=o.pathLengthFunction,a=o.heuristicLengthFunction,u=o.filter,l=o.directed,d=t.getNode(e),h=t.getNode(i);if(!d||!h)return t.nodeList();var c,f=d._index,g=h._index,p=s||function(){return 0},_=a||function(){return 0},v=l?yi:xi,m=r.get(f),y=r.get(g);if(f===g)return t.nodeList(new Uint32Array([f]));for(var x=t.getNodeMaxIndex()+1,b=new So,E=new So,A=new Int32Array(x),S=new Float32Array(x),w=new Float32Array(x),T=0;T<x;++T)A[T]=-1,S[T]=1/0,w[T]=1/0;for(E.add(f),S[f]=0,w[f]=_(m,y);0!==E.length;){var C=E.length,M=E.get(0),I=0,L=w[M];for(T=1;T<C;++T){var N=E.get(T),O=w[N];O<L&&(L=O,M=N,I=T)}if(M===g){c=$g(A,f,g);break}var k=r.get(M);E.removeByPosition(I),b.add(M);var F=t.node(M).getAdjacentNodes({direction:v,filter:u})._indexes;for(T=0;T<F.length;++T){var R=F[T],P=r.get(R);if(!b.has(R)){var D=S[M]+p(k,P);!E.add(R)&&D>=S[R]||(A[R]=M,S[R]=D,w[R]=D+_(P,y))}}}return c&&t.nodeList(c)}function $g(t,e,i){for(var r=[i],n=i;n!==e;)n=t[n],r.push(n);return r.reverse(),r}var tp,ep=(x(ip,tp=Ae),Object.defineProperty(ip.prototype,"x",{get:function(){return this._position.x||0},enumerable:!0,configurable:!0}),Object.defineProperty(ip.prototype,"y",{get:function(){return this._position.y||0},enumerable:!0,configurable:!0}),ip.prototype._later=function(){return this._dom.afterNextFrame()},ip.prototype.move=function(t){var i=this,r=t.x,n=t.y;return void 0!==r&&void 0!==n?this._dom.afterNextFrame().then(function(){var t=r-i.x,e=n-i.y;return i._events.fire(be.VIRTUAL_MOVE,{x:r,y:n,dx:t,dy:e}),i._later()}):Promise.resolve()},ip.prototype.down=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,s=void 0===o?Cc.LEFT:o;return this.move({x:r,y:n}).then(function(){return e._events.fire(be.VIRTUAL_DOWN,{x:e.x,y:e.y,button:s}),e._events.fire(be.VIRTUAL_MOVE,{x:e.x,y:e.y,dx:0,dy:0,button:s}),e._later()})},ip.prototype.up=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,s=void 0===o?Cc.LEFT:o;return this.move({x:r,y:n}).then(function(){return e._events.fire(be.VIRTUAL_UP,{x:r,y:n,button:s}),e._later()})},ip.prototype.click=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,s=void 0===o?Cc.LEFT:o;return this.move({x:r,y:n}).then(function(){return e._events.fire(be.VIRTUAL_CLICK,{x:r,y:n,button:s}),e._later()})},ip.prototype.rightClick=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,s=void 0===o?Cc.RIGHT:o;return this.move({x:r,y:n}).then(function(){return e._events.fire(be.VIRTUAL_CLICK,{x:r,y:n,button:s}),e._later()})},ip.prototype.doubleClick=function(t){var e=this,i=void 0===t?{}:t,r=i.x,n=i.y,o=i.button,s=void 0===o?Cc.LEFT:o;return this.move({x:r,y:n}).then(function(){return e._events.fire(be.VIRTUAL_DOUBLE_CLICK,{x:r,y:n,button:s}),e._later()})},ip.prototype.drag=function(t,e){var i=this;return this.down(t).then(function(){return i.move(e)}).then(function(){return i.up(e)})},ip.prototype.wheel=function(t){var e=this,i=t.x,r=t.y,n=t.delta;return this.move({x:i,y:r}).then(function(){return e._events.fire(be.VIRTUAL_WHEEL,{x:i,y:r,delta:n}),e._later()})},ip);function ip(t){var e=t.position,i=t.dom,r=t.events,n=tp.call(this)||this;return n._dom=i,n._events=r,n._position=e,n._events.register([be.VIRTUAL_DOWN,be.VIRTUAL_UP,be.VIRTUAL_MOVE,be.VIRTUAL_CLICK,be.VIRTUAL_DOUBLE_CLICK,be.VIRTUAL_WHEEL]),n}function rp(t,e,i,r,n,o){var s=wt(),a=o.graphToScreenCoordinates(t),u=o.graphToScreenCoordinates(e);n.beginPath(),n.moveTo(a.x*s,a.y*s),n.lineTo(u.x*s,u.y*s),n.strokeStyle=r,n.lineWidth=i,n.stroke()}function np(t,e,i,r){for(var n,o,s=0,a=t.length-1;s<a;)n=(s+a)/2|0,o=Math.abs(e[t[n]]-i),Math.abs(e[t[1+n]]-i)<=o?s=1+n:a=n;return r?a:t[a]}function op(t,e,i,r,n,o,s){for(var a,u,l=0,d=t.length;l<d;l++)for(var h=0;h<d;h++)if(l!==h){var c=t[l],f=t[h];h<l&&(a=f,f=c,c=a);var g=e[c],p=e[f],_=o.get(c),v=o.get(f);if(g+_<r-n&&r+n<p-v&&Math.abs(Math.abs(g+_-(r-n))-Math.abs(p-v-(r+n)))<=s)return{a:c,b:i,c:f,current:i,target:u=g+_+Math.abs(p-v-(g+_))/2,points:[g+_,u-n,u+n,p-v]};if(g+_<r-n&&p+v<r-n&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.max(g+_,p+v)-(r-n)))<=s)return{a:c,b:f,c:i,current:i,target:u=p+_+Math.abs(Math.abs(g+_-(p-v)))+n,points:[g+_,p-v,p+v,u-n]};if(r+n<g-_&&r+n<p-v&&Math.abs(Math.abs(g+_-(p-v))-Math.abs(Math.min(g-_,p-v)-(r+n)))<=s)return{a:i,b:c,c:f,current:i,target:u=g-_-Math.abs(Math.abs(g+_-(p-v)))-n,points:[u+n,g-_,g+_,p-v]}}return null}var sp,ap,up={tolerance:5,centerSnapDistance:240,sideSnapDistanceFactor:3,guidelineWidth:1,guidelineColor:"#ff0000",preferredDistance:{enabled:!0,ratio:1.13,tolerance:10,lineColor:"#00C3FF",lineWidth:1},neighbours:{enabled:!0,offset:5,tolerance:3,lineColor:"#00C3FF",lineWidth:1}};(ap=sp=sp||{})[ap.NONE=0]="NONE",ap[ap.CENTER=1]="CENTER",ap[ap.LEFT=2]="LEFT",ap[ap.RIGHT=3]="RIGHT",ap[ap.TOP=4]="TOP",ap[ap.BOTTOM=5]="BOTTOM";var lp,dp=(x(hp,lp=Ae),hp.prototype.enable=function(t){var n=this;this._enabled||(this._options=J(t,up),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._events.on(be.NODES_DRAG_START,this._onNodeDragStart),this._events.on(be.NODES_DRAG_END,this._onNodeDragEnd),this._settings.update({"interactions.drag.onBeforeDrag":function(t,e,i,r){return n._onBeforeDrag(e,i,r)}}))},hp.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._onNodeDragStart),this._events.removeListener(this._onNodeDragEnd),this._graphics.removeCanvas(this._canvas),this._settings.update({"interactions.drag.onBeforeDrag":null}),this._enabled=!1)},hp.prototype.enabled=function(){return this._enabled},hp.prototype._onBeforeDrag=function(t,e,i){if(this._node){var r=i[0];this._scan(r),this._node.setAttributes(r)}},hp.prototype._cacheViewportData=function(){var t=this._camera,e=t.screenToGraphCoordinates({x:0,y:0}),i=t.screenToGraphCoordinates({x:t.width,y:t.height});if(this._nodes=this._spatial.getNodesByBoundingBox(e.x,e.y,i.x,i.y),null!=this._node){var r=this._node._index,n=Array.from(this._nodes._indexes);n.splice(n.indexOf(r),1);var o=this._graph.getNodeAttribute("radius"),s=this._graph.getNodeAttribute("x"),a=this._graph.getNodeAttribute("y"),u=s.buffer(),l=a.buffer(),d=X(n.slice(),s),h=X(n.slice(),a),c={},f={};this._gridResolution=this._node.getAttribute("radius");for(var g=this._gridResolution,p=0,_=n.length;p<_;p++){var v=d[p],m=h[p],y=u[v]/g|0,x=l[m]/g|0;c[y]||(c[y]=[]),f[x]||(f[x]=[]),c[y].push(v),f[x].push(m)}this._nodesByX=d,this._nodesByY=h,this._xGrid=c,this._yGrid=f,this._xList=s,this._yList=a,this._X=u,this._Y=l,this._R=o}},hp.prototype._scan=function(t){if(En(this._canvas,this._ctx),null!=this._node){var e,i,r,n,o,s,a,u,l=this._node._index,d=t.x,h=t.y,c=this._r,f=this._options,g=this._xList,p=this._yList,_=this._R,v=this._X,m=this._Y,y=this._camera.zoom,x=Math.min(c,this._options.tolerance/y),b=2*c*f.sideSnapDistanceFactor,E=f.guidelineWidth,A=f.guidelineColor,S=l,w=l,T=null,C=!1,M=!1;if(S=np(this._nodesByX,v,d),w=np(this._nodesByY,m,h),Math.abs(v[S]-d)>f.centerSnapDistance&&(S=l),Math.abs(m[w]-h)>f.centerSnapDistance&&(w=l),this._xsnap=sp.NONE,S!==l){e=this._vguideline.start,i=this._vguideline.end,r=v[u=S],n=m[u],T=_.get(u),a=Math.abs(d-r);var I=Math.abs(d-c-(r-T)),L=Math.abs(d+c-(r+T));a<Math.max(c,T)&&(n<h?(e.y=n-T,i.y=h+c):(e.y=n+T,i.y=h-c),(N=Math.min(I,a,L))===a?(e.x=i.x=r,i.y=h,e.y=n,this._xsnap=sp.CENTER):Math.abs(h-n)<T+c+b&&(N===I?(e.x=i.x=r-T,this._xsnap=sp.LEFT):(e.x=i.x=r+T,this._xsnap=sp.RIGHT)),N<x&&(C=!0)),this._xsnap!==sp.NONE&&rp(e,i,E,A,this._ctx,this._camera)}if(this._ysnap=sp.NONE,w!==l){e=this._hguideline.start,i=this._hguideline.end,r=v[u=w],n=m[u],T=_.get(u),a=Math.abs(h-n);var N,O=Math.abs(h-c-(n-T)),k=Math.abs(h+c-(n+T));a<Math.max(c,T)&&(r<d?(e.x=r-T,i.x=d+c):(e.x=r+T,i.x=d-c),(N=Math.min(O,a,k))===a?(e.y=i.y=n,i.x=d,e.x=r,this._ysnap=sp.CENTER):Math.abs(d-r)<T+c+b&&(N===O?(e.y=i.y=n-T,this._ysnap=sp.TOP):(e.y=i.y=n+T,this._ysnap=sp.BOTTOM)),N<x&&(M=!0)),this._ysnap!==sp.NONE&&rp(e,i,E,A,this._ctx,this._camera)}if(null!=T&&f.preferredDistance.enabled){var F=f.preferredDistance.ratio,R=Math.min(f.preferredDistance.tolerance/y,c),P=Math.max(c,T);if(S===l||this._xsnap!==sp.NONE&&C)w!==l&&(this._ysnap===sp.NONE||!M)&&(r=v[u=w],n=m[u],T=_.get(u),(s=Math.abs(h-n)-(c+T)*(1+F))<=R&&-R<=s)&&(D=h<n?-1:1,e=this._hguideline.start,i=this._hguideline.end,e.x=r-P,i.x=r+P,e.y=i.y=n,rp(e,i,E,A,this._ctx,this._camera),e.x=d-P,i.x=d+P,e.y=i.y=n+D*(1+F)*(c+T),rp(e,i,E,A,this._ctx,this._camera),this._ysnap=sp.CENTER,M=!0);else if(r=v[u=S],n=m[u],T=_.get(u),(o=Math.abs(d-r)-(c+T)*(1+F))<=R&&-R<=o){var D=d<r?-1:1;e=this._vguideline.start,i=this._vguideline.end,e.x=i.x=r+D*(1+F)*(c+T),e.y=n-P,i.y=n+P,e.x=i.x=r,rp(e,i,E,A,this._ctx,this._camera),e.y=h-P,i.y=h+P,e.x=i.x=r+D*(1+F)*(c+T),rp(e,i,E,A,this._ctx,this._camera),this._xsnap=sp.CENTER,C=!0}}if(f.neighbours.enabled){var z=this._gridResolution,B=d/z|0,U=h/z|0,V=this._xGrid,j=this._yGrid,G=[],H=[].concat(j[U-1]||G,j[U]||G,j[1+U]||G),W=[].concat(V[B-1]||G,V[B]||G,V[1+B]||G),q=void 0;1<H.length&&(X(H,g),(q=op(H,v,l,d,c,_,x))&&(this._drawNeighbourGuidelines(q,t,!1),C=!1)),1<W.length&&!q&&(X(W,p),(q=op(W,m,l,h,c,_,x))&&(this._drawNeighbourGuidelines(q,t,!0),M=!1))}(C||M)&&this._snap(t,!C,!M)}},hp.prototype._drawNeighbourGuidelines=function(t,e,i){var r,n,o=t.a,s=t.b,a=t.c,u=t.points,l=t.target,d={x:0,y:0},h={x:0,y:0},c=this._R,f=this._X,g=this._Y,p=c.getMultiple([o,s,a]),_=p[0],v=p[1],m=p[2],y=this._options.neighbours,x=y.offset,b=y.lineWidth,E=y.lineColor;n=i?(e.y=l,_=-_,v=-v,m=-m,r=h.x=d.x=Math.min(f[o]+_,f[s]+v,f[a]+m)-x,f):(e.x=l,r=h.y=d.y=Math.max(g[o]+_,g[s]+v,g[a]+m)+x,g);var A=i?"y":"x",S=i?"x":"y";d[A]=u[0],h[A]=u[1],rp(d,h,b,E,this._ctx,this._camera),d[A]=u[2],h[A]=u[3],rp(d,h,b,E,this._ctx,this._camera),d[A]=u[0],d[S]=r-x/2,h[A]=u[0],d[S]=n[o]+_,rp(d,h,b,E,this._ctx,this._camera),d[A]=u[1],d[S]=r-x/2,h[A]=u[1],d[S]=n[s]+v,rp(d,h,b,E,this._ctx,this._camera),d[A]=u[2],d[S]=r-x/2,h[A]=u[2],d[S]=n[s]+v,rp(d,h,b,E,this._ctx,this._camera),d[A]=u[3],d[S]=r-x/2,h[A]=u[3],d[S]=n[a]+m,rp(d,h,b,E,this._ctx,this._camera)},hp.prototype._snap=function(t,e,i){var r,n=this._xsnap,o=this._ysnap;e||n===sp.NONE||(r=this._vguideline.end,n===sp.LEFT?t.x=r.x+this._r:n===sp.RIGHT?t.x=r.x-this._r:t.x=r.x),i||o===sp.NONE||(r=this._hguideline.end,o===sp.TOP?t.y=r.y+this._r:o===sp.BOTTOM?t.y=r.y-this._r:t.y=r.y)},hp);function hp(t){var e=t.graph,i=t.graphics,r=t.spatial,n=t.camera,o=t.events,s=t.settings,a=lp.call(this)||this;return a._options=G(up),a._enabled=!1,a._ysnap=sp.NONE,a._xsnap=sp.NONE,a._node=null,a._nodes=null,a._r=0,a._vguideline={start:{x:0,y:0},end:{x:0,y:0}},a._hguideline={start:{x:0,y:0},end:{x:0,y:0}},a._gridResolution=0,a._onNodeDragStart=function(t){var e=t.nodes;1===e.size&&(a._node=e.get(0),a._cacheViewportData(),a._r=a._node.getAttribute("radius"))},a._onNodeDragEnd=function(){a._node=null,En(a._canvas,a._ctx)},a._graph=e,a._graphics=i,a._spatial=r,a._settings=s,a._events=o,a._camera=n,a._options=G(up),a._enabled=!1,a._canvas=bn(),a._ctx=a._canvas.getContext("2d"),a}var cp=(fp.prototype.getId=function(){return this._id},fp.prototype.whenApplied=function(){return this._whenApplied},fp.prototype.refresh=function(){return this._module.refreshRule(this._id)},fp.prototype.getIndex=function(){return this._module.getRuleIndex(this._id)},fp.prototype.setIndex=function(t){return this._module.setRuleIndex(this._id,t)},fp.prototype.update=function(t){return this._module.updateRule(this._id,t)},fp.prototype.getDefinition=function(){return this._module.getRuleDefinition(this._id)},fp.prototype.destroy=function(){return this._module.destroyRule(this._id)},fp.prototype.delete=function(){return this.destroy()},fp);function fp(t,e,i){var r=this;this._module=t,this._id=e,this._whenApplied=i.then(function(){return r})}var gp,pp=(x(_p,gp=Ae),_p.prototype._get=function(t){for(var e=0;e<this._rules.length;++e){var i=this._rules[e];if(i.id===t)return i.index=e,i}throw new Error("calling a method on a destroyed style rule")},_p.prototype._updatePriorities=function(){for(var t=0;t<this._rules.length;++t){var e=3+.001*t;this._rules[t].attributeLayer.update({priority:e})}},_p.prototype.addRule=function(t){void 0===t&&(t={});var e=this._idCounter++,i=this._graphics.addAttributeLayer(I({name:"rule("+e+")"},vp(t))),r=this._dom.afterNextFrame(),n=new cp(this,e,r),o={id:e,attributeLayer:i,wrapper:n};return this._rules.push(o),this._updatePriorities(),n},_p.prototype.getRuleIndex=function(t){var e=this._get(t);return null==e.index?null:e.index},_p.prototype.setRuleIndex=function(t,e){var i=this._get(t),r=Ye(e,0,this._rules.length-1);return this._rules.splice(i.index,1),this._rules.splice(r,0,i),this._updatePriorities(),this._dom.afterNextFrame()},_p.prototype.updateRule=function(t,e){var i=this._get(t),r=Object.assign({fullOverwrite:e.fullOverwrite},vp(e));return i.attributeLayer.update(r),this._dom.afterNextFrame()},_p.prototype.getRuleDefinition=function(t){return vp(this._get(t).attributeLayer.getDefinition())},_p.prototype.destroyRule=function(t){var e=this._get(t);return e.attributeLayer.destroy(),this._rules.splice(e.index,1),this._dom.afterNextFrame()},_p.prototype.refreshRule=function(t){return this._get(t).attributeLayer.updateAll(),this._dom.afterNextFrame()},_p.prototype.refreshAllRules=function(){for(var t=0;t<this._rules.length;t++)this._rules[t].attributeLayer.updateAll();return this._dom.afterNextFrame()},_p.prototype.getRuleList=function(){return this._rules.map(function(t){return t.wrapper})},_p);function _p(t){var e=t.graphics,i=t.dom,r=gp.call(this)||this;return r._idCounter=1,r._rules=[],r._graphics=e,r._dom=i,r._rules=[],r}function vp(t){return{nodeAttributes:t.nodeAttributes,edgeAttributes:t.edgeAttributes,nodeSelector:t.nodeSelector,edgeSelector:t.edgeSelector,nodeDependencies:t.nodeDependencies,edgeDependencies:t.edgeDependencies,nodeOutput:t.nodeOutput,edgeOutput:t.edgeOutput}}var mp,yp={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){return t.nodes.setSelected(!0)},bothExtremities:!1},xp=(x(bp,mp=Ae),bp.prototype.enable=function(t){return this._enabled||(this._enabled=!0,this._captor.setDetectionEnabled(!1),this._options=J(t,yp),this._graphics.addCanvas(this._canvas),Vt(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition())),this},bp.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._captor.setDetectionEnabled(!0),this._graphics.removeCanvas(this._canvas)),this},bp.prototype.enabled=function(){return this._enabled},bp.prototype.savePoint=function(t,e,i){var r=wt(),n=this._ctx,o=this._options,s=this._points;if(this._bbox.addPoint(t,e),n.clearRect(0,0,this._canvas.width,this._canvas.height),s.push({x:t,y:e}),i){var a=s[0];n.lineWidth=o.strokeWidth,n.lineJoin="bevel",n.strokeStyle=o.strokeColor,n.fillStyle=o.fillColor,n.beginPath(),n.moveTo(a.x*r,a.y*r);for(var u=1;u<s.length;++u){var l=s[u];n.lineTo(l.x*r,l.y*r)}n.stroke(),o.fillColor&&n.fill()}},bp.prototype.filterByExtremities=function(t,n){var o=this._graph.getEdgeAttribute("source"),s=this._graph.getEdgeAttribute("target");return t.filter(function(t){var e=t._index,i=o.get(e),r=s.get(e);return n[i]&&n[r]})},bp);function bp(t){var e=t.locate,i=t.graphics,r=t.captor,n=t.graph,o=t.spatial,s=t.interactions,h=mp.call(this)||this;return h._enabled=!1,h._points=[],h._bbox=new ss,h._onStart=function(t){var e=t.x,i=t.y;h._bbox.reset(),h.savePoint(e,i,!1)},h._onStop=function(){var t=h._bbox,e=t.minX,i=t.minY,r=t.maxX,n=t.maxY,o=h._spatial.queryProjected(e,i,r,n),s=o.nodes,a=o.edges,u={},l=s.filter(function(t){var e=t.isVisible(),i=t.getAttribute("detectable"),r=e&&i&&h._locate.isNodeInPolygon(t,h._points);return u[t._index]=r}),d=a.filter(function(t){var e=t.isVisible(),i=t.getAttribute("detectable");return e&&i&&h._locate.isEdgeInPolygon(t,h._points)});h._options.bothExtremities&&(d=h.filterByExtremities(d,u)),h._ctx.clearRect(0,0,h._canvas.width,h._canvas.height),h._points=[],h.disable(),h._options.callback({nodes:l,edges:d})},h._locate=e,h._graph=n,h._graphics=i,h._captor=r,h._interactions=s,h._spatial=o,h._options=G(yp),h._canvas=bn(),h._ctx=h._canvas.getContext("2d"),h._interaction=h._interactions.onDrag({priority:"lasso",check:function(){return h._enabled},onStart:h._onStart,onProgress:function(t){var e=t.x,i=t.y;return h.savePoint(e,i,!0)},onStop:h._onStop}),h}var Ep,Ap={strokeColor:"#00C3FF",fillColor:"rgba(0,195,255,0.1)",strokeWidth:1,cursorStyle:"cell",callback:function(t){var e=t.nodes,i=t.edges;e.size?e.setSelected(!0):i.setSelected(!0)},bothExtremities:!1},Sp=(x(wp,Ep=xp),wp.prototype.enable=function(t){return this._enabled||(this._enabled=!0,this._options=J(t,Ap),this._graphics.addCanvas(this._canvas),Vt(this._canvas,this._options.cursorStyle),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorPosition())),this},wp.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas)),this},wp.prototype.enabled=function(){return this._enabled},wp.prototype._formatRectangle=function(t){var e=this._start.x,i=this._start.y,r=t.x,n=t.y,o=Math.abs(e-r),s=Math.abs(i-n),a=e<r?e:r,u=i<n?i:n;return this._rectangle.reset().addPoint(a,u).addPoint(a+o,u+s)},wp.prototype._refreshRectangle=function(t){var e=this._formatRectangle(t),i=e.minX,r=e.minY,n=e.width,o=e.height,s=wt();En(this._canvas,this._ctx),this._ctx.strokeRect(i*s,r*s,n*s,o*s),this._options.fillColor&&this._ctx.fillRect(i*s,r*s,n*s,o*s)},wp);function wp(t){var u=Ep.call(this,t)||this;return u._options=G(Ap),u._canvas=bn(),u._ctx=u._canvas.getContext("2d"),u._enabled=!1,u._rectangle=new ss,u._interaction=u._interactions.onDrag({priority:"lasso",disableDetection:!0,check:function(){return u._enabled},onStart:function(t){var e=t.x,i=t.y;u._rectangle.reset(),u._start={x:e,y:i},u._ctx.fillStyle=u._options.fillColor,u._ctx.strokeStyle=u._options.strokeColor,u._ctx.lineWidth=u._options.strokeWidth},onProgress:function(t){var e=t.x,i=t.y;return u._refreshRectangle({x:e,y:i})},onStop:function(){var t=u._captor.getCursorPosition(),n=u._formatRectangle(t),e=u._spatial.queryProjected(n.minX,n.minY,n.maxX,n.maxY),i=e.nodes,r=e.edges,o={},s=i.filter(function(t){var e=t.isVisible(),i=t.getAttribute("detectable"),r=e&&i&&u._locate.isNodeInRectangle(t,n);return o[t._index]=r}),a=r.filter(function(t){var e=t.isVisible(),i=t.getAttribute("detectable");return e&&i&&u._locate.isEdgeInRectangle(t,n)});u._options.bothExtremities&&(a=u.filterByExtremities(a,o)),En(u._canvas,u._ctx),u.disable(),u._options.callback({nodes:s,edges:a})}}),u}function Tp(t,e,i,r,n,o,s,a){void 0===n&&(n=0),void 0===o&&(o=Math.sin(n)),void 0===s&&(s=Math.cos(n)),void 0===a&&(a=[0,0,0,0]);var u,l,d,h,c,f,g,p,_=i/2,v=r/2,m=t+_,y=e+v;return 0===n?(a[0]=t,a[1]=e,a[2]=t+i,a[3]=e+r):(c=g=u=m+(d=-_)*s-(h=-v)*o,f=p=l=y+d*o+h*s,(u=m+(d=-_)*s-(h=v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*s)<f?f=l:p<l&&(p=l),(u=m+(d=_)*s-(h=v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*s)<f?f=l:p<l&&(p=l),(u=m+(d=_)*s-(h=-v)*o)<c?c=u:g<u&&(g=u),(l=y+d*o+h*s)<f?f=l:p<l&&(p=l),a[0]=c,a[1]=f,a[2]=g,a[3]=p),a}function Cp(t,e,i,r,n){void 0===n&&(n=0);var o=i/2,s=r/2,a=t+o,u=e+s;if(0===n)return[{x:t,y:e},{x:t+i,y:e},{x:t+i,y:e+r},{x:t,y:e+r}];var l,d,h=Math.sin(n),c=Math.cos(n);return[{x:a+(l=-o)*c-(d=-s)*h,y:u+l*h+d*c},{x:a+(l=-o)*c-(d=s)*h,y:u+l*h+d*c},{x:a+(l=o)*c-(d=s)*h,y:u+l*h+d*c},{x:a+(l=o)*c-(d=-s)*h,y:u+l*h+d*c}]}function Mp(t,e,i,r){void 0===e&&(e=0),void 0===i&&(i=1),void 0===r&&(r=Ta.slice());var n=i*Math.sin(e),o=i*Math.cos(e);return r[0]=t[0]+n,r[1]=t[1]+o,r[2]=t[2]+n,r[3]=t[3]+o,r}function Ip(t,e,i,r,n,o,s,a){return n<t&&t<s&&o<e&&e<a||n<i&&i<s&&o<r&&r<a}function Lp(t,e,i,r,n,o,s,a){return o<=r&&e<=a&&n<=i&&t<=s}function Np(t,e,i,r,n,o){return{minX:t,minY:e,maxX:i,maxY:r,leaf:!0,level:o,parent:n,objects:[],final:!1,children:[]}}function Op(t){return[t.minX,t.minY,t.maxX,t.maxY]}function kp(t,e,i,r,n,o,s,a){var u=(t+i)/2,l=(e+r)/2;return n<=u&&u<=s&&o<=l&&l<=a}var Fp=0,Rp=1,Pp=2,Dp=3;function zp(t,e,i,r,n,o,s,a){var u=(o+a)/2,l=(e+r)/2;return(t+i)/2<=(n+s)/2?l<=u?Fp:Rp:l<=u?Dp:Pp}function Bp(t){return t}var Up=(Object.defineProperty(Vp.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(Vp.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),Vp.prototype.clear=function(){return this._root=null,this._objects={},this._size=0,this._idToCell={},this._rootLevel=0,this._maxLevel=this._rootLevel+30,this},Vp.prototype.insert=function(t,e,i){if(void 0===i&&(i=this._root),e=e||this._getBBox(t),!this._objects[t]){if(this._objects[t]=!0,this._size++,!this._root){var r=Math.max(Math.abs(e[2]-e[0]),Math.abs(e[3]-e[1]));return this._root=Np(e[0],e[1],e[0]+r,e[1]+r,null,this._rootLevel),this._root.objects=[t],t}for(var n,o,s=[i],a=!1,u=this._nodeCapacity,l=this._idToCell,d=this._maxLevel;o=s.pop();){var h=(n=o).minX,c=n.minY,f=n.maxX,g=n.maxY;Lp(e[0],e[1],e[2],e[3],h,c,f,g)&&(n.leaf?n.objects&&(n.objects.length<u||n.final)?(n.objects.push(t),l[t]?l[t].push(n):l[t]=[n],a=!0,(n.level>=d||Math.abs(f-h)<=Math.abs(e[2]-e[0])||Math.abs(g-c)<=Math.abs(e[3]-e[1]))&&(n.final=!0)):(this.splitNode(n),s.push(n)):s.push.apply(s,n.children))}if(a)return t;if(i=this._root,!kp(e[0],e[1],e[2],e[3],i.minX,i.minY,i.maxX,i.maxY)){var p,_=this._rootLevel,v=(e[0]+e[2])/2,m=(e[1]+e[3])/2;for(p=this._root?this._root:{minX:1/0,maxX:-1/0,minY:1/0,maxY:-1/0};!kp(e[0],e[1],e[2],e[3],this._root.minX,this._root.minY,this._root.maxX,this._root.maxY);){var y=h=(p=this._root).minX,x=c=p.minY,b=f=p.maxX,E=g=p.maxY,A=Math.abs(f-h),S=Math.abs(g-c);if(0===S&&0===A)break;var w=Math.max(A,S);v<=h&&(y-=w),m<=c&&(x-=w),h<v&&(b+=w),c<m&&(E+=w);var T=Np(y,x,b,E,null,--_);this.splitNode(T),T.children[zp(h,c,f,g,y,x,b,E)]=p,this._root=p.parent=T}for(s=[this._root],this._root.level=this._rootLevel;o=s.shift();)if(!(n=o).leaf)for(var C=0;C<4;C++){var M=n.children[C];M.level=n.level+1,s.push(M)}}return(n=(i=this._root).children[zp(e[0],e[1],e[2],e[3],i.minX,i.minY,i.maxX,i.maxY)]).leaf&&n.objects&&(n.objects.push(t),l[t]?l[t].push(n):l[t]=[n]),t}},Vp.prototype.removeById=function(t){if(!this._objects[t])return t;this._size--;for(var e=this._idToCell[t],i=0;i<e.length;i++)for(var r=e[i].objects||[],n=0,o=r.length;n<o;n++)if(r[n]===t){r.splice(n,1);break}return delete this._objects[t],delete this._idToCell[t],t},Vp.prototype.remove=function(t){for(var e,i,r=this._getBBox(t),n=r[0],o=r[1],s=r[2],a=r[3],u=[this._root],l=[];e=u.pop();)if(Lp(n,o,s,a,e.minX,e.minY,e.maxX,e.maxY))if(e.leaf){for(var d=e.objects||[],h=0,c=d.length;h<c;h++)if(d[h]===t){d.splice(h,1),1===c&&l.push(e);break}}else u.push.apply(u,e.children);if(delete this._idToCell[t],delete this._objects[t],this._size--,l.length)for(;i=l.pop();)for(var f=i.parent,g=!0;f&&g;){if(!f.leaf){for(h=0;h<4;h++)if(!(e=f.children[h]).leaf||e.objects&&0!==e.objects.length){g=!1;break}g&&(f.leaf=!0,f.children=[],f.objects=[])}f=f.parent}return t},Vp.prototype.splitNode=function(t){var e=t.minX,i=t.minY,r=t.maxX,n=t.maxY,o=(e+r)/2,s=(i+n)/2,a=t.level+1,u=this._idToCell,l=this._maxLevel,d=[Np(e,i,o,s,t,a),Np(e,s,o,n,t,a),Np(o,s,r,n,t,a),Np(o,i,r,s,t,a)];if(null!==t.objects)for(var h=t.objects,c=this._getBBox,f=0,g=h.length;f<g;f++){for(var p=h[f],_=c(p),v=u[p],m=0;m<4;m++){var y=d[m],x=y.minX,b=y.minY,E=y.maxX,A=y.maxY;Lp(_[0],_[1],_[2],_[3],x,b,E,A)&&(y.objects&&y.objects.push(p),(y.level>=l||Math.abs(E-x)<=Math.abs(_[2]-_[0])||Math.abs(A-b)<=Math.abs(_[3]-_[1]))&&(y.final=!0),v?v.push(y):v=[y])}v.splice(v.indexOf(t),1)}t.children=d,t.objects=null,t.leaf=!1},Vp.prototype.point=function(t,e,i){for(var r,n,o,s=[],a=[this._root],u=this._getBBox;r=a.pop();)if(t>=r.minX&&t<=r.maxX&&e>=r.minY&&e<=r.maxY){if(r.leaf){i&&r.objects&&(s=r.objects);for(var l=r.objects||[],d=0,h=l.length;d<h;d++)t>=(n=u(o=l[d]))[0]&&t<=n[2]&&e>=n[1]&&e<=n[3]&&s.push(o);break}a.push.apply(a,r.children)}return s.length?s:null},Vp.prototype.neigbours=function(t,e){for(var i,r=[],n=[this._root];i=n.pop();)if(t>=i.minX&&t<=i.maxX&&e>=i.minY&&e<=i.maxY){if(i.leaf){r=i.objects;break}n.push.apply(n,i.children)}return r},Vp.prototype.query=function(t,e,i,r){for(var n,o,s,a=[],u=[this._root],l=this._getBBox,d={};n=u.pop();)if(Lp(t,e,i,r,n.minX,n.minY,n.maxX,n.maxY))if(n.leaf)for(var h=n.objects||[],c=0,f=h.length;c<f;c++)d[s=h[c]]||(Lp(t,e,i,r,(o=l(s))[0],o[1],o[2],o[3])&&a.push(s),d[s]=!0);else u.push.apply(u,n.children);return a},Vp.prototype.getOverlaps=function(){for(var t,e,i,r=[this._root],n=[],o=this._getBBox,s={};t=r.pop();)if(t.leaf){for(var a=t.objects||[],u=a.length,l=0;l<u;l++)for(var d=0;d<u;d++)if(e=a[l],i=a[d],l!==d&&!s[e+":"+i]&&!s[i+":"+e]){s[e+":"+i]=!0;var h=o(e),c=o(i);Lp(h[0],h[1],h[2],h[3],c[0],c[1],c[2],c[3])&&n.push(e,i)}}else r.push.apply(r,t.children);return n},Vp.prototype.getAll=function(){return Object.keys(this._objects).map(function(t){return Number(t)})},Vp.prototype.forEach=function(t,e){for(var i,r=[this._root];i=r.pop();)if(i.leaf&&i.objects)for(var n=0,o=i.objects.length;n<o;n++)t.call(e,i.objects[n]);else r.push.apply(r,i.children);return this},Vp.prototype.getLeafs=function(){for(var t,e=[this._root],i=[];t=e.pop();)t.leaf?i.push(t):e.push.apply(e,t.children);return i},Vp.prototype.traverse=function(t,e){for(var i,r=[this._root];i=r.pop();)t.call(e,i,i.objects)||i.leaf||r.push.apply(r,i.children);return this},Vp.prototype.update=function(t){return this.remove(t),this.insert(t,this._getBBox(t)),this},Vp.prototype.getNodeBounds=function(t){return Op(t)},Vp.flatAccessor=function(i,r){return function(t){var e=r*t;return i.slice(e,e+r)}},Vp.inside=kp,Vp.intersects=Ip,Vp.overlaps=Lp,Vp.getNodeBBox=Op,Vp);function Vp(t,e,i,r){void 0===t&&(t=Bp),void 0===e&&(e=10),void 0===r&&(r=0),this._nodeCapacity=10,this._root=null,this._objects={},this._size=0,this._rootLevel=0,this._maxLevel=30,this._idToCell={},this._nodeCapacity=e,this._root=null,this._getBBox=t,this._rootLevel=r,this._maxLevel=r+30,this._idToCell={},i&&(this._root=Np(i[0],i[1],i[2],i[3],null,r))}var jp={left:-1,right:1,top:0,bottom:0,center:0},Gp={left:0,right:0,top:-1,bottom:1,center:0},Hp={left:-1,right:0,top:-.5,bottom:-.5,center:-.5},Wp={left:-.5,right:-.5,top:-1,bottom:0,center:-.5};var qp={x1:0,y1:0,x2:0,y2:0},Xp={x:0,y:0},Yp={x:0,y:0},Zp=Math.PI/2;function Kp(t,e,i,r){void 0===r&&(r="#ff0000"),e.strokeStyle=r,e.lineWidth=1,e.beginPath();for(var n=wt(),o=0,s=t.length;o<s;o++){var a=i.graphToScreenCoordinates(t[o]);0===o?e.moveTo(a.x*n,a.y*n):e.lineTo(a.x*n,a.y*n)}e.closePath(),e.stroke()}function Qp(e,t,i,r,n,o){e.clearRect(0,0,t.width,t.height);for(var s=0,a=r.length;s<a;s+=6)u=r.slice(s,s+4),l=e,d=i,void 0===(h="#aaaaaa")&&(h="#22ff00"),Kp([[u[0],u[1]],[u[2],u[1]],[u[2],u[3]],[u[0],u[3]]].map(function(t){return{x:t[0],y:t[1]}}),l,d,h);var u,l,d,h;for(s=0;s<n.length;s+=5){Kp(Cp(n[s],n[s+1],n[s+2],n[s+3],n[s+4]),e,i,"green")}o.forEach(function(t){return Kp(t,e,i,"red")})}var Jp,$p=["x","y","radius","width","layer","text.content","text.minVisibleSize","text.size","text.scale","text.scaling","text.padding","text.margin","text.position","text.style"].reduce(function(t,e){return t.add(e),t},new Set),t_=(x(e_,Jp=Ae),e_.prototype.getTextsBoundingBox=function(){this._updateLabels();for(var t=this._rects,e=this._textBBoxes,i=new ss,r=this._graphics.getNodeAttributes(),n=this._graphics.getEdgeAttributes(),o=r.excluded,s=n.excluded,a=0;a<t.length;a++){var u=5*a,l=1===e[6*a+4],d=e[6*a+4];if(!(l?o.get(d):s.get(d))){var h=Tp(t[u],t[1+u],t[2+u],t[3+u],t[4+u]),c=h[0],f=h[1],g=h[2],p=h[3];i.addPoint(c,f).addPoint(g,p)}}return i},e_.prototype.setRate=function(t){var e=this;this._updateDebounced=this._sync.debounceIdle(function(t){return e._updateLabels(t)},t)},e_.prototype.forceEnable=function(){this._forceEnabled=!0},e_.prototype.update=function(){this._update()},e_.prototype.forceUpdate=function(){this._updateLabels()},e_.prototype._enable=function(){this._enabled=!0,this._update()},e_.prototype._disable=function(){this._textBBoxes=[],this._rects=[],this._intersects=[],this._enabled=!1},e_.prototype._onCameraMove=function(){this._update()},e_.prototype._updateLabels=function(t){if(void 0===t&&(t=this._camera.getZoom()),this._settings.get("texts.preventOverlap")){var e=this._graphics.getNodeAttributes(),i=this._graphics.getEdgeAttributes();this._intersects=[],this._textBBoxes=[],this._rects=[];var r=this._textQuad.clear(),n=this._camera.getAngle(),o=this._camera.getProjectedScreenBounds(.25),s="bottomUp"===this._settings.get("texts.removalStrategy"),a={angle:n,zoom:t,screen:o,sin:Math.sin(n),cos:Math.cos(n)},u={remove:{nodes:[],edges:[]},redraw:{nodes:[],edges:[]},rects:this._rects,bboxes:this._textBBoxes,intersects:this._intersects},l=this._spatial.queryRaw(o[0],o[1],o[2],o[3]),d=l.nodes,h=l.edges;if(d.length+h.length!==0){var c=this._captor.getPointedElement(),f=null,g=null;null!==c&&(c.isNode?f=c._index:g=c._index),function(t,e,i,r,n,o,s,a){for(var u,l,d=s.remove.nodes,h=s.remove.edges,c=s.redraw.nodes,f=i.angle,g=i.zoom,p=i.sin,_=i.cos,v=r.x,m=r.y,y=r.radius,x=r.layer,b=r.innerStroke.width,E=r.outerStroke.width,A=r.scalingMethod,S=r.text.content,w=r.text.position,T=r.text.size,C=r.text.font,M=r.text.style,I=r.text.maxLineLength,L=r.text.scaling,N=r.text.scale,O=r.text.minVisibleSize,k=r.text.padding,F=r.text.margin,R=r.animationDuration,P=r.textHidden,D=r.excluded,z=[],B=0;B<t.length;B++){var U=t[B];(z[X=x.get(U)- -1]=z[X]||[]).push(U)}null!==a&&z[z.length-1].unshift(a);for(var V=[0,0,0,0],j=[0,0,0,0,0],G=s.bboxes,H=s.rects,W=s.intersects,q=z.length-1;0<=q;q--){var X;if(X=z[q])for(B=0;B<X.length;B++){u=X[B];var Y=R.get(u),Z=S.get(u);if(null!==Z&&""!==Z&&0===Y){var K=y.get(u),Q=O.get(u);if(1!==D.get(u))if(2*K*g<Q)0===P.get(u)&&d.push(u);else{"fixed"===A.get(u)&&(K/=g);var J=v.get(u),$=m.get(u);"number"==typeof Z&&(Z=Z.toString());for(var tt=!L.get(u),et=w.get(u),it=k.get(u),rt=N.get(u),nt=+(tt?T.get(u):rt*K),ot=M.get(u),st=C.get(u),at=Es(Z,I.get(u)),ut=at.lines,lt=at.data,dt=it+b.get(u)+E.get(u)+F.get(u),ht=jp[et],ct=Gp[et],ft=n(lt[0],st,ot,nt).width,gt=1;gt<ut;gt++)ft=Math.max(ft,n(lt[gt],st,ot,nt).width);var pt=ut*nt*1,_t=ft/2/g,vt=pt/2/g,mt=dt/g,yt=Hp[et]*ft,xt=Wp[et]*pt;tt&&(yt/=g,xt/=g),yt=yt+ht*mt+_t+ht*K,xt=xt+ct*mt+vt+ct*K,Tp(J-_t,$-vt,ft/g,pt/g,-f,p,-_,V),j[0]=J-_t,j[1]=$-vt,j[2]=ft/g,j[3]=pt/g,j[4]=f;var bt=_*yt-p*xt,Et=p*yt+_*xt;V[0]+=bt,V[1]+=Et,V[2]+=bt,V[3]+=Et,j[0]+=bt,j[1]+=Et;var At=e.query(V[0],V[1],V[2],V[3]);if(0!==At.length){for(var St=!1,wt=Cp(j[0],j[1],j[2],j[3],j[4]),Tt=0;Tt<At.length;Tt++){var Ct=At[Tt],Mt=5*Ct,It=Cp(H[Mt],H[1+Mt],H[2+Mt],H[3+Mt],H[4+Mt]);if(Qd(wt,It)){if(W.push(wt,It),St=!0,!o)break;e.remove(Ct),1===G[6*Ct+4]?d.push(G[6*Ct+5]):h.push(G[6*Ct+5])}}if(St&&!o){d.push(u);continue}}c.push(u),l=G.length/6,G.push(V[0],V[1],V[2],V[3],1,u),e.insert(l,V),H.push(j[0],j[1],j[2],j[3],j[4])}else d.push(u)}}}}(d,r,a,e,this._measureText,s,u,f),function(t,e,i,r,n,o,s,a,u){for(var l,d,h=a.remove.nodes,c=a.remove.edges,f=a.redraw.edges,g=i.angle,p=i.zoom,_=n.x,v=n.y,m=n.radius,y=Math.PI,x=r.source,b=r.target,E=r.scalingMethod,A=r.width,S=r.curvature,w=r.layer,T=r.text.content,C=r.text.scaling,M=r.text.size,I=r.text.font,L=r.text.style,N=r.text.scale,O=r.text.maxLineLength,k=r.text.margin,F=r.text.minVisibleSize,R=r.animationDuration,P=[],D=0;D<t.length;D++){var z=t[D];(P[W=w.get(z)- -1]=P[W]||[]).push(z)}null!==u&&P[P.length-1].unshift(u);for(var B=[0,0,0,0],U=[0,0,0,0,0],V=a.bboxes,j=a.rects,G=a.intersects,H=P.length-1;0<=H;H--){var W;if(W=P[H])for(D=0;D<W.length;D++){l=W[D];var q=R.get(l),X=T?T.get(l):"";if(null!==X&&""!==X&&!q){var Y=x.get(l),Z=b.get(l),K=A.get(l),Q=S.get(l);if(!(K*p<F.get(l))){"fixed"===E.get(l)&&(K/=p);var J=(_.get(Y)+_.get(Z))/2,$=(v.get(Y)+v.get(Z))/2;X=X?X.toString():"";var tt=!C.get(l),et=N.get(l),it=I.get(l),rt=+(tt?M.get(l):et*K),nt=L.get(l),ot=O.get(l),st=k.get(l),at=_.get(Y),ut=v.get(Y),lt=_.get(Z),dt=v.get(Z),ht=void 0,ct=Y===Z;if(ct)ht=y/4-g,ma(at,ut,Q,m.get(Y),0,qp),Nu(.5,at,ut,lt,dt,qp.x1,qp.y1,qp.x2,qp.y2,Yp),J=Yp.x,$=Yp.y,st/=-p;else{if(at===lt&&ut===dt)continue;ht=gu(at,ut,lt,dt)-g,0!==Q&&(ht=gu(at,ut,lt,dt)-g,va(at,ut,lt,dt,Q,Xp),Iu(.5,at,ut,lt,dt,Xp.x,Xp.y,Yp),J=Yp.x,$=Yp.y)}var ft=st+4,gt=Es(X,ot);if(gt){for(var pt=gt.lines,_t=gt.data,vt=+o(_t[0],it,nt,rt).width,mt=1;mt<pt;mt++)vt=Math.max(vt,+o(_t[mt],it,nt,rt).width);var yt=pt*rt,xt=vt/p/2,bt=yt/p/2,Et=Math.abs(ht)<Zp?1:-1,At=ct?yt/p+K/2:Et*(ft/p+K/2+bt);U[0]=J-xt,U[1]=$-bt,U[2]=J+xt,U[3]=$+bt,U[4]=ht+g,Mp(U,-(ht+g),-At,U),U[2]=U[2]-U[0],U[3]=U[3]-U[1],Tp(J-xt,$-bt,2*xt,2*bt,ht=y-ht-g,void 0,void 0,B),Mp(B,ht,At,B);var St=e.query(B[0],B[1],B[2],B[3]);if(St.length){for(var wt=!1,Tt=Cp(U[0],U[1],U[2],U[3],U[4]),Ct=0;Ct<St.length;Ct++){var Mt=St[Ct],It=5*Mt,Lt=Cp(j[It],j[1+It],j[2+It],j[3+It],j[4+It]);if(Qd(Tt,Lt)){if(wt=!0,G.push(Tt,Lt),!s)break;e.remove(Mt),1===V[6*Mt+4]?h.push(V[6*Mt+5]):c.push(V[6*Mt+5])}}if(wt&&!s){c.push(l);continue}}f.push(l),d=V.length/6,V.push(B[0],B[1],B[2],B[3],0,l),e.insert(d,B),j.push(U[0],U[1],U[2],U[3],U[4])}}}}}}(h,r,a,i,e,this._measureText,s,u,g),this._clearOverlaps(u),this._settings.get("texts.debug")&&this.drawAll()}}},e_.prototype._clearOverlaps=function(t){var e=this._graph.nodeList,i=this._graph.edgeList,r=this._graphics,n=e(new Uint32Array(t.remove.nodes)),o=i(new Uint32Array(t.remove.edges)),s=e(new Uint32Array(t.redraw.nodes)),a=i(new Uint32Array(t.redraw.edges));r.setTextHidden(n,!0),r.setTextHidden(o,!0),r.setTextHidden(s,!1),r.setTextHidden(a,!1),this._events.fire("labelCollisionsRemoved",t)},e_.prototype._reset=function(){this._graphics.resetTextHidden()},e_.prototype.drawAll=function(){this._canvas&&this._ctx&&Qp(this._ctx,this._canvas,this._camera,this._textBBoxes,this._rects,this._intersects)},e_);function e_(t,e){var i,r=t.graph,n=t.graphics,o=t.camera,s=t.events,a=t.settings,u=t.sync,l=t.spatial,d=t.captor,h=Jp.call(this)||this;return h._textBBoxes=[],h._rects=[],h._enabled=!1,h._intersects=[],h._onZoomStart=P(function(t){var e=t.startZoom,i=t.endZoom;h._enabled&&i<e&&h._updateLabels(i)},80),h._onAttributesChanged=function(t){E(t.edgeAttributes,t.nodeAttributes).some(function(t){return $p.has(t)})&&h._update()},h._onItemsAdded=function(t){var e=t.nodes||t.edges;(h._enabled||h._forceEnabled)&&h._settings.get("texts.preventOverlap")&&h._graphics.setTextHidden(e,!0)},h._onToggle=function(t){return t?h._update():h._reset(),h},h._update=function(){(h._enabled||h._forceEnabled)&&h._updateDebounced()},h._toggleDebug=function(t){t?(h._canvas=bn(),h._graphics.addCanvas(h._canvas),h._ctx=h._canvas.getContext("2d"),h._update()):h._canvas&&(h._graphics.removeCanvas(h._canvas),h._canvas=h._ctx=null)},h._measureText=function(t,e,i,r){return h._engine.measureText(t,e,i,r)},h._graph=r,h._graphics=n,h._camera=o,h._events=s,h._settings=a,h._sync=u,h._spatial=l,h._captor=d,h._engine=n.getGraphicsEngine(),h._textQuad=new Up(function(t){var e=6*t;return h._textBBoxes.slice(e,6+e)},5),e.forceEnableTextOverlapRemoval&&h.forceEnable(),h._events.register(["labelCollisionsRemoved"]),h.setRate(200),a.register("texts.preventOverlap",!0,h._onToggle),a.register("texts.debug",!1,h._toggleDebug),a.register("texts.removalStrategy","topDown"),s.on(((i={})[[be.ADD_NODES,be.ADD_EDGES].join(" ")]=h._onItemsAdded,i[be.LAYOUT_END]=function(){return h._updateLabels()},i[[be.VIEW_CHANGED,be.HOVER,be.UNHOVER].join(" ")]=h._update,i[be.UPDATE_ATTRIBUTES]=h._onAttributesChanged,i[be.SET_CONTAINER]=function(t){if(t.element)return h._enable();h._disable()},i[be.START_ZOOM]=h._onZoomStart,i)),h}function i_(){}function r_(){return!1}var n_,o_,s_=(a_.prototype._startInteraction=function(t,e){t.onStart&&t.onStart(e),t.onStop&&(this._current=t).disableDetection&&this._captor.setDetectionEnabled(!1)},a_.prototype._stopCurrentInteraction=function(t){this._current&&this._current.disableDetection&&this._captor.setDetectionEnabled(!0),this._current&&this._current.onStop&&this._current.onStop(t),this._current=void 0},a_.prototype._forceStartInteraction=function(t,e){this._current&&this._stopCurrentInteraction(e),this._startInteraction(t,e)},a_.prototype._createWrapper=function(e){var i=this;return{start:function(t){return i._forceStartInteraction(e,t)}}},a_.prototype._addInteraction=function(t,e){var i=this._interactionsByStartEvent[t];return i?i.push(e):(this._interactionsByStartEvent[t]=[e],this._events.on(t,this._onStartInteractionEvent)),this._createWrapper(e)},a_.prototype._createProgressiveInteraction=function(t,e,i,r){var n={priority:u_(r.priority),check:r.check||r_,onStart:r.onStart||i_,onProgress:r.onProgress||i_,onStop:r.onStop||i_,disableDetection:!!r.disableDetection,progressEventName:e,stopEventName:i};return this._boundProgressEvents[e]||(this._boundProgressEvents[e]=!0,this._events.on(e,this._onProgressInteractionEvent)),this._boundStopEvents[i]||(this._boundStopEvents[i]=!0,this._events.on(i,this._onStopInteractionEvent)),this._addInteraction(t,n)},a_.prototype._createNonProgressiveInteraction=function(t,e){return this._addInteraction(t,{priority:u_(e.priority),check:e.check||r_,onStart:e.handler||i_,onProgress:void 0,onStop:void 0,disableDetection:!1,progressEventName:void 0,stopEventName:void 0})},a_.prototype.onDrag=function(t){return this._createProgressiveInteraction(be.DRAG_START,be.DRAG_PROGRESS,be.DRAG_END,t)},a_.prototype.onGesture=function(t){return this._createProgressiveInteraction(be.GESTURE_START,be.GESTURE_PROGRESS,be.GESTURE_END,t)},a_.prototype.onClick=function(t){return this._createNonProgressiveInteraction(be.CLICK,t)},a_.prototype.onDoubleClick=function(t){return this._createNonProgressiveInteraction(be.DOUBLE_CLICK,t)},a_.prototype.onHover=function(t){return this._createNonProgressiveInteraction(be.HOVER,t)},a_.prototype.onUnhover=function(t){return this._createNonProgressiveInteraction(be.UNHOVER,t)},a_.prototype.onMouseWheel=function(t){return this._createNonProgressiveInteraction(be.WHEEL,t)},a_.prototype.onMouseDown=function(t){return this._createNonProgressiveInteraction(be.DOWN,t)},a_.prototype.onMouseUp=function(t){return this._createNonProgressiveInteraction(be.UP,t)},a_.prototype.onMouseMove=function(t){return this._createNonProgressiveInteraction(be.MOVE,t)},a_);function a_(t){var s=this,e=t.captor,i=t.events;this._onStartInteractionEvent=function(t,e){if(!s._current){for(var i,r=0,n=s._interactionsByStartEvent[e];r<n.length;r++){var o=n[r];o.check(t)&&(!i||o.priority>=i.priority)&&(i=o)}i&&s._startInteraction(i,t)}},this._onProgressInteractionEvent=function(t,e){s._current&&s._current.progressEventName===e&&s._current.onProgress&&s._current.onProgress(t)},this._onStopInteractionEvent=function(t,e){s._current&&s._current.stopEventName===e&&s._stopCurrentInteraction(null)},this._captor=e,this._events=i,this._interactionsByStartEvent={},this._boundProgressEvents={},this._boundStopEvents={}}function u_(t){return"string"==typeof t?Ei.indexOf(t):"number"!=typeof t||isNaN(t)?0:t}(o_=n_=n_||{}).MOUSE="mouse",o_.TOUCH="touch";var l_,d_=[be.VIRTUAL_UP,be.MOUSE_UP,be.TOUCH_UP].join(" "),h_=[be.VIRTUAL_DOWN,be.MOUSE_DOWN,be.TOUCH_DOWN].join(" "),c_=[be.VIRTUAL_MOVE,be.MOUSE_MOVE,be.TOUCH_MOVE].join(" "),f_=[be.VIRTUAL_CLICK,be.MOUSE_CLICK,be.TOUCH_TAP].join(" "),g_=[be.VIRTUAL_DOUBLE_CLICK,be.MOUSE_DOUBLE_CLICK,be.TOUCH_DOUBLE_TAP].join(" "),p_=[be.VIRTUAL_WHEEL,be.MOUSE_WHEEL].join(" "),__=(x(v_,l_=Ae),v_.prototype.triggerUnhover=function(){this._hover=!1,this._hoveredElt=null},v_.prototype.triggerDetection=function(){this._detectElement(this._position.x,this._position.y),this._elt&&(this._hoveredElt=this._elt,this._hover=!0)},v_.prototype.getElementAt=function(t,e){var i=t.x,r=t.y;return this._detectElementAt(i,r,e)},v_.prototype.getPointedElement=function(){return this._hoveredElt},v_.prototype.getDraggedElement=function(){return this._draggedElt},v_.prototype.isAnyButtonPressed=function(){return this._buttons[Cc.LEFT].isPressed||this._buttons[Cc.RIGHT].isPressed||this._buttons[Cc.MIDDLE].isPressed},v_.prototype.isAnyButtonDragging=function(){return this._buttons[Cc.LEFT].isDragging||this._buttons[Cc.RIGHT].isDragging||this._buttons[Cc.MIDDLE].isDragging},v_.prototype.isButtonPressed=function(t){return this._buttons[t].isPressed},v_.prototype.isLeftPressed=function(){return this.isButtonPressed(Cc.LEFT)},v_.prototype.getCursorPosition=function(){return{x:this._position.x,y:this._position.y}},v_.prototype.getCursorInformation=function(){return{x:this._position.x,y:this._position.y,target:this._hoveredElt}},v_.prototype.setDetectionEnabled=function(value){this._disabledCounter=Math.max(0,this._disabledCounter+(value?-1:1))},v_.prototype._resetCurrent=function(t,e){for(var i in this._buttons){var r=this._buttons[i];r.isDragging&&this._events.fire(be.DRAG_END,{domEvent:null,x:t,y:e,button:i,target:this._draggedElt}),r.isPressed=!1,r.isDragging=!1}this._hover&&this._hoveredElt&&this._events.fire(be.UNHOVER,{domEvent:null,x:t,y:e,target:this._hoveredElt}),this._hover=!1,this._hoveredElt=null,this._draggedElt=null},v_.prototype._onMove=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source,o=this._setPointerPosition(i,r),s=o.dx,a=o.dy;for(var u in this._events.fire(be.MOVE,{domEvent:e,x:i,y:r,dx:s,dy:a,source:n}),this._buttons){var l=this._buttons[u];if(l.isPressed)if(l.isDragging){var d=this._getStoredDXY();s+=d.dx,a+=d.dy,this._events.fire(be.DRAG_PROGRESS,{domEvent:e,x:i,y:r,dx:s,dy:a,button:u,source:n,target:this._draggedElt})}else l.isDragging=!0,this._hoveredElt&&this._hover&&(this._events.fire(be.UNHOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt}),this._hover=!1),this._draggedElt||(this._draggedElt=this._hoveredElt),this._storeDXY(s,a),this._events.fire(be.DRAG_START,{domEvent:e,x:i,y:r,button:u,source:n,target:this._draggedElt})}e&&!this._graphics.getDomElement().contains(e.target)||this._detectElement(i,r),this._elt!==this._hoveredElt&&(this._hoveredElt&&this._hover&&(this._hover=!0,this._events.fire(be.UNHOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt})),this._hoveredElt=this._elt,this._elt&&(this._hover=!0,this._events.fire(be.HOVER,{domEvent:e,x:i,y:r,source:n,target:this._hoveredElt})))},v_.prototype._onDocumentMove=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source;for(var o in this._buttons)if(this._buttons[o].isDragging){var s=this._setPointerPosition(i,r),a=s.dx,u=s.dy;this._events.fire(be.DRAG_PROGRESS,{domEvent:e,x:i,y:r,dx:a,dy:u,button:o,source:n,target:this._draggedElt})}},v_.prototype._onDocumentUp=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.source,o=t.button;if(null!=o&&this._buttons[o].isDragging){this._events.fire(be.DRAG_END,{domEvent:e,x:i,y:r,button:o,source:n,target:this._draggedElt});var s=this._buttons[o];s.isDragging=!1,s.isPressed=!1,this.isAnyButtonDragging()||(this._draggedElt=null)}},v_.prototype._onDown=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;if(null!=n){this._detectElement(i,r),this._elt!==this._hoveredElt&&this._resetCurrent(i,r);var s=this._buttons[n];this._hoveredElt=this._elt,s.isPressed=!0,this._events.fire(be.DOWN,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt})}},v_.prototype._onDoubleClick=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;null!=n&&(b_(e,"doubleclick")||this._events.fire(be.DOUBLE_CLICK,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt}))},v_.prototype._onUp=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;if(null!=n){var s=this._buttons[n];s.isPressed&&(s.isDragging&&(this._events.fire(be.DRAG_END,{domEvent:e,x:i,y:r,button:n,source:o,target:this._draggedElt}),s.isDragging=!1,this.isAnyButtonDragging()||(this._draggedElt=null)),s.isPressed=!1,this._detectElement(i,r),this._events.fire(be.UP,{domEvent:e,x:i,y:r,button:n,source:o,target:this._elt}),this.isAnyButtonPressed()||this._hover||o===n_.TOUCH||(this._hoveredElt=this._elt,this._hoveredElt&&(this._events.fire(be.HOVER,{domEvent:e,x:i,y:r,source:o,target:this._hoveredElt}),this._hover=!0)))}},v_.prototype._onClick=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.button,o=t.source;b_(e,"click")||this._events.fire(be.CLICK,{domEvent:e,x:i,y:r,button:n,source:o,target:this._hoveredElt})},v_.prototype._onWheel=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.delta,o=t.source;this._position.x=i,this._position.y=r,this._events.fire(be.WHEEL,{domEvent:e,x:i,y:r,delta:n,source:o,target:this._hoveredElt})},v_.prototype._storeDXY=function(t,e){this._accDx=t,this._accDy=e},v_.prototype._getStoredDXY=function(){var t=this._accDx,e=this._accDy;return this._accDx=0,this._accDy=0,{dx:t,dy:e}},v_.prototype._setPointerPosition=function(t,e){var i=t-this._prevX,r=e-this._prevY;return this._position.x=t,this._position.y=e,this._prevX=t,this._prevY=e,this._accDx=0,this._accDy=0,{dx:i,dy:r}},v_.prototype._detectElement=function(t,e,i){this._elt=this._detectElementAt(t,e,i)},v_.prototype._detectElementAt=function(t,e,i){if(0!==this._disabledCounter)return null;var r=this._settings,n=r.get("detect.enableSpatialIndex"),o=r.get("detect.nodeErrorMargin"),s=r.get("detect.edgeErrorMargin"),a=r.get("detect.nodes"),u=r.get("detect.edges"),l=null,d=[],h=[];if(!i&&n&&(a||u)){var c=r.get("detect.spatialIndexMarginRatio"),f=Math.max(o*c,s*c),g=this._spatial.queryRawProjected(t-f,e-f,t+f,e+f);d=g.nodes,h=g.edges}return a&&(l=this._graphics.detectNode({x:t,y:e,indexes:d,margin:o,texts:!!r.get("detect.nodeTexts")})),!l&&u&&(l=this._graphics.detectEdge({x:t,y:e,indexes:h,margin:s,texts:!!r.get("detect.edgeTexts")})),l},v_);function v_(t){var e,i,r=t.dom,n=t.events,o=t.graphics,s=t.spatial,a=t.settings,u=t.position,l=l_.call(this)||this;return l._elt=null,l._hoveredElt=null,l._draggedElt=null,l._hover=!1,l._disabledCounter=0,l._accDx=0,l._accDy=0,l._prevX=0,l._prevY=0,l._buttons=((e={})[Cc.LEFT]={isPressed:!1,isDragging:!1},e[Cc.MIDDLE]={isPressed:!1,isDragging:!1},e[Cc.RIGHT]={isPressed:!1,isDragging:!1},e),l._onGraphChanged=function(){l._resetCurrent(l._position.x,l._position.y),l._timeout||(l._timeout=l._dom.setTimeout(function(){l._onMove({x:l._position.x,y:l._position.y,source:null,domEvent:null}),l._timeout=null},0))},l._dom=r,l._graphics=o,l._events=n,l._settings=a,l._spatial=s,l._position=u,n.register([be.MOVE,be.DOWN,be.UP,be.CLICK,be.DOUBLE_CLICK,be.HOVER,be.UNHOVER,be.WHEEL,be.DRAG_START,be.DRAG_PROGRESS,be.DRAG_END,be.GESTURE_START,be.GESTURE_PROGRESS,be.GESTURE_END]),a.register("detect.nodes",!0).register("detect.edges",!0).register("detect.nodeTexts",!0).register("detect.edgeTexts",!0).register("detect.nodeErrorMargin",5).register("detect.edgeErrorMargin",7).register("detect.enableSpatialIndex",!0).register("detect.spatialIndexMarginRatio",3),n.on(((i={})[[be.REMOVE_NODES,be.REMOVE_EDGES,be.CLEAR_GRAPH].join(" ")]=l._onGraphChanged,i[c_]=function(t,e){var i=t.domEvent,r=t.x,n=t.y;l._onMove({domEvent:i,x:r,y:n,source:m_(e)})},i[h_]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,s=void 0===o?Cc.LEFT:o;l._onDown({domEvent:i,x:r,y:n,button:s,source:m_(e)})},i[d_]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,s=void 0===o?Cc.LEFT:o;l._onUp({domEvent:i,x:r,y:n,button:s,source:m_(e)})},i[f_]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,s=void 0===o?Cc.LEFT:o;l._onClick({domEvent:i,x:r,y:n,button:s,source:m_(e)})},i[g_]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,s=void 0===o?Cc.LEFT:o;l._onDoubleClick({domEvent:i,x:r,y:n,button:s,source:m_(e)})},i[p_]=function(t){var e=t.domEvent,i=t.x,r=t.y,n=t.delta;l._onWheel({domEvent:e,x:i,y:r,delta:n,source:n_.MOUSE})},i.touchStartGesture=function(t){return n.fire(be.GESTURE_START,t)},i.touchProgressGesture=function(t){return n.fire(be.GESTURE_PROGRESS,t)},i.touchEndGesture=function(t){return n.fire(be.GESTURE_END,t)},i[be.DOCUMENT_MOUSE_MOVE]=function(t,e){var i=t.domEvent,r=t.x,n=t.y;l._onDocumentMove({domEvent:i,x:r,y:n,source:m_(e)})},i[be.DOCUMENT_MOUSE_UP]=function(t,e){var i=t.domEvent,r=t.x,n=t.y,o=t.button,s=void 0===o?Cc.LEFT:o;l._onDocumentUp({domEvent:i,x:r,y:n,source:m_(e),button:s})},i)),l}function m_(t){return 0===t.indexOf(n_.TOUCH)?n_.TOUCH:n_.MOUSE}var y_=!1,x_={down:{trigger:"pointerdown",duplicate:"mousedown"},click:{trigger:"pointerdown",duplicate:"mouseup"},doubleclick:{trigger:"pointerdown",duplicate:"mouseup"}};function b_(t,e){return t&&(t.type===x_[e].trigger&&(y_=!0),t.type===x_[e].duplicate&&y_&&(y_=!1,1))}var E_,A_=(x(S_,E_=Ae),S_);function S_(t){t.graph;var e=t.graphics,i=t.camera,r=t.selection,n=t.events,o=t.captor,s=t.individualAttributes,a=t.interactions,u=t.classes,l=t.settings,d=E_.call(this)||this;return d._dragged=null,d._start=[],d._end=[],d._shouldDrag=function(t){var e=t.target,i=t.button===Cc.LEFT,r=d._settings.get("interactions.drag.enabled"),n=null!==e&&e.isNode&&!0===e.getAttribute("draggable");return!!(i&&r&&n)},d._onDragStart=function(t){var e=t.x,i=t.y,r=t.target;r.isSelected()?d._dragged=d._selection.getSelectedNodes().filter(function(t){return t.getAttribute("draggable")}):d._dragged=r.toList(),d._dragged&&(d._start=d._dragged.getPosition(),d._end=G(d._start),d._onBeforeDrag=d._settings.get("interactions.drag.onBeforeDrag"),d._startDrag=d._camera.screenToGraphCoordinates({x:e,y:i}),d._dragged.addClass(fi),d._events.fire(be.NODES_DRAG_START,{nodes:d._dragged}),d._graphics.addCursorStyle(d._settings.get("interactions.drag.cursor")))},d._onDrag=function(){if(d._dragged&&d._startDrag){for(var t=d._captor.getCursorInformation(),e=t.x,i=t.y,r=d._dragged._indexes,n=d._camera.screenToGraphCoordinates({x:e,y:i}),o=n.x-d._startDrag.x,s=n.y-d._startDrag.y,a=0;a<r.length;++a){var u=d._start[a],l=d._end[a];l.x=u.x+o,l.y=u.y+s}d._onBeforeDrag&&d._onBeforeDrag(d._dragged,e,i,d._end),d._settings.get("interactions.drag.applyResult")&&d._attributes.setMultipleAttributes(d._dragged,d._end,void 0,["x","y"]),d._events.fire(be.NODES_DRAG_PROGRESS,{nodes:d._dragged,dx:o,dy:s})}},d._onDragEnd=function(){d._dragged&&(d._dragged.removeClass(fi),d._graphics.removeCursorStyle(d._settings.get("interactions.drag.cursor")),d._events.fire(be.NODES_DRAG_END,{nodes:d._dragged,start:d._start,end:d._end}),d._dragged=null,d._start=[],d._end=[])},d._camera=i,d._graphics=e,d._selection=r,d._events=n,d._settings=l,d._captor=o,d._attributes=s,d._interactions=a,u.createClass({name:fi,isBuiltin:!0,nodeAttributes:{layer:3}}),n.register([be.NODES_DRAG_START,be.NODES_DRAG_PROGRESS,be.NODES_DRAG_END]),l.register("interactions.drag.enabled",!0),l.register("interactions.drag.cursor","move"),l.register("interactions.drag.onBeforeDrag",void 0),l.register("interactions.drag.applyResult",!0),d._interactions.onDrag({priority:"drag",disableDetection:!0,check:d._shouldDrag,onStart:d._onDragStart,onProgress:d._onDrag,onStop:d._onDragEnd}),d}var w_,T_={color:"#00C3FF",radius:7,cursorOnHover:"grab",cursorOnDrag:"grabbing"},C_=(x(M_,w_=Ae),M_.prototype.onMounted=function(t){t.events.onEdgesSelected(this._refreshHandles),t.events.onEdgesUnselected(this._refreshHandles)},M_.prototype.enable=function(t){this._enabled||(this._options=I(I({},T_),t),this._enabled=!0,this._graphics.addCanvas(this._canvas),this._refreshHandles())},M_.prototype.disable=function(){this._enabled&&(this._interaction.stop&&this._interaction.stop(),this._graphics.removeCursorStyle(this._options.cursorOnDrag),this._disableCursorOnHover(),this._restoreSettings(),this._graphics.removeCanvas(this._canvas),this._rewirableClass.clearEdges(),this._enabled=!1)},M_.prototype.enabled=function(){return this._enabled},M_.prototype._restoreSettings=function(){this._prevSettings&&(this._settings.update(this._prevSettings),this._prevSettings=void 0)},M_.prototype._disableCursorOnHover=function(){this._hoverHandle&&!this._grabHandle&&(this._hoverHandle=!1,this._graphics.removeCursorStyle(this._options.cursorOnHover))},M_.prototype._enableCursorOnHover=function(){this._hoverHandle||(this._hoverHandle=!0,this._graphics.addCursorStyle(this._options.cursorOnHover))},M_.prototype._displayMovedEdges=function(){var d=this;if(this._movedEdges){var t=this._x,e=this._y,h=this._ctx,c=wt(),f={x:t,y:e},g=this._camera.getZoom();this._movedEdges.forEach(function(t,e){var i=d._edgeColors[e],r=t.getSource(),n=t.getTarget(),o=d._getPointedNode(),s=n===d._startNode?r:n,a=t.getAttribute("width")*g,u=s.getPositionOnScreen(),l=o?o.getPositionOnScreen():f;s.addClass(ci),h.beginPath(),h.moveTo(u.x*c,u.y*c),h.lineTo(l.x*c,l.y*c),h.strokeStyle=i,h.lineWidth=a*c,h.stroke()})}},M_.prototype._getPointedNode=function(){var t=this._captor.getPointedElement();return t&&t.isNode?t:null},M_);function M_(t){var e,i=t.classes,r=t.graphics,n=t.camera,o=t.captor,s=t.selection,a=t.events,u=t.settings,l=t.interactions,c=w_.call(this)||this;return c._canvas=bn(),c._ctx=c._canvas.getContext("2d"),c._hoverHandle=!1,c._grabHandle=!1,c._x=0,c._y=0,c._enabled=!1,c._onDragStart=function(){if(c._movedEdges){c._nodesToHighlight=c._nodesToHighlight.filter(function(t){return t!==c._startNode}),c._movedEdges.setExcluded(!0);var t=c._options.cursorOnDrag;c._prevSettings=c._settings.update({edgeHover:!1,cursor:{default:t,node:t,edge:t}})}},c._onDragEnd=function(){if(c._movedEdges){c._restoreSettings();var e=c._getPointedNode();e&&c._movedEdges.forEach(function(t){t.getTarget()===c._startNode?t.setTarget(e):t.setSource(e)}),c._movedEdges.setExcluded(!1),c._movedEdges.setSelected(!0),c._movedEdges=null,c._refreshHandles()}},c._refreshHandles=function(){if(c._enabled&&!c._movedEdges){var t=c._selection.getSelectedEdges();c._nodesToHighlight=t.getExtremities().dedupe(),c._rewirableClass.clearEdges(),c._rewirableClass.add(t),c._refreshCanvas()}},c._shouldInteractionStart=function(t){var e=t.target;if(!(c._enabled&&e&&e.isNode&&c._hoverHandle))return!1;var i=e.getAdjacentEdges().filter(function(t){return t.isSelected()});return!!i.size&&(c._movedEdges=i,c._edgeColors=c._movedEdges.getAttribute("color"),c._startNode=e,!0)},c._refreshCanvas=function(){if(c._enabled&&c._nodesToHighlight){var o=c._captor.getCursorPosition(),t=c._getPointedNode(),s=c._camera.zoom,a=c._canvas.getContext("2d"),u=wt(),e=c._options.color,l=c._options.radius,d=2*l*u;a.clearRect(0,0,c._canvas.width,c._canvas.height),c._displayMovedEdges(),a.fillStyle=e,a.strokeStyle=e;var h=!1;if(c._nodesToHighlight.forEach(function(t){var e=t.getPositionOnScreen(),i=e.x,r=e.y,n=t.getAttribute("radius")*("fixed"===t.getAttribute("scalingMethod")?1:s);l<n&&(a.fillRect((i-l)*u,(r-l)*u,d,d),distance(i,r,o.x,o.y)<l&&(h=!0))}),c._movedEdges){var i=t?t.getPositionOnScreen():o;a.fillRect((i.x-l)*u,(i.y-l)*u,d,d)}h?c._enableCursorOnHover():c._disableCursorOnHover()}},c._captor=o,c._camera=n,c._graphics=r,c._selection=s,c._events=a,c._settings=u,c._interactions=l,c._classes=i,c._rewirableClass=c._classes.createClass({name:gi,isBuiltin:!0,edgeAttributes:{layer:4}}),c._events.on(((e={})[be.CAMERA_MOVE]=c._refreshCanvas,e[be.MOVE]=c._refreshCanvas,e[be.NODES_DRAG_PROGRESS]=c._refreshCanvas,e[be.DOWN]=function(){c._hoverHandle&&(c._grabHandle=!0)},e[be.UP]=function(){return c._grabHandle=!1},e)),c._interaction=c._interactions.onDrag({priority:"rewiring",check:c._shouldInteractionStart,onStart:c._onDragStart,onProgress:function(t){var e=t.x,i=t.y;c._x=e,c._y=i},onStop:c._onDragEnd}),c}var I_,L_={cursor:"nesw-resize",color:"#00C3FF",lineWidth:1,handleSize:6,detectionMargin:5,snappingRatio:1.25,nbNodesToSnapTo:5,previewColor:"rgba(0, 0, 0, 0.2)",sizeIndicatorColor:"black",sizeIndicatorOffset:5,sizeIndicatorWidth:3,sizeIndicatorThickness:1},N_=(x(O_,I_=Ae),O_.prototype.onMounted=function(t){t.events.onNodesSelected(this._onSelectionChange),t.events.onNodesUnselected(this._onSelectionChange)},O_.prototype._enableCursor=function(){this._cursorEnabled||(this._graphics.addCursorStyle(this._options.cursor),this._cursorEnabled=!0)},O_.prototype._disableCursor=function(){this._cursorEnabled&&(this._graphics.removeCursorStyle(this._options.cursor),this._cursorEnabled=!1)},O_.prototype._detectBoundingBoxes=function(a,u){var l=this;if(this._enabled&&!this._nodeBeingResized&&this._nodesToHighlight){var d=this._options.handleSize/2,h=this._options.detectionMargin;return this._pointedNode=null,this._forEachNodeToHighlight(function(t,e,i){var r=e.x+i-d-h,n=e.x+i+d+h,o=e.y-i-d-h,s=e.y-i+d+h;r<=a&&a<=n&&o<=u&&u<=s&&(l._pointedNode=t)}),this._pointedNode?this._enableCursor():this._disableCursor()}},O_.prototype._forEachNodeToHighlight=function(r){var n=this;this._nodesToHighlight&&this._nodesToHighlight.forEach(function(t){var e=t.getPositionOnScreen(),i=n._getTotalOnScreenRadius(t);r(t,e,i)})},O_.prototype._displayHandles=function(){var d=this;if(this._enabled&&this._nodesToHighlight){var t=this._canvas,h=this._ctx,e=t.width,i=t.height,c=wt(),r=this._options,f=r.color,g=r.lineWidth,p=r.handleSize,_=0;if(h.clearRect(0,0,e,i),this._nodeBeingResized){var n=this._getTotalOnScreenRadius(this._nodeBeingResized),o=this._nodeBeingResized.getPositionOnScreen();_=Math.max(this._x-(o.x+n),-(this._y-(o.y-n)))/2}this._additionalRadiuses=[],this._forEachNodeToHighlight(function(t,e,i){var r=0;if(d._nodeBeingResized){r=_;var n=-i+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+g/2+1;r=r<n?n:d._snap(t,r),d._additionalRadiuses.push(r);var o=t.getAttribute("shape"),s=d._engine.getShapePoints(o),a=e.x+r,u=e.y-r,l=i+r;d._displayNodePreview(h,c,a,u,l,s)}h.strokeStyle=f,h.fillStyle=f,h.lineWidth=g,h.strokeRect((e.x-i)*c,(e.y-i-2*r)*c,2*(r+i)*c,2*(r+i)*c),h.fillRect((e.x+i+2*r-p/2)*c,(e.y-i-2*r-p/2)*c,p*c,p*c)})}},O_.prototype._displayNodePreview=function(t,e,i,r,n,o){if(i*=e,r*=e,n*=e,t.beginPath(),1===o.length)t.arc(i,r,n,0,2*Math.PI);else for(var s=0;s<o.length;++s){var a=o[s],u=i+a.x*n,l=r+a.y*n;0===s?t.moveTo(u,l):t.lineTo(u,l)}t.fillStyle=this._options.previewColor,t.fill()},O_.prototype._getTotalOnScreenRadius=function(t){return t.getAttribute("radius")*this._camera.zoom+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")+this._options.lineWidth/2},O_.prototype._snap=function(t,e){var i=this,r=this._spatial.getNodesInScreenByDistance(t).filter(function(t){return!t.isSelected()}).slice(0,this._options.nbNodesToSnapTo),n=this._ctx,o=this._getTotalOnScreenRadius(t),s=o+e,a=this._options.snappingRatio,u=s/o,l=Math.round($e(u,a)),d=o*Math.pow(a,l),h=null;if(r.forEach(function(t){var e=i._getTotalOnScreenRadius(t);Math.abs(e-s)<=Math.abs(d-s)&&(d=e,h=t)}),h){n.save(),n.strokeStyle=this._options.sizeIndicatorColor,n.lineWidth=this._options.sizeIndicatorThickness;var c=h.getAttribute("radius");this._displaySizeIndicator(t,d),r.filter(function(t){return t.getAttribute("radius")===c}).forEach(function(t){return i._displaySizeIndicator(t)}),n.restore()}return d-o},O_.prototype._displaySizeIndicator=function(t,e){var i=this._ctx,r=wt(),n=t.getPositionOnScreen(),o=this._getTotalOnScreenRadius(t),s=e||o,a=e?e-o:0,u=a-this._options.sizeIndicatorOffset-(e?t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width"):0),l=n.x-s+u|0,d=n.y-s-a|0,h=n.y+s-a|0,c=this._options.sizeIndicatorWidth;i.beginPath(),i.moveTo((l-c)*r,d*r),i.lineTo((l+c)*r,d*r),i.moveTo(l*r,d*r),i.lineTo(l*r,h*r),i.moveTo((l-c)*r,h*r),i.lineTo((l+c)*r,h*r),i.stroke()},O_.prototype.enable=function(t){var e;this._enabled||(this._options=I(I({},L_),t),this._graphics.addCanvas(this._canvas),this._ctx=this._canvas.getContext("2d"),this._events.on(((e={})[[be.CAMERA_MOVE,be.NODES_DRAG_PROGRESS].join(" ")]=this._displayHandlesHandler,e[[be.MOVE,be.DOWN].join(" ")]=this._moveHandler,e)),this._enabled=!0)},O_.prototype.disable=function(){this._enabled&&(this._events.removeListener(this._displayHandlesHandler),this._events.removeListener(this._moveHandler),this._graphics.removeCanvas(this._canvas),this._disableCursor(),this._reset())},O_.prototype._reset=function(){this._enabled=!1,this._nodesToHighlight=null,this._options=I({},L_),this._nodeBeingResized=null,this._pointedNode=null,this._cursorEnabled=!1,this._x=0,this._y=0,this._additionalRadiuses=[]},O_.prototype.enabled=function(){return this._enabled},O_);function O_(t){var e=t.dom,i=t.interactions,r=t.camera,n=t.events,o=t.graphics,s=t.spatial,a=t.selection,u=I_.call(this)||this;return u._enabled=!1,u._cursorEnabled=!1,u._x=0,u._y=0,u._additionalRadiuses=[],u._onSelectionChange=function(){u._enabled&&(u._nodesToHighlight=u._selection.getSelectedNodes(),u._displayHandles())},u._displayHandlesHandler=function(){return u._displayHandles()},u._moveHandler=function(t){var e=t.x,i=t.y;u._dom.setTimeout(function(){return u._detectBoundingBoxes(e,i)})},u._dom=e,u._interactions=i,u._events=n,u._camera=r,u._dom=e,u._spatial=s,u._graphics=o,u._selection=a,u._engine=u._graphics.getGraphicsEngine(),u._canvas=bn(),u._ctx=u._canvas.getContext("2d"),u._interactions.onDrag({priority:"resizing",disableDetection:!0,check:function(){return!(!u._enabled||!u._pointedNode)},onStart:function(t){var e=t.x,i=t.y;u._x=e,u._y=i,u._nodeBeingResized=u._pointedNode},onProgress:function(t){var e=t.x,i=t.y;u._x=e,u._y=i,u._displayHandles()},onStop:function(){u._nodesToHighlight&&u._nodesToHighlight.forEach(function(t,e){var i=u._additionalRadiuses[e]/u._camera.zoom;t.setAttributes({radius:t.getAttribute("radius")+i,x:t.getPosition().x+i,y:t.getPosition().y-i})}),u._pointedNode=null,u._nodeBeingResized=null,u._displayHandles()}}),u}var k_,F_,R_,P_={strokeColor:"black",strokeWidth:5,dashed:!0,cursorStyle:"cell",createNodes:!0,condition:function(){return!0},onNodeCreated:function(){},onEdgeCreated:function(){},onComplete:function(){}},D_=(x(z_,k_=Ae),z_.prototype._onStart=function(t){t&&(this._cursorEnabled=!0,this._startNode=t,this._startPos=t.getPosition(),this._graphics.addCursorStyle(this._options.cursorStyle),this._blockId=this._graphics.allocateGraphicsEngineBlockId())},z_.prototype._onMove=function(t,e){null!==this._startNode&&(this._endPos=this._camera.screenToGraphCoordinates({x:t,y:e}),this._drawLine())},z_.prototype._onStop=function(){if(null!==this._startNode){var t=this._options,e=t.condition,i=t.onNodeCreated,r=t.onEdgeCreated,n=t.onComplete,o=t.createNodes,s=this._captor.getPointedElement(),a=null,u=null;this._graphics.releaseGraphicsEngineBlockId(this._blockId),!s&&o&&(u=s=this._graph.addNode({attributes:{x:this._endPos.x,y:this._endPos.y}}),i&&i(u)),s&&(u||!e||e(this._startNode,s))&&(a=this._graph.addEdge({source:this._startNode.getId(),target:s.getId()}),r&&r(a)),n&&(this._events.fire(be.CONNECT_NODES,{source:this._startNode,target:s,edge:a}),n(this._startNode,s,a||void 0)),this.disable()}},z_.prototype._drawLine=function(){this._block.reset(1,!1,this._depth);var t=this._block.nextAndReset().end;t.pieceId=jr,t.shape="line",t.x1=this._startPos.x,t.y1=this._startPos.y,t.x2=this._endPos.x,t.y2=this._endPos.y,t.fillColor=this._options.strokeColor,t.thicknessOrFontSizeFixed=this._options.strokeWidth,this._options.dashed&&(t.dashLength=3,t.gapLength=1),this._engine.storeBlock(this._blockId,this._block),this._dom.refresh()},z_.prototype.enable=function(t){return void 0===t&&(t={}),this._enabled||(this._options=I(I({},P_),t),this._enabled=!0,this._cursorEnabled=!1,this._startNode=null,this._prevSettings=this._settings.update({"cursor.node":this._options.cursorStyle,"detect.edges":!1}),this._captor.isLeftPressed()&&this._interaction.start(this._captor.getCursorInformation())),this},z_.prototype.disable=function(){return this._enabled&&(this._enabled=!1,this._settings.update(this._prevSettings),this._cursorEnabled&&this._graphics.removeCursorStyle(this._options.cursorStyle)),this},z_.prototype.enabled=function(){return this._enabled},z_);function z_(t){var e=t.dom,i=t.camera,r=t.captor,n=t.graph,o=t.graphics,s=t.interactions,a=t.events,u=t.settings,l=k_.call(this)||this;return l._enabled=!1,l._cursorEnabled=!1,l._dom=e,l._camera=i,l._captor=r,l._graph=n,l._graphics=o,l._interactions=s,l._events=a,l._settings=u,l._engine=l._graphics.getGraphicsEngine(),l._block=l._engine.createBlock(),l._depth=Zl(0).edgeBody,l._events.register([be.CONNECT_NODES]),l._interaction=l._interactions.onDrag({priority:"connectNodes",check:function(t){var e=t.target,i=t.button,r=void 0===i?"left":i;return l._enabled&&"left"===r&&e&&e.isNode},onStart:function(t){var e=t.target;return l._onStart(e)},onProgress:function(t){var e=t.x,i=t.y;return l._onMove(e,i)},onStop:function(){return l._onStop()}}),l._events.on(be.CLEAR_GRAPH,function(){return l.disable()}),l}var B_,U_=["top","bottom","left","right","cssDefined"],V_={top:{x:0,y:-1},bottom:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}},j_={position:"top",autoAdjust:!0,delay:100},G_={hover:{node:function(t){var e=t.target;return e&&e.isNode},edge:function(t){var e=t.target;return e&&!e.isNode}},click:((F_={})[Cc.LEFT]={node:function(t){var e=t.target;return t.button===Cc.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Cc.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Cc.LEFT&&!e}},F_[Cc.RIGHT]={node:function(t){var e=t.target;return t.button===Cc.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Cc.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Cc.RIGHT&&!e}},F_),doubleClick:((R_={})[Cc.LEFT]={node:function(t){var e=t.target;return t.button===Cc.LEFT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Cc.LEFT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Cc.LEFT&&!e}},R_[Cc.RIGHT]={node:function(t){var e=t.target;return t.button===Cc.RIGHT&&e&&e.isNode},edge:function(t){var e=t.target;return t.button===Cc.RIGHT&&e&&!e.isNode},background:function(t){var e=t.target;return t.button===Cc.RIGHT&&!e}},R_)},H_=(x(W_,B_=Ae),W_.prototype.hide=function(){this._hideTooltip(!0)},W_.prototype.isShown=function(){return!!this._tooltip},W_.prototype.refresh=function(){this._refreshTooltip()},W_.prototype.show=function(t,e){var i=void 0===e?{}:e,r=i.position,n=void 0===r?"top":r,o=i.autoAdjust,s=void 0===o||o,a=i.className,u=i.x,l=void 0===u?0:u,d=i.y,h=void 0===d?0:d;this._showTooltip(t,{position:n,autoAdjust:s,className:a},{x:l,y:h})},W_.prototype.setHandler=function(t,e,i){var r=I(I({},j_),i);r.position&&-1===U_.indexOf(r.position)&&(r.position="top"),this._handlers[t]={handler:e,condition:W(G_,t),settings:r}},W_.prototype._hideTooltip=function(t){if(this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null),t&&(this._currentHandlerName=null),this._tooltip){var e=this._tooltip;this._tooltip.parentNode&&this._tooltip.parentNode.removeChild(this._tooltip),this._tooltip=null,this._events.fire(be.TOOLTIP_HIDE,{tooltip:e})}},W_.prototype._createInteraction=function(n,o){var s=this;return void 0===o&&(o=!1),{priority:"tooltip",check:function(t){var e=q_(n,t),i=s._handlers[e];return!(o&&s._connectNodes.enabled()||(!i||!i.condition(t))&&(o||!s._currentHandlerName||s._isHover||null===s._tooltip))},handler:function(t){var e=t.target,i=t.x,r=t.y;s._hideTooltip(!1),s._isHover=o,s._elt=e,s._x=i,s._y=r,s._currentHandlerName=q_(n,t),s._refreshTooltip()}}},W_.prototype._refreshTooltip=function(){var e=this;if(this._currentHandlerName){var t=this._handlers[this._currentHandlerName];if(t){var i=t.settings,r=t.handler,n=this._elt;if(n){var o=n.isNode?"node":"edge";if(-1===this._currentHandlerName.indexOf(o))return}var s=r(n);Promise.resolve(s).then(function(t){e._schedule(function(){return e._showTooltip(t,i)},i.delay)})}}else this._hideTooltip(!1)},W_.prototype._schedule=function(t,e){var i=this;this._timeout&&this._dom.clearTimeout(this._timeout),this._timeout=this._dom.setTimeout(function(){i._timeout=null,t()},e)},W_.prototype._showTooltip=function(t,e,i){this._hideTooltip(!1);var r=e.position,n=e.className,o=e.autoAdjust,s=this._x,a=this._y,u=this._elt,l=this._dom.getDimensions(),d=0,h=0;if(i&&(s=i.x,a=i.y,u=null),"string"==typeof t)this._tooltip=function(t){return ct?document.createElement(t):St()}("div"),this._tooltip.innerHTML=t;else{if(!Ut(t))throw new Error("invalid tooltip "+t+", expected HTML string or HTML element");this._tooltip=t}var c=this._tooltip;if(n&&this._tooltip.classList.add(n),"cssDefined"!==r&&(c.style.position="absolute"),this._dom.appendElement(c),u&&u.isNode){var f=u,g=f.getPositionOnScreen(),p=f.getAttribute("radius");p="fixed"===f.getAttribute("scalingMethod")?p+f.getAttribute("innerStroke.width")+f.getAttribute("outerStroke.width"):p*this._camera.getZoom()+f.getAttribute("innerStroke.width")+f.getAttribute("outerStroke.width"),s=g.x,a=g.y,h=d=p}var _=c.offsetWidth/2,v=c.offsetHeight/2;if(d+=_,h+=v,r&&"cssDefined"!==r){var m=V_[r],y=m.x,x=m.y;if(o){var b=s+d*m.x,E=a+h*m.y;(b-_<0||b+_>=l.width)&&("left"===r||"right"===r?y*=-1:y=b-_<0?(_-b+1)/d:(l.width-(b+_)-1)/d),(E-v<0||E+v>=l.height)&&("top"===r||"bottom"===r?x*=-1:x=E-v<0?(v-E+1)/h:(l.height-(E+v)-1)/h)}c.style.left=s+d*y-_+"px",c.style.top=a+h*x-v+"px"}this._events.fire(be.TOOLTIP_SHOW,{tooltip:c})},W_);function W_(t){var e,i=t.dom,r=t.connectNodes,n=t.interactions,o=t.camera,s=t.events,a=B_.call(this)||this;return a._x=0,a._y=0,a._dom=i,a._connectNodes=r,a._interactions=n,a._camera=o,a._events=s,a._handlers={},a._currentHandlerName=null,a._tooltip=null,a._isHover=!1,a._events.register(["showTooltip","hideTooltip"]),a._events.on(((e={})[be.UP+" "+be.DRAG_START]=function(){a._isHover||a._hideTooltip(!1)},e[be.UNHOVER]=function(){a._isHover&&a._hideTooltip(!1)},e[be.CLEAR_GRAPH]=function(){return a._hideTooltip(!1)},e)),a._interactions.onHover(a._createInteraction("hover",!0)),a._interactions.onClick(a._createInteraction("click")),a._interactions.onDoubleClick(a._createInteraction("doubleClick")),a}function q_(t,e){var i=e.button,r=e.target;return t+(i?"."+i:"")+"."+(null!==r?r.isNode?"node":"edge":"background")}var X_,Y_={65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",13:"enter",16:"shift",17:"ctrl",18:"alt",27:"esc",46:"del",8:"backspace",32:"space",224:"cmd",91:"cmd",92:"cmd",93:"cmd",187:"+",189:"-"},Z_=Object.keys(Y_).reduce(function(t,e){var i=Y_[e];return t[i]||(t[i]=[]),t[i].push(e),t},{}),K_=(x(Q_,X_=Ae),Q_.prototype.setIdleTimeout=function(t){if(!isFinite(t)||t<=1)throw new TypeError("Idle timeout must be a positive number > 1");this._idleTimeout=t},Q_.prototype.resetKeys=function(){for(var t=0;t<this._pressed.length;t++)this._pressed[t]&&(this._pressed[t]=!1,this._events.fire("keyUp",{key:Y_[t],code:t}))},Q_.prototype.onKeyPress=function(t,e){var i=this,r=[];if("number"==typeof t)r=[t];else if("string"==typeof t)r=t.split(" ");else{if(!Array.isArray(t))throw new TypeError(t+" is not a number, string or array");r=t}if(0===r.length)throw new Error("the array should contain at least one element");var n=r.map(function(t){if("number"==typeof t)return[t];if("string"!=typeof t)throw new TypeError(t+" is not a valid key identifier");var e=Z_[t];if(!e)throw new Error(t+" is not a valid key identifier");return e}),o=n.pop(),s={keys:n,handler:e};o&&o.forEach(function(t){i._binds[t]||(i._binds[t]=[]),i._binds[t].push(s)})},Q_.prototype.isPressed=function(t){var e=this;if("number"==typeof t)return this._pressed[t];if("string"==typeof t){var i=Z_[t];if(i)return i.some(function(t){return e._pressed[t]})}return!1},Q_);function Q_(t){var e=t.dom,i=t.events,s=X_.call(this)||this;return s._onBlur=function(){return s.resetKeys()},s._onKeyUp=function(t){var e=t.keyCode||t.which;s._pressed[e]=!1,s._events.fire("keyUp",{domEvent:t,key:Y_[e],code:e})},s._onKeyDown=function(t){var e=t.keyCode||t.which,i=s._binds[e];if(!s._pressed[e]){if(s._pressed[e]=!0,i)for(var r=0,n=i;r<n.length;r++){var o=n[r];o.keys.every(function(t){return t.some(function(t){return s._pressed[t]})})&&o.handler({domEvent:t})}s._events.fire("keyDown",{domEvent:t,key:Y_[e],code:e})}},s._events=i,s._events.register(["keyUp","keyDown"]),s._binds=[],s._pressed=[],e.addWindowEventListener("keydown",s._onKeyDown),e.addWindowEventListener("keyup",s._onKeyUp),e.addWindowEventListener("visibilitychange",s._onBlur),e.addWindowEventListener("blur",s._onBlur,!1),s._idleTimeout=4e3,s._prevEventTimeStamp=Kt(),s._events.onAnyEvent(function(){var t=Kt();t-s._prevEventTimeStamp>s._idleTimeout&&s.resetKeys(),s._prevEventTimeStamp=t}),s}var J_=[{name:"color",isNode:!0},{name:"shape",isNode:!0},{name:"radius",isNode:!0},{name:"icon.content",isNode:!0},{name:"image.url",isNode:!0},{name:"image",isNode:!0},{name:"color",isNode:!1},{name:"shape",isNode:!1},{name:"width",isNode:!1}],$_=Math.PI,tv=2*Math.PI,ev=Math.cos($_/2-tv/5),iv=Math.cos($_/2-tv/5*2),rv=Math.cos($_/2-tv/5*3),nv=Math.cos($_/2-tv/5*4),ov=Math.sin(-$_/2+tv/5),sv=Math.sin(-$_/2+tv/5*2),av=Math.sin(-$_/2+tv/5*3),uv=Math.sin(-$_/2+tv/5*4),lv=1.6,dv=3,hv=.9,cv=.31,fv=1/3,gv=[8,3],pv=[3,3],_v={position:"bottom",widgetWidth:130,fontFamily:"Arial",fontSize:10,fontColor:"black",titleFontSize:12,titleFontColor:"black",titleMaxLength:20,titleTextAlign:"left",shapeColor:"grey",backgroundColor:"white",borderColor:"black",borderRadius:0,borderWidth:1,innerMargin:10,outerMargin:5,circleStrokeWidth:3,titleFunction:function(t){return t[t.length-1]}},vv=["widgetWidth","fontSize","titleFontSize","borderRadius","borderWidth","innerMargin","outerMargin","circleStrokeWidth"];function mv(t){var e=["K","M","B","T","P","E","Z","Y"];if(9999<t){for(var i=0;i<e.length&&999<t;)t/=1e3,i++;return(yv(t,3)+e[i-1]).toString()}return yv(t,4).toString()}function yv(t,e){void 0===e&&(e=3);var i=4===e?10:1;return t<10?Math.round(100*t*i)/(100*i):t<100?Math.round(10*t*i)/(10*i):t<1e3?Math.round(t*i)/i:Math.round(t)}function xv(t){return t.innerMargin+(t.titleFontSize+t.fontSize)*lv}function bv(c,t,e){var i,r,f=t.getContext("2d"),n=e.x,o=e.y,s=e.height,g=e.isNode,p=e.styleProperty,a=e.title,_=e.mapping,v=e.iconFont,m=e.iconFontStyle;r=s,function(t,e,i,r,n,o,s,a,u){t.setLineDash([]),t.beginPath(),t.moveTo(e+o,i),t.lineTo(e+r-o,i),t.quadraticCurveTo(e+r,i,e+r,i+o),t.lineTo(e+r,i+n-o),t.quadraticCurveTo(e+r,i+n,e+r-o,i+n),t.lineTo(e+o,i+n),t.quadraticCurveTo(e,i+n,e,i+n-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+o,i),t.closePath(),t.fillStyle=s,t.fill(),t.strokeStyle=a,t.lineWidth=u,t.stroke()}(f,n,o,(i=c).widgetWidth,r,i.borderRadius,i.backgroundColor,i.borderColor,i.borderWidth),function(t,e,i,r,n){Ev(t,e.fontFamily,e.titleFontSize,e.titleFontColor,e.titleTextAlign);var o="center"===e.titleTextAlign,s=e.widgetWidth-2*e.innerMargin,a=t.measureText(i).width,u=r+(o?e.widgetWidth/2:e.innerMargin),l=n+e.titleFontSize/2+e.innerMargin;if(s<a){var d=s/a,h=(i.length*d|0)-2;i=i.substr(0,h)+""}t.fillText(i,u,l)}(f,c,a,n,o);var u,y=c.fontSize*lv,x=c.fontSize/2*lv*hv,b=c.fontSize*dv,E=c.fontSize,l=(u=g?1:dv,c.fontSize*u),A=o+xv(c),S=n+c.innerMargin+l/2,w=n+2*c.innerMargin+l,d=V(_),T=function i(t){return Array.isArray(t)?t.reduce(function(t,e){return t&&i(e)},!0):"undefined"===t||!isNaN(Number(t))}(d),C=c.fontColor,M=c.shapeColor,h=Object.keys(_);if(T&&(h.sort(function(t,e){return Je(_[e])-Je(_[t])}),"radius"===p||"width"===p)){var I=function i(t){return Array.isArray(t)?t.reduce(function(t,e){return Math.min(t,i(e))},1/0):isNaN(t)?1/0:+t}(d),L=function i(t){return Array.isArray(t)?t.reduce(function(t,e){return Math.max(t,i(e))},-1/0):isNaN(t)?-1/0:+t}(d),N=Math.round((I+L)/2);return(g?Sv:wv)(c,f,n,A,I,N,L,M)}h.forEach(function(t){var e,i,r,n,o,s,a,u,l,d,h=_[t];"color"===p&&(g?Av(f,S,A,x,t):(i=S,r=A,n=b,o=E,s=t,(e=f).fillStyle=s,e.fillRect(i-n/2,r-o/2,n,o))),"shape"===p&&(g?function(t,e,i,r,n,o){switch(t.fillStyle=o,n){case"square":return t.fillRect(e-r,i-r,2*r,2*r);case"circle":return Av(t,e,i,r,o);case"cross":return function(t,e,i,r){t.fillRect(e-r,i-r*cv,2*r,2*r*cv),t.fillRect(e-r*cv,i-r,2*r*cv,2*r)}(t,e,i,r);case"diamond":return function(t,e,i,r){t.beginPath(),t.moveTo(e-r,i),t.lineTo(e,i-r),t.lineTo(e+r,i),t.lineTo(e,i+r),t.fill()}(t,e,i,r);case"equilateral":return function(t,e,i,r){t.beginPath(),t.moveTo(e,i-r),t.lineTo(e+ev*r,i+ov*r),t.lineTo(e+iv*r,i+sv*r),t.lineTo(e+rv*r,i+av*r),t.lineTo(e+nv*r,i+uv*r),t.fill()}(t,e,i,r);case"star":(function(t,e,i,r){t.beginPath(),t.moveTo(e,i-r),t.lineTo(e+iv*r,i+sv*r),t.lineTo(e+nv*r,i+uv*r),t.lineTo(e+ev*r,i+ov*r),t.lineTo(e+rv*r,i+av*r),t.fill()})(t,e,i,r)}}(f,S,A,x,t,M):function(t,e,i,r,n,o,s){t.fillStyle=s,"line"===o&&t.fillRect(e-r/2,i-n/4,r,n/2);if("arrow"===o)return function(t,e,i,r,n){t.fillRect(e-r/2,i-n/4,r*(1-fv),n/2),t.beginPath(),t.moveTo(e+r*(1-fv-.5),i-n/2),t.lineTo(e+r*(1-fv-.5),i+n/2),t.lineTo(e+r/2,i),t.fill()}(t,e,i,r,n);if("dashed"===o||"dotted"===o)return function(t,e,i,r,n,o,s){t.beginPath(),t.moveTo(e-r/2,i),t.lineTo(e+r/2,i),t.strokeStyle=o,t.lineWidth=n/2,t.setLineDash("dashed"===s?gv:pv),t.stroke()}(t,e,i,r,n,s,o);if("tapered"===o)(function(t,e,i,r,n){t.beginPath(),t.moveTo(e-r/2,i-n/2),t.lineTo(e-r/2,i+n/2),t.lineTo(e+r/2,i),t.fill()})(t,e,i,r,n)}(f,S,A,b,E,t,M)),"icon.content"===p&&(u=S,l=A,d=t,Ev(a=f,v,2*x,C,"center",m),a.fillText(d,u,l)),"image"!==p&&"image.url"!==p||function(t,e,i,r,n){if("undefined"==typeof Image)return;t._imgStore||(t._imgStore={});var o=t._imgStore[n];if(o)return t.drawImage(o,e-r,i-r,2*r,2*r);(o=new Image).src=n,o.onload=function(){t.drawImage(o,e-r,i-r,2*r,2*r)},t._imgStore[n]=o}(f,S,A,x,t),function(t,e,i,r,n,o){var s=n.join();if(o)if(1===n.length)s=mv(n[0]);else{var a=Je(n),u=Qe(n);s=mv(a)+" - "+mv(u)}Ev(t,e.fontFamily,e.fontSize,e.fontColor),t.fillText(s,i,r)}(f,c,w,A,h,T),A+=y})}function Ev(t,e,i,r,n,o){void 0===n&&(n="left"),void 0===o&&(o="normal");t.textAlign=n,t.textBaseline="middle",t.fillStyle=r,t.font=o+" "+i+'px "'+e+'"'}function Av(t,e,i,r,n){t.beginPath(),t.arc(e,i,r,0,2*$_),t.fillStyle=n,t.fill()}function Sv(t,e,i,r,n,o,s,a){for(var u,l,d,h,c,f,g=.7*t.fontSize,p=3*g,_=(g+p)/2,v=i+t.innerMargin+p,m=v+p+t.innerMargin,y=r+2*p-.5*t.innerMargin,x=t.circleStrokeWidth,b=0,E=[g,_,p];b<E.length;b++){var A=E[b];l=v,d=y-A,h=A,c=a,f=x,(u=e).beginPath(),u.arc(l,d,h,0,tv),u.strokeStyle=c,u.lineWidth=f,u.stroke()}Ev(e,t.fontFamily,t.fontSize,t.fontColor,"left"),e.fillText(mv(n),m,y+g-2*g),e.fillText(mv(o),m,y+g-2*_),e.fillText(mv(s),m,y+g-2*p)}function wv(t,e,i,r,n,o,s,a){var u=(t.widgetWidth-2*t.innerMargin)/3,l=t.fontSize,d=r-t.innerMargin/2,h=d+2*l,c=i+t.innerMargin;e.fillStyle=a,e.fillRect(c,d-l/2,1+u,l),e.fillRect(c+u,d-l/3,1+u,l/1.5),e.fillRect(c+2*u,d-l/6,u,l/3),Ev(e,t.fontFamily,t.fontSize,t.fontColor,"center"),e.fillText(mv(s),c+.5*u,h),e.fillText(mv(o),c+1.5*u,h),e.fillText(mv(n),c+2.5*u,h)}function Tv(e,i,t){var r={width:i.width,height:i.height},n=!1;return r.width&&r.height&&t&&((n="top"===e.position||"bottom"===e.position?function(t,e,i,r){i=i.slice();for(var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),s=t.height-e.outerMargin,a=new Array(Math.min(o,i.length)),u=i.length,l=0,d=0,h=0,c=0,f=0;f<u;++f){(S=i[f]).isNode?(l+=1,d+=S.height):(h+=1,c+=S.height)}var g=d+c,p=d/g,_=c/g,v=Math.round(p*o),m=Math.round(_*o);l<v?v=l:h<m&&(v=o-h);if(0===o)return!1;for(f=0;f<a.length;f++)a[f]={content:[],height:0,isNode:f<v};for(f=0;f<u;++f){var y=Mv(i);Cv(i[y],a,e),i.splice(y,1)}a.every(function(t){return 1===t.content.length})?a.sort(Ov):a.sort(Nv);var x=e.outerMargin;for(f=0;f<a.length;++f){var b=a[f];if(b.height>s)return!1;b.content.sort(Lv);for(var E=0,A=0;A<b.content.length;++A){var S;(S=b.content[A]).x=x,S.y=r?t.height-E-S.height-e.outerMargin:E+e.outerMargin,E+=S.height+e.outerMargin}x+=n}return!0}(r,e,t,"bottom"===e.position):function(t,e,i,r){var n=e.widgetWidth+e.outerMargin,o=Math.floor((t.width-e.outerMargin)/n),s=t.height,a=e.outerMargin,u=r?e.outerMargin:t.width-n,l=1;i=i.slice().sort(Iv);for(var d=0;d<i.length;++d){var h=i[d];if(a+h.height>s){if(a===e.outerMargin)return!1;a=e.outerMargin,l+=1,r?u+=n:u-=n}h.x=u,h.y=a,a+=h.height}return l<=o}(r,e,t,"left"===e.position))&&t.forEach(function(t){return bv(e,i,t)}),n)}function Cv(t,e,i){for(var r=null,n=0;n<e.length;++n){var o;(o=e[n]).isNode!==t.isNode&&1!==e.length||!(null===r||o.height<e[r].height)||(r=n)}null!=r&&((o=e[r]).content.push(t),o.height+=t.height+i.outerMargin)}function Mv(t){for(var e=0,i=1;i<t.length;++i)t[i].height>t[e].height&&(e=i);return e}function Iv(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.title<=e.title?-1:1}function Lv(t,e){return t.height-e.height}function Nv(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:e.height-t.height}function Ov(t,e){return t.isNode!==e.isNode?t.isNode?-1:1:t.content[0].title<=e.content[0].title?-1:1}var kv,Fv=(x(Rv,kv=Ae),Rv.prototype.enable=function(t){var e=this._settings;return this._settings=I(I({},_v),t),this._mustRefresh=!this._enabled||!this._sameOptions(e,this._settings),this._enabled?Promise.resolve():(this._enabled=!0,this._graphics.addCanvas(this._canvas),this.refresh())},Rv.prototype._afterNextUpdate=function(){var e=this;return new Promise(function(t){return e._promises.push(t)})},Rv.prototype._formatSettings=function(t,e){var i=I(I({},_v),t);return vv.forEach(function(t){return i[t]*=e}),i},Rv.prototype.disable=function(){this._enabled&&(this._enabled=!1,this._graphics.removeCanvas(this._canvas))},Rv.prototype.enabled=function(){return this._enabled},Rv.prototype.refresh=function(){return this._mustRefresh=!0,this._dom.refresh(),this._afterNextUpdate()},Rv.prototype.destroy=function(){this._enabled=!1,this._mustRefresh=!1,this._settings=I({},_v),this._promises=[]},Rv.prototype.getOptions=function(){if(this._enabled)return I({},this._settings)},Rv.prototype.getCurrentOptions=function(){return this._settings},Rv.prototype._sameOptions=function(i,r){return i===r||Object.keys(i).reduce(function(t,e){return t&&i[e]===r[e]},!0)},Rv.prototype._drawOnCanvas=function(t,e,i){var r=this._formatSettings(t,i);Tv(r,e,this._computeWidgetList(r))},Rv.prototype.exportOnCanvas=function(t,e){return this._drawOnCanvas(e,t,1)},Rv.prototype._computeWidgetList=function(n){var o=this,s=[];return J_.forEach(function(t){var e=t.name,i=t.isNode,r=o._computeWidget(n,e,i);r&&s.push(r)}),s},Rv.prototype._computeWidget=function(t,e,i){var r=this._computePropertyMapping(t,e,i);if(r){if("icon.content"!==e)return r;var n=this._getRulesForAttribute(i,"icon.font"),o=this._getRulesForAttribute(i,"icon.style"),s=null,a=null;if(n.length||(s="Arial",a="normal"),"string"==typeof n[0]&&(s=n[0],a=o[0]),s&&a)return r.iconFont=s,r.iconFontStyle=a,r}return null},Rv.prototype._computePropertyMapping=function(t,e,i){var r,n,o,s,a,u,l,d=this._getRulesForAttribute(i,e)[0],h=d&&d.mapping,c=h&&h.getValues(i);if(h&&c){var f=h.getField(),g={};return j(c,function(t,e){void 0!==t&&"undefined"!==e&&(g[t]=g[t]||[],g[t].push(e))}),0===Object.keys(g).length?null:{isNode:i,title:t.titleFunction(f),styleProperty:e,dataProperty:f,mapping:g,height:(r=g,n=e,o=i,a=(s=t).outerMargin+xv(s),u=s.fontSize*lv,l=a-.8*s.innerMargin,"radius"===n||"width"===n?l+u*(o?3:2):l+Object.keys(r).length*u)}}return null},Rv.prototype._getRulesForAttribute=function(i,r){return this._styleRules.getRuleList().map(function(t){var e=t.getDefinition();return W(i?e.nodeAttributes:e.edgeAttributes,r)}).filter(function(t){return t}).sort(function(t,e){return t.mapping&&e.mapping?0:t.mapping?-1:1})},Rv);function Rv(t){var e,i=t.graphics,r=t.dom,n=t.events,o=t.styleRules,s=kv.call(this)||this;return s._enabled=!1,s._mustRefresh=!1,s._promises=[],s._graphics=i,s._dom=r,s._events=n,s._styleRules=o,s._canvas=bn(),s._ctx=s._canvas.getContext("2d"),s._events.on(((e={})[be.NEW_FRAME]=function(){if(s._enabled&&s._mustRefresh){s._ctx.clearRect(0,0,s._canvas.width,s._canvas.height),s._drawOnCanvas(s._settings,s._canvas,wt());var t=s._promises;s._promises=[],t.forEach(function(t){return t()}),s._mustRefresh=!1}},e[be.RESIZE+" "+be.RELOAD_FONTS]=function(){s._mustRefresh=!0},e)),s}var Pv,Dv={layer:3,outerStroke:{color:"red",width:5},innerStroke:{minVisibleSize:0},text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},zv={layer:3,color:"red",text:{backgroundColor:"rgb(220, 220, 220)",minVisibleSize:0}},Bv=(x(Uv,Pv=Ae),Uv.prototype.setRate=function(t){this._delay=t},Uv.prototype.updateNodeAttributes=function(t,e){this._hoverClass.update({nodeAttributes:t,fullOverwrite:e}),this._hoverExtremityHighlightedClass.update({nodeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},Uv.prototype.updateEdgeAttributes=function(t,e){this._hoverClass.update({edgeAttributes:t,fullOverwrite:e}),this._updateExtremityHighlightLayer()},Uv.prototype.getHoverClassDefinition=function(){return this._hoverClass.getDefinition()},Uv.prototype.onMounted=function(t){function e(){i._hoverExtremityHighlightedClass.clearNodes(),i._hoverClass.getEdges().getExtremities().addClass(di)}var i=this;this._classes.onEdgeClassAdded(li,e),this._classes.onEdgeClassRemoved(li,e)},Uv.prototype._registerSettings=function(){var e=this;this._settings.register("cursor.node","pointer",function(value,t){e._hovered&&e._hovered.isNode&&(e._graphics.removeCursorStyle(t),e._graphics.addCursorStyle(value))}),this._settings.register("cursor.edge","pointer",function(value,t){e._hovered&&!e._hovered.isNode&&(e._graphics.removeCursorStyle(t),e._graphics.addCursorStyle(value))}),this._settings.register("nodeHover",!0,function(value){!value&&e._hovered&&e._hovered.isNode&&e._unhover(e._hovered)}),this._settings.register("edgeHover",!0,function(value){value||!e._hovered||e._hovered.isNode||e._unhover(e._hovered)})},Uv.prototype._updateExtremityHighlightLayer=function(){var t=this._hoverClass.getDefinition().edgeAttributes,e=t?t.layer:void 0;this._hoverExtremityHighlightedClass.update({nodeAttributes:{layer:e},fullOverwrite:!1})},Uv.prototype._removeTimeout=function(){this._timeout&&(this._dom.clearTimeout(this._timeout),this._timeout=null)},Uv.prototype._hover=function(t){var e=this,i=t.isNode?"nodeHover":"edgeHover";this._settings.get(i)&&!this._graphics.isAnimating()&&(this._removeTimeout(),this._timeout=this._dom.setTimeout(function(){e._graphics.isAnimating()||(e._setElementHighlight(!0,t),e._hovered=t),e._timeout=null},this._delay))},Uv.prototype._unhover=function(t){this._removeTimeout(),this._hovered===t&&(this._setElementHighlight(!1,t),this._hovered=null)},Uv.prototype._setElementHighlight=function(t,e){var i=this._settings.get(e.isNode?"cursor.node":"cursor.edge");t?(this._graphics.addCursorStyle(i),e.addClass(li)):(this._graphics.removeCursorStyle(i),e.removeClass(li)),e.isNode&&t&&this._graph.getAttribute(e.isNode,"textHidden").set(e._index,!1)},Uv);function Uv(t){var e,i=t.dom,r=t.classes,n=t.captor,o=t.graph,s=t.graphics,a=t.settings,u=t.events,l=Pv.call(this)||this;return l._delay=100,l._manualTriggerDetection=!1,l._hovered=null,l._onAnimate=function(t){t.duration&&(l._manualTriggerDetection=!0,l._resetHover())},l._onBeforeNewFrame=function(){if(l._manualTriggerDetection&&!l._graphics.isAnimating()){l._manualTriggerDetection=!1,l._captor.triggerDetection();var t=l._captor.getPointedElement();t&&l._hover(t)}},l._onClear=function(){l._hovered=null,l._timeout&&l._dom.clearTimeout(l._timeout)},l._resetHover=function(){l._hovered&&(l._unhover(l._hovered),l._captor.triggerUnhover()),l._timeout&&(l._dom.clearTimeout(l._timeout),l._timeout=null)},l._dom=i,l._graph=o,l._graphics=s,l._settings=a,l._captor=n,l._events=u,l._classes=r,l._registerSettings(),l._hoverExtremityHighlightedClass=l._classes.createClass({name:di,isBuiltin:!0,nodeAttributes:Dv}),l._hoverClass=l._classes.createClass({name:li,isBuiltin:!0,nodeAttributes:Dv,edgeAttributes:zv}),l._events.on(((e={})[be.HOVER]=function(t){var e=t.target;return e&&l._hover(e)},e[be.UNHOVER]=function(t){var e=t.target;return e&&l._unhover(e)},e[be.ANIMATE]=l._onAnimate,e[be.BEFORE_NEW_FRAME]=l._onBeforeNewFrame,e[be.MOUSE_LEAVE]=l._resetHover,e[be.CLEAR_GRAPH]=l._onClear,e)),l}var Vv=function(){this.x=0,this.y=0},jv=(Gv.prototype.getValue=function(t,e){var i=t.isNode,r=i?this._nodeMapping:this._edgeMapping;r.valid||(r.values=this._computeMapping(i),r.valid=!0);var n=t.getData(this._field);return Array.isArray(n)?"color"===e?n.map(function(t){return r.values[t]}):r.values[n[0]]:r.values[n]},Gv.prototype.markAsInvalid=function(){this._nodeMapping.valid=!1,this._edgeMapping.valid=!1},Gv.prototype.getValues=function(t){return t?this._nodeMapping.values:this._edgeMapping.values},Gv.prototype.getField=function(){return this._field},Gv);function Gv(t,e){this._nodeMapping={valid:!1,values:{}},this._edgeMapping={valid:!1,values:{}},this._computeMapping=e,this._field=t}function Hv(t,e,i){var r=(e?t.getNodes():t.getEdges()).getData(i),n={};return r.forEach(function(value){if(!Array.isArray(value))return n[value]=1;value.forEach(function(t){return n[t]=1})}),"undefined"in n&&delete n[void 0],Object.keys(n).sort()}function Wv(t,e,i,r){for(var n=i.values,o=void 0===n?{}:n,s=i.fallback,a=Hv(t,r,e),u={},l=0,d=0;d<a.length;++d){var value=a[d];value in o?u[value]=o[value]:(u[value]=s[l],l=(l+1)%s.length)}return u}function qv(t,e,i,r){for(var n=i.fallback,o=i.stops,s=void 0===o?{}:o,a=i.values,u=i.reverse,l=Hv(t,r,e),d=1/0,h=-1/0,c=0;c<l.length;c++){Sg(value=+l[c])&&(d=Math.min(d,value),h=Math.max(h,value),l[c]=value)}var f={};if(!isFinite(d)){for(c=0;c<l.length;c++)f[l[c]]=n;return f}var g=function(t,e){var i=e.nbSlices,r=e.minValue,n=e.maxValue;if(Array.isArray(t))return t.slice();for(var o=t.min,s=void 0===o?r:o,a=t.max,u=((void 0===a?n:a)-s)/i,l=[],d=1;d<i;++d)l.push(s+u*d);return l}(s,{nbSlices:Array.isArray(a)?a.length:a.nbSlices,minValue:d,maxValue:h}),p=function(t,e){if(Array.isArray(t))return t;for(var i=t.min,r=t.max,n=e.length+1,o=(r-i)/e.length,s=[],a=0;a<n;a++)s.push(i+a*o);return s}(a,g);u&&p.reverse();for(c=0;c<l.length;++c){var value=l[c];if(isFinite(value)){for(var _=0;_<g.length&&g[_]<=value;)_+=1;f[value]=p[_]}else f[value]=n}return f}var Xv,Yv=(x(Zv,Xv=Ae),Zv.prototype.createMapping=function(t){var e=void 0===t?{field:""}:t,i=e.field,r=e.values,n=void 0===r?{}:r,o=e.fallback,s=void 0===o?void 0:o;if(i=R(i),Array.isArray(s)?0===s.length&&(s=[void 0]):s=[s],!U(n))throw new Error('"mapping" should be an object');return this._createMappingFunction(Wv,i,{values:n,fallback:s})},Zv.prototype.createSlices=function(t){var e=void 0===t?{field:"",values:[]}:t,i=e.field,r=e.fallback,n=void 0===r?void 0:r,o=e.stops,s=void 0===o?{}:o,a=e.values,u=e.reverse,l=void 0!==u&&u;if(i=R(i),Array.isArray(a)||a.nbSlices||(a.nbSlices=7),Array.isArray(s)&&Array.isArray(a)&&s.length!==a.length-1)throw new Error("there should be exactly one more value that stops");return this._createMappingFunction(qv,i,{fallback:n,stops:s,values:a,reverse:l})},Zv.prototype._createMappingFunction=function(e,i,r){var n=this,o=new jv(i,function(t){return e(n._graph,i,r,t)});function t(t,e,i){return o.getValue(t,i)}return this._mappingList.push(o),t.mapping=o,t},Zv.prototype.createTemplate=function(t){if("string"!=typeof t)throw new TypeError('"template" should be a string');for(var r=[],e=0,i=!1;!i;){var n=-1,o=t.indexOf("{{",e);-1!==o&&(n=t.indexOf("}}",o+2)),-1!==n?(r.push(t.substring(e,o)),r.push(t.substring(o+2,n)),e=n+2):(r.push(t.slice(e)),i=!0)}return function(t){for(var e=r[0],i=1;i<r.length;i+=2)e+=t.getData(r[i]),e+=r[i+1];return e}},Zv);function Zv(t){var e,i=t.graph,r=t.events,n=t.styleRules,o=t.legend,s=Xv.call(this)||this;return s._mappingList=[],s._graph=i,s._styleRules=n,s._events=r,s._legend=o,s._events.on(((e={})[[be.ADD_NODES,be.ADD_EDGES,be.UPDATE_NODE_DATA,be.UPDATE_EDGE_DATA,be.REMOVE_NODES,be.BEFORE_REMOVE_EDGES,be.EXCLUDED_STATE_CHANGE,be.CLEAR_GRAPH].join(" ")]=function(){if(s._mappingList.length){for(var t=0;t<s._mappingList.length;++t)s._mappingList[t].markAsInvalid();s._styleRules.refreshAllRules(),s._legend.refresh()}},e)),s}var Kv,Qv,Jv=($v.prototype.run=function(t){var e=t.ogma,i=t.duration,r=this._getNodesToFilter(e),n=this._getEdgesToFilter(e,r);return Promise.all([r.addClass(vi,i),n.addClass(vi,i)]).then(function(){return r.setExcluded(!0),n.setExcluded(!0),{nodes:r,edges:n,virtualNodes:null,virtualEdges:null}})},$v.prototype.undo=function(t){var e=t.duration,i=t.context,r=i.nodes,n=i.edges;return r.setExcluded(!1),n.setExcluded(!1),r.addClass(vi),n.addClass(vi),Promise.all([r.removeClass(vi,e),n.removeClass(vi,e)])},$v.prototype.cleanup=function(t){return Promise.resolve()},$v);function $v(t){var e=t.getNodesToFilter,i=t.getEdgesToFilter;this._getNodesToFilter=e,this._getEdgesToFilter=i}(Qv=Kv=Kv||{}).NodeFilter="node-filter",Qv.EdgeFilter="edge-filter",Qv.NodeCollapsing="node-collapsing",Qv.VirtualProperties="virtual-properties",Qv.NeighborGeneration="neighbor-generation",Qv.NeighborMerging="neighbor-merging",Qv.NodeGrouping="node-grouping",Qv.EdgeGrouping="edge-grouping";var tm,em=(x(im,tm=Jv),im.prototype.getName=function(){return Kv.NodeFilter},im);function im(e){return tm.call(this,{getNodesToFilter:function(t){return t.getNodes().filter(function(t){return!e||!e(t)})},getEdgesToFilter:function(t,e){return e.getAdjacentEdges()}})||this}var rm,nm=(x(om,rm=Jv),om.prototype.getName=function(){return Kv.EdgeFilter},om);function om(e){return rm.call(this,{getNodesToFilter:function(t){return t.createNodeList()},getEdgesToFilter:function(t){return t.getEdges().filter(function(t){return!e||!e(t)})}})||this}function sm(t){return"object"!=typeof t?{criteria:t,enabled:!0,duration:0}:t}var am,um=(x(lm,am=Ae),lm.prototype.addNodeFilter=function(t){var e=sm(t),i=e.criteria,r=b(e,["criteria"]);return this._transformations.add(new em(i),r)},lm.prototype.addEdgeFilter=function(t){var e=sm(t),i=e.criteria,r=b(e,["criteria"]);return this._transformations.add(new nm(i),r)},lm);function lm(t){var e=t.transformations,i=am.call(this)||this;return i._transformations=e,i}var dm=(hm.prototype.destroy=function(){var i=this;Object.keys(this).forEach(function(t){var e=i[t];e instanceof Ae&&e.destroy(i._ogma)})},hm);function hm(t,i){var r=this;this._ogma=t,"webgl"===Oh&&ou.cacheInitData(ou.createInitData()),this.settings=new qh,this.events=new zh,this.dom=new Ce(this,i.dimensions),this.animations=new vf(this),this.camera=new wh(this),this.graph=new Sr(this,t),this.data=new Ne(this),this.graphics=new kh(this,t),this.individualAttributes=new Gh(this),this.algorithms=new Vf(this),this.position=new Vv,this.touch=new zc(this),this.mouse=new Fc(this),this.virtualMouse=new ep(this),this.spatial=new Sc(this),this.captor=new __(this),this.interactions=new s_(this),this.classes=new Qh(this),this.cameraInteractions=new mh(this,!!i.debug),this.hover=new Bv(this),this.keyboard=new K_(this),this.selection=new ef(this),this.styleRules=new pp(this),this.legend=new Fv(this),this.sync=new of(this),this.rules=new Yv(this),this.transformations=new Zc(this,t),this.filters=new um(this),this.locate=new Ic(this),this.drag=new A_(this),this.grouping=new jc(this),this.pulses=new cf(this),this.curvatureManager=new Hf(this),this.tasks=new hg(this),this.layouts=new xg(this),this.watcher=new Dg(this),this.pathfinding=new Kg(this),this.rectangleSelect=new Sp(this),this.labels=new t_(this,i),this.brand=new Cf(this),this.lasso=new xp(this),this.rewiring=new C_(this),this.resizing=new N_(this),this.snapping=new dp(this),this.connectNodes=new D_(this),this.tooltip=new H_(this),this.geo=new Nf(this),t.onReady(function(){Object.keys(r).forEach(function(t){var e=r[t];e instanceof Ae&&e.onMounted(r._ogma,i)})})}var cm=(fm.initNamespace=function(t){var o;t.algorithms=(o=t,{shortestPath:function(t){return o.modules.algorithms.shortestPath(t)},hasCycle:function(t){var e=void 0===t?{}:t,i=e.nodes,r=e.edges;return null!==o.algorithms.detectCycle({nodes:i,edges:r})},getAllSimpleCycles:function(t){var e=void 0===t?{}:t,i=e.nodes,r=e.edges;return i=i||o.getNodes(),r=r||i.getAdjacentEdges({bothExtremities:!0}),o.modules.algorithms.getAllSimpleCycles(i,r)},detectCycle:function(t){var e=void 0===t?{}:t,i=e.nodes,r=e.edges;i=i||o.getNodes(),r=r||i.getAdjacentEdges({bothExtremities:!0});var n=o.modules.algorithms.detectCycle(i,r);return n.size?n:null}})},fm);function fm(){}var gm=(pm.prototype.createClass=function(t,e){return this.modules.classes.createClass(Object.assign({},e,{name:t}))},pm.prototype.updateClass=function(t,e){return this.modules.classes.getClassByName(t,!0).update(e||{})},pm.prototype.getNodesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getNodes(e)},pm.prototype.getEdgesByClassName=function(t,e){return this.modules.classes.getClassByName(t,!0).getEdges(e)},pm);function pm(){}var _m=(vm.prototype.getHoveredElement=function(){return this.modules.captor.getPointedElement()},vm.prototype.getPointerInformation=function(){return this.modules.captor.getCursorInformation()},vm);function vm(){}var mm=(ym.initNamespace=function(t){var d;t.debug=(d=t,{wait:function(e){return new Promise(function(t){return setTimeout(t,e)})},initRandomGraph:function(t){return d.generate.random(t).then(d.setGraph).then(function(){return d.view.locateGraph()}).then(function(){return d.view.afterNextFrame()})},initGrid:function(t){var e=Math.ceil(Math.sqrt(t));return d.generate.grid({rows:e,columns:e}).then(function(t){return d.setGraph(t)}).then(function(){return d.view.locateGraph()})},initLine:function(t){return d.setGraph({nodes:[{id:0,attributes:{x:0,y:0}},{id:1,attributes:t?{x:0,y:50}:{x:50,y:0}}],edges:[{id:0,source:1,target:0}]}),d.view.locateGraph()},initSingleNode:function(){return d.setGraph({nodes:[{id:0,attributes:{x:0,y:0}}],edges:[]}),d.view.locateGraph()},initContinuousRenderLoop:function(t){var e=void 0===t?{}:t,i=e.triggerKey,r=void 0===i?"r":i,n=e.start,o=void 0===n||n,s=function(){o&&d.modules.dom.beforeNextFrame().then(s)};document.addEventListener("keydown",function(t){t.key===r&&(o=!o,s())}),s()},appendToBody:function(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0",t.style.left="0",t.style.bottom="0",t.style.right="0",document.body.appendChild(t),d.setContainer(t)},loadFile:function(t){return(t.endsWith(".gexf")?d.parse.gexfFromUrl(t):d.parse.jsonFromUrl(t)).then(function(t){return d.setGraph(t)}).then(function(){return d.view.locateGraph()}).then(function(){return d.view.afterNextFrame()})},enableLasso:function(t){d.events.onDragStart(function(){d.keyboard.isKeyPressed("ctrl")&&d.tools.lasso.enable(t)})},randomizeGraph:function(t){var e=void 0===t?{}:t,i=e.minX,r=void 0===i?0:i,n=e.minY,o=void 0===n?0:n,s=e.maxX,a=void 0===s?500:s,u=e.maxY,l=void 0===u?500:u;return d.getNodes().setAttributes(d.getNodes().map(function(){return{x:r+Math.random()*(a-r),y:o+Math.random()*(l-o)}}))}})},ym);function ym(){}var xm=(bm.prototype.setContainer=function(t){this.modules.dom.setContainer(t)},bm.prototype.getContainer=function(){return this.modules.dom.getContainer()},bm);function bm(){}var Em=(Am.initNamespace=function(t){var i;t.events=(i=t,{removeListener:function(t){i.modules.events.removeListener(t)},onNodesAdded:function(t){return i.modules.events.on(be.ADD_NODES,t),i},onBeforeNodesRemoved:function(t){return i.modules.events.on(be.BEFORE_REMOVE_NODES,t),i},onNodesRemoved:function(t){return i.modules.events.on(be.REMOVE_NODES,t),i},onEdgesAdded:function(t){return i.modules.events.on(be.ADD_EDGES,t),i},onBeforeEdgesRemoved:function(t){return i.modules.events.on(be.BEFORE_REMOVE_EDGES,t),i},onEdgesRemoved:function(t){return i.modules.events.on(be.REMOVE_EDGES,t),i},onNodesClassAdded:function(t,e){return i.modules.classes.onNodeClassAdded(t,e),i},onNodesClassRemoved:function(t,e){return i.modules.classes.onNodeClassRemoved(t,e),i},onEdgesClassAdded:function(t,e){return i.modules.classes.onEdgeClassAdded(t,e),i},onEdgesClassRemoved:function(t,e){return i.modules.classes.onEdgeClassRemoved(t,e),i},onNodeDragStart:function(t){return i.modules.events.on(be.NODES_DRAG_START,t),i},onNodeDragProgress:function(t){return i.modules.events.on(be.NODES_DRAG_PROGRESS,t),i},onNodeDragEnd:function(t){return i.modules.events.on(be.NODES_DRAG_END,t),i},onDrop:function(t){return i.modules.events.on(be.DROP,t),i},onKeyPress:function(t,e){return i.modules.keyboard.onKeyPress(t,e),i},onNodesSelected:function(t){return i.events.onNodesClassAdded(hi,t)},onNodesUnselected:function(t){return i.events.onNodesClassRemoved(hi,t)},onEdgesSelected:function(t){return i.events.onEdgesClassAdded(hi,t)},onEdgesUnselected:function(t){return i.events.onEdgesClassRemoved(hi,t)},onNodeDataChange:function(t){return i.modules.events.on(be.UPDATE_NODE_DATA,t),i},onEdgeDataChange:function(t){return i.modules.events.on(be.UPDATE_EDGE_DATA,t),i},onMouseMove:function(t){return i.modules.events.on(be.MOVE,t),i},onMouseButtonDown:function(t){return i.modules.events.on(be.DOWN,t),i},onMouseButtonUp:function(t){return i.modules.events.on(be.UP,t),i},onClick:function(t){return i.modules.events.on(be.CLICK,t),i},onDoubleClick:function(t){return i.modules.events.on(be.DOUBLE_CLICK,t),i},onMouseWheel:function(t){return i.modules.events.on(be.WHEEL,t),i},onHover:function(t){return i.modules.events.on(be.HOVER,t),i},onUnhover:function(t){return i.modules.events.on(be.UNHOVER,t),i},onDragStart:function(t){return i.modules.events.on(be.DRAG_START,t),i},onDragProgress:function(t){return i.modules.events.on(be.DRAG_PROGRESS,t),i},onDragEnd:function(t){return i.modules.events.on(be.DRAG_END,t),i},onGestureStart:function(t){return i.modules.events.on(be.GESTURE_START,t),i},onGestureProgress:function(t){return i.modules.events.on(be.GESTURE_PROGRESS,t),i},onGestureEnd:function(t){return i.modules.events.on(be.GESTURE_END,t),i},onRendererStateChange:function(t){return i.modules.events.on(be.RENDERER_STATE_CHANGE,t),i},onZoomProgress:function(t){return i.modules.events.on(be.CAMERA_ZOOM,t),i},onViewChanged:function(t){return i.modules.events.on(be.VIEW_CHANGED,t),i},onNodesConnected:function(t){return i.modules.events.on(be.CONNECT_NODES,t),i},onGeoModeEnabled:function(t){return i.modules.events.on(be.GEO_ENABLED,t),i},onGeoModeDisabled:function(t){return i.modules.events.on(be.GEO_DISABLED,t),i},onGeoModeLoaded:function(t){return i.modules.events.on(be.GEO_LOADED,t),i},onLayoutStart:function(t){return i.modules.events.on(be.LAYOUT_START,t),i},onLayoutComplete:function(t){return i.modules.events.on(be.LAYOUT_END,t),i},onLayoutComputed:function(t){return i.modules.events.on(be.LAYOUT_COMPUTED,t),i},onTooltipShown:function(t){return i.modules.events.on(be.TOOLTIP_SHOW,t),i},onTooltipHidden:function(t){return i.modules.events.on(be.TOOLTIP_HIDE,t),i}})},Am);function Am(){}function Sm(t){return t instanceof _r?t.getId():t}function wm(t){return t instanceof Qi?t.getId():t}function Tm(t){return t instanceof mr?t.getId():t instanceof _r?[t.getId()]:L(t)?t.map(Sm):[Sm(t)]}function Cm(t){return t instanceof $i?t.getId():t instanceof Qi?[t.getId()]:L(t)?t.map(wm):[wm(t)]}function Mm(t,e,i){if(null!=t){if(Array.isArray(t))return t[0];if(e&&i){if("source"===t)return Mm(i.color.get(e.getSource()._index));if("target"===t)return Mm(i.color.get(e.getTarget()._index))}return t}}function Im(t){return null==t?null:"string"==typeof t||"number"==typeof t?""+t:t&&Im(t.content)}var Lm=["color","radius","shape","text.content","x","y"],Nm=["color","width","shape.type","text.content"];function Om(t){return{nodes:t.nodes.map(function(t){var e=t.id,i=t.attributes,r=void 0===i?{}:i,n=t.data,o=r.color,s=r.radius,a=r.shape,u=r.text;return{id:e,x:r.x,y:r.y,color:Mm(o),size:s,shape:a,text:Im(u),data:n}}),edges:t.edges.map(function(t){var e=t.id,i=t.source,r=t.target,n=t.attributes,o=void 0===n?{}:n,s=t.data,a=o.color,u=o.width,l=o.text,d=o.shape;return{id:e,source:i,target:r,color:Mm(a),size:u,shape:function(t){if(null!=t)return"string"==typeof t?t:t.type}(d),text:Im(l),data:s}})}}var km="visible";function Fm(t,e,i,r){var n,o,s,a,u=(o=r,(n=e)?Tm(n):"object"==typeof o?Tm(o.nodes):o||km),l=(a=r,(s=i)?Cm(s):"object"==typeof a?Cm(a.edges):a||km);return{nodes:t.getNodes(u),edges:t.getEdges(l)}}function Rm(t,e){var i=e.nodeAttributes,r=e.edgeAttributes,n=e.nodes,o=e.edges,s=e.filter,a=e.nodeData,u=e.edgeData,l=Fm(t,n,o,s);return{nodes:l.nodes.toJSON({attributes:i,data:a}),edges:l.edges.toJSON({attributes:r,data:u})}}function Pm(s,t,e){var i,r,n,o,a,u=e.styles,l=e.nodes,d=e.edges,h=e.filter,c=e.nodeData,f=e.edgeData,g="all"!==u?{nodes:["x","y"],edges:[]}:{nodes:Lm,edges:Nm},p=Rm(s,{nodeAttributes:g.nodes,edgeAttributes:g.edges,nodes:l,edges:d,filter:h,nodeData:c,edgeData:f});if("original"===u){for(var _=(i=t,r=Fm(s,l,d,h),n=r.nodes,o=r.edges,a=i.getOriginalAttributes(),{nodes:n.reduce(function(t,e){return t[e.getId()]={x:a.nodes.x.get(e._index),y:a.nodes.y.get(e._index),color:Mm(a.nodes.color.get(e._index)),radius:a.nodes.radius.get(e._index),shape:a.nodes.shape.get(e._index),text:{content:a.nodes.text.content.get(e._index)}},t},{}),edges:o.reduce(function(t,e){return t[e.getId()]={color:Mm(a.edges.color.get(e._index)),width:a.edges.width.get(e._index),shape:{type:a.edges.shape.type.get(e._index)},text:{content:a.edges.text&&a.edges.text.content&&a.edges.text.content.get(e._index)}},t},{})}),v=0,m=p.nodes;v<m.length;v++){var y=m[v];null!=y.id&&(y.attributes=_[y.id])}for(var x=0,b=p.edges;x<b.length;x++){var E=b[x];null!=E.id&&(E.attributes=_[E.id])}}return"all"===u&&p.edges.forEach(function(t){var e=t.source,i=t.target,r=t.attributes;if(r){var n=s.getNode(e);"source"===r.color&&n&&(r.color=n.getAttribute("color"));var o=s.getNode(i);"target"===r.color&&o&&(r.color=o.getAttribute("color"))}}),Om(p)}function Dm(value,t){return null==value||Array.isArray(value)&&!value.length?t:value}function zm(t){return"string"==typeof t}function Bm(t,r,s,a,u){var l="edges"===r,d={};return t.forEach(function(n,t){var e=u.get(t),i=N(Dm(s(e),r));if(!i.every(zm))throw Error("The tab "+r+" function returned an invalid value.");var o=N(a(n.data,i));i.forEach(function(t,e){var i=Dm(o[e],{}),r=Io(I(I(I({},i),{id:n.id}),l?{source:n.source,target:n.target}:{})).reduce(function(t,e){var i=e.path,value=e.value;return t[i.join(".")]=value,t},{});d[t]=d[t]||[],d[t].push(r)})}),d}function Um(t){if(!t.length)return[];for(var e=function(t){for(var e=I({},t[0]),i=0,r=t;i<r.length;i++)for(var n=r[i],o=0,s=Object.keys(n);o<s.length;o++){var a=s[o];a in e||(e[a]=void 0)}return Object.keys(e)}(t),i=-1<e.indexOf("source")?["id","source","target"]:["id"],r=E(i,e.filter(function(t){return-1===i.indexOf(t)})),n=[r],o=function(e){n.push(r.map(function(t){return e[t]}))},s=0,a=t;s<a.length;s++){o(a[s])}return n}function Vm(l,d,h){for(var c=new Lo,f=d?1:3,g=[],t=function(t){var e=l[t],i=new Array(f),r=e.data;if(h){var n={};h.forEach(function(t){var e=R(t),value=function(t,e){for(var i=0;i<e.length;++i){if(null==t)return;t=t[e[i]]}return t}(r,e);!function(t,e,value){for(var i=0;i<e.length-1;++i){var r=e[i],n=t[r];void 0===n&&(n={},t[r]=n),t=n}t[e[e.length-1]]=value}(n,e,value)}),r=n}var o=Io(r);i[0]=e.id,d||(i[1]=e.source,i[2]=e.target);for(var s=0;s<o.length;++s){var a=o[s],u=a.path,value=a.value;u.length&&(c.has(u)?i[c.get(u)]=value:(c.set(u,f),i[f]=value,f++))}g.push(i)},e=0;e<l.length;++e)t(e);var i=[];return i.push("id"),d||(i.push("source"),i.push("target")),c.keys().forEach(function(t){return i.push(t[t.length-1])}),g.unshift(i),g.forEach(function(t){return t.length=f}),g}function jm(p){return{csv:function(t){var e=J("string"==typeof t?{what:t}:t,Gm),i=e.what,r=e.dataProperties,n=e.nodes,o=e.edges,s=e.separator,a=e.textSeparator,u=e.download,l=e.nodeData,d=e.edgeData,h=e.filename,c=e.filter,f=Pm(p.modules.graph,p.modules.individualAttributes,{styles:"none",nodes:n,edges:o,filter:c,nodeData:l,edgeData:d});try{var g=function(t,e){var i=e.what,r=e.separator,n=e.textSeparator,o=e.dataProperties,s=new RegExp(""+n,"g");function a(t){return t=function(t){if(t instanceof Date)return t.toISOString();return""+t}(t),t=n+t.replace(s,"\\$&")+n}if(n&&'"'!==n&&"'"!==n)throw new TypeError('Invalid argument :"textSeparator" is not single-quote or double-quote, was '+n);if("nodes"!==i&&"edges"!==i)throw new TypeError('missing argument: "what": should have value "nodes" or "edges"');var u="nodes"===i;return Vm(u?t.nodes:t.edges,u,o).map(function(t){return t.map(function(value){return a(value)})}).map(function(t){return t.join(r)}).join("\n")}(f,{what:i,separator:s,textSeparator:a,dataProperties:r});return u&&It(g,h,"text"),Promise.resolve(g)}catch(t){return Promise.reject(t)}}}}var Gm={what:void 0,dataProperties:void 0,separator:",",textSeparator:'"',download:!0,filename:"graph.csv",filter:"visible",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},styles:"none"};function Hm(f){return{gexf:function(t){void 0===t&&(t={});var e=J(t,Wm),i=e.styles,r=e.nodes,n=e.edges,o=e.download,s=e.filename,a=e.creator,u=e.description,l=e.filter,d=e.nodeData,h=e.edgeData,c=function(t,e){var i,u=new kr,l=Jo(),d={},a={},h=0,c=0,r=l.createElement("gexf");r.setAttribute("xmlns","http://www.gexf.net/1.2draft"),r.setAttribute("xmlns:viz","http://www.gexf.net/1.2draft/viz"),r.setAttribute("xmlns:xsi","http://www.w3.org/2001/XMLSchema-instance"),r.setAttribute("xsi:schemaLocation","http://www.gexf.net/1.2draft http://www.gexf.net/1.2draft/gexf.xsd"),r.setAttribute("version","1.2");var n=l.createElement("meta");if(n.setAttribute("lastmodifieddate",Qt()),e.creator){var o=l.createElement("creator");i=l.createTextNode(""+e.creator),o.appendChild(i),n.appendChild(o)}if(e.description){var s=l.createElement("description");i=l.createTextNode(""+e.description),s.appendChild(i),n.appendChild(s)}var f=l.createElement("graph");f.setAttribute("mode","static");var g=l.createElement("nodes");t.nodes.forEach(function(t){var e=l.createElement("node");if(e.setAttribute("id",String(t.id)),t.text&&e.setAttribute("label",Ht(t.text)),Ym(t.data)){var r=Zm(t.data),n=l.createElement("attvalues");Object.keys(r).forEach(function(t){t in d||(d[t]={id:h,type:"integer"},h++);var e=r[t];d[t].type=Xm(e,d[t].type);var i=l.createElement("attvalue");i.setAttribute("for",d[t].id),i.setAttribute("value",Ht(e)),n.appendChild(i)}),e.appendChild(n)}if(t.color){var i=u.parseColor(t.color);if(i){var o=l.createElement("viz:color");o.setAttribute("r",qm(i[0])),o.setAttribute("g",qm(i[1])),o.setAttribute("b",qm(i[2])),o.setAttribute("a",i[3]),e.appendChild(o)}}var s=l.createElement("viz:position");if(s.setAttribute("x",t.x),s.setAttribute("y",-t.y),e.appendChild(s),t.size){var a=l.createElement("viz:size");a.setAttribute("value",t.size),e.appendChild(a)}g.appendChild(e)});var p=l.createElement("attributes");p.setAttribute("class","node"),Object.keys(d).forEach(function(t){var e=l.createElement("attribute");e.setAttribute("id",d[t].id),e.setAttribute("title",t),e.setAttribute("type",d[t].type),p.appendChild(e)});var _=l.createElement("edges");t.edges.forEach(function(t){var e=l.createElement("edge");if(e.setAttribute("id",t.id.toString()),e.setAttribute("source",t.source),e.setAttribute("target",t.target),t.size&&e.setAttribute("weight",t.size),t.text&&e.setAttribute("label",Ht(t.text)),Ym(t.data)){var r=Zm(t.data),n=l.createElement("attvalues");Object.keys(r).forEach(function(t){t in a||(a[t]={id:c,type:"integer"},c++);var e=r[t];a[t].type=Xm(e,a[t].type);var i=l.createElement("attvalue");i.setAttribute("for",a[t].id),i.setAttribute("value",Ht(e)),n.appendChild(i)}),e.appendChild(n)}if(t.color){var i=u.parseColor(t.color);if(i){var o=l.createElement("viz:color");o.setAttribute("r",qm(i[0])),o.setAttribute("g",qm(i[1])),o.setAttribute("b",qm(i[2])),o.setAttribute("a",i[3]),e.appendChild(o)}}if(t.size){var s=l.createElement("viz:size");s.setAttribute("value",t.size),e.appendChild(s)}_.appendChild(e)});var v=l.createElement("attributes");return v.setAttribute("class","edge"),Object.keys(a).forEach(function(t){var e=l.createElement("attribute");e.setAttribute("id",a[t].id),e.setAttribute("title",t),e.setAttribute("type",a[t].type),v.appendChild(e)}),f.appendChild(p),f.appendChild(v),f.appendChild(g),f.appendChild(_),r.appendChild(n),r.appendChild(f),l.appendChild(r),'<?xml version="1.0" encoding="UTF-8"?>'+l.serialize()}(Pm(f.modules.graph,f.modules.individualAttributes,{styles:i,nodes:r,edges:n,filter:l,nodeData:d,edgeData:h}),{creator:a,description:u});return o&&It(c,s,"text"),Promise.resolve(c)}}}var Wm={creator:void 0,description:void 0,styles:"all",download:!0,filename:"graph.gexf",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"};function qm(value){return Math.round(255*value)}function Xm(t,e){if("integer"===e&&"number"==typeof t){if(t%1!=0)return"float"}else if("number"!=typeof t)return"boolean"==typeof t?"boolean":"string";return e}function Ym(value){return"object"==typeof value&&null!==value&&value.constructor===Object}function Zm(t,e){return void 0===e&&(e={}),j(t,function(value,t){Ym(value)?Zm(value,e):e[t]=value}),e}function Km(f){return{graphml:function(t){void 0===t&&(t={});var e=J(t,Qm),i=e.styles,r=e.nodes,n=e.edges,o=e.download,s=e.filename,a=e.graphId,u=e.directedEdges,l=e.filter,d=e.nodeData,h=e.edgeData,c=function(t,o){var n=new kr,s=ts();function a(t){return n.toHexa(t)}function u(t,e){var i,r=(i=e,n.parseColor(i));r&&(t.r=r[0],t.g=r[1],t.b=r[2])}function l(t,e,i,r,force){i=i||{};var n=s.createElement(e);for(var o in i)if(i.hasOwnProperty(o)){var value=i[o];void 0!==value&&n.setAttribute(o,value)}return void 0===r&&!force||("[object Object]"===Object.prototype.toString.call(r)&&(r=JSON.stringify(r)),n.appendChild(s.createTextNode(r))),t.appendChild(n),n}var d=["id","source","target"],h=["size","x","y","shape","text","color"],c={size:{for:"all",type:"double"},x:{for:"node",type:"double"},y:{for:"node",type:"double"},shape:{for:"all",type:"string"},color:{for:"all",type:"string"},r:{for:"all",type:"int"},g:{for:"all",type:"int"},b:{for:"all",type:"int"},a:{for:"all",type:"double"},text:{for:"all",type:"string"}};o.noStyles&&(delete c.color,delete c.r,delete c.g,delete c.b,delete c.a,delete c.shape,h.pop());var f=[],g=[];function e(e,i){var r={id:e.id};h.forEach(function(t){var value=e[t];"y"===t&&value&&(value=-parseFloat(value)),void 0!==value&&(r[("edge"===i?"edge_":"")+t]=value,"color"===t&&u(r,value))}),j(e.data||{},function(value,t){-1===h.indexOf(t)&&-1===d.indexOf(t)&&(c[t]?c[t].for!==i&&(c[t].for="all"):c[t]={for:i,type:"string"},r[t]=value)}),"edge"===i?(r.source=e.source,r.target=e.target,g.push(r)):f.push(r)}t.nodes.forEach(function(t){return e(t,"node")}),t.edges.forEach(function(t){return e(t,"edge")});var i=l(s,"graphml",{xmlns:"http://graphml.graphdrawing.org/xmlns","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xsi:schemaLocation":"http://graphml.graphdrawing.org/xmlns http://www.yworks.com/xml/schema/graphml/1.1/ygraphml.xsd","xmlns:y":"http://www.yworks.com/xml/graphml","xmlns:java":"http://www.yworks.com/xml/yfiles-common/1.0/java","xmlns:sys":"http://www.yworks.com/xml/yfiles-common/markup/primitives/2.0","xmlns:x":"http://ww.yworks.com/xml/yfiles-common/markup/2.0"});j(c,function(value,t){"node"!==value.for&&"all"!==value.for||l(i,"key",{"attr.name":t,"attr.type":value.type,for:"node",id:t}),"edge"!==value.for&&"all"!==value.for||l(i,"key",{"attr.name":t,"attr.type":value.type,for:"edge",id:"edge_"+t})}),l(i,"key",{id:"nodegraphics",for:"node","yfiles.type":"nodegraphics","attr.type":"string"}),l(i,"key",{id:"edgegraphics",for:"edge","yfiles.type":"edgegraphics","attr.type":"string"});var p=l(i,"graph",{edgedefault:o.directedEdges||void 0===o.directedEdges?"directed":"undirected",id:o.graphId?o.graphId:"G","parse.nodes":t.nodes.length,"parse.edges":t.edges.length,"parse.order":"nodesfirst"});return f.forEach(function(t){var e=l(p,"node",{id:t.id});!function(t,e){var i=l(t,"data",{key:"nodegraphics"}),r=l(i,"y:ShapeNode");l(r,"y:Geometry",{x:e.x,y:e.y,width:e.size,height:e.size}),o.noStyles||l(r,"y:Fill",{color:a(e.color),transparent:!1});l(r,"y:NodeLabel",null,e.text||""),l(r,"y:Shape",{type:e.shape})}(e,t),j(t,function(value,t){-1===d.indexOf(t)&&l(e,"data",{key:t},value,!0)})}),g.forEach(function(t){var e,i,r,n=l(p,"edge",{id:t.id,source:t.source,target:t.target});e=t,i=l(n,"data",{key:"edgegraphics"}),r=l(i,"y:PolyLineEdge"),l(r,"y:LineStyle",{type:e.edge_type,color:o.noStyles?void 0:a(e.edge_color),width:e.edge_size}),l(r,"y:EdgeLabel",null,e.edge_label),j(t,function(value,t){-1===d.indexOf(t)&&l(n,"data",{key:t},value,!0)})}),'<?xml version="1.0" encoding="UTF-8"?>\n'+$o(s)}(Pm(f.modules.graph,f.modules.individualAttributes,{styles:i,nodes:r,edges:n,filter:l,nodeData:d,edgeData:h}),{graphId:a,directedEdges:u,noStyles:"none"===i});return o&&It(c,s,"text"),Promise.resolve(c)}}}var Qm={graphId:"G",directedEdges:!0,styles:"all",download:!0,filename:"graph.graphml",nodes:void 0,edges:void 0,nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible"};var Jm={nodeAttributes:["x","y","color","radius","shape","text"],edgeAttributes:["color","width","text"],nodeData:function(t){return t},edgeData:function(t){return t},filter:"visible",pretty:!1,download:!0,filename:"graph.json"};function $m(t,e){void 0===e&&(e={});var i=t.view.get(),r="number"==typeof e.margin?e.margin:0,n={pixelRatio:1,angle:0,backgroundColor:null,zoom:0,x:0,y:0,width:0,height:0,hideImages:!1};if(e.width&&e.height?(n.width=e.width,n.height=e.height):(n.width=i.width,n.height=i.height),e.clip)n.zoom=i.zoom,n.x=i.x,n.y=i.y;else{var o=t.getNodes(e.filter),s=o.getBoundingBox().computeForZoom(i.zoom).extend(ss.fromValues(o.getAttribute("x"),o.getAttribute("y"),o.map(function(t){return t.getAttribute("radius")+t.getAttribute("innerStroke.width")+t.getAttribute("outerStroke.width")})));if(e.texts){var a=t.modules.labels.getTextsBoundingBox();a.isValid()&&s.extend(a)}if(null==e.width||!isFinite(e.width)||null==e.height||!isFinite(e.height)){var u=t.view.graphToScreenCoordinates(s.bottomLeft()),l=t.view.graphToScreenCoordinates(s.topRight()),d=l.x-u.x,h=l.y-u.y,c=Math.min(n.width/d,n.height/h);n.width=d*c,n.height=h*c}n.x=s.cx,n.y=s.cy,n.width=Math.max(n.width,2*r+1),n.height=Math.max(n.height,2*r+1),n.zoom=Math.min((n.width-2*r)/s.width,(n.height-2*r)/s.height)}return t.modules.geo.isEnabled()?n.backgroundColor=null:void 0!==e.background&&(n.backgroundColor=e.background),n}function ty(t,e,i,r,n){void 0===n&&(n=!1);var o=I(I({},i),{renderBackground:!1,hideImages:n,angle:i.angle||0,currentTime:Kt(),isBufferDisplayable:function(t){return e.texts||!Vl(t)}}),s={};if(!1===e.badges){var a={text:null,image:null};s.badges={topLeft:a,topRight:a,bottomRight:a,bottomLeft:a}}var u=t.styles.getClass(pi);return u&&u.update({nodeAttributes:s}),t.modules.graphics.export(r,o,e.filter||km,e)}function ey(t){return{download:!0,filter:"visible",filename:"graph."+t,clip:!1,margin:10,width:void 0,height:void 0,background:null,badges:!0,legend:void 0,texts:!0,images:!0,textWatermark:{content:"",fontFamily:"Arial",fontSize:48,fontStyle:void 0,fontColor:"red",repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageWatermark:{url:void 0,width:void 0,height:void 0,repeat:!1,angle:0,alpha:.65,space:50,x:void 0,y:void 0},imageCrossOrigin:void 0}}var iy={png:ey("png"),jpg:ey("jpg"),tiff:ey("tiff"),gif:ey("gif")};function ry(e){var i=e.canvas,r=e.parameters;return r.textWatermark.content&&gy(i,r.textWatermark,dy,hy),r.imageWatermark.url?Dt(r.imageWatermark.url).then(function(t){return t&&(r.imageWatermark.content=t,gy(i,r.imageWatermark,fy,cy)),e}):e}function ny(t){var e=t.ogma,i=t.canvas,r=t.parameters,n=e.modules.legend,o=null;return void 0===r.legend&&(o=!!n.enabled()&&n.getCurrentOptions()),!0===r.legend&&(o={}),o&&n.exportOnCanvas(i,o),t}function oy(r){var t=r.ogma,n=r.view;return t.modules.geo.isEnabled()?t.modules.geo.exportBackground(n).then(function(t){var e=uy(r.view),i=e.getContext("2d");return i.drawImage(t,(n.width-t.width)/2,(n.height-t.height)/2),i.drawImage(r.canvas,0,0),r.canvas=e,r}):r}function sy(e){var i=e.ogma,r=e.parameters,t=e.canvas,n=e.view,o=t.getContext("2d");return ty(i,r,n,"canvas",!r.images).then(function(t){try{return t.getContext("2d").getImageData(0,0,1,1),o.drawImage(t,0,0),e}catch(t){return Ci(t),ty(i,r,n,"canvas",!0).then(function(t){return o.drawImage(t,0,0),e})}})}function ay(t){var e=t.canvas,i=t.parameters,r=t.type,n=e.toDataURL("image/"+r);return i.download&&It(n,i.filename,"dataURL"),n}function uy(t){var e=t.width,i=t.height,r=bn();return r.width=e,r.height=i,r}function ly(t,e,i){var r=J(e,iy[i]);null===r.background&&(r.background=t.modules.graphics.getTransparentBackgroundColor());var n=$m(t,r),o={ogma:t,parameters:r,canvas:uy(n),view:n,type:i};return Promise.resolve(o).then(oy).then(sy).then(ry).then(ny).then(ay)}function dy(t,e,i,r){t.textAlign="center",t.textBaseline="middle",t.fillText(e,i,r)}function hy(t,e,i){return{width:t.measureText(e).width,height:i}}function cy(t,e,i,r,n){return{width:void 0===r?e.width:r,height:void 0===n?e.height:n}}function fy(t,e,i,r,n,o){t.drawImage(e,i-n/2,r-o/2,n,o)}function gy(t,e,i,r){if(e){if("object"!=typeof e)e={content:e};else if(!e.content)return;var n=e.fontFamily,o=e.fontSize,s=e.fontStyle,a=e.fontColor,u=e.repeat,l=e.angle,d=e.alpha,h=e.space,c=e.content,f=t.getContext("2d"),g=t.width,p=t.height,_=void 0===e.x?g/2:e.x,v=void 0===e.y?p/2:e.y,m=e.height,y=e.width;l=l/180*Math.PI,An(f,n,o,s),f.fillStyle=a,f.globalAlpha=d;var x=r(f,c,o,y,m);if(u){var b=x.width+h,E=x.height+h,A=Math.sqrt(g*g+p*p);f.save(),f.translate(0,0),f.rotate(l);for(var S=0;S<A;S+=b)for(var w=0;w<A;w+=E)i(f,c,S,w,x.width,x.height),0!==w&&i(f,c,S,-w,x.width,x.height);f.restore()}else f.save(),f.translate(_,v),f.rotate(l),i(f,c,0,0,x.width,x.height),f.restore()}}function py(e){return{svg:function(t){return void 0===t&&(t={}),function(e,t){var n=J(t,_y),i=n.background,r=n.filename,o=n.download,s=e.modules.graphics;null===i&&(n.background=s.getTransparentBackgroundColor());var a=$m(e,n);return ty(e,n,a,"svg",!n.images).then(function(t){return t.removeAttribute("pointer-events"),t.setAttribute("version","1.1"),t.setAttributeNS(kt,"xmlns",Ot),t.setAttributeNS(kt,"xmlns:xlink",Ft),t}).then(function(t){return function(t,e,i){for(var r=e.childNodes[2],n=r.childNodes,o={},s=i.prefix,a=0;a<n.length;a++){var u=(E=n[a]).getAttribute(Fa);null!=u&&(o[u]=o[u]||[],o[u].push(E))}var l=Object.keys(o),d=t.modules.graph,h=d.getNodeAttribute("id"),c=d.getEdgeAttribute("id"),f=Rt("g",{class:s+"-edges"}),g=Rt("g",{class:s+"-nodes"});for(a=0;a<l.length;a++){var p=l[a],_="n"===p.charAt(0),v=parseInt(p.substring(1)),m=o[p],y=Ht((_?h:c).get(v).toString()),x=Rt("g");x.setAttribute("data-"+(_?"node":"edge")+"-id",y),x.setAttribute("class",s+"-"+(_?"node":"edge"));for(var b=0;b<m.length;b++){var E=m[b];x.appendChild(E),E.removeAttribute(Fa)}(_?g:f).appendChild(x)}return r.appendChild(f),r.appendChild(g),e}(e,t,n)}).then(function(t){return e=n,i=function(t){for(var e=[].concat(Array.prototype.slice.call(t.getElementsByTagName("text")||[]),Array.prototype.slice.call(t.getElementsByTagName("tspan")||[])),i=[],r={},n=0;n<e.length;n++){var o=e[n].getAttribute("font-family");if("string"==typeof o)for(var s=o.split(","),a=0;a<s.length;a++){var u=s[a].replace(/['"]/g,"");""===u||r[u]||(r[u]=!0,i.push(u))}}return{list:i,map:r}}(r=t).map,vo().then(function(t){return t.filter(function(t){return i[t.name]})}).then(function(t){return mo(t,!!e.embedFonts)}).then(function(t){if(0!==t.length){for(var e=Rt("style"),i=0;i<t.length;i++)e.appendChild(Pt(t[i]));r.childNodes[0].appendChild(e)}return r});var r,e,i}).then(function(t){var e='<?xml version="1.0" encoding="utf-8"?>'+$o(t);return o&&It(e,r,"text/xml"),e})}(e,t)}}}var _y={download:!0,filename:"graph.svg",width:void 0,height:void 0,background:null,texts:!0,images:!0,badges:!0,embedFonts:!1,clip:!1,margin:10,prefix:"ogma"};function vy(p){return{xlsx:function(t){"string"==typeof t&&(t={what:t});var e=J(t,my),i=e.what,r=e.nodes,n=e.edges,o=e.tab,s=void 0===o?{nodes:function(){return"nodes"},edges:function(){return"edges"}}:o,a=e.download,u=e.filename,l=e.dataProperties,d=e.filter,h=e.nodeData,c=e.edgeData;s.nodes||(s.nodes=function(){return"nodes"}),s.edges||(s.edges=function(){return"edges"});var f=Pm(p.modules.graph,p.modules.individualAttributes,{styles:"none",nodes:r,edges:n,filter:d,nodeData:function(t){return t},edgeData:function(t){return t}}),g=function(t,e,i){var r=e.what,n=e.tabFunctions,o=e.tabContentFunctions,s=M("XLSX")||M("xlsx",{throwOnError:!0});if(!s)throw Error('The xlsx exports requires the "xlsx" peer dependency to be associated');var a=new xy;if(r){if("nodes"!==r&&"edges"!==r)throw new TypeError('Invalid argument: "what" is not "nodes" or "edges", was '+r);"nodes"===r&&(t.edges=[]),"edges"===r&&(t.nodes=[])}for(var u={},l=0,d=["nodes","edges"];l<d.length;l++)for(var h=d[l],c=Bm(t[h],h,n[h],o[h],i[h]),f=0,g=Object.keys(c);f<g.length;f++){var p=g[f];u[p]=E(u[p]||[],c[p])}for(var _=0,v=Object.keys(u);_<v.length;_++){p=v[_];a.SheetNames.push(p),a.Sheets[p]=yy(s,Um(u[p]))}return Mt([function(t){for(var e=new ArrayBuffer(t.length),i=new Uint8Array(e),r=0;r!==t.length;++r)i[r]=255&t.charCodeAt(r);return e}(s.write(a,{bookType:"xlsx",bookSST:!1,type:"binary"}))])}(f,{what:i,tabFunctions:s,tabContentFunctions:{nodes:h||function(t){return et(q(t||{}),l)},edges:c||function(t){return et(q(t||{}),l)}}},{nodes:p.modules.graph.getNodes(f.nodes.map(function(t){return t.id})),edges:p.modules.graph.getEdges(f.edges.map(function(t){return t.id}))});return a&&It(g,u,"blob"),Promise.resolve(g)}}}var my={what:void 0,dataProperties:void 0,filter:"visible",nodes:void 0,edges:void 0,download:!0,filename:"graph.xlsx",tab:void 0,nodeData:void 0,edgeData:void 0};function yy(t,e){for(var i,r={},n={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!==e.length;++o)for(var s=e[o],a=0;a!==s.length;++a){var value=s[a];n.s.r>o&&(n.s.r=o),n.s.c>a&&(n.s.c=a),n.e.r<o&&(n.e.r=o),n.e.c<a&&(n.e.c=a);var u={v:void 0===(i=value)?"":i instanceof Date?i.toISOString():""+i};r[t.utils.encode_cell({c:a,r:o})]=u}return n.s.c<1e7&&(r["!ref"]=t.utils.encode_range(n)),r}var xy=function(){this.SheetNames=[],this.Sheets={}};function by(t){return t.styles.createClass({name:pi,isBuiltin:!0}),I(I(I(I(I(I(I({},jm(t)),Hm(t)),Km(t)),(c=t,{json:function(t){void 0===t&&(t={});var e=J(t,Jm),i=e.nodeAttributes,r=e.edgeAttributes,n=e.nodeData,o=e.edgeData,s=e.filter,a=e.pretty,u=e.download,l=e.filename,d=Rm(c.modules.graph,{nodeAttributes:i,edgeAttributes:r,filter:s,nodeData:n,edgeData:o}),h=a?JSON.stringify(d,null," "):JSON.stringify(d);return u&&It(h,l,"text"),Promise.resolve(h)}})),(e=t,{png:function(t){return void 0===t&&(t={}),ly(e,t,"png")},jpg:function(t){return void 0===t&&(t={}),ly(e,t,"jpg")},tiff:function(t){return void 0===t&&(t={}),ly(e,t,"tiff")},gif:function(t){return void 0===t&&(t={}),ly(e,t,"gif")}})),py(t)),vy(t));var e,c}var Ey=(Ay.initNamespace=function(t){t.export=by(t)},Ay);function Ay(){}var Sy={configure:function(t){var e,i=void 0===t?{}:t,r=i.children,n=void 0===r?2:r,o=i.height,s=void 0===o?3:o;if(!("number"==typeof(e=n)&&isFinite(e)&&0<e&&e))throw new TypeError('Invalid argument: "children" is not a positive number, was '+n);if(!qu(s))throw new TypeError('Invalid argument: "height" is not a positive number, was '+s);return{children:n,height:s}},generate:function(t){var e=t.children,i=t.height;i+=1;for(var r=Math.pow(e,i),n=[],o=[],s=1,a=0,u=0,l=0;l<i;++l){for(var d=r/(s+1)/1.5,h=0;h<s;++h){var c=a++;if(n.push({id:c,attributes:{x:(h+1)*d*10,y:20*l}}),l!==i-1)for(var f=0;f<e;++f)o.push({id:u,source:c,target:c*e+f+1}),u+=1}s*=e}return{nodes:n,edges:o}}};var wy={configure:function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?40:i,n=e.m0,o=void 0===n?5:n,s=e.m,a=void 0===s?1:s,u=e.scale,l=void 0===u?100:u;if(!Wu(r)||r<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+r);if(!Wu(o)||r<=o)throw new TypeError("Invalid argument: options.m0 is not a number < "+r+", was "+o);if(!Wu(o)||o<=a)throw new TypeError("Invalid argument: options.m is not a number <= "+o+", was "+a);if(!Wu(l)||l<0)throw new TypeError("Invalid argument: options.scale is not a number or is less than 0");return{nodes:r,m0:o,m:a,scale:l}},generate:function(t){for(var e=t.scale,i=t.nodes,r=t.m0,n=t.m,o={nodes:[],edges:[]},s={},a=[],u=e/10,l=0,d=0;d<r;d++)o.nodes.push({id:d,attributes:{x:Math.random()*u,y:Math.random()*u}}),a[d]=0;for(d=0;d<r;d++)for(var h=d+1;h<r;h++){s[(v={id:l++,source:d,target:h}).source+"-"+v.target]=v,o.edges.push(v),a[d]++,a[h]++}for(d=r;d<i;d++){o.nodes.push({id:d,attributes:{x:Math.random()*e,y:Math.random()*e}});var c=a[d]=0;for(h=0;h<d;h++)c+=a[h];for(var f=0,g=0;g<n;g++){var p=Math.random(),_=0;for(h=0;h<d;h++)if(!s[d+"-"+h]&&!s[h+"-"+d]&&p<=(_=1===d?1:_+a[h]/c+f/(d-g))){var v;f+=a[h]/c,s[(v={id:l++,source:d,target:h}).source+"-"+v.target]=v,o.edges.push(v),a[d]++,a[h]++;break}}}return o}};var Ty={configure:function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?20:i,n=e.edges,o=e.p,s=e.scale,a=void 0===s?100:s;if(!Wu(r)||r<3)throw new TypeError("Invalid argument: options.nodes is not a number >= 3, was "+r);if(void 0!==n&&void 0!==o)throw new TypeError("Invalid argument: choose between options.edges and options.p");return void 0===n&&void 0===o&&(o=.1),void 0===o&&(o=-1),void 0===n&&(n=-1),{nodes:r,p:o,edges:n,scale:a}},generate:function(t){var e={nodes:[],edges:[]},i=t.nodes,r=t.p,n=t.scale;if(0<=r)for(var o=0,s=0;s<i;s++){e.nodes.push({id:s,attributes:{x:Math.random()*n,y:Math.random()*n}});for(var a=0;a<s;a++)Math.random()<r&&e.edges.push({id:o++,source:s,target:a})}else{var u=[],l=t.edges;for(s=0;s<i;s++){e.nodes.push({id:s,attributes:{x:100*Math.random(),y:100*Math.random()}});for(a=s+1;a<i;a++)u.push({source:s,target:a})}for(o=u.length-1,s=0;s<l;s++){var d=u.splice(Math.floor(Math.random()*o),1)[0];d.id=s,e.edges.push(d),o--}}return e}},Cy=5,My=10,Iy=10,Ly=2.7,Ny=.2;function Oy(t){return Math.pow(Ly,t)*My}function ky(t){return Cy+Oy(t)/Iy}var Fy={configure:function(t){var e=t.depth,i=void 0===e?3:e,r=t.breadth,n=void 0===r?3:r,o=t.nbNodes;return void 0!==o?(n=5,i=Math.ceil(Math.log(o)/Math.log(5))):o=-1,{depth:i,breadth:n,nbNodes:o}},generate:function(t){var e=t.depth,i=t.breadth,r=t.nbNodes,n={id:0,attributes:{x:0,y:0,radius:ky(e+1)}},o={nodes:[n],edges:[]};return function t(e,i,r,n,o){if(0===r)return o;var distance=Oy(r);var s=ky(r);var a=s*Ny;var u=-Math.PI;var l=2*Math.PI/i;var d=n.attributes.x||0;var h=n.attributes.y||0;for(var c=0;c<i;++c){var f=Math.cos(u),g=Math.sin(u),p={id:o,attributes:{x:d+distance*f,y:h+distance*g,radius:s}},_={id:o,source:n.id,target:o,attributes:{width:a}};e.nodes.push(p),e.edges.push(_),o=t(e,i,r-1,p,o+1),u+=l}return o}(o,i,e,n,1),void 0!==r&&0<=r&&(o.nodes=o.nodes.slice(0,r),o.edges=o.edges.slice(0,Math.max(r-1,0))),o}};var Ry={configure:function(t){var e=void 0===t?{}:t,i=e.rows,r=void 0===i?4:i,n=e.columns,o=void 0===n?4:n,s=e.columnDistance,a=void 0===s?20:s,u=e.rowDistance,l=void 0===u?20:u,d=e.xmin,h=void 0===d?0:d,c=e.ymin;return{rows:r,columns:o,columnDistance:a,rowDistance:l,xmin:h,ymin:void 0===c?0:c}},generate:function(t){for(var e=t.rows,i=t.columns,r=t.columnDistance,n=t.rowDistance,o=t.xmin,s=t.ymin,a={nodes:[],edges:[]},u=0,l=0;l<e;++l)for(var d=0;d<i;++d){var h=l*i+d;a.nodes.push({id:h,attributes:{x:o+d*r,y:s+l*n}}),d!==i-1&&(a.edges.push({id:u,source:h,target:l*i+d+1}),u++),l!==e-1&&(a.edges.push({id:u,source:h,target:(l+1)*i+d}),u++)}return a}};var Py={configure:function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?10:i,n=e.edges,o=void 0===n?10:n,s=e.texts,a=void 0!==s&&s,u=e.scale;return{nodes:r,edges:o,texts:a,scale:void 0===u?100:u}},generate:function(t){for(var e=t.nodes,i=t.edges,r=t.texts,n=t.scale,o=[],s=[],a=0;a<e;a++)o.push({id:a,attributes:{x:Math.random()*n,y:Math.random()*n,text:r?"Node "+a:void 0}});for(a=0;a<i;a++)s.push({id:a,source:Math.random()*e|0,target:Math.random()*e|0,attributes:{text:r?"Edge "+a:void 0}});return{nodes:o,edges:s}}};var Dy={configure:function(t){var e=void 0===t?{}:t,i=e.nodes,r=void 0===i?50:i,n=e.width,o=void 0===n?100:n,s=e.height,a=void 0===s?100:s,u=e.x,l=void 0===u?0:u,d=e.y,h=void 0===d?0:d;if(!isFinite(r)||r<1)throw new RangeError("Tree generator: number of nodes must be a positive integer");return{nodes:r,width:o,height:a,x:l,y:h}},generate:function(t){var e=t.nodes,i=t.x,r=t.y,n=t.width,o=t.height,s=i-n/2,a=r-o/2;return{nodes:new Array(e).fill(0).map(function(t,e){return{id:e,attributes:{x:s+Math.random()*n,y:a+Math.random()*o}}}),edges:new Array(e-1).fill(0).map(function(t,e){return{id:e,source:Math.floor(Math.sqrt(e)),target:e+1}})}}};var zy={configure:function(t){var e=void 0===t?{}:t,i=e.length,r=void 0===i?5:i,n=e.scale;return{length:r,scale:void 0===n?100:n}},generate:function(t){var e=t.length,i=t.scale,r={nodes:[],edges:[]};if(e<=0)return r;r.nodes.push({id:0,attributes:{x:Math.random()*i,y:Math.random()*i}});for(var n=1;n<e;++n)r.nodes.push({id:n,attributes:{x:Math.random()*i,y:Math.random()*i}}),r.edges.push({id:n-1,source:n-1,target:n});return r}},By=(Uy.initNamespace=function(t){t.generate={balancedTree:function(t){return Promise.resolve(Sy.generate(Sy.configure(t)))},barabasiAlbert:function(t){return Promise.resolve(wy.generate(wy.configure(t)))},erdosRenyi:function(t){return Promise.resolve(Ty.generate(Ty.configure(t)))},flower:function(t){return Promise.resolve(Fy.generate(Fy.configure(t)))},grid:function(t){return Promise.resolve(Ry.generate(Ry.configure(t)))},path:function(t){return Promise.resolve(zy.generate(zy.configure(t)))},random:function(t){return Promise.resolve(Py.generate(Py.configure(t)))},randomTree:function(t){return Promise.resolve(Dy.generate(Dy.configure(t)))}}},Uy);function Uy(){}var Vy=(jy.initNamespace=function(t){var r;t.geo=(r=t,{enable:function(t){return r.modules.geo.enable(t)},disable:function(t){return r.modules.geo.disable(t)},setOptions:function(t){return r.modules.geo.setOptions(t)},getOptions:function(){return r.modules.geo.getOptions()},getMap:function(){return r.modules.geo.getMap()},enabled:function(){return r.modules.geo.isEnabled()},getCenter:function(){return r.modules.geo.getCenter()},getView:function(){return r.modules.geo.getView()},getZoom:function(){return r.modules.geo.getZoom()},setZoom:function(t){return r.modules.geo.setZoom(t)},setView:function(t,e,i){return r.modules.geo.setView(t,e,i)},setCenter:function(t,e){return r.modules.geo.setCenter(t,e)},toggle:function(t){return r.modules.geo.toggle(t)},resetCoordinates:function(){return r.modules.geo.resetCoordinates()},updateCoordinates:function(){return r.modules.geo.updateCoordinates()},getUnprojectedCoordinates:function(t){return r.modules.geo.getUnprojectedCoordinates(r.getNodes(t))}})},jy);function jy(){}function Gy(t,e,i,r,n){var o;void 0===r&&(r={}),void 0===n&&(n=!1),Array.isArray(i)||i instanceof(e?mr:$i)||(i=[i]);var s=t.getElements(e,i);if(n||(s=s.dedupe()),!s.size)return Promise.resolve();e&&Gy(t,!1,s.getAdjacentEdges({filter:"all"}),r,!0);var a=r.virtual,u=void 0!==a&&a,l=s._indexes,d=t.storage.fetch(e),h=t.getCacheLists(e),c=d.getFlexArray("removed");if(Xe(d.getFlexArray("virtual").getMultiple(l))!==(u?l.length:0))throw new Error("Attempting to remove virtual elements; you should not do that");var f=((o={virtual:u})[e?"nodes":"edges"]=s,o);if(t.fireEvent(e?be.BEFORE_REMOVE_NODES:be.BEFORE_REMOVE_EDGES,f),h.visible.invalidList(),h.all.invalidList(),u||h.raw.invalidList(),t.setExcluded(s,!0),c.setMultiple(l,1),!e)for(var g=0;g<l.length;++g)t.topology.removeFromAdjacencyList(l[g]);return d.removeElements(l),t.setIndexFreeStep(1),t.fireEvent(e?be.REMOVE_NODES:be.REMOVE_EDGES,f),Promise.resolve()}var Hy=(Wy.prototype.addNodes=function(t,e){return br(this.modules.graph,!0,t,e)},Wy.prototype.addEdges=function(t,e){return br(this.modules.graph,!1,t,e)},Wy.prototype.addNode=function(t,e){return xr(this.modules.graph,!0,t,e)},Wy.prototype.addEdge=function(t,e){return xr(this.modules.graph,!1,t,e)},Wy.prototype.removeNodes=function(t,e){return Gy(this.modules.graph,!0,t,e)},Wy.prototype.removeEdges=function(t,e){return Gy(this.modules.graph,!1,t,e)},Wy.prototype.removeNode=function(t,e){return Gy(this.modules.graph,!0,[t],e)},Wy.prototype.removeEdge=function(t,e){return Gy(this.modules.graph,!1,[t],e)},Wy.prototype.getNodes=function(t){return this.modules.graph.getNodes(t)},Wy.prototype.getEdges=function(t){return this.modules.graph.getEdges(t)},Wy.prototype.getNode=function(t){return this.modules.graph.getNode(t)},Wy.prototype.getEdge=function(t){return this.modules.graph.getEdge(t)},Wy.prototype.clearGraph=function(){this.modules.graph.clear()},Wy.prototype.setGraph=function(t,e){return this.modules.graph.clear(),this.addGraph(t,e)},Wy.prototype.addGraph=function(t,e){return i=this.modules.graph,n=e,s=(r=t).nodes,a=void 0===s?[]:s,u=r.edges,l=void 0===u?[]:u,void 0===n&&(n={}),n.batchSize?br(i,!0,a,n).then(function(t){return o=t,br(i,!1,l,n)}).then(function(t){return{nodes:o,edges:t}}):Promise.resolve({nodes:Er(i,!0,a,n),edges:Er(i,!1,l,n)});var i,r,n,o,s,a,u,l},Wy.prototype.createNodeList=function(){return this.getNodes([])},Wy.prototype.createEdgeList=function(){return this.getEdges([])},Wy.prototype.getConnectedComponents=function(t){return void 0===t&&(t={}),this.modules.graph.getConnectedComponents(this.getNodes(t.filter),t)},Wy.prototype.getConnectedComponentByNode=function(t,e){var i=this.modules.graph.getNode(t);if(void 0===i)throw new Error("getComponentByNode: cannot find node "+t);return this.modules.graph.getConnectedComponentByNode(i,e)[0]},Wy);function Wy(){}var qy=(Xy.prototype.reloadFonts=function(){this.modules.graphics.reloadFonts()},Xy);function Xy(){}function Yy(t){return t.charCodeAt(0)}var Zy=Yy(" "),Ky=Yy("<"),Qy=Yy(">"),Jy=Yy('"'),$y=Yy("\n"),tx=Yy("\r"),ex=Yy("/"),ix=Yy("\\"),rx=Yy("a"),nx=Yy("z"),ox=Yy("A"),sx=Yy("Z"),ax=Yy("0"),ux=Yy("9"),lx=Yy(":"),dx=-1,hx=-2,cx=-3,fx=-4;function gx(t,e,i,r){var n=r.length;if(i-e===n){for(var o=0;o<n;++o)if(t[e+o]!==r[o])return;return 1}}function px(t,e,i,r){for(var n=t.length,o=0;o<n;++o)if(gx(e,i,r,t[o]))return o;return t.push(e.slice(i,r)),n}function _x(t,e,i){var r=mx(e,i),n=e[r];if(n===Qy||n===ex)return r;var o=r;r=yx(e,r);for(var s,a,u,l=(s=e,a=o,u=r,px(t.attributes,s,a,u));e[r]!==Jy;)++r;for(o=++r;(n=e[r])!==Jy;)n===ix&&++r,++r;return t.tokens.push(cx,l,o,r),r+1}function vx(t){return t===Zy||t===$y||t===tx}function mx(t,e){for(;vx(t[e]);)++e;return e}function yx(t,e){for(;i=t[e],rx<=i&&i<=nx||ox<=i&&i<=sx||i===lx||ax<=i&&i<=ux;)++e;var i;return e}function xx(t,e){var i=["return {","  id: undefined,","  attributes: {","    text: undefined,","    color: undefined,","    "+(t?"radius":"width")+": undefined",t?"  ,x: undefined":"",t?"  ,y: undefined":"","  },"];t||i.push("  source: undefined,","  target: undefined,");var r=Object.keys(e);r.length&&i.push("  data: {");for(var n=0;n<r.length;++n){var o=e[r[n]],s=o.title;i.push('  "'+s+'": '+(void 0!==o.default?JSON.stringify(o.default):void 0)+(n===r.length-1?"":","))}return r.length&&i.push("}"),i.push("};"),new Function(i.join("\n"))}function bx(t){return-1===t.indexOf("\\")?t:t=t.replace(/\\"/g,'"')}function Ex(t){if(-1===t.indexOf("<gexf"))throw new Error("not a GEXF file");var e=function(t){for(var e=new Int32Array(t.length),i=0,r=t.length;i<r;++i)e[i]=t.charCodeAt(i);return e}(t),i=function(t,e){for(var i,r,n={tags:[],attributes:[],tokens:[]},o=n.tokens,s=mx(t,e);s<t.length;){var a=t[s];if(a===Ky){if(t[s=mx(t,++s)]===ex)for(o.push(hx);t[++s]!==Qy;);else{s=yx(t,i=s);var u=px(n.tags,t,i,s);for(o.push(dx,u),a=t[s];a!==Qy&&a!==ex;)a=t[s=_x(n,t,s)];if(a===ex)for(o.push(hx);t[++s]!==Qy;);}s+=1}else{for(i=s;t[++s]!==Ky;);for(r=s-1;vx(t[r]);)--r;o.push(fx,i,r+1)}s=mx(t,s)}return n}(e,t.indexOf("<gexf ")),r={},n={};i.tags.forEach(function(t,e){var i=String.fromCharCode.apply(null,t);r[i]=e}),i.attributes.forEach(function(t,e){var i=String.fromCharCode.apply(null,t);n[i]=e});for(var o=r.attributes,s=r.attribute,a=r.node,u=r.edge,l=r.default,d=r["viz:position"],h=r["viz:size"],c=r["viz:color"],f=r.attvalue,g=n.class,p=n.id,_=n.type,v=n.title,m=n.label,y=n.source,x=n.target,b=n.x,E=n.y,A=n.r,S=n.g,w=n.b,T=n.a,C=n.value,M=n.for,I=n.weight,L={float:1,double:1,integer:2,boolean:3,string:4,"list-string":5},N=0,O=i.tokens,k=O.length,F=new Array(16),R=0,P=0,D=0,z=!0,B={},U={},V="",j="",G="",H=void 0,W={attributes:{}},q=0,X=0,Y=0,Z=1,K="",Q=void 0,J=!1,$=!0,tt=null,et=null,it=[],rt=[],nt=0,ot={};N<k;){var st=O[N];if(st===dx)P=R,R=O[N+1],F[D]=R,D+=1,R===a?(W=(tt=tt||xx(!0,B))(),$=!0,ot=B):R===u&&(W=(et=et||xx(!1,U))(),$=!1,ot=U),N+=2;else if(st===hx){if(V&&R===s){ot=z?B:U;var at=L[j];(value=H)&&(1===at?value=+value:2===at?value=0|+value:3===at?value="true"===value:5===at&&(value=value.split(" ").filter(function(t){return t}))),ot[V]={title:G||V,default:value,type:at},j=G=V="",H=void 0}else if(R===a&&4===D)J&&W.attributes&&(W.attributes.color="rgba("+q+", "+X+", "+Y+", "+Z+")",Y=X=q=0,J=!(Z=1)),W.id||(W.id=++nt),it.push(W);else if(R===u&&4===D)W.id||(W.id=++nt),rt.push(W);else if(R===f&&6===D&&K){var ut=($?B:U)[K];if(ut){if(void 0===Q)Q=ut.default;else(at=ut.type)&&(1===at?Q=+Q:2===at?Q=0|+Q:3===at?Q="true"===Q:5===at?Q=Q.split(" ").filter(function(t){return t}).map(function(t){return bx(t)}):"string"==typeof e&&(Q=bx(Q)));W.data[ot[K].title]=Q}K="",Q=null}R=P,P=F[--D-2],N+=1}else if(st===cx){var lt=O[N+1],value=t.substring(O[N+2],O[N+3]);if(R===o)lt===g&&(z="edge"!==value&&"edges"!==value);else if(R===s)lt===p?V=value:lt===_?j=value:lt===v&&(G=value);else if(R!==a&&R!==u||4!==D)if(R===d&&5===D){if(lt===b)W.attributes.x=parseFloat(value);else if(lt===E){var dt=parseFloat(value);W.attributes.y=0===dt?dt:-dt}}else R===c&&5===D?(J=!0,lt===A?q=parseInt(value):lt===S?X=parseInt(value):lt===w?Y=parseInt(value):lt===T&&(Z=parseFloat(value))):R===h&&5===D?lt===C&&($?W.attributes.radius=+value:W.attributes.width=+value):R===f&&6===D&&(lt===M||lt===p?K=value:lt===C&&(Q=value));else lt===p?W.id=value:lt===m?W.attributes.text=value:lt===y?W.source=value:lt===x?W.target=value:lt===I&&(W.attributes.width=+value);N+=4}else{if(st!==fx)throw new Error("at index "+N+": token "+st);value=t.substring(O[N+1],O[N+2]);R===l&&(H=value),N+=3}}return{nodes:it,edges:rt}}function Ax(t,e){for(var i=0,r=e;i<r.length;i++){var n=r[i];if(t[n])return Sx(t[n])}}function Sx(t){if("string"==typeof t||isFinite(t))return String(t);return String(t.id||t._id)}function wx(t){var e=[],i=[];return function e(i,r,n){if(i&&"object"==typeof i){if(Array.isArray(i))return i.forEach(function(t){return e(t,r,n)});if("vertex"===(a=i).type||"vertex"===a._type||a.inE||a.outE||a._inE||a._outE){var o={};i.properties&&Object.keys(i.properties).forEach(function(t){o[t]=i.properties[t][0].value});var t=Sx(i);for(var s in r.push({id:t,data:{id:i.id+"",categories:[i.label],properties:o}}),i)"properties"!==s&&e(i[s],r,n)}else{var a,u;if("edge"===(u=i).type||"edge"===u._type||u.inV||u.outV||u._outV||u._inV)for(var s in t=Sx(i),n.push({id:t,source:Ax(i,["inV","_inV"]),target:Ax(i,["outV","_outV"]),data:{id:t,type:i.label,properties:i.properties||{}}}),i)"properties"!==s&&e(i[s],r,n);else Object.keys(i).forEach(function(t){return e(i[t],r,n)})}}}("string"==typeof t?JSON.parse(t):t,e,i),{nodes:e,edges:i}}function Tx(t,e,i){i=i||e,e in t&&(t.attributes[i]=t[e])}function Cx(t,e){void 0===e&&(e=function(t){return t});for(var i=e(JSON.parse(t)),r=i.nodes||[],n=i.edges||[],o=0;o<r.length;o++){var s=r[o];s.attributes||(s.attributes={}),"string"==typeof s.size&&(s.size=+s.size),"string"==typeof s.x&&(s.x=+s.x),"string"==typeof s.y&&(s.y=+s.y),Tx(s,"x"),Tx(s,"y"),Tx(s,"size","radius"),Tx(s,"color"),Tx(s,"text")}for(o=0;o<n.length;o++){var a=n[o];a.attributes||(a.attributes={}),"string"==typeof a.size&&(a.size=+a.size),Tx(a,"size","width"),Tx(a,"color"),Tx(a,"text")}return{nodes:r,edges:n}}function Mx(t,e){for(var i=0,r=0;r<20;++r){var n=i+t[r]+e[r];i=+(10<=n),t[r]=n%10}}function Ix(){this._decimalPowerOfTwo=new Uint8Array(20),this._binaryNumber=new Uint8Array(64),this._decimalNumber=new Uint8Array(20)}var Lx=new(Ix.prototype.int64ToString=function(t){var e=t.low,i=t.high;if(0===e&&0===i)return"0";!function(t,e,i){for(var r=0;r<32;++r)i[r]=+!!(t&1<<r);for(r=0;r<32;++r)i[r+32]=+!!(e&1<<r)}(e,i,this._binaryNumber),this._decimalNumber.fill(0),this._decimalPowerOfTwo.fill(0);var r=(this._decimalPowerOfTwo[0]=1)===this._binaryNumber[63];r&&function(t){for(var e=0;e<64;++e)t[e]^=1;for(e=0;e<64&&!(t[e]^=1);++e);}(this._binaryNumber);for(var n=0;n<64;++n)this._binaryNumber[n]&&Mx(this._decimalNumber,this._decimalPowerOfTwo),Mx(this._decimalPowerOfTwo,this._decimalPowerOfTwo);var o=[],s=this._decimalNumber.length-1;for(r&&o.push("-");!this._decimalNumber[s];)--s;for(n=s;0<=n;--n)o.push(String(this._decimalNumber[n]));return o.join("")},Ix);function Nx(t){return Lx.int64ToString(t)}function Ox(t){return"object"==typeof t&&"high"in t&&"low"in t}var kx=function(t){return"start"in t&&"end"in t&&"type"in t},Fx=function(t){return"segments"in t};function Rx(e,t,i,r){var n,o,s;t&&(Array.isArray(t)?t.forEach(function(t){return Rx(e,t,i,r)}):Fx(t)?(n=e,o=i,s=r,t.segments.forEach(function(t){Rx(n,t.start,o,s),Rx(n,t.end,o,s),Rx(n,t.relationship,o,s)})):(function(t){if("object"!=typeof t||null===t)throw new Error("Ogma can only retrieve nodes and relationships from Neo4j. Please make sure that your Cypher query returns nodes and edges, not values.");for(var e,i=0,r=Object.keys(t.properties);i<r.length;i++){var n=r[i],o=t.properties[n];Ox(o)&&(t.properties[n]=Nx(o))}if(void 0!==t.identity&&(Ox(t.identity)&&(t.identity=Nx(t.identity)),"start"in(e=t)&&"end"in e)){var s=t.start.identity||t.start,a=t.end.identity||t.end;Ox(s)&&(t.start=Nx(s)),Ox(a)&&(t.end=Nx(a))}}(t),kx(t)?r.has(t.identity)||(r.add(t.identity),e.edges.push({id:t.identity,source:t.start,target:t.end,data:{neo4jType:t.type,neo4jProperties:t.properties}})):i.has(t.identity)||(i.add(t.identity),e.nodes.push({id:t.identity,attributes:{x:100*Math.random(),y:100*Math.random()},data:{neo4jLabels:t.labels,neo4jProperties:t.properties}}))))}function Px(t){return{gexf:function(t){return Promise.resolve(Ex(t))},gexfFromUrl:function(t){return Bt(t).then(function(t){return Ex(t)})},janus:function(t){return Promise.resolve(wx(t))},json:function(t,e){return Promise.resolve(Cx(t,e))},jsonFromUrl:function(t,e){return Bt(t).then(function(t){return Cx(t,e)})},neo4j:function(t){return Promise.resolve((i="string"==typeof(e=t)?JSON.parse(e):e,r={nodes:[],edges:[]},n=new Set,o=new Set,i.records.forEach(function(t){t._fields.forEach(function(t){Rx(r,t,n,o)})}),r));var e,i,r,n,o}}}var Dx=(zx.initNamespace=function(t){t.parse=Px()},zx.prototype.fetch=function(t){return Bt(t)},zx);function zx(){}var Bx=(Ux.initNamespace=function(t){var e;t.keyboard=(e=t,{isKeyPressed:function(t){return e.modules.keyboard.isPressed(t)},resetKeys:function(){e.modules.keyboard.resetKeys()}})},Ux);function Ux(){}var Vx={configure:function(t,e){var i=e.graph,r=e.data;if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');var n,o,s=I(I({},t),{centralNode:(n=i,(o=t.centralNode)instanceof _r?o:n.getNode(o))}),a=s.centralNode,u=s.nodes,l=i.getNode(a);if(void 0===l)throw new Error('concentric layout: "centralNode" parameter is not valid');var d=l._index,h=l.getPosition(),c=h.x,f=h.y,g=u.getAttribute("layoutable"),p=i.getNodes(u)._indexes,_=Array.from(p.filter(function(t,e){return g[e]}));-1===_.indexOf(d)&&_.push(d);var v=i.getNodeAttribute("radius").getMultiple(p),m=function(t,e,i,r){if(e)return"random"===e?"random":"radius"===e?r.slice():"degree"===e?i.getDegree():t.getProperty(i,e)}(r,s.sortBy,u,v),y=_.reduce(function(t,e,i){return t[e]=i,t},{}),x=_.map(function(t,e){return e}),b=new Set;t.edges.getExtremities()._indexes.forEach(function(t){b.add(t)});var E=_.map(function(t){return i.topology.getAdjacentElements(!0,new Uint32Array([t])).filter(function(t){return b.has(t)}).map(function(t){return y[t]})});return{sourceNodeIndex:_.indexOf(d),centerX:"number"==typeof s.centerX?s.centerX:c,centerY:"number"==typeof s.centerY?s.centerY:f,list:_,indexes:x,size:_.length,totalSize:_.length,attributes:{adjacentNodes:E,size:v},sortAttr:m,clockwise:void 0===s.clockwise||s.clockwise,circleHopRatio:s.circleHopRatio||5,allowOverlap:!!s.allowOverlap}},context:function(){return{dijkstra:function(s,a,u,t,e){var l=Math.pow(2,31)-1,d=new Int32Array(t),h=new Int32Array(t),c=new Int8Array(t);d.fill(l),h.fill(-1);for(var i=0;i<t;++i){var r=a[i];void 0!==r&&(d[r]=l,h[r]=-1)}for(var f=d[e]=0,n=function(){var t=l;f=-1;for(var e=0;e<u;++e){var i=a[e],r=d[i];!c[i]&&r<t&&(t=r,c[f=i]=1)}if(-1<f){var n=s[f],o=t+1;n.forEach(function(t){var e=d[t];o<e&&(d[t]=o,h[t]=f)})}};-1!==f;)n();return d},determinePropertyType:function(e,t,i){return t.some(function(t){return"number"!==e[t]})?"string":"number"}}},update:function(h,t){for(var e=h.attributes,i=h.indexes,r=h.size,n=h.sourceNodeIndex,c=h.centerX,f=h.centerY,o=h.sortAttr,s=e.adjacentNodes,g=e.size,p=new Array(h.totalSize),_=new Array(h.totalSize),a=t.dijkstra(s,i,h.size,h.totalSize,n),u=0,v={},l=0;l<r;l++){var d=g[i[l]];u<d&&(u=d)}var m=u*h.circleHopRatio,y=0,x=0,b=Math.PI/9;for(l=0;l<r;l++){var E=i[l],distance=a[E],A=v[distance];A||(A=[],v[distance]=A),A.push(E)}var S,w,T,C=(w=i,T=t,"random"===(S=o)?function(){return Math.random()-.5}:S?"number"===T.determinePropertyType(S,w,w.length)?function(t,e){return S[t]-S[e]}:function(t,e){return S[t]<S[e]?-1:1}:void 0),M="random"===o||o;return Object.keys(v).sort(function(t,e){return parseInt(t)-parseInt(e)}).forEach(function(t,e){var i=v[t],r=i.length,n=0,o=x,s=2*Math.PI/r;if(0!==e&&!h.allowOverlap){var a;2*Math.PI*y<(a=2*(n+=i.reduce(function(t,e){return t+g[e]},0))*Math.SQRT2)&&(y+=a/(2*Math.PI)-y)}M&&(i.sort(C),h.clockwise||i.reverse());for(var u=0;u<r;u++){var l=i[u];p[l]=Math.cos(o)*y+c,_[l]=Math.sin(o)*y+f;var d=g[l];o+=s*(h.allowOverlap?1:d/n*r)}y+=m,x+=b}),{x:p,y:_,indexes:h.list}},isRunning:function(){return!1},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}};function bellmanFord(t){var e=t.sources,i=t.targets,r=t.weights,n=t.source,o=t.target,s=t.undirected,a=void 0!==s&&s,u=t.indexes,l=t.N;if(!(l=u?u.length:l)||!isFinite(l)||0===l)throw new Error("Invalid number of nodes "+l);var d=new Float32Array(l),h=new Int32Array(l),c={},f=Number.POSITIVE_INFINITY;if(!r){r=[];for(var g=0;g<l;g++)r[g]=1}if(!u){u=new Uint32Array(l);for(g=0;g<l;g++)u[g]=g+1}for(g=0;g<l;g++)d[g]=f,h[g]=-1,c[u[g]]=g;d[c[n]]=0;var p=!1;for(g=1;g<=l;g++){for(var _=0;_<r.length;_++){var v=e[_],m=i[_],y=c[v],x=c[m];if(void 0!==y&&void 0!==x){var b=r[_],E=d[y]+b;d[y]!==f&&E<d[x]&&(d[x]=E,h[x]=v,p=!0),a&&(E=d[x]+b,d[x]!==f&&E<d[y]&&(d[y]=E,h[y]=m,p=!0))}}if(!p)break}if(p)for(g=0;g<r.length;g++){v=e[g],m=i[g],y=c[v],x=c[m];if(void 0!==y&&void 0!==x){b=r[g];if(d[y]+b<d[x])return null}}var A=null,S=null;if(void 0!==o){var w=c[o];if(void 0!==w&&d[w]!==f){A=[];for(g=o;-1!==g;g=h[c[g]])A.push(g);A=A.reverse(),S=d[w]}}return{distances:d,path:A,pathLength:S}}function johnson(t){var e=t.sources,i=t.targets,r=t.weights,n=t.indexes,o=t.adjacency,s=t.undirected,a=t.ignoreWeights,u=Number.POSITIVE_INFINITY,l=n?n.length:o.length;if(!n){n=new Uint32Array(l);for(var d=0;d<l;d++)n[d]=d+1}var h=new Array(l),c={};for(d=0;d<l;d++){h[d]=new Float32Array(l);for(var f=0;f<l;f++)h[d][f]=d===f?0:u;c[n[d]]=d}var g=l,p=r.length;e=e.slice(),i=i.slice(),r=r.slice();for(d=0;d<l;d++)e[p+d]=g,i[p+d]=n[d],r[p+d]=0,a&&(r[d]=1);var _=bellmanFord({sources:e,targets:i,weights:r,undirected:s,N:l+1,source:g});if(null===_)throw new Error("Graph has negative weight loops");var v=_.distances;for(d=0;d<r.length;d++){var m=c[e[d]],y=c[i[d]];void 0!==m&&void 0!==y&&(r[d]=r[d]+v[m]-v[y])}e=e.slice(0,p),i=i.slice(0,p),r=r.slice(0,p);for(d=0;d<l;d++){var x=dijkstra(o,n[d],void 0,n,c,!!a).distances;for(f=0;f<l;f++)h[d][f]=d===f?0:x[f]}return h}function removeRadialOverlap(t){var i=t.X,r=t.Y,e=t.sizes,n=t.indexes,o=t.R,s=t.center,a=t.gap,u=void 0===a?0:a,l=t.epsilon,d=void 0===l?.001:l,h=t.maxLoops,c=void 0===h?5:h,f=t.inPlace,g=void 0===f||f,p=n.length,_=s[0],v=s[1],m=p;g||(i=i.slice(),r=r.slice());for(var y=circleCircleIntersection,x=circleSortCompare,b=n.slice().sort(function(t,e){return x(i[t],r[t],i[e],r[e],_,v)}),E=b[p-1],A=i[E],S=r[E],w=!1,T=0;T<m-1;T++){var C=T%p,M=(T+1)%p;-1===T&&(C=p-1,M=0),C=b[C],M=b[M];var I=i[C],L=r[C],N=i[M],O=r[M],k=e[C]+e[M]+u,F=x(I,L,N,O,_,v);if(-1===F&&w&&(F=1),!(o<k)){if(1===F||k-distance(I,L,N,O)>d){var R=y(_,v,o,I,L,k);if(R){var P=R[0];w=_<N&&P[0]<_,N=i[M]=P[0],O=r[M]=P[1]}}else w=!1;if(T%p==p-2){var D=b[p-1],z=b[0];if(r[D]>v&&r[z]>v&&i[D]-e[D]<i[z]+e[D]){var B=0;for(m=Math.min(p*c,m+p);r[b[D]]>v&&r[b[0]]>v&&i[b[D]]<i[b[0]]&&++B<p;){(X=b.pop())&&b.unshift(X)}}}}}var U=A-_,V=S-v,j=i[E]-_,G=r[E]-v,H=U==j?0:Math.abs(Math.acos((U*j+V*G)/(Math.sqrt(U*U+V*V)*Math.sqrt(j*j+G*G))));if(0!==H){var W=Math.sin(-H),q=Math.cos(-H),X=void 0;for(T=0;T<p;T++){X=b[T];B=i[X]-_;var Y=r[X]-v;i[X]=B*q-Y*W+_,r[X]=B*W+Y*q+v}}return{X:i,Y:r}}function jx(t,e,i,r,n,o){var s=Object.create(null),a=i[t],u=a,l=0,d=a;for(var h in e){for(var c=e[h],f=0,g=0,p=0,_=c.length;p<_;p++){var v=i[c[p]];g=Math.max(g,v),f+=2*v+r}var m=f/(2*Math.PI)+g,y=g+u,x=o?l+Math.max(o,y):l*n;l=Math.max(l,m,d,x),s[h]=l,u=g}return s[0]=0,s[Number.POSITIVE_INFINITY]=l,s}function weightedStress(t,e,i,r,n,o){for(var s=0,a=0;a<r;a++)for(var u=0;u<r;u++){var l=o[a],d=o[u];if(l!==d){var h=t[l][d]*n,c=1/(h*h);if(c){var f=e[l]-e[d],g=i[l]-i[d];s+=c*Math.pow(h-Math.sqrt(f*f+g*g),2)}}}return s}function distanceStress(t,e,i,r,n,o,s){var a=0;if(-1===n)return 0;for(var u=0;u<r;u++)for(var l=0;l<r;l++){var d=s[u],h=s[l];if(d!==h&&(d===n||h===n)){var c=t[d][h]*o,f=1/(c*c);if(f){var g=e[d]-e[h],p=i[d]-i[h];a+=f*Math.pow(c-Math.sqrt(g*g+p*p),2)}}}return a}function constrainedStress(t,e,i,r,n,o,s,a){s=s||0;for(var weightedStress=0,distanceStress=0,u=0;u<r;u++)for(var l=0;l<r;l++){var d=a[u],h=a[l];if(d!==h){var c=t[d][h]*o,f=1/(c*c);if(f){var g=e[d]-e[h],p=i[d]-i[h],_=f*Math.pow(c-Math.sqrt(g*g+p*p),2);weightedStress+=_,d!==n&&h!==n||(distanceStress+=_)}}}return(1-s)*weightedStress+s*distanceStress}function stressMinimizationStep(t,e,i,r,n,o,s,a,u){s=s||0;var l=e,d=i;-1===(n=void 0===n?-1:n)&&(s=0);for(var h=e[n],c=i[n],f=0;f<r;f++){var g=a[f],p=u(t[n][f]),_=s/(p*p);if(0!==p){for(var v=0,m=0,y=0,x=e[g],b=i[g],E=0;E<r;E++){var A=a[E];if(A!==g){var S=t[g][A]*o,w=1/(S*S),T=e[A],C=i[A];if(0!=w){var M=(O=(L=x-T)*L+(N=b-C)*N)<1e-6?0:1/Math.sqrt(O);m+=(1-s)*w*(T+S*(x-T)*M),y+=(1-s)*w*(C+S*(b-C)*M)}v+=w}}var I=(1-s)*v+_;if(0!=I){var L,N,O;O=(O=(L=x-h)*L+(N=b-c)*N)<1e-6?0:1/Math.sqrt(O);var k=0===p?0:p*O*_;l[g]=(m+k*e[g])/I,d[g]=(y+k*i[g])/I}}}return{x:l,y:d}}function Gx(t,e){return t-e}var Hx={imports:{minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,distance:distance,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,removeRadialOverlap:removeRadialOverlap,quadraticInOut:fl,calculateRadii:jx},configure:function(t,e){var i=e.graph,r=t.nodes,n=r.size;function o(t,e){return null!=t&&isFinite(t)?t:e}if(void 0===t.centralNode)throw new Error('radial layout: missing parameter "centralNode"');var s=i.getNode(t.centralNode);if(void 0===s)throw new Error('radial layout: parameter "centralNode" is not valid');t.radiusRatio=o(t.radiusRatio,Math.SQRT2),t.radiusDelta=o(t.radiusDelta,0),t.nodeGap=o(t.nodeGap,10),t.repulsion=n*o(t.repulsion,1);var a=s.getPosition(),u=o(t.centerX,a.x),l=o(t.centerY,a.y),d=s._index;r.includes(s)||(r=r.concat(s.toList()));var h=r._indexes,c=r.getAttribute("layoutable");(h=h.filter(function(t,e){return c[e]||t===d})).sort(Gx);var f=h.length,g=function(t,e,i){for(var r=t.slice().sort(Gx),n=[],o=0,s=e.length;o<s;o++){for(var a=[],u=e[o],l=!1,d=0,h=u.length;d<h;d++){var c=u[d];-1!==F(r,c)&&(c===i&&(l=!0),a.push(c))}0!==a.length&&n[l?"unshift":"push"](a.sort(Gx))}return n}(h,i.getConnectedComponents(r,{internalIndexes:!0}),d),p=i.degrees(h),_=new Float32Array(i.getNodeAttribute("x").getMultiple(h)),v=new Float32Array(i.getNodeAttribute("y").getMultiple(h)),m=i.getNodeAttribute("radius").getMultiple(h),y=i.getEdges()._indexes,x=i.getEdgeAttribute("source").getMultiple(y),b=i.getEdgeAttribute("target").getMultiple(y),E=i.getAdjacencyList({internalIndexes:!0,weight:1,indexes:h});return{centerIndex:d,centerIndexPos:0,cx:u,cy:l,D:null,indexes:h,components:g,normIndexes:null,radii:null,rings:null,x:_,y:v,degree:p,size:f,attributes:{size:m,adjacency:E,weights:b.map(function(){return 1}),sources:x,targets:b},sortAttr:null,allowOverlap:!!t.allowOverlap,nodeGap:t.nodeGap,radiusRatio:t.radiusRatio,radiusDelta:t.radiusDelta,repulsion:t.repulsion,randomize:!("randomize"in t)||!!t.randomize,renderSteps:!!t.renderSteps,epsilon:o(t.epsilon,.001),maxSteps:o(t.maxIterations,100),iterationsPerRender:o(t.iterationsPerRender,20),step:-1,stress:Number.POSITIVE_INFINITY,prevStress:0,converged:!1,overlapRemoved:!1,done:!1}},context:function(){return{data:null,gridPlacement:function(t,e,i){void 0===i&&(i=8);for(var r=t.length,n=new Float32Array(r),o=new Float32Array(r),s=0,a=0,u=t.length;a<u;a++){var l=e[t[a]];s<l&&(s=l)}var d=s*i,h=Math.ceil(Math.sqrt(r)),c=Math.ceil(r/h),f=-Math.floor((c-1)*d/2),g=-Math.floor((h-1)*d/2);for(a=0;a<h;a++)for(var p=0;p<c;p++)n[a*c+p]=f+p*d,o[a*c+p]=g+a*d;return{x:n,y:o}},connectComponents:function(s,a,u,l,d,h){var c;function f(t,value){var e=new Uint32Array(t.length+1);return e.set(t),e[t.length]=value,e}for(var t=function(t){var e=s[t],r=0,n=0;e.forEach(function(t,e){var i=d.get(t);null!=i&&r<i&&(n=e,r=i)}),c=e[n];var i=a[h.get(c)];i.weights=i.weights||[],i.nodes=f(i.nodes,u),i.weights.push(l);var o=a[h.get(u)];o.weights=o.weights||[],o.nodes=f(o.nodes,c),o.weights.push(l)},e=1;e<s.length;e++)t(e)},correctSubgraphsDistances:function(t,e,r,n,i){for(var o=Array.prototype.reduce.call(t[r],function(t,e,i){return i!==r&&e<n&&t<e&&(t=e),t},0),s=n-o-1,a=1;a<e.length;a++)for(var u=e[a],l=0,d=u.length;l<d;l++){var h=i.get(u[l]);null!=h&&(t[r][h]-=s,t[h][r]-=s)}},initialize:function(r,n){(r.data=n).step=0;var o=new Map,s=new Map;n.normIndexes=n.indexes.reduce(function(t,e,i){return t[i]=i,o.set(e,i),s.set(e,n.degree[i]),r.data&&e===n.centerIndex&&(r.data.centerIndexPos=i),t},new Uint32Array(n.indexes.length));var t=n.centerIndexPos,e=n.components[0].length;r.connectComponents(n.components,n.attributes.adjacency,n.centerIndex,e,s,o);var i=johnson({sources:n.attributes.sources,targets:n.attributes.targets,weights:n.attributes.weights,indexes:n.indexes,adjacency:n.attributes.adjacency,undirected:!0});r.correctSubgraphsDistances(i,n.components,t,e,o);for(var a=(n.D=i)[t],u=Object.create(null),l=0,d=n.normIndexes.length;l<d;l++)if(l!==t){var h=a[l];u[h]=u[h]||[],u[h].push(n.normIndexes[l])}n.rings=u,n.radii=jx(t,n.rings,n.attributes.size,n.nodeGap,n.radiusRatio,n.radiusDelta)},removeOverlaps:function(t,e){if(t.data){var i=t.data.centerIndexPos,r=e.attributes.size,n=e.rings,o=e.x[i],s=e.y[i];for(var a in n){var u=n[a],l=distance(o,s,e.x[u[0]],e.y[u[0]]);removeRadialOverlap({X:e.x,Y:e.y,sizes:r,indexes:u,center:[o,s],R:l,gap:e.nodeGap,inPlace:!0})}}}}},update:function(e,t){var i,r=(e=e||t.data).indexes,n=e.centerIndex;e.x=e.x||new Float32Array(e.size),e.y=e.y||new Float32Array(e.size),-1===e.step?t.initialize(t,e):e.step++;function o(t){return e.radii&&e.radii[t]||1}var s=e.repulsion;if(0===e.step)e.randomize&&(i=t.gridPlacement(e.indexes,e.attributes.size),e.x=i.x,e.y=i.y);else if(!e.converged)for(var a=e.maxSteps,u=e.iterationsPerRender,l=e.step,d=Math.min(l+u,a+1),h=e.D,c=e.x,f=e.y,g=e.size,p=e.centerIndexPos,_=e.normIndexes;l<=d||!e.converged;){var v=fl(Math.min(l,a)/a);e.step=l++,i=stressMinimizationStep(h,c,f,g,p,s,v,_,o),e.x=i.x,e.y=i.y,e.prevStress=e.stress,e.stress=constrainedStress(h,c,f,g,p,s,v,_),e.converged=e.converged||Math.abs(e.stress-e.prevStress)<=e.epsilon}if(e.converged)if(e.overlapRemoved||e.allowOverlap){e.done=!0;var m=e.rings||{};e.rings=Object.keys(m).reduce(function(t,e){return t[e]=m[e].map(function(t){return r[t]}),t},{})}else t.removeOverlaps(t,e,n),e.overlapRemoved=!0;return e},isRunning:function(t){var e=t.data;return!!e&&(!e.converged||!e.allowOverlap&&!e.done)},onSync:function(t){if(t.renderSteps||t.done)return Wx(t)},onEnd:function(t,e){return Wx(t)}};function Wx(t){for(var e=t.x,i=t.y,r=t.indexes.length,n=e[t.centerIndexPos]-t.cx,o=i[t.centerIndexPos]-t.cy,s=0;s<r;s++)e[s]-=n,i[s]-=o;return{indexes:t.indexes,x:e,y:i}}
/**
  * @preserve
  * @linkurious/force-layout@0.3.1
  * Ogma general-purpose force-directed layout
  */
function qx(){return function(){var e=function(t){var r,e=(r=4022871197,function(t){t=t.toString();for(var e=0;e<t.length;e++){var i=.02519603282416938*(r+=t.charCodeAt(e));i-=r=i>>>0,r=(i*=r)>>>0,r+=4294967296*(i-=r)}return 2.3283064365386963e-10*(r>>>0)});this.c=1,this.s0=e(" "),this.s1=e(" "),this.s2=e(" "),this.s0-=e(String(t)),this.s0<0&&(this.s0+=1),this.s1-=e(String(t)),this.s1<0&&(this.s1+=1),this.s2-=e(t),this.s2<0&&(this.s2+=1),e=null};function i(t){return new e(t.toString()).next()}e.prototype.next=function(){var e=this;return function(){var t=2091639*e.s0+2.3283064365386963e-10*e.c;return e.s0=e.s1,e.s1=e.s2,e.s2=t-(e.c=0|t)}},e.prototype.nextDouble=function(){var t=this.next();return function(){return t()+11102230246251565e-32*(2097152*t()|0)}},e.prototype.nextInt32=function(){var t=this.next();return function(){return 4294967296*t()|0}};var st=i(42);function f(t){st=i(t)}function tt(){return 1e-6*(st()-.5)}var d=function(t){return t.x},h=function(t){return t.y},c=function(t){return t.r};function et(t,e,i,r){void 0===e&&(e=d),void 0===i&&(i=h),void 0===r&&(r=c);for(var n,o=function(t){for(var e=t.length-1;0<=e;e--){var i=Math.floor(Math.random()*(e+1));i=Math.max(Math.min(i,e),0);var r=t[e];t[e]=t[i],t[i]=r}return t}(t.slice()),s=o.length,a=[],u=0;u<s;){var l=o[u];n&&p(n,e(l),i(l),r(l))?u++:(n=_(a=g(a,l,e,i,r),e,i,r),u=0)}return n}function g(t,e,i,r,n){var o=i(e),s=r(e),a=n(e),u={x:o,y:s,r:a};if(w(u,t,i,r,n))return[e];for(var l=0;l<t.length;++l){var d=t[l],h=i(d),c=r(d),f=n(d);if(!S(u,h,c,f)&&w(T(h,c,f,o,s,a),t,i,r,n))return[t[l],e]}for(var g=0;g<t.length-1;g++)for(var p=g+1;p<t.length;p++){var _=t[g],v=t[p],m=i(_),y=r(_),x=n(_),b=i(v),E=r(v),A=n(v);if(!S(T(m,y,x,b,E,A),o,s,a)&&!S(T(m,y,x,o,s,a),b,E,A)&&!S(T(b,E,A,o,s,a),m,y,x)&&w(C(m,y,x,b,E,A,o,s,a),t,i,r,n))return[t[g],t[p],e]}throw new Error}function S(t,e,i,r){var n=t.r-r,o=e-t.x,s=i-t.y;return 0<=n&&o*o+s*s<n*n}function p(t,e,i,r){var n=t.r-r+1e-6,o=e-t.x,s=i-t.y;return 0<n&&o*o+s*s<n*n}function w(t,e,i,r,n){for(var o=0;o<e.length;++o){var s=e[o];if(!p(t,i(s),r(s),n(s)))return}return 1}function _(t,e,i,r){return 1===t.length?(n=e(t[0]),o=i(t[0]),s=r(t[0]),{x:n,y:o,r:s}):2===t.length?T(e(t[0]),i(t[0]),r(t[0]),e(t[1]),i(t[1]),r(t[1])):C(e(t[0]),i(t[0]),r(t[0]),e(t[1]),i(t[1]),r(t[1]),e(t[2]),i(t[2]),r(t[2]));var n,o,s}function T(t,e,i,r,n,o){var s=r-t,a=n-e,u=o-i,l=Math.sqrt(s*s+a*a);return{x:(t+r+s/l*u)/2,y:(e+n+a/l*u)/2,r:(l+i+o)/2}}function C(t,e,i,r,n,o,s,a,u){var l=t-r,d=t-s,h=e-n,c=e-a,f=o-i,g=u-i,p=t*t+e*e-i*i,_=p-r*r-n*n+o*o,v=p-s*s-a*a+u*u,m=d*h-l*c,y=(h*v-c*_)/(2*m)-t,x=(c*f-h*g)/m,b=(d*_-l*v)/(2*m)-e,E=(l*g-d*f)/m,A=x*x+E*E-1,S=2*(i+y*x+b*E),w=y*y+b*b-i*i,T=-(A?(S+Math.sqrt(S*S-4*A*w))/(2*A):w/S);return{x:t+y+x*T,y:e+b+E*T,r:T}}for(var r=[0,1],n=[0,2],t=4;t<65535;t<<=2)for(var o=0,s=r.length;o<s;o++)r.push(r[o]|t),n.push((r[o]|t)<<1);function E(t,e){return(n[255&e]|r[255&t])+65536*(n[e>>8&255]|r[t>>8&255])+4294967296*(n[e>>16&255]|r[t>>16&255])}function A(t,e){var i=t^e,r=65535^i,n=65535^(t|e),o=t&(65535^e),s=i|r>>1,a=i>>1^i,u=n>>1^r&o>>1^n,l=i&n>>1^o>>1^o;a=(i=s)&(r=a)>>2^r&(i^r)>>2,u^=i&(n=u)>>2^r&(o=l)>>2,l^=r&n>>2^(i^r)&o>>2,a=(i=s=i&i>>2^r&r>>2)&(r=a)>>4^r&(i^r)>>4,u^=i&(n=u)>>4^r&(o=l)>>4,l^=r&n>>4^(i^r)&o>>4,u^=(i=s=i&i>>4^r&r>>4)&(n=u)>>8^(r=a)&(o=l)>>8;var d=t^e,h=(r=(l^=r&n>>8^(i^r)&o>>8)^l>>1)|65535^(d|(i=u^u>>1));return((h=1431655765&((h=858993459&((h=252645135&((h=16711935&(h|h<<8))|h<<4))|h<<2))|h<<1))<<1|(d=1431655765&((d=858993459&((d=252645135&((d=16711935&(d|d<<8))|d<<4))|d<<2))|d<<1)))>>>0}var M=new Uint32Array(1024);function I(t,e,i,r){this.left=null,this.right=null,this.data=null,this.code=t,this.data=e,this.left=i,this.right=r}var L,a,v=Math.clz32||function(t){for(var e=1<<31,i=0;i<31;i+=1){if(e&t)return i;e>>>=1}return 32};function N(t,e,i,r){var n=e[t[i]],o=e[t[r]];if(n===o)return i;for(var s,a,u=v(n^o),l=i,d=r-i;(s=l+(d=d+1>>1))<r&&(a=e[t[s]],u<v(n^a)&&(l=s)),1<d;);return l}(a=L=L||{})[a.HILBERT=1]="HILBERT",a[a.MORTON=0]="MORTON";var it,rt,nt,ot,at,ut,lt,dt,ht,m=function(t,e){void 0===e&&(e={});var i=e.getX,r=e.getY,n=e.bucketSize;void 0===n&&(n=0);var o=e.sfc;void 0===o&&(o=L.HILBERT),this.bucketSize=0,this._root=null;var s=t.length,a=new Uint32Array(s),u=1/0,l=1/0,d=-1/0,h=-1/0;this._x=i,this._y=r;var c=o===L.HILBERT?A:E;this._project=c;for(var f=new Uint32Array(s),g=0;g<s;g++){var p=t[g],_=i(p),v=r(p);_<u&&(u=_),v<l&&(l=v),d<_&&(d=_),h<v&&(h=v),f[g]=g}this._minX=u,this._minY=l,this._maxX=d,this._maxY=h;var m=65535/Math.max(d-u,1),y=65535/Math.max(h-l,1);this._hw=m,this._hh=y;for(var x=0;x<s;x++){var b=t[x];a[x]=c(m*(i(b)-u),y*(r(b)-l))}!function(t,e){for(var i=new Uint32Array(e.length),r=0;r<1024;r++)M[r]=0;for(var n=0;n<e.length;n++){var o=e[n];M[255&o]++,M[256+(o>>8&255)]++,M[512+(o>>16&255)]++,M[768+(o>>24&255)]++}for(var s=0;s<4;s++)for(var a=0,u=0,l=256*s,d=0;d<256;d++)a=M[d+l],M[d+l]=u,u+=a;for(var h=0;h<e.length;h++){var c=e[h];i[M[255&c]++]=h}for(var f=0;f<e.length;f++){var g=i[f],p=e[g];t[M[256+(p>>8&255)]++]=g}for(var _=0;_<e.length;_++){var v=t[_],m=e[v];i[M[512+(m>>16&255)]++]=v}for(var y=0;y<e.length;y++){var x=i[y],b=e[x];t[M[768+(b>>24&255)]++]=x}}(f,a),this._root=0===n?function(t,e,i,r,n){for(var o=new I(null,null,null,null),s=[o],a=[r,n];0!==s.length;){var u=a.pop(),l=a.pop(),d=s.pop();if(u-l==0)d.code=i[l],d.data=t[e[l]];else{var h=N(e,i,l,u);l<=(d.code=h)&&(d.left=new I(null,null,null,null),s.push(d.left),a.push(l,h)),h<u&&(d.right=new I(null,null,null,null),s.push(d.right),a.push(h+1,u))}}return o}(t,f,a,0,s-1):function(t,e,i,r,n,o){for(var s=new I(null,null,null,null),a=[s],u=[r,n];0!==a.length;){var l=u.pop(),d=u.pop(),h=a.pop();if(l-d<o){for(var c=new Array(l-d+1),f=d,g=0;f<=l;f++,g++)c[g]=t[e[f]];h.code=i[d],h.data=c}else{var p=N(e,i,d,l);d<=(h.code=p)&&(h.left=new I(null,null,null,null),a.push(h.left),u.push(d,p)),p<l&&(h.right=new I(null,null,null,null),a.push(h.right),u.push(p+1,l))}}return s}(t,f,a,0,s-1,n),this.bucketSize=n},u={root:{configurable:!0}};u.root.get=function(){return this._root},m.prototype.inOrder=function(t,e){for(var i=this._root,r=[],n=!1;!n;)if(i)r.push(i),i=i.left;else if(0!==r.length){if(i=r.pop(),t.call(e,i))break;i=i.right}else n=!0;return this},m.prototype.preOrder=function(t,e){for(var i=[this._root];0!==i.length;){var r=i.pop();t.call(e,r)||(r.right&&i.push(r.right),r.left&&i.push(r.left))}return this},m.prototype.postOrder=function(t,e){var i,r=[],n=this._root;do{for(;n;)n.right&&r.push(n.right),r.push(n),n=n.left;n=r.pop(),i=r.length-1,n=n.right&&r[i]===n.right?(r[i]=n).right:(t.call(e,n),null)}while(0!==r.length);return this},m.prototype.map=function(e,i){var r=[];return this.inOrder(function(t){r.push(e.call(i,t))}),r},m.prototype.height=function(){return function t(e){return e?1+Math.max(t(e.left),t(e.right)):0}(this._root)},m.prototype.toString=function(t){void 0===t&&(t=function(t){return t.code.toString()});var e=[];return function t(e,i,r,n,o){if(e){n(i+(r?"^-- ":"|-- ")+o(e)+"\n");var s=i+(r?"    ":"|   ");e.left&&t(e.left,s,!1,n,o),e.right&&t(e.right,s,!0,n,o)}}(this._root,"",!0,function(t){return e.push(t)},t),e.join("")},m.prototype.size=function(){var t=0;return this.preOrder(function(){t++}),t},m.prototype.destroy=function(){return this._root=null,this},Object.defineProperties(m.prototype,u);var ct=0;function y(t,e,i,r){var n=r.X,o=r.Y,s=r.R,a=r.bucketSize;ct=t,null===i&&(i=new m(e,{getX:nt,getY:ot,bucketSize:a})).postOrder(it);for(var u=e.length,l=0;l<u;l++)ut=e[l],lt=n[ut],dt=o[ut],ht=s[ut],i.preOrder(rt);return i}var b,k,F,R,P,D,z,B,U;function x(t,e,i,r){for(var n=i.sources,o=i.targets,s=i.X,a=i.Y,u=i.R,l=i.fx,d=i.fy,h=i.degrees,c=i.weights,f=r.edgeStrength,g=r.edgeLength,p=0;p<e.length;p++){var _=e[p],v=n[_],m=o[_],y=h[v]+1,x=h[m]+1,b=f*c[_],E=s[m]+l[m]-s[v]-l[v]||tt(),A=a[m]+d[m]-a[v]-d[v]||tt(),S=E*E+A*A,w=Math.sqrt(S),T=g+u[v]+u[m];if(!(w<=T)){var C=T-w,M=1/Math.min(y,x),I=Math.min(1,t*b*(C*C/S)*M);E*=I,A*=I;var L=x/(x+y);l[v]+=E*L,d[v]+=A*L,l[m]-=E*(1-L),d[m]-=A*(1-L)}}}function O(t,e,i,r,n){var o=r.X,s=r.Y,a=r.R,u=r.fx,l=r.fy,d=r.bucketSize;if(0===n.elasticity)return i;i||(i=new m(e,{getX:b,getY:k,bucketSize:d})).postOrder(R);for(var h=0;h<e.length;h++)D=e[h],z=o[D]+u[D],B=s[D]+l[D],U=a[D],i.preOrder(P);return i}y.initialize=function(t,e,i){var r=t.length,n=e.X,o=e.Y,s=e.R,a=e.degrees,u=e.layer,l=e.pinned,d=e.component,h=e.masses,c=e.nodeIds,f=i.scaling,g=i.defaultRadius,p=i.bucketSize;e.bucketSize=void 0===p?Math.floor(Math.log(r)):p;for(var _,x,b,E,A,S,v,m,y,w,T,C,M,I,L,N,O,k,F=1/0,R=1/0,P=-1/0,D=-1/0,z=Math.PI*(3-Math.sqrt(5)),B=0;B<t.length;B++){var U=t[B],V=U.x,j=U.y,G=U.r,H=U.mass;if(isNaN(V)||isNaN(j)){var W=5*Math.sqrt(B),q=B*z;V=W*Math.cos(q),j=W*Math.sin(q)}n[B]=V,o[B]=j,s[B]=G||g,l[B]=U.pinned?1:0,u[B]=U.layer,d[B]=U.component,h[B]=void 0===H?(1+a[B])*f:H,c[B]=B,V<F&&(F=V),j<R&&(R=j),P<V&&(P=V),D<j&&(D=j)}if(1<t.length&&(P-F==0||D-R==0))for(var X=(F+P)/2,Y=(R+D)/2,Z=0;Z<r;Z++)if(!l[Z]){var K=5*Math.sqrt(Z),Q=Z*z,J=X+K*Math.cos(Q),$=Y+K*Math.sin(Q);(n[Z]=J)<F&&(F=J),(o[Z]=$)<R&&(R=$),P<J&&(P=J),D<$&&(D=$)}nt=function(t){return n[t]},ot=function(t){return o[t]},at=function(t){return s[t]},x=(_=e).X,b=_.Y,E=_.R,A=_.masses,S=_.bucketSize,it=function(t){var e,i=0,r=0,n=0,o=0,s=t.data;if(null!==s)if(0!==S){var a=s,u=et(a,nt,ot,at);i=u.x,r=u.y,n=u.r;for(var l=0;l<a.length;l++)o+=A[a[l]]}else i=x[s],r=b[s],n=E[s],o=A[s];else if(t.left&&t.right){var d=t.left.cx,h=t.left.cy,c=t.right.cx,f=t.right.cy,g=t.left.r,p=t.right.r,_=c-d,v=f-h,m=p-g,y=Math.sqrt(_*_+v*v);i=(d+c+_/y*m)/2,r=(h+f+v/y*m)/2,n=(y+g+p)/2,o=t.left.mass+t.right.mass}else i=(e=t.left||t.right).cx,r=e.cy,n=e.r,o=e.mass;t.cx=i,t.cy=r,t.r=n,t.mass=o},m=i,y=(v=e).fx,w=v.fy,T=v.X,C=v.Y,M=v.R,I=v.masses,L=v.bucketSize,N=m.charge,O=m.theta,k=m.friction,rt=function(t){var e=0,i=0,r=0,n=lt-t.cx||tt(),o=dt-t.cy||tt(),s=n*n+o*o,a=ht+t.r,u=t.data;if(null!==u){if(u===ut)return!1;if(0!==L)for(var l=u,d=0;d<l.length;d++){var h=l[d];h!==ut&&(s=(n=lt-T[h]||tt())*n+(o=dt-C[h]||tt())*o,a=ht+M[h],s<1&&(s=Math.sqrt(+s)),e=N*I[h],i=ct*e/s,y[ut]+=n*i,w[ut]+=o*i)}else s<1&&(s=Math.sqrt(+s)),e=N*t.mass,s<a*a&&(s=k*a*a),i=ct*e/s,y[ut]+=n*i,w[ut]+=o*i}else if((r=a/O)*r<s)return s<1&&(s=Math.sqrt(+s)),e=N*t.mass,s<a*a&&(s=k*a*a),i=ct*e/s,y[ut]+=n*i,w[ut]+=o*i,!0}},x.initialize=function(t,e){for(var i=e.edgeIds,r=e.sources,n=e.targets,o=e.degrees,s=e.weights,a=0;a<t.length;a++){var u=t[a],l=u.source,d=u.target,h=u.weight;void 0===h&&(h=1),r[a]=l,n[a]=d,s[a]=h,o[l]++,o[d]++,i[a]=a}};function V(t,e,i,r){for(var n=i.pinned,o=i.X,s=i.Y,a=i.fx,u=i.fy,l=r.gravity,d=r.cx,h=r.cy,c=0,f=0,g=e.length,p=0;p<g;p++)c+=o[p],f+=s[p];c=c/g-d,f=f/g-h;for(var _=0;_<g;_++){var v=e[_];n[v]||(o[v]-=c,s[v]-=f)}for(var m=0;m<g;m++){var y=e[m],x=d-o[y]||tt(),b=h-s[y]||tt(),E=l*t;a[y]+=x*E,u[y]+=b*E}}function j(t,e){return void 0===e&&(e=1),function(t){for(var e=0,i=0,r=0,n=t;r<n.length;r+=1){var o=n[r];e+=o.w*o.h,i=Math.max(i,o.w)}t.sort(function(t,e){return e.h-t.h});for(var s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],a=0,u=0,l=0,d=t;l<d.length;l+=1)for(var h=d[l],c=s.length-1;0<=c;c--){var f=s[c];if(!(h.w>f.w||h.h>f.h)){if(h.x=f.x,h.y=f.y,u=Math.max(u,h.y+h.h),a=Math.max(a,h.x+h.w),h.w===f.w&&h.h===f.h){var g=s.pop();c<s.length&&(s[c]=g)}else h.h===f.h?(f.x+=h.w,f.w-=h.w):(h.w===f.w||s.push({x:f.x+h.w,y:f.y,w:f.w-h.w,h:h.h}),f.y+=h.h,f.h-=h.h);break}}}(t.map(function(t){return t.w+=t.maxr+e,t.h+=t.maxr+e,t}).sort(function(t,e){return t.w*t.h-e.w*e.h}))}O.initialize=function(t,e,i){var r,v,m,y,x,n,o,w,T,C,M,I,L,N,O,s=e.X,a=e.Y,u=e.R;b=function(t){return s[t]},k=function(t){return a[t]},F=function(t){return u[t]},v=(r=e).X,m=r.Y,y=r.R,x=r.bucketSize,R=function(t){var e,i,r,n,o=t.data;if(null!==o)if(0!==x){var s=et(o,b,k,F);e=s.x,i=s.y,r=s.r}else e=v[o],i=m[o],r=y[o];else if(t.left&&t.right){var a=t.left.cx,u=t.left.cy,l=t.right.cx,d=t.right.cy,h=t.left.r,c=t.right.r,f=l-a,g=d-u,p=c-h,_=Math.sqrt(f*f+g*g);e=(a+l+f/_*p)/2,i=(u+d+g/_*p)/2,r=(_+h+c)/2}else(n=t.left||t.right)&&(e=n.cx,i=n.cy,r=n.r);t.cx=e,t.cy=i,t.r=r},o=i,w=(n=e).X,T=n.Y,C=n.R,M=n.fx,I=n.fy,L=n.bucketSize,N=o.elasticity,O=o.margin,P=function(t){var e=t.data;if(null===e){var i=t.cx-z,r=t.cy-B,n=t.r+U;return n*n<i*i+r*r}if(0!==L)for(var o=e,s=0;s<o.length;s++){var a=o[s];if(D<a){var u=C[a],l=z-w[a]-M[a],d=B-T[a]-I[a],h=U+u+O,c=l*l+d*d;if(c<h*h){0===l&&(c+=(l=tt())*l),0===d&&(c+=(d=tt())*d);var f=Math.sqrt(c),g=(h-f)*N/f,p=u/h;M[D]+=l*g*p,I[D]+=d*g*p,M[a]-=l*g*(1-p),I[a]-=d*g*(1-p)}}}else{var _=t.data;if(D<_){var v=C[_],m=z-w[_],y=B-T[_],x=U+v+O,b=m*m+y*y;if(b<x*x){0===m&&(b+=(m=tt())*m),0===y&&(b+=(y=tt())*y);var E=Math.sqrt(b),A=(x-E)*N/E,S=v/x;M[D]+=m*A*S,I[D]+=y*A*S,M[_]-=m*A*(1-S),I[_]-=y*A*(1-S)}}}}},V.initialize=function(t,e,i){var r=e.X,n=e.Y,o=i.cx,s=i.cy,a=t.length;if(void 0===o||void 0===s){o=s=0;for(var u=0;u<a;u++)o+=r[u],s+=n[u];o/=a,s/=a}i.cx=o,i.cy=s};var G=function(){this.ids=[],this.xmin=1/0,this.ymin=1/0,this.xmax=-1/0,this.ymax=-1/0,this.x=0,this.y=0,this.w=0,this.h=0,this.cx=0,this.cy=0,this.radius=0,this.mx=0,this.my=0,this.m=0,this.maxr=0};function ft(t,e){return(t+e)*(t+e+1)/2+e}function H(t,M,I){var e=t.edgeIds,i=t.sources,r=t.targets,u=t.pinned,L=t.degrees,N=t.X,O=t.Y,k=t.R;void 0===M&&(M=0),void 0===I&&(I=.5);for(var l={},F={},n=0,o=e;n<o.length;n+=1){var s=o[n],a=i[s],d=r[s];a!==d&&(l[a]=l[a]||{},l[d]=l[d]||{},l[a][d]=!0,l[d][a]=!0)}Object.keys(l).forEach(function(t){var e,i,r=Number(t),n=Object.keys(l[Number(r)]);if(2===n.length){var o=n[0],s=n[1],a=(e=Number(o),i=Number(s),e<i?e*i+Math.pow(i-e-1,2)/4:e*i+Math.pow(e-i-1,2)/4);a in F||(F[a]=[Number(s),Number(o)]),u[r]||F[a].push(r)}}),Object.keys(F).forEach(function(t){var e=F[Number(t)],i=e[0],r=e[1],n=e.slice(2);if(1!==n.length){var o=N[i],s=O[i],a=N[r],u=O[r],l=L[i],d=.25+.5*l/(l+L[r]),h=o+(a-o)*d,c=s+(u-s)*d,f=-(u-s),g=a-o,p=Math.sqrt(Math.pow(o-a,2)+Math.pow(s-u,2));f=-2*f/p,g=-2*g/p;var _=Math.acos(f/Math.sqrt(f*f+g*g));0<M&&(_<M||_>Math.PI-M&&_<=Math.PI?(f=2*Math.cos(Math.PI-M),g=2*Math.sin(Math.PI-M)):(_>2*Math.PI-M||_>=Math.PI&&_<Math.PI+M)&&(f=2*Math.cos(M),g=2*Math.sin(M)));var v=0,m=1;n.sort(function(t,e){return k[e]-k[t]});var y=0,x=0,b=Math.max(k[n[0]],k[n[1]])/2;n.length%2==1&&(v=1,h-=f*b,c-=g*b);for(var E=1+I,A=0;A<n.length;A++){var S=(v+A)%2,w=n[A],T=2<=A?k[w]:b,C=(S?y:x)+T;N[w]=h+f*m*C,O[w]=c+g*m*C,S?y+=T*E:x+=T*E,m=-m}}})}function W(t,e,i,r){var n=i.X,o=i.Y,s=i.R,a=i.components,u=i.pinned,l=i.degrees,d=i.sources,h=i.targets,c=i.edgeIds,f=r.update,g=r.onUpdate,p=r.placement,_=r.placementOffset,v=r.alignSiblings,m=r.siblingsMinAngle,y=r.siblingsOffset;if(v&&(H({X:n,Y:o,R:s,degrees:l,pinned:u,sources:d,targets:h,edgeIds:c},m,y),f(t,n,o)),p){var x=function(t,e,i,r){for(var n=0,o=[],s=0,a=r;s<a.length;s+=1){for(var u=a[s],l=new G,d=0,h=u;d<h.length;d+=1){var c=h[d];l.add(c,t[c],e[c],i[c])}o.push(l.measure()),u.length>o[n].ids.length&&(n=o.length-1)}return{boxes:o,biggest:n}}(n,o,s,a),b=x.boxes,E=x.biggest;if("spiral"===p)!function(t,e,i,r,n){void 0===e&&(e=20);for(var o=0,s=t;o<s.length;o+=1){var a=s[o],u=et(a.ids,function(t){return i[t]},function(t){return r[t]},function(t){return n[t]}),l=u.x,d=u.y,h=u.r;a.cx=l,a.cy=d,a.radius=h+e}for(var c=t.slice().sort(function(t,e){return t.radius-e.radius}),f=c.map(function(t){return{x:t.cx,y:t.cy,r:t.radius}}),g=c.pop(),p=3*Math.PI/2,_=g.radius,v=2*Math.PI,m=g.cx,y=g.cy,x=[g],b=function(){var r=c[c.length-1],t=_+r.radius,n=m+Math.cos(p)*t,o=y+Math.sin(p)*t;x.some(function(t){var e=t.cx-n,i=t.cy-o;return Math.sqrt(e*e+i*i)<t.radius+r.radius})?_+=1:(r.x=n-r.w/2,r.y=o-r.h/2,r.cx=n,r.cy=o,f[c.length-1].x=n,f[c.length-1].y=o,x.push(c.pop()),p+=(2*r.radius+1)/t*1%v)};0!==c.length;)b()}(b,_,n,o,s);else{if("box"!==p)return;j(b,_)}for(var A=b[E].xmin-b[E].x,S=b[E].ymin-b[E].y,w=0,T=b;w<T.length;w+=1)for(var C=T[w],M=C.xmin,I=C.ymin,L=M-C.x-A,N=I-C.y-S,O=0,k=C.ids;O<k.length;O+=1){var F=k[O];n[F]-=L,o[F]-=N}f(t,n,o),g()}}function q(p,_,t,e,v,i){var m,y=t.X,x=t.Y,b=t.R,E=t.degrees,A=t.nodeIds,S=t.edgeIds,r=t.layers,n=t.layer,w=t.cluster,T=t.masses,o=t.weights,s=t.sources,a=t.targets,C=e.cx,M=e.cy,I=e.nextTick,u=e.cancelTick,L=e.update,N=e.onUpdate,O=e.batch,k=e.maxIterations,l=e.steps,F=e.minMovement,R=r.slice(),P=0;function D(){u(m),L(p,y,x),N(),i()}for(var z={},d=0;d<_.length;d++)z[Number(_[d].id)||d]=d;for(var h=new Map,c=0;c<S.length;c++){var f=S[c];h.set(ft(s[f],a[f]),f)}for(var g=0;g<r.length;g++){for(var B=r[g],U=g,V=0;V<B.length;V++){var j=B[V],G=w[j];-1!==G&&(T[G]+=T[j])}for(var H=0;H<_.length;H++){var W=_[H],q=Number(W.id)||H,X=W.source,Y=W.target,Z=o[z[q]];if(n[X]===U&&n[Y]===U){var K=w[X],Q=w[Y];if(K!==Q){var J=h.get(ft(K,Q));void 0!==J&&(o[J]+=Z)}}}}A.length=0,S.length=0,k=1/0;var $,tt,et=1,it=0,rt=1-Math.pow(.1,1/l/2),nt=(et-.1)/l,ot=.5;return m=setTimeout(function t(){var e=v(et+=(it-et)*rt,A,S),i=et<=ot||e<F;if(0===P||i){var r=R.pop();if(r){$&&(tt=$.reduce(function(t,e){return Math.max(t,C-y[e],M-x[e])},0)),A.push.apply(A,r);for(var n=0;n<r.length;n++){var o=r[n],s=w[o];if(-1!==s){var a=1<E[o]?2:1,u=b[s]+b[o];T[s]-=T[o],y[o]=y[s]+a*u*(2*st()-1),x[o]=x[s]+a*u*(2*st()-1)}else $&&(y[o]=C+2*tt*(1-2*st()),x[o]=M+2*tt*(1-2*st()))}$=r;for(var l=A.reduce(function(t,e){return t[e]=!0,t},{}),d=S.length=0;d<_.length;d++){var h=_[d],c=h.source,f=h.target,g=h.id;l[c]&&l[f]&&S.push(z[Number(g)])}i=!1,et=0===R.length?.2:.1+2*nt,ot=.1}}P%O==0&&(L(p,y,x),N()),++P>=k||i?D():m=I(t)}),{done:!1,stop:function(){return D(),this},get iterations(){return P}}}function X(t,e,i){for(var r=i.X,n=i.Y,o=i.fx,s=i.fy,a=i.pinned,u=0,l=t.length,d=0;d<l;d++){var h=t[d],c=o[h]*=e,f=s[h]*=e;if(a[h])o[h]=s[h]=0;else{var g=c,p=f;if(1e4<g||1e4<p){var _=Math.sqrt(g*g+p*p);p/=_,g/=_}r[h]+=g,n[h]+=p,u+=.5*(g*g+p*p)}}return u}G.prototype.add=function(t,e,i,r){this.ids.push(t),e-r<this.xmin&&(this.xmin=e-r),i-r<this.ymin&&(this.ymin=i-r),e+r>this.xmax&&(this.xmax=e+r),i+r>this.ymax&&(this.ymax=i+r),r>this.maxr&&(this.maxr=r),this.mx+=r*e,this.my+=r*i,this.m+=r},G.prototype.measure=function(t){return void 0===t&&(t=0),this.w=this.xmax-this.xmin+2*t,this.h=this.ymax-this.ymin+2*t,this.cx=this.mx/this.m,this.cy=this.my/this.m,this.x=this.xmin,this.y=this.ymin,this.radius=Math.sqrt(this.w*this.w+this.h*this.h)/2,this};var l=0,Y="undefined"==typeof window,Z="undefined"!=typeof performance&&performance.now?performance:Date,K=Y?function(t){var e=Z.now(),i=Math.max(0,16-(e-l)),r=setTimeout(function(){return t(e+i)},i);return l=e+i,r}:window.requestAnimationFrame,Q=Y?function(t){return clearTimeout(t)}:window.cancelAnimationFrame;function J(t,e,i){for(var r=0;r<t.length;r++){var n=t[r];n.x=e[r],n.y=i[r]}}function $(){}function gt(t){for(var e in void 0===t&&(t={}),this.onUpdate=$,this.update=J,this.nextTick=K,this.cancelTick=Q,this.onEnd=$,this.charge=10,this.maxIterations=1e3,this.minMovement=.1,this.edgeLength=30,this.edgeStrength=2,this.friction=.1,this.elasticity=.9,this.margin=1,this.cx=void 0,this.cy=void 0,this.gravity=.01,this.theta=.34,this.batch=1,this.inertia=.9,this.integrator=0,this.multilevel=!1,this.placement="none",this.placementOffset=10,this.alignSiblings=!1,this.bucketSize=void 0,this.siblingsMinAngle=0,this.siblingsOffset=.15,this.steps=300,this.scaling=1,this.defaultRadius=1,t)void 0!==t[e]&&(this[e]=t[e])}function pt(value){for(var t=0,e=this.length;t<e;t++)this[t]=value;return this}var _t=Int32Array.prototype.fill||pt,vt=Uint8Array.prototype.fill||pt;function mt(t,e,i){!function(t,e,i){for(var r=i.sources,n=i.targets,o=i.degrees,s=i.nodeIds,a=i.edgeIds,u={},l=0;l<t.length;l++)u[l]=s[l]=l;for(var d=0;d<e.length;d++){var h=e[d],c=h.source,f=h.target,g=u[c],p=u[f];a[d]=d,r[d]=g,n[d]=p,o[g]++,o[p]++}}(t,e,i),function(t){for(var e=t.nodeIds,i=t.edgeIds,r=t.sources,n=t.targets,o=t.degrees,s=t.layer,a=t.layers,u=t.component,l=t.components,d=t.cluster,h=t.parent,c=0,f=1,g=new Uint32Array(e.length),p=0;p<e.length;p++)g[p]=o[p];for(var _=new Array(e.length),v=0;v<i.length;v++){var m=i[v],y=r[m],x=n[m];_[y]=_[y]||[],_[x]=_[x]||[],_[y].push(x),_[x].push(y)}var b=new Uint8Array(e.length),E=new Uint8Array(e.length);_t.call(h,-1);for(var A=0,S=0;S<e.length;S++)if(0===b[S]){for(var w=[S];0!==w.length;){var T=w.pop();0===b[T]&&(w.push.apply(w,_[T]),b[T]=1,u[T]=A)}A++}for(var C=new Array(e.length),M=0;M<e.length;M++)s[M]=0,C[M]=M;for(;0!==C.length;){for(var I=[],L=[],N=0;N<C.length;N++)g[C[N]]<=c&&(I.push(N),L.push(C[N]));for(var O=0;O<L.length;O++){var k=L[O];E[k]=c,s[k]=f;var F=_[k];if(F)for(var R=0;R<F.length;R++)g[F[R]]--}for(var P=0;P<L.length;P++){var D=L[P],z=_[D];if(z)for(var B=0;B<z.length;B++){var U=z[B],V=s[U];if(void 0===V||f<V){h[D]=U;break}}}I.reverse();for(var j=0;j<I.length;j++)C.splice(I[j],1);if(f+=1,0<C.length){for(var G=1/0,H=0;H<C.length;H++){var W=g[C[H]];W<G&&(G=W)}c+1<=G&&(c=G,f=1)}}vt.call(b,0);for(var q=0;q<e.length;q++){var X=e[q],Y=s[X];if(-1===h[X]||s[h[X]]===Y){var Z=[X];for(vt.call(b,0);0!==Z.length;){var K=Z.pop();if(!b[K]){if(s[K]>Y){h[X]=K;break}var Q=_[K];b[K]=1,Q&&Z.push.apply(Z,Q)}}}}for(var J=0;J<e.length;J++){var $=e[J],tt=u[$];l[tt]=l[tt]||[],l[tt].push($);var et=s[$]-1;a[et]=a[et]||[],a[et].push($),d[$]=h[$]}}(i)}function yt(t){this.bucketSize=0;var e=t.nodes.length,i=t.edges.length;f(e+i),this.X=new Array(e),this.Y=new Array(e),this.R=new Array(e),this.fx=new Float32Array(e),this.fy=new Float32Array(e),this.vx=new Float32Array(e),this.vy=new Float32Array(e),this.pinned=new Uint8Array(e),this.masses=new Float32Array(e),this.weights=new Float32Array(i),this.sources=new Uint16Array(i),this.targets=new Uint16Array(i),this.degrees=new Uint32Array(e),this.layer=new Uint32Array(e),this.parent=new Int32Array(e),this.cluster=new Int32Array(e),this.component=new Uint16Array(e),this.components=[],this.layers=[],this.nodeIds=new Array(e),this.edgeIds=new Array(i),mt(t.nodes,t.edges,this)}function xt(t){this.promise=new Promise(t)}xt.prototype.then=function(t){return this.promise.then(t)},xt.prototype.stop=function(){return this.simulation.stop(),this},xt.prototype.iterations=function(){return this.simulation.iterations()};var bt={euler:function(t,e,i){for(var r=i.X,n=i.Y,o=i.fx,s=i.fy,a=i.vx,u=i.vy,l=i.masses,d=i.pinned,h=0,c=0,f=t.length,g=0;g<f;g++){var p=t[g],_=l[p],v=o[p]/_,m=s[p]/_;a[p]+=1/8*v,u[p]+=1/8*m;var y=.2*a[p]*(1/8)+.5*v*(1/8)*(1/8),x=.2*u[p]*(1/8)+.5*m*(1/8)*(1/8);o[p]=s[p]=0,d[p]||(r[p]+=y,n[p]+=x,h+=Math.abs(y)*_,c+=Math.abs(x)*_)}return(h*h+c*c)/f},verlet:X,leapfrog:function(t,e,i){for(var r=i.X,n=i.Y,o=i.fx,s=i.fy,a=i.vx,u=i.vy,l=i.pinned,d=i.masses,h=t.length,c=0,f=0;f<h;f++){var g=t[f],p=d[g],_=o[g]/p,v=s[g]/p,m=a[g]+_,y=u[g]+v,x=+m,b=+y;1e4<x&&(x=.1),1e4<b&&(b=.1),a[g]=e*(m+a[g])/2,u[g]=e*(y+u[g])/2,o[g]=s[g]=0,l[g]||(r[g]+=x,n[g]+=b),c+=.5*(x*x+b*b)}return c}};function force(r,t){var e,i,n=this;void 0===t&&(t={});function o(t){return void 0===t&&(t={nodes:[],edges:[]}),e=t.nodes,i=t.edges,f(ft(e.length,i.length)),new yt(t)}function s(t){return void 0===t&&(t={}),new gt(t)}var a=o(r),u=s(t);x.initialize(i,a),y.initialize(e,a,u),O.initialize(e,a,u),V.initialize(e,a,u);function l(t,e,i){return c&&(c.destroy(),c=null),e.length<=1?0:(c=y(t,e,c,a),x(t,i,a,u),0!==u.elasticity&&O(0,e,c,a,u),V(t,e,a,u),h(e,u.inertia,a))}var d,h=bt[u.integrator]||X,c=null;return{setOptions:function(t){return void 0===t&&(t={}),u=s(t),n},setGraph:function(t){var e=t.nodes,i=t.edges;return a=o(r),x.initialize(i,a),y.initialize(e,a,u),O.initialize(e,a,u),V.initialize(e,a,u),n},start:function(){return d=(u.multilevel?q:function(i,t,e,r,n,o){function s(){A=!0,f(a),y(),o()}var a,u=e.X,l=e.Y,d=e.nodeIds,h=e.edgeIds,c=r.nextTick,f=r.cancelTick,g=r.batch,p=r.maxIterations,_=r.steps,v=r.minMovement,m=r.update,y=r.onUpdate,x=0,b=1,E=1-Math.pow(.1,1/_),A=!1,S=function(){var t=n(b+=(0-b)*E,d,h),e=A||b<.1||t<=v;x%g==0&&(m(i,u,l),y()),++x<p&&!e?a=c(S):s()};return a=setTimeout(S),{done:!1,stop:function(){return s(),this},get iterations(){return x}}})(e,i,a,u,l,function(){d.done||W(e,0,a,u),u.onEnd(),d.done=!0}),this},iterations:function(){return d.iterations},data:function(){return a},stop:function(){return d&&d.stop(),this},step:function(t){return void 0===t&&(t=1),l(t,a.nodeIds,a.edgeIds),u.update(e,a.X,a.Y),this}}}return force.run=function(e,i){var r,t=new xt(function(t){i.onEnd=t,r=force(e,i).start()});return t.simulation=r,t.stop=function(){return r.stop(),t},t.iterations=function(){return r.iterations()},t},force}().apply(this,arguments)}var Xx={imports:{force:qx},configure:function(t,e){var i=e.graph,r=t.nodes._indexes,n=i.getNodeAttribute("x").getMultiple(r),o=i.getNodeAttribute("y").getMultiple(r),s=i.getNodeAttribute("radius").getMultiple(r),a=i.getNodeAttribute("layoutable").getMultiple(r),u=t.edges,l=[],d=[],h={};void 0===t.edgeStrength&&(t.edgeStrength=.75),null==t.gravity&&(t.gravity=.05),null==t.siblingsOffset&&(t.siblingsOffset=0),null==t.theta&&(t.theta=.62),t.alignSiblings=!!t.alignSiblings;for(var c=t.radiusRatio||1.25,f=0;f<t.nodes._indexes.length;f++){var g=t.nodes._indexes[f];h[g]=f,l.push({id:f,x:n[f],y:o[f],r:s[f]*c,pinned:!a[f]})}u.forEach(function(t){var e=h[t.getSource()._index],i=h[t.getTarget()._index];e!==i&&void 0!==e&&void 0!==i&&d.push({source:e,target:i})});var p=Q(I({},t));return delete p.nodes,delete p.edges,{graph:{nodes:l,edges:d},options:p,indexes:t.nodes._indexes,done:!1,x:n,y:o}},update:function(t,r){if(!r.simulation){r.graph=t.graph,r.options=t.options,r.indexes=t.indexes,t.options.nextTick=function(t){return t()},t.options.update=function(t,e,i){r.x=e,r.y=i},t.options.onEnd=function(){return r.done=!0};var e=qx(t.graph,t.options).start(),i=e.data(),n=i.X,o=i.Y;r.simulation=e,r.x=n,r.y=o}return{graph:r.graph,indexes:r.indexes,x:r.x,y:r.y}},context:function(){return{done:!1,graph:null,x:null,y:null,indexes:null}},isRunning:function(t){return!t.done},onSync:function(t){return{indexes:t.indexes,x:t.x,y:t.y}}};function Yx(t){for(var e,i,r,n=t.length,o=[0,1],s=2,a=2;a<n;a++){for(;1<s&&(e=t[o[s-2]],i=t[o[s-1]],r=t[a],(i[0]-e[0])*(r[1]-e[1])-(i[1]-e[1])*(r[0]-e[0])<=0);)--s;o[s++]=a}return o.slice(0,s)}function Zx(t){var e=t.length;if(e<3)return null;for(var i=new Array(e),r=new Array(e),n=0;n<e;n++)i[n]=[+t[n][0],+t[n][1],n];i.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]});for(n=0;n<e;n++)r[n]=[i[n][0],-i[n][1]];var o=Yx(i),s=Yx(r),a=s[s.length-1],u=o[o.length-1],l=s[0]===o[0],d=a===u?1:0,h=[];for(n=o.length-1;0<=n;--n)h.push(t[i[o[n]][2]]);for(n=+l;n<s.length-d;n++)h.push(t[i[s[n]][2]]);return h}var Kx,Qx=(function(t){function e(t){if(!(this instanceof e))return new e(t);this.points=t||[]}function _(t,e,i){return 0<(e[0]-t[0])*(i[1]-t[1])-(e[1]-t[1])*(i[0]-t[0])}function v(t,e){return _(t,e.dest,e.orig)}function m(t,e){return _(t,e.orig,e.dest)}function y(t,e){return v(t.dest,e)}function x(t,e,i,r){if(t[0]===r[0]&&t[1]===r[1]||e[0]===r[0]&&e[1]===r[1]||i[0]===r[0]&&i[1]===r[1])return!1;var n=t[0]*t[0]+t[1]*t[1],o=e[0]*e[0]+e[1]*e[1],s=i[0]*i[0]+i[1]*i[1],a=r[0]*r[0]+r[1]*r[1],u=s-a,l=i[1]-r[1],d=i[1]*a-s*r[1],h=i[0]-r[0],c=i[0]*a-s*r[0],f=i[0]*r[1]-i[1]*r[0];return 1<t[0]*(e[1]*u-o*l+d)-t[1]*(e[0]*u-o*h+c)+n*(e[0]*l-e[1]*h+f)-e[0]*d+e[1]*c-o*f}function s(t,e,i){this.onext=t,this.rot=e,this.orig=i,this.mark=!1}function b(t,e){var i=new s(null,null,t),r=new s(null,null,null),n=new s(null,null,e),o=new s(null,null,null);return i.onext=i,n.onext=n,(r.onext=o).onext=r,(((i.rot=r).rot=n).rot=o).rot=i}function E(t,e){var i=t.onext.rot,r=e.onext.rot,n=t.onext,o=r.onext,s=i.onext;t.onext=e.onext,e.onext=n,i.onext=o,r.onext=s}function A(t,e){var i=b(t.dest,e.orig);return E(i,t.lnext),E(i.sym,e),i}function S(t){E(t,t.oprev),E(t.sym,t.sym.oprev)}e.prototype={triangulate:function(){var t=this.points;t.sort(function(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]});for(var e=t.length-1;1<=e;e--)t[e][0]===t[e-1][0]&&t[e][1]===t[e-1][1]&&t.splice(e,1);if(t.length<2)return{};for(var i=function t(e){var i,r,n,o;{if(2===e.length)return{le:i=b(e[0],e[1]),re:i.sym};if(3===e.length)return i=b(e[0],e[1]),r=b(e[1],e[2]),E(i.sym,r),_(e[0],e[1],e[2])?(n=A(r,i),{le:i,re:r.sym}):_(e[0],e[2],e[1])?{le:(n=A(r,i)).sym,re:n}:{le:i,re:r.sym};for(var s=Math.ceil(e.length/2),a=t(e.slice(0,s)),u=t(e.slice(s)),l=a.le,d=a.re,h=u.le,c=u.re;;)if(m(h.orig,d))d=d.lnext;else{if(!v(d.orig,h))break;h=h.rprev}var f=A(h.sym,d);for(d.orig===l.orig&&(l=f.sym),h.orig===c.orig&&(c=f);;){var g=f.sym.onext;if(y(g,f))for(;x(f.dest,f.orig,g.dest,g.onext.dest);)o=g.onext,S(g),g=o;var p=f.oprev;if(y(p,f))for(;x(f.dest,f.orig,p.dest,p.oprev.dest);)o=p.oprev,S(p),p=o;if(!y(g,f)&&!y(p,f))break;f=!y(g,f)||y(p,f)&&x(g.dest,g.orig,p.orig,p.dest)?A(p,f.sym):A(f.sym,g.sym)}return{le:l,re:c}}}(t).le,r=[],n=0,o=[i];m(i.onext.dest,i);)i=i.onext;for(var s=i;o.push(s.sym),s.mark=!0,(s=s.lnext)!==i;);do{var a=o[n++];if(!a.mark)for(s=a;r.push(s.orig),s.sym.mark||o.push(s.sym),s.mark=!0,(s=s.lnext)!=a;);}while(n<o.length);return r}},s.prototype={get sym(){return this.rot.rot},get dest(){return this.sym.orig},get rotSym(){return this.rot.sym},get oprev(){return this.rot.onext.rot},get dprev(){return this.rotSym.onext.rotSym},get lnext(){return this.rotSym.onext.rot},get lprev(){return this.onext.sym},get rprev(){return this.sym.onext}},e.prototype.ccw=_,e.prototype.rightOf=v,e.prototype.leftOf=m,e.prototype.inCircle=x,t.exports=e}(Kx={exports:{}},Kx.exports),Kx.exports);function Jx(t,e,i,r,convexhull){if(void 0===e&&(e=1),void 0===i&&(i=0),!r||!convexhull){var n=t.map(function(t){return[t.x,t.y]});r=new Qx(n.slice()).triangulate(),convexhull=Zx(n)}if(!convexhull)return[];for(var o,s,a,u,l,d,h,c,f,g,p=i*i,_=[],v={},m=0;m<r.length;m+=3){if($x(convexhull,tb(r[m],r[m+1],r[m+2])))p<(E=(o=r[m],s=r[m+1],a=r[m+2],0,u=tb(o,s,a),l=u[0],d=u[1],h=o[0],c=o[1],(f=l-h)*f+(g=d-c)*g))&&(_.push(m),v[m]=E)}if(0===_.length)return[];_.sort(function(t,e){return v[t]-v[e]});var y=_[0],x=v[y],b=[];for(m=0;m<_.length;m++){var E,A=_[m];x<(E=v[A])&&p<E&&(y=A,x=E,b.push(y),b.length>e&&b.shift())}return b.map(function(t){return function(t,e,i){for(var r=arguments,n=tb(t,e,i),o=0,s=0;s<3;s++){var a=r[s],u=a[0]-n[0],l=a[1]-n[1],d=Math.sqrt(u*u+l*l);o<d&&(o=d)}return[n[0],n[1],o]}(r[t],r[t+1],r[t+2])})}function $x(t,e){for(var i=t.length,r=t[i-1],n=e[0],o=e[1],s=r[0],a=r[1],u=!1,l=0;l<i;l++){var d=t[l],h=d[0],c=d[1];o<c!=o<a&&n<(s-h)*(o-c)/(a-c)+h&&(u=!u),s=h,a=c}return u}function tb(t,e,i){var r=[(t[0]+e[0])/2,(t[1]+e[1])/2],n=[(e[0]+i[0])/2,(e[1]+i[1])/2],o=-1/((e[1]-t[1])/(e[0]-t[0])),s=-1/((i[1]-e[1])/(i[0]-e[0])),a=r[1]-o*r[0],u=(a-(n[1]-s*n[0]))/(s-o);return[u,o*u+a]}var eb=10;function ib(t,e,distance){for(var i,r,n=1/0,o=0,s=e.length;o<s;o++){var a=e[o],u=e[(o+1)%s],l=xu(t[0],t[1],a[0],a[1],u[0],u[1]);l<n&&(n=l,i=a,r=u)}return function(t,e,i,r,n,o,distance){var s=bu(t,e,i,r,n,o),a=-(r-o),u=i-n,l=Math.sqrt(a*a+u*u);return a/=l,u/=l,[s.x-distance*a,s.y-distance*u]}(t[0],t[1],i[0],i[1],r[0],r[1],distance)}function rb(t,e,i){var r=e.duration,n=void 0===r?0:r,o=e.margin,s=void 0===o?5:o,a=e.referenceNodes,u=e.nodes,l=a;!l||l instanceof mr||(l=t.getNodes(l));var d=l||u.inverse(),h=d.getPosition().map(function(t){return[t.x,t.y]}),c=i,f=u.getBoundingBox(),g=d.getBoundingBox();g.pad(g.maxScaledSize);var p,_,v,m,y,x,b,E,A,S=minDisk(c.map(function(t){return t.x}),c.map(function(t){return t.y}),u.getAttribute("radius")),w=S[0],T=S[1],C=S[2]+g.maxScaledSize+s,M=0,I=0;if(function(t,e,i,r){for(var n=0;n<t.length;n++){var o=t[n],s=o[0],a=o[1],u=Math.abs(s-e),l=Math.abs(a-i);if(u+l<=r)return 1;if(!(r<u||r<l)&&u*u+l*l<=r*r)return 1}}(h,w,T,C))if(d.size<=3){if(gd(w,T,S[2],g.minX,g.minY,g.maxX,g.maxY)){var L=function(t,e,i){for(var r,n=_u(i.cx,i.cy,t,e,i.minX,i.minY,i.maxX,i.maxY),o=1/0,s={x:i.maxX,y:e},a=0,u=n;a<u.length;a++){var l=u[a];(r=distance(t,e,l.x,l.y))<o&&(o=r,s=l)}return s}(w,T,g);p=distance(g.cx,g.cy,L.x,L.y);var N=(y=g.cx,x=g.cy,b=L.x,E=L.y,{x:y+(A=(p+C)/p)*(b-y),y:x+A*(E-x)});M=N.x-w,I=N.y-T}}else{var O=new Qx(h.slice()).triangulate(),convexhull=3<h.length?Zx(h):(v=(_=g).bottomLeft(),m=_.topRight(),[[v.x,v.y],[v.x,m.y],[m.x,m.y],[m.x,v.y]]),k=Jx(d.getPosition(),eb,C,O,convexhull);L=ib([w,T],convexhull,C);if(0<k.length){for(var F=Math.pow(w-L[0],2)+Math.pow(T-L[1],2),R=0,P=k;R<P.length;R++){var D=P[R];M=w-D[0],I=T-D[1],(p=M*M+I*I)<F&&(F=p,L=D.slice(0,2))}M=L[0]-w,I=L[1]-T}else M=L[0]-f.cx,I=L[1]-f.cy}var z={layoutName:"incremental",ids:u.getId(),positions:{before:c,current:c}};if(M||I){var B=c.map(function(t){return t.x+=M,t.y+=I,t});if(e.locate){"boolean"==typeof e.locate&&(e.locate={});var U=t.modules.locate.layoutDataBoundingBox({x:h.map(function(t){return t[0]}).concat(B.map(function(t){return t.x})),y:h.map(function(t){return t[1]}).concat(B.map(function(t){return t.y})),indexes:t.getNodes()._indexes}),V=t.modules.locate.computeConfigForBounds(U,e.locate);t.modules.camera.setView(V,{duration:n,easing:e.locate.easing,ignoreZoomLimits:!0})}return z.positions.current=B,u.setAttributes(B,n).then(function(){return z})}return u.setAttributes(c,n).then(function(){return z})}function nb(e,i,t){var r=G(i);return r.duration=0,r.dryRun=!0,r.locate=!1,delete r.incremental,t(r).then(function(t){return rb(e,i,t.positions.current)})}function ob(i,t,r){var e=t.nodes,n=t.duration,o=t.centralNode,s=e,a=s.reduce(function(t,e){return t[e._index]=!0,t},{}),u=i.getNodes();if(t.focusOnGroupShape)return r({nodes:s,duration:0}).then(function(){var t=s.concat(o),e=t.getAttribute("layoutable");return t.setAttributes({layoutable:!1}),r({nodes:i.getNodes(),duration:n}).then(function(){return t.setAttributes(e)})});var l=G(t);return delete l.centralNode,l.incremental=!1,l.nodes=u,l.nodeMass=function(t,e){return(e+1)*(a[t._index]?1:2)},r(l)}function sb(t,e,i){var r=fg(e.modules.graph,t);if("boolean"!=typeof r.incremental&&"margin"in r.incremental&&!isFinite(r.incremental.margin))throw new Error("Incremental layout: margin has to be a positive number");var n=G(r);return"boolean"!=typeof r.incremental&&(n.margin=r.incremental.margin,n.referenceNodes=r.incremental.referenceNodes),(n.centralNode&&!n.centralNode.getAttribute("layoutable")?ob:nb)(e,n,i)}var ab={configure:function(t,e){var i,r=e.graph,n=e.camera,o=(e.graphics,t.nodes._indexes),s=t.edges._indexes,a={},u={},l=o.length,d=s.length,h=r.getObjectList(!0),c=r.getObjectList(!1);(t.nodes||t.edges)&&(delete(t=G(t)).nodes,delete t.edges);var f=r.getNodeAttribute("innerStroke.width").getMultiple(o),g=r.getNodeAttribute("outerStroke.width").getMultiple(o),p=r.degrees(o),_=r.getNodeAttribute("x").getMultiple(o),v=r.getNodeAttribute("y").getMultiple(o),m=r.getNodeAttribute("radius").getMultiple(o),y=r.nodeList(o).getAttribute("layoutable"),x="function"==typeof t.nodeMass?t.nodeMass:function(t,e,i){return e+1};delete t.nodeMass;var b="function"==typeof t.edgeWeight?t.edgeWeight:function(t){return 1};delete t.edgeWeight,isFinite(t.scalingRatio)||delete t.scalingRatio;var E=o.reduce(function(t,e,i){return y[i]||(t[e]=!0),t},{}),A=0,S=0,w=0,T=n.getZoom();for(i=0;i<o.length;++i){var C=o[i],M=_[i],I=v[i],L=m[i]+(f[i]+g[i])/T;a[C]={id:C,x:M,y:I,degree:p[i],size:L,pinned:!!E[C],mass:x(h.get(C),p[i],i)},w=Math.max(L,w)}if(1<l)for(i=0;i<l;i++){var N=a[o[i]];A+=N.x,S+=N.y}var O={x:A/=l,y:S/=l},k=r.edgeList(s),F=k.getSource()._indexes,R=k.getTarget()._indexes;for(i=0;i<d;i++){var P=s[i],D=F[i],z=R[i];a[D]&&a[z]&&(u[P]={source:D,target:z},u[P].weight=b(c.get(P)))}return{nodes:a,edges:u,maxSize:w,config:Q(t),barycentre:O}},context:function(){return{}},update:function(t,e){var Z,i,r,n;e.W?Z=e.W:(Z={ppn:10,ppe:3,ppr:9,MAX_SUBDIVISION_RETRIES:3,maxForce:10,iterations:0,converged:!1,settings:{linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:0,scalingRatio:100,strongGravityMode:!0,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5,startingIterations:10,iterationsPerRender:10,maxIterations:1e3,avgDistanceThreshold:.01,autoStop:!0,alignNodeSiblings:!0,nodeSiblingsScale:5,nodeSiblingsAngleMin:0}},e.W=Z,r=(i=t).config,n=function(t,e){var i,r,n,o,s=t.nodes,a=t.edges,u=t.maxSize,l=Object.keys(t.nodes),d=Object.keys(t.edges),h=l.length*Z.ppn,c=d.length*Z.ppe,f={},g=Math.pow(10,Math.log(Math.max(u,1))-6),p=g/2,_=Math.random,v=e.randomizeFactor||1;o="locally"===e.randomize?function(t){return t+_()*v}:"globally"===e.randomize?function(t){return _()*v}:function(t){return t+_()*g-p};var m=new Float32Array(h),y=new Float32Array(c);for(i=r=0,n=l.length;i<n;i++){var x=l[i],b=s[x],E=b.x,A=b.y;b.pinned||(E=o(E),A=o(A)),f[x]=r,m[r]=E,m[r+1]=A,m[r+2]=0,m[r+3]=0,m[r+4]=0,m[r+5]=0,m[r+6]=b.mass,m[r+7]=1,m[r+8]=b.size,m[r+9]=b.pinned||0,r+=Z.ppn}for(i=r=0,n=d.length;i<n;i++){x=d[i];var S=a[x];y[r]=f[S.source],y[r+1]=f[S.target],y[r+2]=S.weight||0,r+=Z.ppe}return{nodes:m,edges:y}}(i,r),e.NodeMatrix=n.nodes,e.EdgeMatrix=n.edges,Z.nodesLength=e.NodeMatrix.length,Z.edgesLength=e.EdgeMatrix.length,Z.settings=function(t,e){for(var i in t)e[i]=t[i];return e}(t.config,Z.settings),e.nodes=t.nodes,e.edges=t.edges,e.barycentre=t.barycentre);var K,Q=e.NodeMatrix,J=e.EdgeMatrix;function o(){var t,e,i,r,n,o,s,a,u,l,d,h,c,f,g,distance,p;for(i=0;i<Z.nodesLength;i+=Z.ppn)Q[i+4]=Q[i+2],Q[i+5]=Q[i+3],Q[i+2]=0,Q[i+3]=0;if(Z.settings.outboundAttractionDistribution){for(i=u=0;i<Z.nodesLength;i+=Z.ppn)u+=Q[i+6];u/=Z.nodesLength}if(Z.settings.barnesHutOptimize){var _,v,m,y,x=1/0,b=-1/0,E=1/0,A=-1/0;for(K=[],i=0;i<Z.nodesLength;i+=Z.ppn)x=Math.min(x,Q[i+0]),b=Math.max(b,Q[i+0]),E=Math.min(E,Q[i+1]),A=Math.max(A,Q[i+1]);var S=b-x,w=A-E;for(w<S?A=(E-=(S-w)/2)+S:b=(x-=(w-S)/2)+w,K[0]=-1,K[1]=(x+b)/2,K[2]=(E+A)/2,K[3]=Math.max(b-x,A-E),K[4]=-1,K[5]=-1,K[6]=0,K[7]=0,t=1,i=K[8]=0;i<Z.nodesLength;i+=Z.ppn)for(e=0,m=Z.MAX_SUBDIVISION_RETRIES;;){if(!(0<=K[e+5])){if(K[e+0]<0){K[e+0]=i;break}if(K[e+5]=t*Z.ppr,s=K[e+3]/2,a=K[e+5],K[a+0]=-1,K[a+1]=K[e+1]-s,K[a+2]=K[e+2]-s,K[a+3]=s,K[a+4]=a+Z.ppr,K[a+5]=-1,K[a+6]=0,K[a+7]=0,K[a+8]=0,a+=Z.ppr,K[a+0]=-1,K[a+1]=K[e+1]-s,K[a+2]=K[e+2]+s,K[a+3]=s,K[a+4]=a+Z.ppr,K[a+5]=-1,K[a+6]=0,K[a+7]=0,K[a+8]=0,a+=Z.ppr,K[a+0]=-1,K[a+1]=K[e+1]+s,K[a+2]=K[e+2]-s,K[a+3]=s,K[a+4]=a+Z.ppr,K[a+5]=-1,K[a+6]=0,K[a+7]=0,K[a+8]=0,a+=Z.ppr,K[a+0]=-1,K[a+1]=K[e+1]+s,K[a+2]=K[e+2]+s,K[a+3]=s,K[a+4]=K[e+4],K[a+5]=-1,K[a+6]=0,K[a+7]=0,K[a+8]=0,t+=4,_=Q[K[y=e+0]+0]<K[e+1]?Q[K[y]+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[K[y]+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr,K[e+6]=Q[K[y]+6],K[e+7]=Q[K[y]+0],K[e+8]=Q[K[y]+1],K[_+0]=K[e+0],K[e+0]=-1,_===(v=Q[i+0]<K[e+1]?Q[i+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[i+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr)){if(m--){e=_;continue}m=Z.MAX_SUBDIVISION_RETRIES;break}K[v+0]=i;break}_=Q[i+0]<K[e+1]?Q[i+1]<K[e+2]?K[e+5]:K[e+5]+Z.ppr:Q[i+1]<K[e+2]?K[e+5]+2*Z.ppr:K[e+5]+3*Z.ppr,K[e+7]=(K[e+7]*K[e+6]+Q[i+0]*Q[i+6])/(K[e+6]+Q[i+6]),K[e+8]=(K[e+8]*K[e+6]+Q[i+1]*Q[i+6])/(K[e+6]+Q[i+6]),K[e+6]+=Q[i+6],e=_}}if(Z.settings.barnesHutOptimize)for(l=Z.settings.scalingRatio,i=0;i<Z.nodesLength;i+=Z.ppn)for(e=0;;)if(0<=K[e+5]){if(distance=Math.sqrt((Q[i+0]-K[e+7])*(Q[i+0]-K[e+7])+(Q[i+1]-K[e+8])*(Q[i+1]-K[e+8])),2*K[e+3]/distance<Z.settings.barnesHutTheta){if(d=Q[i+0]-K[e+7],h=Q[i+1]-K[e+8],Z.settings.adjustSizes?0<distance?(p=l*Q[i+6]*K[e+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p):distance<0&&(p=-l*Q[i+6]*K[e+6]/distance,Q[i+2]+=d*p,Q[i+3]+=h*p):0<distance&&(p=l*Q[i+6]*K[e+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p),K[e+4]<0)break;e=K[e+4];continue}e=K[e+5]}else{if(0<=K[e+0]&&K[e+0]!==i&&(d=Q[i+0]-Q[K[e+0]+0],h=Q[i+1]-Q[K[e+0]+1],distance=Math.sqrt(d*d+h*h),Z.settings.adjustSizes?0<distance?(p=l*Q[i+6]*Q[K[e+0]+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p):distance<0&&(p=-l*Q[i+6]*Q[K[e+0]+6]/distance,Q[i+2]+=d*p,Q[i+3]+=h*p):0<distance&&(p=l*Q[i+6]*Q[K[e+0]+6]/distance/distance,Q[i+2]+=d*p,Q[i+3]+=h*p)),K[e+4]<0)break;e=K[e+4]}else for(l=Z.settings.scalingRatio,r=0;r<Z.nodesLength;r+=Z.ppn)for(n=0;n<r;n+=Z.ppn)d=Q[r+0]-Q[n+0],h=Q[r+1]-Q[n+1],Z.settings.adjustSizes?0<(distance=Math.sqrt(d*d+h*h)-Q[r+8]-Q[n+8])?(p=l*Q[r+6]*Q[n+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p,Q[n+2]+=d*p,Q[n+3]+=h*p):distance<0&&(p=100*l*Q[r+6]*Q[n+6],Q[r+2]+=d*p,Q[r+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p):0<(distance=Math.sqrt(d*d+h*h))&&(p=l*Q[r+6]*Q[n+6]/distance/distance,Q[r+2]+=d*p,Q[r+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p);for(a=Z.settings.gravity/Z.settings.scalingRatio,l=Z.settings.scalingRatio,i=0;i<Z.nodesLength;i+=Z.ppn)d=Q[i+(p=0)],h=Q[i+1],distance=Math.sqrt(d*d+h*h),Z.settings.strongGravityMode?0<distance&&(p=l*Q[i+6]*a):0<distance&&(p=l*Q[i+6]*a/distance),Q[i+2]-=d*p,Q[i+3]-=h*p;for(l=+(Z.settings.outboundAttractionDistribution?u:1),o=0;o<Z.edgesLength;o+=Z.ppe)r=J[o+0],n=J[o+1],s=J[o+2],g=Math.pow(s,Z.settings.edgeWeightInfluence),d=Q[r+0]-Q[n+0],h=Q[r+1]-Q[n+1],Z.settings.adjustSizes?(distance=Math.sqrt(d*d+h*h)-Q[r+8]-Q[n+8],Z.settings.linLogMode?Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g*Math.log(1+distance)/distance/Q[r+6]):0<distance&&(p=-l*g*Math.log(1+distance)/distance):Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g/Q[r+6]):0<distance&&(p=-l*g)):(distance=Math.sqrt(d*d+h*h),Z.settings.linLogMode?Z.settings.outboundAttractionDistribution?0<distance&&(p=-l*g*Math.log(1+distance)/distance/Q[r+6]):0<distance&&(p=-l*g*Math.log(1+distance)/distance):p=Z.settings.outboundAttractionDistribution?(distance=1,-l*g/Q[r+6]):(distance=1,-l*g)),0<distance&&(Q[r+2]+=d*p,Q[r+3]+=h*p,Q[n+2]-=d*p,Q[n+3]-=h*p);var force,T,C,M,I=0;if(Z.settings.adjustSizes)for(i=0;i<Z.nodesLength;i+=Z.ppn)Q[i+9]||((force=Math.sqrt(Q[i+2]*Q[i+2]+Q[i+3]*Q[i+3]))>Z.maxForce&&(Q[i+2]=Q[i+2]*Z.maxForce/force,Q[i+3]=Q[i+3]*Z.maxForce/force),T=Q[i+6]*Math.sqrt((Q[i+4]-Q[i+2])*(Q[i+4]-Q[i+2])+(Q[i+5]-Q[i+3])*(Q[i+5]-Q[i+3])),C=Math.sqrt((Q[i+4]+Q[i+2])*(Q[i+4]+Q[i+2])+(Q[i+5]+Q[i+3])*(Q[i+5]+Q[i+3]))/2,M=.1*Math.log(1+C)/(1+Math.sqrt(T)),c=Q[i+0],f=Q[i+1],Q[i+0]=Q[i+0]+Q[i+2]*(M/Z.settings.slowDown),Q[i+1]=Q[i+1]+Q[i+3]*(M/Z.settings.slowDown),d=Q[i+0],h=Q[i+1],I+=distance=Math.sqrt((d-c)*(d-c)+(h-f)*(h-f)));else for(i=0;i<Z.nodesLength;i+=Z.ppn)Q[i+9]||(T=Q[i+6]*Math.sqrt((Q[i+4]-Q[i+2])*(Q[i+4]-Q[i+2])+(Q[i+5]-Q[i+3])*(Q[i+5]-Q[i+3])),C=Math.sqrt((Q[i+4]+Q[i+2])*(Q[i+4]+Q[i+2])+(Q[i+5]+Q[i+3])*(Q[i+5]+Q[i+3]))/2,M=Q[i+7]*Math.log(1+C)/(1+Math.sqrt(T)),Q[i+7]=Math.min(1,Math.sqrt(M*(Q[i+2]*Q[i+2]+Q[i+3]*Q[i+3])/(1+Math.sqrt(T)))),c=Q[i+0],f=Q[i+1],Q[i+0]=Q[i+0]+Q[i+2]*(M/Z.settings.slowDown),Q[i+1]=Q[i+1]+Q[i+3]*(M/Z.settings.slowDown),d=Q[i+0],h=Q[i+1],I+=distance=Math.sqrt((d-c)*(d-c)+(h-f)*(h-f)));if(Z.iterations++,Z.settings.autoStop&&(Z.converged=Z.iterations>Z.settings.maxIterations||I/Z.nodesLength<Z.settings.avgDistanceThreshold,Z.converged&&Z.settings.alignNodeSiblings)){var L,N,O={},k={};for(o=0;o<Z.edgesLength;o+=Z.ppe)(r=J[o+0])!==(n=J[o+1])&&(O[r]=O[r]||{},O[n]=O[n]||{},O[r][n]=!0,O[n][r]=!0);Object.keys(O).forEach(function(t){var e=~~t;2==(N=Object.keys(O[e])).length&&((L=N[0]+";"+N[1])in k||(L=N[1]+";"+N[0],k[L]||(k[L]=[~~N[1],~~N[0]])),k[L].push(e))});var F,R,P,D,z,B,U,V,j,G,H,W,q,X,Y=Z.settings.nodeSiblingsAngleMin;Object.keys(k).forEach(function(t){if(R=k[t].shift(),P=k[t].shift(),1!=(F=k[t].filter(function(t){return!Q[t+9]})).length){var e,i,r,n,o,s,a,u,l,d,h,c,f,g;if(B=Q[R+0],U=Q[R+1],V=Q[P+0],j=Q[P+1],D=Object.keys(O[R]).length,z=Object.keys(O[P]).length,H={x:(r=B)+(V-r)*(o=(.75-(i=.25))*(D/(D+z)-(e=0))/(1-e)+i),y:(n=U)+(j-n)*o},W={xi:-((l=j)-(a=U)),yi:(u=V)-(s=B),xiPrime:l-a,yiPrime:-(u-s)},d=V-B,h=j-U,G=Math.sqrt(d*d+h*h),f=G,q={x:((c=W).xiPrime-c.xi)/f,y:(c.yiPrime-c.yi)/f},g=q,X=Math.acos(g.x/Math.sqrt(g.x*g.x+g.y*g.y)),2*Y>Math.PI)throw new Error("ForceLink.Worker - Invalid parameter: angleMin must be smaller than 2 PI.");0<Y&&(X<Y||X>Math.PI-Y&&X<=Math.PI?q={x:2*Math.cos(Math.PI-Y),y:2*Math.sin(Math.PI-Y)}:(X>2*Math.PI-Y||X>=Math.PI&&X<Math.PI+Y)&&(q={x:2*Math.cos(Y),y:2*Math.sin(Y)}));var p=0,_=1,v=1;F.length%2==1&&(v=0,p=1);for(var m=0;m<F.length;m++)Q[F[m]+0]=H.x+_*q.x*v*(p||2<=m?Z.settings.nodeSiblingsScale:2*Z.settings.nodeSiblingsScale/3),Q[F[m]+1]=H.y+_*q.y*v*(p||2<=m?Z.settings.nodeSiblingsScale:2*Z.settings.nodeSiblingsScale/3),_=-_,v+=(m+p)%2}})}}return function(){if(Z.settings.autoStop)for(;!Z.converged;)o();else for(var t=0===Z.iterations?Z.settings.startingIterations:Z.iterations+Z.settings.iterationsPerRender;Z.iterations!==t;)o();return{nodes:function(t){for(var e=Object.keys(t),i={},r=0;r<Q.length;r+=Z.ppn){var n=e[r/Z.ppn];i[n]={id:n,x:Q[r+0],y:Q[r+1],pinned:Q[r+9]}}return i}(e.nodes),barycentre:e.barycentre}}()},isRunning:function(t){return!t.W.settings.autoStop},onSync:function(t,e){var i,r,n,o,s,a,u,l,d=t.nodes,h=t.barycentre,c=e.graph,f=Object.keys(d),g=f.length,p=0,_=0,v=new Array(g),m=new Array(g),y=new Array(g),x=new Array(g),b=c.getAttributes(!0,["x","y"]),E=b[0],A=b[1];for(i=0;i<g;i++)n=d[r=f[i]],l=parseInt(r),v[i]=l,x[i]=n.pinned,s=n.pinned?(o=E.get(l),A.get(l)):(o=n.x,n.y),p+=m[i]=o,_+=y[i]=s;for(a=p/g-h.x,u=_/g-h.y,i=0;i<g;i++)x[i]||(m[i]-=a,y[i]-=u);return{indexes:v,x:m,y:y}}},ub=function(t){return t.reduce(function(t,e){return t[e]=!0,t},{})};function lb(t,e){for(var i=[t],r=ub(i),n=[t];i.length;)for(var o=0,s=e[i.shift()];o<s.length;o+=1){var a=s[o];r[a]||(r[a]=!0,n.push(a),i.push(a))}return n}function db(t){return t.reduce(function(t,e){return t[e.source]=t[e.source]||[],t[e.target]=t[e.target]||[],t[e.source].push(""+e.target),t[e.target].push(""+e.source),t},{})}function hb(n,t){var o=Math.max(Math.min(t||10,100),1)/1e3;return function(t,e){var i=Math.abs(t.layer-e.layer),r=[e,t].reduce(function(t,e){return t+(mb(e)?1:o)},0);return i?2*i*n:r*n}}function cb(t){return t.reduce(function(t,e){return t+function(t,e){for(var i=[],r=arguments.length-2;0<r--;)i[r]=arguments[r+2];for(var n=e,o=0,s=i;o<s.length;o+=1){var a=s[o];if(!n[a])return t;n=n[a]}return n}(mb(e)?.5:0,e,"data","radius")},0)/t.length}function fb(t,e,i){var r=i||db(e||[]);return t.filter(function(t){return!(t.id in r)})}function gb(t,e){var i=ub(e);return t.filter(function(t){return!(t in i)})}function pb(t,n){t.forEach(function(t,r){t.forEach(function(t,e,i){n(t,e,i,r)})})}function _b(e){return Object.keys(e).map(function(t){return e[t]})}function vb(i,r){return Object.keys(i).reduce(function(t,e){return t[e]=r(i[e],e,i),t},{})}function mb(t){return!!t.data}function yb(t,e){return{id:t,data:e,children:[]}}function xb(t,e,l){var d=e.reduce(function(t,e){return t[e.source]=t[e.source]||[],t[e.source].push(e),t},{});var r=t.reduce(function t(e,i){var r=e.visited,n=e.stack,o=e.result;if(r[i.id])return e;r[i.id]=n[i.id]=1;for(var s=0,a=d[i.id]||[];s<a.length;s+=1){var u=a[s];n[u.target]?o.push(u):t(e,l[u.target])}return delete n[i.id],e},{visited:{},stack:{},result:[]}).result.reduce(function(t,e){var i=e.source,r=e.target;return t[i]=t[i]||{},t[i][r]=1,t},{});return e.map(function(t){var e=t.source,i=t.target;return r[e]&&r[e][i]?{source:i,target:e}:t})}function bb(t,e){e.forEach(function(t){return t._median=[]}),t.forEach(function(e,i){e.children.filter(function(t){return t.layer>e.layer}).forEach(function(t){t._median.push(i)})}),e.forEach(function(t,e){t.children.forEach(function(){return t._median.push(e)})}),e.forEach(function(t){return t._median=function(t){if(t.sort(function(t,e){return t-e}),0===t.length)return 0;var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2}(t._median)||0}),e.sort(function(t,e){return t._median-e._median}),e.forEach(function(t){return delete t._median})}var Eb="up",Ab="down",Sb="left",wb="right",Tb=Number.POSITIVE_INFINITY;function Cb(t){for(var e=0,i=[Eb,Ab];e<i.length;e+=1){t(i[e])}}function Mb(t){for(var e=0,i=[Sb,wb];e<i.length;e+=1){t(i[e])}}function Ib(){return function(t,a){var n,i,e,d,h,r,o=(n={},pb(t,function(t){n[t.id]||(n[t.id]={successors:[],ancestors:[]});for(var e=0,i=t.children;e<i.length;e+=1){var r=i[e];n[r.id]||(n[r.id]={successors:[],ancestors:[]}),r.layer>t.layer&&(n[t.id].successors.push(r),n[r.id].ancestors.push(t)),r.layer<t.layer&&(n[t.id].ancestors.push(r),n[r.id].successors.push(t))}}),{getSuccessors:function(t){return n[t.id].successors},getAncestors:function(t){return n[t.id].ancestors}}),u=o.getSuccessors,g=o.getAncestors,s=(i={},pb(t,function(t,e){i[t.id]=e}),i),p=(d=u,h=function(t){var e=t.id;return s[e]},r=(e=t).length,e.reduce(function(t,o,e){var i=t.prevLayer,s=t.conflicts;if(!e||r-2<e)return{prevLayer:i,conflicts:s};var a=0,u=o.length,l=o[u-1];return o.forEach(function(t,e){var i=function(t){if(mb(t))return d(t).find(mb)}(t),r=i?h(i):u-1;if(i||t===l)for(var n=function(){var i=o[a];d(i).forEach(function(t){var e=h(t);(e<0||r<e)&&(s[i.id]=s[i.id]||{},s[i.id][t.id]=!0)}),a++};a<=e;)n()}),{prevLayer:o,conflicts:s}},{prevLayer:e[0],conflicts:{}}).conflicts),_={};Cb(function(o){var s=o===Eb?t:[].concat(t).reverse();Mb(function(t){t===wb&&(s=s.map(function(t){return[].concat(t).reverse()}));var e,l,d,h,c,f,i=a,r=(l=p,d=o===Eb?g:u,h={},c={},f={},pb(e=s,function(t,e){h[t.id]=t.id,c[t.id]=t.id,f[t.id]=e}),e.forEach(function(t){var u=-1;t.forEach(function(t){var e,i,r=d(t).sort(function(t,e){return f[t.id]-f[e.id]});if(r.length)for(var n=(r.length-1)/2,o=0,s=[Math.floor(n),Math.ceil(n)];o<s.length;o+=1){var a=r[s[o]];c[t.id]===t.id&&(i=a,!(l[(e=t).id]&&l[e.id][i.id]||l[i.id]&&l[i.id][e.id])&&u<f[a.id]&&(c[a.id]=t.id,h[t.id]=h[a.id],c[t.id]=h[t.id],u=f[a.id]))}})}),{roots:h,aligns:c}),n=function(t,s,a,u){var l={},d={},r={},h={},c={},f={},g={};pb(t,function(t,e,i){l[t.id]=t,d[t.id]=Tb,r[t.id]=e,c[t.id]=i[e-1]||t,f[t.id]=t,g[t.id]=0});var p=3500,_=p/10;return t.forEach(function(t){t.filter(function(t){return s[t.id]===t.id}).forEach(function(t){return function t(e,i){void 0===i&&(i=0);if(null==h[e.id]){h[e.id]=0;for(var r=e,n=!1;!n;){if(null!=c[r.id]){var o=f[s[c[r.id].id]];if(g[o.id]>_||p<i)return;t(o,i+1),g[o.id]++,l[e.id]===e&&(l[e.id]=l[o.id]),l[e.id]!==l[o.id]?d[l[o.id].id]=Math.min(d[l[o.id].id],h[e.id]-h[o.id]-u(e,c[e.id])):h[e.id]=Math.max(h[e.id],h[o.id]+u(e,c[e.id]))}r=f[a[r.id]],n=r===e}}}(t)})}),pb(t,function(t){h[t.id]=h[s[t.id]];var e=d[l[s[t.id]].id];t.id===s[t.id]&&isFinite(e)&&(h[t.id]+=e)}),h}(s,r.roots,r.aligns,i);t===wb&&(n=vb(n,function(t){return-t})),_[o+t]=n})});var l,c,f,v,m,y,x,b=(l=_,c=Object.keys(l).reduce(function(t,e){var i=t.alignment,value=t.value,r=_b(l[e]),n=Math.max.apply(Math,r)-Math.min.apply(Math,r);return value<=n?{alignment:i,value:value}:{alignment:e,value:n}},{alignment:null,value:Tb}).alignment,l[c]);f=_,m=_b(v=b),y=Math.min.apply(Math,m),x=Math.max.apply(Math,m),Cb(function(o){Mb(function(t){var e=o+t,i=f[e];if(i!==v){var r=_b(i),n=t===Sb?y-Math.min.apply(Math,r):x-Math.max.apply(Math,r);n&&(f[e]=vb(i,function(t){return t+n}))}})});var E,A=vb((E=_)[Eb+Sb],function(t,r){var n=[];return Cb(function(i){Mb(function(t){var e=i+t;n.push(E[e][r])})}),n.sort(function(t,e){return t-e}),(n[1]+n[2])/2});return pb(t,function(t){t.x=A[t.id]}),t}}function Lb(){return function(t,r){var n=-Tb;return t.forEach(function(t){var e=t.filter(mb);if(1===e.length){e[0].x=.5}else{e.reduce(function(t,e){return e.x=void 0===t?0:t.x+r(t,e),e},void 0);var i=e[e.length-1].x;n=Math.max(n,i),e.forEach(function(t){return t.x/=i})}}),n=Math.max(n,1),pb(t,function(t){return t.x*=n}),t}}function Nb(t,e,i,r){this.feasible=i,this.evaluation=e,this.bounded=r,this._tableau=t}var Ob=Nb;function kb(t,e,i,r,n){Ob.call(this,t,e,i,r),this.iter=n}Nb.prototype.generateSolutionSet=function(){for(var t={},e=this._tableau,i=e.varIndexByRow,r=e.variablesPerIndex,n=e.matrix,o=e.rhsColumn,s=e.height-1,a=Math.round(1/e.precision),u=1;u<=s;u+=1){var l=r[i[u]];if(void 0!==l&&!0!==l.isSlack){var d=n[u][o];t[l.id]=Math.round(d*a)/a}}return t};var Fb=kb;function Rb(t){this.model=null,this.matrix=null,this.width=0,this.height=0,this.costRowIndex=0,this.rhsColumn=0,this.variablesPerIndex=[],this.unrestrictedVars=null,this.feasible=!0,this.evaluation=0,this.varIndexByRow=null,this.varIndexByCol=null,this.rowByVarIndex=null,this.colByVarIndex=null,this.precision=t||1e-8,this.optionalObjectives=[],this.objectivesByPriority={},this.savedState=null,this.availableIndexes=[],this.lastElementIndex=0,this.variables=null,this.nVars=0,this.bounded=!0,this.unboundedVarIndex=null,this.branchAndCutIterations=0}kb.prototype=Object.create(Ob.prototype),kb.constructor=kb;var Pb=Rb;function Db(t,e){this.priority=t,this.reducedCosts=new Array(e);for(var i=0;i<e;i+=1)this.reducedCosts[i]=0}Rb.prototype.solve=function(){return 0<this.model.getNumberOfIntegerVariables()?this.branchAndCut():this.simplex(),this.updateVariableValues(),this.getSolution()},Db.prototype.copy=function(){var t=new Db(this.priority,this.reducedCosts.length);return t.reducedCosts=this.reducedCosts.slice(),t},Rb.prototype.setOptionalObjective=function(t,e,i){var r=this.objectivesByPriority[t];void 0===r&&(r=new Db(t,Math.max(this.width,e+1)),this.objectivesByPriority[t]=r,this.optionalObjectives.push(r),this.optionalObjectives.sort(function(t,e){return t.priority-e.priority}));r.reducedCosts[e]=i},Rb.prototype.initialize=function(t,e,i,r){this.variables=i,this.unrestrictedVars=r,this.width=t,this.height=e;for(var n=new Array(t),o=0;o<t;o++)n[o]=0;this.matrix=new Array(e);for(var s=0;s<e;s++)this.matrix[s]=n.slice();this.varIndexByRow=new Array(this.height),this.varIndexByCol=new Array(this.width),this.varIndexByRow[0]=-1,this.varIndexByCol[0]=-1,this.nVars=t+e-2,this.rowByVarIndex=new Array(this.nVars),this.colByVarIndex=new Array(this.nVars),this.lastElementIndex=this.nVars},Rb.prototype._resetMatrix=function(){var t,e,i=this.model.variables,r=this.model.constraints,n=i.length,o=r.length,s=this.matrix[0],a=!0===this.model.isMinimization?-1:1;for(t=0;t<n;t+=1){var u=i[t],l=u.priority,d=a*u.cost;0===l?s[t+1]=d:this.setOptionalObjective(l,t+1,d),e=i[t].index,this.rowByVarIndex[e]=-1,this.colByVarIndex[e]=t+1,this.varIndexByCol[t+1]=e}for(var h=1,c=0;c<o;c+=1){var f,g,p=r[c],_=p.index;this.rowByVarIndex[_]=h,this.colByVarIndex[_]=-1,this.varIndexByRow[h]=_;var v=p.terms,m=v.length,y=this.matrix[h++];if(p.isUpperBound){for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=g.coefficient;y[0]=p.rhs}else{for(f=0;f<m;f+=1)g=v[f],y[this.colByVarIndex[g.variable.index]]=-g.coefficient;y[0]=-p.rhs}}},Rb.prototype.setModel=function(t){var e=(this.model=t).nVariables+1,i=t.nConstraints+1;return this.initialize(e,i,t.variables,t.unrestrictedVariables),this._resetMatrix(),this},Rb.prototype.getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},Rb.prototype.density=function(){for(var t=0,e=this.matrix,i=0;i<this.height;i++)for(var r=e[i],n=0;n<this.width;n++)0!==r[n]&&(t+=1);return t/(this.height*this.width)},Rb.prototype.setEvaluation=function(){var t=Math.round(1/this.precision),e=this.matrix[this.costRowIndex][this.rhsColumn];this.evaluation=Math.round(e*t)/t},Rb.prototype.getSolution=function(){var t=!0===this.model.isMinimization?this.evaluation:-this.evaluation;return 0<this.model.getNumberOfIntegerVariables()?new Fb(this,t,this.feasible,this.bounded,this.branchAndCutIterations):new Ob(this,t,this.feasible,this.bounded)},Pb.prototype.simplex=function(){return this.bounded=!0,this.phase1(),!0===this.feasible&&this.phase2(),this},Pb.prototype.phase1=function(){for(var t=this.model.checkForCycles,e=[],i=this.matrix,r=this.rhsColumn,n=this.width-1,o=this.height-1,s=0;;){for(var a=0,u=-this.precision,l=1;l<=o;l++)if(!(!0===this.unrestrictedVars[this.varIndexByRow[l]])){var value=i[l][r];value<u&&(u=value,a=l)}if(0===a)return this.feasible=!0,s;for(var d=0,h=-1/0,c=i[0],f=i[a],g=1;g<=n;g++){var p=f[g];if(!(-this.precision<p&&p<this.precision)&&(!0===this.unrestrictedVars[this.varIndexByCol[g]]||p<-this.precision)){var _=-c[g]/p;h<_&&(h=_,d=g)}}if(0===d)return this.feasible=!1,s;if(t){e.push([this.varIndexByRow[a],this.varIndexByCol[d]]);var v=this.checkForCycles(e);if(0<v.length)throw console.log("Cycle in phase 1"),console.log("Start :",v[0]),console.log("Length :",v[1]),new Error}this.pivot(a,d),s+=1}},Pb.prototype.phase2=function(){for(var t,e,i=this.model.checkForCycles,r=[],n=this.matrix,o=this.rhsColumn,s=this.width-1,a=this.height-1,u=this.precision,l=this.optionalObjectives.length,d=null,h=0;;){var c=n[this.costRowIndex];0<l&&(d=[]);for(var f=0,g=u,p=!1,_=1;_<=s;_++)t=c[_],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],0<l&&-u<t&&t<u?d.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);if(0<l)for(var v=0;0===f&&0<d.length&&v<l;){var m=[],y=this.optionalObjectives[v].reducedCosts;g=u;for(var x=0;x<d.length;x++)t=y[_=d[x]],e=!0===this.unrestrictedVars[this.varIndexByCol[_]],-u<t&&t<u?m.push(_):e&&t<0?g<-t&&(g=-t,f=_,p=!0):g<t&&(g=t,f=_,p=!1);d=m,v+=1}if(0===f)return this.setEvaluation(),h;for(var b=0,E=1/0,A=(this.varIndexByRow,1);A<=a;A++){var S=n[A],w=S[o],T=S[f];if(!(-u<T&&T<u)){if(0<T&&w<u&&-u<w){E=0,b=A;break}var C=p?-w/T:w/T;u<C&&C<E&&(E=C,b=A)}}if(E===1/0)return this.evaluation=-1/0,this.bounded=!1,this.unboundedVarIndex=this.varIndexByCol[f],h;if(i){r.push([this.varIndexByRow[b],this.varIndexByCol[f]]);var M=this.checkForCycles(r);if(0<M.length)throw console.log("Cycle in phase 2"),console.log("Start :",M[0]),console.log("Length :",M[1]),new Error}this.pivot(b,f,!0),h+=1}};var zb=[];function Bb(t,e,i,r){this.id=t,this.cost=e,this.index=i,this.value=0,this.priority=r}function Ub(t,e,i,r){Bb.call(this,t,e,i,r)}function Vb(t,e){Bb.call(this,t,0,e,0)}function jb(t,e){this.variable=t,this.coefficient=e}function Gb(t,e,i){return 0===i||"required"===i?null:(e=e||1,i=i||1,!1===t.isMinimization&&(e=-e),t.addVariable(e,"r"+t.relaxationIndex++,!1,!1,i))}function Hb(t,e,i,r){this.slack=new Vb("s"+i,i),this.index=i,this.model=r,this.rhs=t,this.isUpperBound=e,this.terms=[],this.termsByVarIndex={},this.relaxation=null}function Wb(t,e){this.upperBound=t,this.lowerBound=e,this.model=t.model,this.rhs=t.rhs,this.relaxation=null}Pb.prototype.pivot=function(t,e){var i=this.matrix,r=i[t][e],n=this.height-1,o=this.width-1,s=this.varIndexByRow[t],a=this.varIndexByCol[e];this.varIndexByRow[t]=a,this.varIndexByCol[e]=s,this.rowByVarIndex[a]=t,this.rowByVarIndex[s]=-1,this.colByVarIndex[a]=-1,this.colByVarIndex[s]=e;for(var u,l,d,h=i[t],c=0,f=0;f<=o;f++)0!==h[f]&&(h[f]/=r,zb[c]=f,c+=1);h[e]=1/r;this.precision;for(var g=0;g<=n;g++){var p=i[g];if(g!==t&&0!==(u=p[e])){for(l=0;l<c;l++)0!==(d=h[f=zb[l]])&&(p[f]=p[f]-u*d);p[e]=-u/r}}var _=this.optionalObjectives.length;if(0<_)for(var v=0;v<_;v+=1){var m=this.optionalObjectives[v].reducedCosts;if(0!==(u=m[e])){for(l=0;l<c;l++)0!==(d=h[f=zb[l]])&&(m[f]=m[f]-u*d);m[e]=-u/r}}},Pb.prototype.checkForCycles=function(t){for(var e=0;e<t.length-1;e++)for(var i=e+1;i<t.length;i++){var r=t[e],n=t[i];if(r[0]===n[0]&&r[1]===n[1]){if(i-e>t.length-i)break;for(var o=!0,s=1;s<i-e;s++){var a=t[e+s],u=t[i+s];if(a[0]!==u[0]||a[1]!==u[1]){o=!1;break}}if(o)return[e,i-e]}}return[]},Vb.prototype.isSlack=Ub.prototype.isInteger=!0,Hb.prototype.addTerm=function(t,e){var i=e.index,r=this.termsByVarIndex[i];if(void 0===r)r=new jb(e,t),this.termsByVarIndex[i]=r,this.terms.push(r),!0===this.isUpperBound&&(t=-t),this.model.updateConstraintCoefficient(this,e,t);else{var n=r.coefficient+t;this.setVariableCoefficient(n,e)}return this},Hb.prototype.removeTerm=function(t){return this},Hb.prototype.setRightHandSide=function(t){if(t!==this.rhs){var e=t-this.rhs;!0===this.isUpperBound&&(e=-e),this.rhs=t,this.model.updateRightHandSide(this,e)}return this},Hb.prototype.setVariableCoefficient=function(t,e){var i=e.index;if(-1!==i){var r=this.termsByVarIndex[i];if(void 0===r)this.addTerm(t,e);else if(t!==r.coefficient){var n=t-r.coefficient;!0===this.isUpperBound&&(n=-n),r.coefficient=t,this.model.updateConstraintCoefficient(this,e,n)}return this}console.warn("[Constraint.setVariableCoefficient] Trying to change coefficient of inexistant variable.")},Hb.prototype.relax=function(t,e){this.relaxation=Gb(this.model,t,e),this._relax(this.relaxation)},Hb.prototype._relax=function(t){null!==t&&(this.isUpperBound?this.setVariableCoefficient(-1,t):this.setVariableCoefficient(1,t))},Wb.prototype.isEquality=!0,Wb.prototype.addTerm=function(t,e){return this.upperBound.addTerm(t,e),this.lowerBound.addTerm(t,e),this},Wb.prototype.removeTerm=function(t){return this.upperBound.removeTerm(t),this.lowerBound.removeTerm(t),this},Wb.prototype.setRightHandSide=function(t){this.upperBound.setRightHandSide(t),this.lowerBound.setRightHandSide(t),this.rhs=t},Wb.prototype.relax=function(t,e){this.relaxation=Gb(this.model,t,e),this.upperBound.relaxation=this.relaxation,this.upperBound._relax(this.relaxation),this.lowerBound.relaxation=this.relaxation,this.lowerBound._relax(this.relaxation)};var qb={Constraint:Hb,Variable:Bb,IntegerVariable:Ub,SlackVariable:Vb,Equality:Wb,Term:jb},Xb=qb.SlackVariable;function Yb(t,value){this.index=t,this.value=value}Pb.prototype.addCutConstraints=function(t){for(var e,i=t.length,r=this.height,n=r+i,o=r;o<n;o+=1)void 0===this.matrix[o]&&(this.matrix[o]=this.matrix[o-1].slice());this.height=n,this.nVars=this.width+this.height-2;for(var s=this.width-1,a=0;a<i;a+=1){var u=t[a],l=r+a,d="min"===u.type?-1:1,h=u.varIndex,c=this.rowByVarIndex[h],f=this.matrix[l];if(-1===c){for(f[this.rhsColumn]=d*u.value,e=1;e<=s;e+=1)f[e]=0;f[this.colByVarIndex[h]]=d}else{var g=this.matrix[c],p=g[this.rhsColumn];for(f[this.rhsColumn]=d*(u.value-p),e=1;e<=s;e+=1)f[e]=-d*g[e]}var _=this.getNewElementIndex();this.varIndexByRow[l]=_,this.rowByVarIndex[_]=l,this.colByVarIndex[_]=-1,this.variablesPerIndex[_]=new Xb("s"+_,_),this.nVars+=1}},Pb.prototype._addLowerBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new Xb("s"+o,o),e[n][this.rhsColumn]=Math.floor(i);for(var s=1;s<this.varIndexByCol.length;s+=1){if(this.variablesPerIndex[this.varIndexByCol[s]].isInteger){var a=e[t][s],u=Math.floor(a)+Math.max(0,a-Math.floor(a)-r)/(1-r);e[n][s]=u}else e[n][s]=Math.min(0,e[t][s]/(1-r))}for(var l=0;l<this.width;l+=1)e[n][l]-=e[t][l];return!0},Pb.prototype._addUpperBoundMIRCut=function(t){if(t===this.costRowIndex)return!1;this.model;var e=this.matrix;if(!this.variablesPerIndex[this.varIndexByRow[t]].isInteger)return!1;var i=e[t][this.rhsColumn],r=i-Math.floor(i);if(r<this.precision||1-this.precision<r)return!1;var n=this.height;e[n]=e[n-1].slice(),this.height+=1,this.nVars+=1;var o=this.getNewElementIndex();this.varIndexByRow[n]=o,this.rowByVarIndex[o]=n,this.colByVarIndex[o]=-1,this.variablesPerIndex[o]=new Xb("s"+o,o),e[n][this.rhsColumn]=-r;for(var s=1;s<this.varIndexByCol.length;s+=1){var a=this.variablesPerIndex[this.varIndexByCol[s]],u=e[t][s],l=u-Math.floor(u);a.isInteger?e[n][s]=l<=r?-l:-(1-l)*r/l:e[n][s]=0<=u?-u:u*r/(1-r)}return!0},Pb.prototype.applyMIRCuts=function(){for(var t=this.height,e=0;e<t;e+=1)this._addUpperBoundMIRCut(e);for(e=0;e<t;e+=1)this._addLowerBoundMIRCut(e)},Pb.prototype._putInBase=function(t){var e=this.rowByVarIndex[t];if(-1===e){for(var i=this.colByVarIndex[t],r=1;r<this.height;r+=1){var n=this.matrix[r][i];if(n<-this.precision||this.precision<n){e=r;break}}this.pivot(e,i)}return e},Pb.prototype._takeOutOfBase=function(t){var e=this.colByVarIndex[t];if(-1===e){for(var i=this.rowByVarIndex[t],r=this.matrix[i],n=1;n<this.height;n+=1){var o=r[n];if(o<-this.precision||this.precision<o){e=n;break}}this.pivot(i,e)}return e},Pb.prototype.updateVariableValues=function(){for(var t=this.variables.length,e=Math.round(1/this.precision),i=0;i<t;i+=1){var r=this.variables[i],n=r.index,o=this.rowByVarIndex[n];if(-1===o)r.value=0;else{var s=this.matrix[o][this.rhsColumn];r.value=Math.round(s*e)/e}}},Pb.prototype.updateRightHandSide=function(t,e){var i=this.height-1,r=this.rowByVarIndex[t.index];if(-1===r){for(var n=this.colByVarIndex[t.index],o=0;o<=i;o+=1){var s=this.matrix[o];s[this.rhsColumn]-=e*s[n]}var a=this.optionalObjectives.length;if(0<a)for(var u=0;u<a;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[this.rhsColumn]-=e*l[n]}}else this.matrix[r][this.rhsColumn]-=e},Pb.prototype.updateConstraintCoefficient=function(t,e,i){if(t.index===e.index)throw new Error("[Tableau.updateConstraintCoefficient] constraint index should not be equal to variable index !");var r=this._putInBase(t.index),n=this.colByVarIndex[e.index];if(-1===n)for(var o=this.rowByVarIndex[e.index],s=0;s<this.width;s+=1)this.matrix[r][s]+=i*this.matrix[o][s];else this.matrix[r][n]-=i},Pb.prototype.updateCost=function(t,e){var i=t.index,r=this.width-1,n=this.colByVarIndex[i];if(-1===n){var o,s=this.matrix[this.rowByVarIndex[i]];if(0===t.priority){var a=this.matrix[0];for(o=0;o<=r;o+=1)a[o]+=e*s[o]}else{var u=this.objectivesByPriority[t.priority].reducedCosts;for(o=0;o<=r;o+=1)u[o]+=e*s[o]}}else this.matrix[0][n]-=e},Pb.prototype.addConstraint=function(t){var e=t.isUpperBound?1:-1,i=this.height,r=this.matrix[i];void 0===r&&(r=this.matrix[0].slice(),this.matrix[i]=r);for(var n=this.width-1,o=0;o<=n;o+=1)r[o]=0;r[this.rhsColumn]=e*t.rhs;for(var s=t.terms,a=s.length,u=0;u<a;u+=1){var l=s[u],d=l.coefficient,h=l.variable.index,c=this.rowByVarIndex[h];if(-1===c)r[this.colByVarIndex[h]]+=e*d;else{var f=this.matrix[c];f[this.rhsColumn];for(o=0;o<=n;o+=1)r[o]-=e*d*f[o]}}var g=t.index;this.varIndexByRow[i]=g,this.rowByVarIndex[g]=i,this.colByVarIndex[g]=-1,this.height+=1},Pb.prototype.removeConstraint=function(t){var e=t.index,i=this.height-1,r=this._putInBase(e),n=this.matrix[i];this.matrix[i]=this.matrix[r],this.matrix[r]=n,this.varIndexByRow[r]=this.varIndexByRow[i],this.varIndexByRow[i]=-1,this.rowByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.slack.index=-1,--this.height},Pb.prototype.addVariable=function(t){var e=this.height-1,i=this.width,r=!0===this.model.isMinimization?-t.cost:t.cost,n=t.priority,o=this.optionalObjectives.length;if(0<o)for(var s=0;s<o;s+=1)this.optionalObjectives[s].reducedCosts[i]=0;0===n?this.matrix[0][i]=r:(this.setOptionalObjective(n,i,r),this.matrix[0][i]=0);for(var a=1;a<=e;a+=1)this.matrix[a][i]=0;var u=t.index;this.varIndexByCol[i]=u,this.rowByVarIndex[u]=-1,this.colByVarIndex[u]=i,this.width+=1},Pb.prototype.removeVariable=function(t){var e=t.index,i=this._takeOutOfBase(e),r=this.width-1;if(i!==r){for(var n=this.height-1,o=0;o<=n;o+=1){var s=this.matrix[o];s[i]=s[r]}var a=this.optionalObjectives.length;if(0<a)for(var u=0;u<a;u+=1){var l=this.optionalObjectives[u].reducedCosts;l[i]=l[r]}var d=this.varIndexByCol[r];this.varIndexByCol[i]=d,this.colByVarIndex[d]=i}this.varIndexByCol[r]=-1,this.colByVarIndex[e]=-1,this.availableIndexes[this.availableIndexes.length]=e,t.index=-1,--this.width},Pb.prototype.log=function(t,force){console.log("****",t,"****"),console.log("Nb Variables",this.width-1),console.log("Nb Constraints",this.height-1),console.log("Basic Indexes",this.varIndexByRow),console.log("Non Basic Indexes",this.varIndexByCol),console.log("Rows",this.rowByVarIndex),console.log("Cols",this.colByVarIndex);var e,i,r,n,o,s,a,u,l,d,h="",c=[" "];for(i=1;i<this.width;i+=1)o=this.varIndexByCol[i],a=" ",u="\t",5<(s=void 0===(n=this.variablesPerIndex[o])?"c"+o:n.id).length?a+=" ":u+="\t",c[i]=a,h+=u+s;console.log(h);var f=this.matrix[this.costRowIndex],g="\t";for(e=1;e<this.width;e+=1)g+="\t",g+=c[e],g+=f[e].toFixed(5);for(g+="\t"+c[0]+f[0].toFixed(5),console.log(g+"\tZ"),r=1;r<this.height;r+=1){for(l=this.matrix[r],d="\t",i=1;i<this.width;i+=1)d+="\t"+c[i]+l[i].toFixed(5);d+="\t"+c[0]+l[0].toFixed(5),o=this.varIndexByRow[r],s=void 0===(n=this.variablesPerIndex[o])?"c"+o:n.id,console.log(d+"\t"+s)}console.log("");var p=this.optionalObjectives.length;if(0<p){console.log("    Optional objectives:");for(var _=0;_<p;_+=1){var v=this.optionalObjectives[_].reducedCosts,m="";for(e=1;e<this.width;e+=1)m+=v[e]<0?"":" ",m+=c[e],m+=v[e].toFixed(5);m+=(v[0]<0?"":" ")+c[0]+v[0].toFixed(5),console.log(m+" z"+_)}}return console.log("Feasible?",this.feasible),console.log("evaluation",this.evaluation),this},Pb.prototype.copy=function(){var t=new Pb(this.precision);t.width=this.width,t.height=this.height,t.nVars=this.nVars,t.model=this.model,t.variables=this.variables,t.variablesPerIndex=this.variablesPerIndex,t.unrestrictedVars=this.unrestrictedVars,t.lastElementIndex=this.lastElementIndex,t.varIndexByRow=this.varIndexByRow.slice(),t.varIndexByCol=this.varIndexByCol.slice(),t.rowByVarIndex=this.rowByVarIndex.slice(),t.colByVarIndex=this.colByVarIndex.slice(),t.availableIndexes=this.availableIndexes.slice();for(var e=[],i=0;i<this.optionalObjectives.length;i++)e[i]=this.optionalObjectives[i].copy();t.optionalObjectives=e;for(var r=this.matrix,n=new Array(this.height),o=0;o<this.height;o++)n[o]=r[o].slice();return t.matrix=n,t},Pb.prototype.save=function(){this.savedState=this.copy()},Pb.prototype.restore=function(){if(null!==this.savedState){var t,e,i=this.savedState,r=i.matrix;for(this.nVars=i.nVars,this.model=i.model,this.variables=i.variables,this.variablesPerIndex=i.variablesPerIndex,this.unrestrictedVars=i.unrestrictedVars,this.lastElementIndex=i.lastElementIndex,this.width=i.width,this.height=i.height,t=0;t<this.height;t+=1){var n=r[t],o=this.matrix[t];for(e=0;e<this.width;e+=1)o[e]=n[e]}var s=i.varIndexByRow;for(e=0;e<this.height;e+=1)this.varIndexByRow[e]=s[e];for(;this.varIndexByRow.length>this.height;)this.varIndexByRow.pop();var a=i.varIndexByCol;for(t=0;t<this.width;t+=1)this.varIndexByCol[t]=a[t];for(;this.varIndexByCol.length>this.width;)this.varIndexByCol.pop();for(var u=i.rowByVarIndex,l=i.colByVarIndex,d=0;d<this.nVars;d+=1)this.rowByVarIndex[d]=u[d],this.colByVarIndex[d]=l[d];if(0<i.optionalObjectives.length&&0<this.optionalObjectives.length){this.optionalObjectives=[],this.optionalObjectivePerPriority={};for(var h=0;h<i.optionalObjectives.length;h++){var c=i.optionalObjectives[h].copy();this.optionalObjectives[h]=c,this.optionalObjectivePerPriority[c.priority]=c}}}},Pb.prototype.getMostFractionalVar=function(){for(var t=0,e=null,i=null,r=this.model.integerVariables,n=r.length,o=0;o<n;o++){var s=r[o].index,a=this.rowByVarIndex[s];if(-1!==a){var u=this.matrix[a][this.rhsColumn],l=Math.abs(u-Math.round(u));t<l&&(t=l,e=s,i=u)}}return new Yb(e,i)},Pb.prototype.getFractionalVarWithLowestCost=function(){for(var t=1/0,e=null,i=null,r=this.model.integerVariables,n=r.length,o=0;o<n;o++){var s=r[o],a=s.index,u=this.rowByVarIndex[a];if(-1!==u){var l=this.matrix[u][this.rhsColumn];if(Math.abs(l-Math.round(l))>this.precision){var d=s.cost;d<t&&(t=d,e=a,i=l)}}}return new Yb(e,i)},Pb.prototype.countIntegerValues=function(){for(var t=0,e=1;e<this.height;e+=1)if(this.variablesPerIndex[this.varIndexByRow[e]].isInteger){var i=this.matrix[e][this.rhsColumn];(i-=Math.floor(i))<this.precision&&-i<this.precision&&(t+=1)}return t},Pb.prototype.isIntegral=function(){for(var t=this.model.integerVariables,e=t.length,i=0;i<e;i++){var r=this.rowByVarIndex[t[i].index];if(-1!==r){var n=this.matrix[r][this.rhsColumn];if(Math.abs(n-Math.round(n))>this.precision)return!1}}return!0},Pb.prototype.computeFractionalVolume=function(t){for(var e=-1,i=1;i<this.height;i+=1)if(this.variablesPerIndex[this.varIndexByRow[i]].isInteger){var r=this.matrix[i][this.rhsColumn];if(r=Math.abs(r),Math.min(r-Math.floor(r),Math.floor(r+1))<this.precision){if(!t)return 0}else-1===e?e=r:e*=r}return-1===e?0:e};var Zb=Pb;function Kb(t,e,value){this.type=t,this.varIndex=e,this.value=value}function Qb(t,e){this.relaxedEvaluation=t,this.cuts=e}function Jb(t,e){return e.relaxedEvaluation-t.relaxedEvaluation}Pb.prototype.applyCuts=function(t){if(this.restore(),this.addCutConstraints(t),this.simplex(),this.model.useMIRCuts)for(var e=!0;e;){var i=this.computeFractionalVolume(!0);this.applyMIRCuts(),this.simplex(),.9*i<=this.computeFractionalVolume(!0)&&(e=!1)}},Pb.prototype.branchAndCut=function(){for(var t=[],e=0,i=1/0,r=null,n=[],o=0;o<this.optionalObjectives.length;o+=1)n.push(1/0);var s=new Qb(-1/0,[]);for(t.push(s);0<t.length;)if(!((s=t.pop()).relaxedEvaluation>i)){var a=s.cuts;if(this.applyCuts(a),e++,!1!==this.feasible){var u=this.evaluation;if(!(i<u)){if(u===i){for(var l=!0,d=0;d<this.optionalObjectives.length&&!(this.optionalObjectives[d].reducedCosts[0]>n[d]);d+=1)if(this.optionalObjectives[d].reducedCosts[0]<n[d]){l=!1;break}if(l)continue}if(!0===this.isIntegral()){if(1===e)return void(this.branchAndCutIterations=e);r=s,i=u;for(var h=0;h<this.optionalObjectives.length;h+=1)n[h]=this.optionalObjectives[h].reducedCosts[0]}else{1===e&&this.save();for(var c=this.getMostFractionalVar(),f=c.index,g=[],p=[],_=a.length,v=0;v<_;v+=1){var m=a[v];m.varIndex===f?"min"===m.type?p.push(m):g.push(m):(g.push(m),p.push(m))}var y=Math.ceil(c.value),x=Math.floor(c.value),b=new Kb("min",f,y);g.push(b);var E=new Kb("max",f,x);p.push(E),t.push(new Qb(u,g)),t.push(new Qb(u,p)),t.sort(Jb)}}}}null!==r&&this.applyCuts(r.cuts),this.branchAndCutIterations=e};var $b={},tE=qb.Constraint,eE=qb.Equality,iE=qb.Variable,rE=qb.IntegerVariable;function nE(t,e){this.tableau=new Pb(t),this.name=e,this.variables=[],this.integerVariables=[],this.unrestrictedVariables={},this.constraints=[],this.nConstraints=0,this.nVariables=0,this.isMinimization=!0,this.tableauInitialized=!1,this.relaxationIndex=1,this.useMIRCuts=!0,this.checkForCycles=!1}var oE=nE;nE.prototype.minimize=function(){return this.isMinimization=!0,this},nE.prototype.maximize=function(){return this.isMinimization=!1,this},nE.prototype._getNewElementIndex=function(){if(0<this.availableIndexes.length)return this.availableIndexes.pop();var t=this.lastElementIndex;return this.lastElementIndex+=1,t},nE.prototype._addConstraint=function(t){var e=t.slack;this.tableau.variablesPerIndex[e.index]=e,this.constraints.push(t),this.nConstraints+=1,!0===this.tableauInitialized&&this.tableau.addConstraint(t)},nE.prototype.smallerThan=function(t){var e=new tE(t,!0,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},nE.prototype.greaterThan=function(t){var e=new tE(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(e),e},nE.prototype.equal=function(t){var e=new tE(t,!0,this.tableau.getNewElementIndex(),this);this._addConstraint(e);var i=new tE(t,!1,this.tableau.getNewElementIndex(),this);return this._addConstraint(i),new eE(e,i)},nE.prototype.addVariable=function(t,e,i,r,n){if("string"==typeof n)switch(n){case"required":n=0;break;case"strong":n=1;break;case"medium":n=2;break;case"weak":n=3;break;default:n=0}var o,s=this.tableau.getNewElementIndex();return null==e&&(e="v"+s),null==t&&(t=0),null==n&&(n=0),i?(o=new rE(e,t,s,n),this.integerVariables.push(o)):o=new iE(e,t,s,n),this.variables.push(o),this.tableau.variablesPerIndex[s]=o,r&&(this.unrestrictedVariables[s]=!0),this.nVariables+=1,!0===this.tableauInitialized&&this.tableau.addVariable(o),o},nE.prototype._removeConstraint=function(t){var e=this.constraints.indexOf(t);-1!==e?(this.constraints.splice(e,1),--this.nConstraints,!0===this.tableauInitialized&&this.tableau.removeConstraint(t),t.relaxation&&this.removeVariable(t.relaxation)):console.warn("[Model.removeConstraint] Constraint not present in model")},nE.prototype.removeConstraint=function(t){return t.isEquality?(this._removeConstraint(t.upperBound),this._removeConstraint(t.lowerBound)):this._removeConstraint(t),this},nE.prototype.removeVariable=function(t){var e=this.variables.indexOf(t);if(-1!==e)return this.variables.splice(e,1),!0===this.tableauInitialized&&this.tableau.removeVariable(t),this;console.warn("[Model.removeVariable] Variable not present in model")},nE.prototype.updateRightHandSide=function(t,e){return!0===this.tableauInitialized&&this.tableau.updateRightHandSide(t,e),this},nE.prototype.updateConstraintCoefficient=function(t,e,i){return!0===this.tableauInitialized&&this.tableau.updateConstraintCoefficient(t,e,i),this},nE.prototype.setCost=function(t,e){var i=t-e.cost;return!1===this.isMinimization&&(i=-i),e.cost=t,this.tableau.updateCost(e,i),this},nE.prototype.loadJson=function(t){this.isMinimization="max"!==t.opType;for(var e=t.variables,i=t.constraints,r={},n={},o=Object.keys(i),s=o.length,a=0;a<s;a+=1){var u,l,d=o[a],h=i[d],c=h.equal,f=h.weight,g=h.priority,p=void 0!==f||void 0!==g;if(void 0===c){var _=h.min;void 0!==_&&(u=this.greaterThan(_),r[d]=u,p&&u.relax(f,g));var v=h.max;void 0!==v&&(l=this.smallerThan(v),n[d]=l,p&&l.relax(f,g))}else{u=this.greaterThan(c),r[d]=u,l=this.smallerThan(c),n[d]=l;var m=new eE(u,l);p&&m.relax(f,g)}}for(var y=Object.keys(e),x=y.length,b=t.ints||{},E=t.binaries||{},A=t.unrestricted||{},S=t.optimize,w=0;w<x;w+=1){var T=y[w],C=e[T],M=C[S]||0,I=!!E[T],L=!!b[T]||I,N=!!A[T],O=this.addVariable(M,T,L,N);I&&this.smallerThan(1).addTerm(1,O);var k=Object.keys(C);for(a=0;a<k.length;a+=1){var F=k[a];if(F!==S){var R=C[F],P=r[F];void 0!==P&&P.addTerm(R,O);var D=n[F];void 0!==D&&D.addTerm(R,O)}}}return this},nE.prototype.getNumberOfIntegerVariables=function(){return this.integerVariables.length},nE.prototype.solve=function(){return!1===this.tableauInitialized&&(this.tableau.setModel(this),this.tableauInitialized=!0),this.tableau.solve()},nE.prototype.isFeasible=function(){return this.tableau.feasible},nE.prototype.save=function(){return this.tableau.save()},nE.prototype.restore=function(){return this.tableau.restore()},nE.prototype.activateMIRCuts=function(t){this.useMIRCuts=t},nE.prototype.debug=function(t){this.checkForCycles=t},nE.prototype.log=function(t){return this.tableau.log(t)};var sE={CleanObjectiveAttributes:function(t){var e,i,r;if("string"==typeof t.optimize){if(t.constraints[t.optimize]){for(i in e=Math.random(),t.variables)t.variables[i][t.optimize]&&(t.variables[i][e]=t.variables[i][t.optimize]);return t.constraints[e]=t.constraints[t.optimize],delete t.constraints[t.optimize],t}return t}for(r in t.optimize)if(t.constraints[r])if("equal"===t.constraints[r])delete t.optimize[r];else{for(i in e=Math.random(),t.variables)t.variables[i][r]&&(t.variables[i][e]=t.variables[i][r]);t.constraints[e]=t.constraints[r],delete t.constraints[r]}return t}};function aE(t){return(t.length?function(t){var e={is_blank:/^\W{0,}$/,is_objective:/(max|min)(imize){0,}\:/i,is_int:/^(?!\/\*)\W{0,}int/i,is_constraint:/(\>|\<){0,}\=/i,is_unrestricted:/^\S{0,}unrestricted/i,parse_lhs:/(\-|\+){0,1}\s{0,1}\d{0,}\.{0,}\d{0,}\s{0,}[A-Za-z]\S{0,}/gi,parse_rhs:/(\-|\+){0,1}\d{1,}\.{0,}\d{0,}\W{0,}\;{0,1}$/i,parse_dir:/(\>|\<){0,}\=/gi,parse_int:/[^\s|^\,]+/gi,get_num:/(\-|\+){0,1}(\W|^)\d+\.{0,1}\d{0,}/g,get_word:/[A-Za-z].*/},i={opType:"",optimize:"_obj",constraints:{},variables:{}},r={">=":"min","<=":"max","=":"equal"},n="",o=null,s="",a="",u="",l=0;"string"==typeof t&&(t=t.split("\n"));for(var d=0;d<t.length;d++)if(u="__"+d,n=t[d],o=null,e.is_objective.test(n))i.opType=n.match(/(max|min)/gi)[0],(o=n.match(e.parse_lhs).map(function(t){return t.replace(/\s+/,"")}).slice(1)).forEach(function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0].replace(/\;$/,""),i.variables[a]=i.variables[a]||{},i.variables[a]._obj=s});else if(e.is_int.test(n))o=n.match(e.parse_int).slice(1),i.ints=i.ints||{},o.forEach(function(t){t=t.replace(";",""),i.ints[t]=1});else if(e.is_constraint.test(n)){var h=n.indexOf(":");(o=(-1===h?n:n.slice(h+1)).match(e.parse_lhs).map(function(t){return t.replace(/\s+/,"")})).forEach(function(t){s=null===(s=t.match(e.get_num))?"-"===t.substr(0,1)?-1:1:s[0],s=parseFloat(s),a=t.match(e.get_word)[0],i.variables[a]=i.variables[a]||{},i.variables[a][u]=s}),l=parseFloat(n.match(e.parse_rhs)[0]),n=r[n.match(e.parse_dir)[0]],i.constraints[u]=i.constraints[u]||{},i.constraints[u][n]=l}else e.is_unrestricted.test(n)&&(o=n.match(e.parse_int).slice(1),i.unrestricted=i.unrestricted||{},o.forEach(function(t){t=t.replace(";",""),i.unrestricted[t]=1}));return i}:function(t){if(!t)throw new Error("Solver requires a model to operate on");var e="",i={max:"<=",min:">=",equal:"="},r=new RegExp("[^A-Za-z0-9]+","gi");for(var n in e+=t.opType+":",t.variables)t.variables[n][n]=t.variables[n][n]?t.variables[n][n]:1,t.variables[n][t.optimize]&&(e+=" "+t.variables[n][t.optimize]+" "+n.replace(r,"_"));for(n in e+=";\n",t.constraints)for(var o in t.constraints[n]){for(var s in t.variables)t.variables[s][n]&&(e+=" "+t.variables[s][n]+" "+s.replace(r,"_"));e+=" "+i[o]+" "+t.constraints[n][o],e+=";\n"}if(t.ints)for(n in e+="\n\n",t.ints)e+="int "+n.replace(r,"_")+";\n";if(t.unrestricted)for(n in e+="\n\n",t.unrestricted)e+="unrestricted "+n.replace(r,"_")+";\n";return e})(t)}function uE(){this.Model=oE,this.branchAndCut=$b,this.Constraint=lE,this.Variable=dE,this.Numeral=hE,this.Term=cE,this.Tableau=Zb,this.lastSolvedModel=null,this.Solve=function(t,e,i,r){if(r)for(var n in sE)t=sE[n](t);if(!t)throw new Error("Solver requires a model to operate on");t instanceof oE==!1&&(t=new oE(e).loadJson(t));var o=t.solve();if(this.lastSolvedModel=t,o.solutionSet=o.generateSolutionSet(),i)return o;var s={};return s.feasible=o.feasible,s.result=o.evaluation,s.bounded=o.bounded,Object.keys(o.solutionSet).map(function(t){s[t]=o.solutionSet[t]}),s},this.ReformatLP=aE,this.MultiObjective=function(t){return function(t,e){var i,r,n,o,s,a=e.optimize,u=JSON.parse(JSON.stringify(e.optimize)),l=Object.keys(e.optimize),d=0,h={},c="",f={},g=[];for(delete e.optimize,r=0;r<l.length;r++)u[l[r]]=0;for(r=0;r<l.length;r++){for(s in e.optimize=l[r],e.opType=a[l[r]],i=t.Solve(e,void 0,void 0,!0),l)if(!e.variables[l[s]])for(o in i[l[s]]=i[l[s]]?i[l[s]]:0,e.variables)e.variables[o][l[s]]&&i[o]&&(i[l[s]]+=i[o]*e.variables[o][l[s]]);for(c="base",n=0;n<l.length;n++)i[l[n]]?c+="-"+(1e3*i[l[n]]|0)/1e3:c+="-0";if(!h[c]){for(h[c]=1,d++,n=0;n<l.length;n++)i[l[n]]&&(u[l[n]]+=i[l[n]]);delete i.feasible,delete i.result,g.push(i)}}for(r=0;r<l.length;r++)e.constraints[l[r]]={equal:u[l[r]]/d};for(r in e.optimize="cheater-"+Math.random(),e.opType="max",e.variables)e.variables[r].cheater=1;for(r in g)for(o in g[r])f[o]=f[o]||{min:1e99,max:-1e99};for(r in f)for(o in g)g[o][r]?(g[o][r]>f[r].max&&(f[r].max=g[o][r]),g[o][r]<f[r].min&&(f[r].min=g[o][r])):(g[o][r]=0,f[r].min=0);return{midpoint:i=t.Solve(e,void 0,void 0,!0),vertices:g,ranges:f}}(this,t)}}var lE=qb.Constraint,dE=qb.Variable,hE=qb.Numeral,cE=qb.Term;"object"==typeof window&&(window.solver=new uE);var fE=new uE;function gE(t){var r={},e={},n={};t.nodes.forEach(function(i){e[i.id]=1,r[i.id]={opt:i.children.length},i.children.forEach(function(t){var e=i.id+"->"+t.id;n[e]={min:1},r[i.id][e]=-1})}),t.nodes.forEach(function(i){i.children.forEach(function(t){var e=i.id+"->"+t.id;r[t.id].opt--,r[t.id][e]=1})});var i=fE.Solve({optimize:"opt",opType:"max",constraints:n,variables:r,ints:e});return t.nodes.forEach(function(t){t.layer=i[t.id]||0}),t}function pE(t){return t.nodes.forEach(function(t){t.layer=null!=t.data.layer?t.data.layer:t.layer}),t}function _E(t){var u=Object.assign({},{normalization:!0},t),l=gE;return function(t){if(t.nodes.some(function(t){return"layer"in t.data&&t.data.layer<0}))throw new Error("Some nodes have negative layering information");if(!u.normalization&&t.nodes.every(function(t){return"layer"in t.data&&-1<t.data.layer})){var e=[];t.nodes.forEach(function(t){return e[t.data.layer]=1});for(var i=e.findIndex(function(t){return null!=t}),r=0,n=e.slice(i);r<n.length;r+=1){if(null==n[r])throw new Error("The overall layering contains gaps (two non-consecutive layers)")}}t.nodes.some(function(t){return"layer"in t.data&&0===t.data.layer})||pE(l(t));var o,s,a=function(t){if(t.nodes.every(function(t){return t.layer})){var e=1/0;t.nodes.forEach(function(t){e=Math.min(e,t.layer)}),t.nodes.forEach(function(t){t.layer-=e})}return t}(function(t){if(t.nodes.some(function(t){return t.data.sink})){var e=-1/0;t.nodes.forEach(function(t){e=Math.max(e,t.layer)}),t.nodes.forEach(function(t){t.data.sink&&(t.layer=e+1)})}return t}(function(t){var i={};t.nodes.forEach(function(e){i[e.id]=(i[e.id]||[]).concat(e.children),e.children.forEach(function(t){i[t.id]=(i[t.id]||[]).concat([e])})});var e=[];t.nodes.forEach(function(t){0===t.layer&&e.push(t)});var r={},n={};for(t.nodes.forEach(function(t){null!=t.layer&&(n[t.id]=t.layer)});e.length;)for(var o=e.shift().id,s=0,a=i[o];s<a.length;s+=1){var u=a[s];if(!r[u.id]){if(null==n[u.id]){var l=n[o]+1;n[u.id]=l,u.layer=l}r[u.id]=!0,e.push(u)}}return t}(pE(t))));return function(t,e){if(!e.normalization)return;var i=[];t.nodes.forEach(function(t){return i[t.layer]=0});var r=Array.from(i).reduce(function(t,e,i){if(0===i)return t.push(0),t;var r=t[i-1];return null!=e?t.push(r):t.push(r-1),t},[]);t.nodes.forEach(function(t){t.layer+=r[t.layer]})}(a,u),(s=(o=a).nodes.reduce(function(t,e){if(e.data.fixed){if(null==t)return e;if(t.layer>e.layer)return e}return t},null))&&o.nodes.forEach(function(t){t.ref=s.id}),o}}var vE=function(){this.root=null};function mE(t){var e={x:0,y:0};for(var i in t)e.x+=t[i].x||0,e.y+=t[i].y||0;return e.x/=Object.keys(t).length,e.y/=Object.keys(t).length,e}vE.prototype.fit=function(t){var e=t.length?t[0].w:0,i=t.length?t[0].h:0;this.root={x:0,y:0,w:e,h:i};for(var r=0,n=t;r<n.length;r+=1){var o=n[r],s=this.findNode(this.root,o.w,o.h);o.fit=s?this.splitNode(s,o.w,o.h):this.growNode(o.w,o.h)}},vE.prototype.findNode=function(t,e,i){return t.used?this.findNode(t.right,e,i)||this.findNode(t.down,e,i):e<=t.w&&i<=t.h?t:void 0},vE.prototype.splitNode=function(t,e,i){return t.used=!0,t.down={x:t.x,y:t.y+i,w:t.w,h:t.h-i},t.right={x:t.x+e,y:t.y,w:t.w-e,h:i},t},vE.prototype.growNode=function(t,e){var i=t<=this.root.w,r=e<=this.root.h;return r&&this.root.h>=this.root.w+t?this.growRight(t,e):i&&this.root.w>=this.root.h+e?this.growDown(t,e):r?this.growRight(t,e):i?this.growDown(t,e):void 0},vE.prototype.getNewRoot=function(t,e,i,r){return void 0===t&&(t=0),void 0===e&&(e=0),void 0===i&&(i=this.root),void 0===r&&(r=this.root),{used:!0,x:0,y:0,w:this.root.w+t,h:this.root.h+e,right:i,down:r}},vE.prototype.growRight=function(t,e){return this.root=this.getNewRoot(t,0,{x:this.root.w,y:0,w:t,h:this.root.h}),this.grow(t,e)},vE.prototype.growDown=function(t,e){return this.root=this.getNewRoot(0,e,void 0,{x:0,y:this.root.h,w:this.root.w,h:e}),this.grow(t,e)},vE.prototype.grow=function(t,e){var i=this.findNode(this.root,t,e);if(i)return this.splitNode(i,t,e)};var yE={down:function(){},up:function(t){t.y=-t.y},left:function(t){var e=t.x;t.x=-t.y,t.y=e},right:function(t){var e=t.x;t.x=t.y,t.y=-e}};function xE(t,e){return null!=t&&0<t?t:e}var bE=1.2,EE=50;function AE(t,e){void 0===e&&(e={});var i=t.slice().sort(function(t,e){return e.r-t.r}),r=Math.sqrt(i.length),n=Math.floor(r),o=Math.ceil(r);n*o<i.length&&(n<o?n++:o++);var s=bE*i.reduce(function(t,e){var i=e.r;return Math.max(t,2*i)},0),a=Math.max(e.nodesGridSeparation||EE,1),u=s*o+a*(o-1),l=s*n+a*Math.max(n-1,0);return i.forEach(function(t,e){var i=e%o,r=Math.floor(e/o);t.x=u*i/o,t.y=l*r/n}),{w:u,h:l}}function SE(t){if(!t||!t.length)throw Error("Cannot stratify empty data");for(var e=0,i=t;e<i.length;e+=1){var r=i[e];if(null==r)throw Error('Node data is "null"');if(null==r.id)throw Error('Node id contains a "null" value')}for(var n=t.map(function(t){return yb(t.id,t)}),o=n.reduce(function(t,e){if(t[e.id])throw Error("The connected component contains id duplicates: "+e.id);return t[e.id]=e,t},{}),s=yb(),a=0,u=n;a<u.length;a+=1){for(var l=u[a],d=0,h=l.data.parentIds;d<h.length;d+=1){var c=h[d],f=o[c];if(!f)throw Error("The node "+l.id+" has a missing parent id "+c);f.children.push(l)}l.data.parentIds.length||s.children.push(l)}return{nodes:function(t){var e={},i=[].concat(t.children),r=[];for(;i.length;){var n=i.pop();e[n.id]||(r.push(n),e[n.id]=1,i.push.apply(i,n.children))}return r}(s)}}var wE=1,TE=1;function CE(t,e){var i=e.decross,r=e.separation,n=e.coord;(0,e.layering)(t);var o,s,a=t.nodes.reduce(function(n,o){return n[o.layer]=n[o.layer]||[],n[o.layer].push(o),o.children=o.children.map(function(t){if(t.layer===o.layer+1)return t;for(var e=t,i=t.layer-1;i>o.layer;i--){var r=yb(o.id+"->"+t.id+"@"+i);r.children=[e],n[i]=n[i]||[],n[i].push(r),e=r}return e}),n},[]);return s=1===(o=a).length?ME:IE,o.forEach(function(t,e){for(var i=0,r=t;i<r.length;i+=1)r[i].y=s(e,o.length)}),function(t,e){var i=e.coord,r=e.decross,n=e.separation;if(t.every(function(t){return 1===t.length}))return t.forEach(function(t){return t[0].x=TE/2});r(t),i(t,n)}(a,{decross:i,coord:n,separation:r}),t.nodes.forEach(function(t){t.data&&(t.children=t.children.filter(function(t){return t.data}))}),t}function ME(){return wE/2}function IE(t,e){return wE*t/(e-1)}function LE(t){return{id:""+t.id,layer:t.layer,sink:t.sink,radius:t.r,fixed:!1===t.layoutable,parentIds:[],ref:null}}function NE(t,e){void 0===e&&(e={});for(var i=(t.edges||[]).filter(function(t){return t.source!==t.target}),r={},n=0,o=t.nodes;n<o.length;n+=1){var s=o[n];r[s.id]=s}var a=xb(t.nodes,i,r),u=function(t,e,i){void 0===i&&(i={});for(var r=db(e),n=Object.keys(r),o=[];n.length;){var s=lb(n[0],r);o.push(s),n=gb(n,s)}return i.skipSingletons?o:o.concat(fb(t,e,r).map(function(t){return[t.id+""]}))}(t.nodes,a,{skipSingletons:"singleton"===e.packing}),l=a.reduce(function(t,e){return t[e.source]||(t[e.source]=LE(r[e.source])),t[e.target]||(t[e.target]=LE(r[e.target])),t[e.target].parentIds.push(""+e.source),t},{});return{shapes:u.map(function(t){return t.map(function(t){return l[t]||LE(r[t]||{id:t})})}),nLookup:r}}function OE(t,e){void 0===e&&(e={});for(var i=[],r=0,n=t;r<n.length;r+=1){var o=SE(n[r]);i.push(o),CE(o,{decross:function(i){return i.slice(0,i.length-1).forEach(function(t,e){return bb(t,i[e+1])}),i},separation:hb(cb(o.nodes),e.gapDistance),coord:(e.evenDistribution?Lb:Ib)(),layering:_E(e)})}return i}function kE(t,e){if(!t||!t.nodes)return t;var i,r,n=e||{},o=NE(t,n),s=o.shapes,a=o.nLookup,u=OE(s,n);if("singleton"===n.packing){var l=fb(t.nodes,t.edges),d=AE(l,n);u.push((i=l,r=d,Object.assign({},{nodes:i.map(function(t){return Object.assign({},t,{data:t})}),isFake:!0},r)))}return function(t,p,e){void 0===e&&(e={});for(var _=-1/0,v=-1/0,m=xE(e.nodesSeparation,0),y=xE(e.componentsSeparation,25),x=xE(e.layerSeparation,50),b=[],i=mE(p),r=t.reduce(function(t,e){return e.nodes.filter(function(t){return t.data&&t.data.fixed}).reduce(function(t,e){var i=p[e.id],r=i.x,n=i.y;return t[e.id]={x:r||0,y:n||0},t},t)},{}),n=function(){var t=A[E],i={},e=t.nodes,r=1==e.length,n=2*cb(e)|5,o=e.reduce(function(t,e){var i=e.x;return Math.min(t,i)},1/0);_=e.reduce(function(t,e){var i=e.x;return Math.max(t,i)},-1/0)-o;for(var s=0,a=e;s<a.length;s+=1){var u=a[s],l=u.x,d=u.y,h=u.id;p[h]&&(r?p[h].x=p[h].y=0:(p[h].x=l-o,p[h].y=d,i[d]=i[d]||[],i[d].push(p[h])))}var c=Math.max(n,x),f=Object.keys(i),g=f.reduce(function(t,e){return Math.max(t,i[e].length-1)},1)*(3+Math.max(1,m));v=(f.length||1)*c,_=Math.max(_,1),t.isFake||f.sort(function(t,e){return t-e}).forEach(function(t,e){i[t].forEach(function(t){t.y=e*c,t.x=t.x/_*g})}),b.push({w:Math.ceil(g)+y,h:Math.ceil(v),dag:t}),v=_=-1/0},E=0,A=t;E<A.length;E+=1)n();if(b.sort(function(t,e){return Math.max(e.w,e.h)-Math.max(t.w,t.h)}),"hierarchy"!==e.packing)(new vE).fit(b);else for(var o=0,s=0,a=b;s<a.length;s+=1){var u=a[s];u.fit={x:o,y:0},o+=u.w}for(var l,d,h=b.reduce(function(t,e){var i=e.h;return Math.max(t,i)},1),c=0,f=b;c<f.length;c+=1)for(var g=f[c],S=g.fit,w=g.dag,T=S||{x:0,y:0},C=T.y/h*50+T.y,M=T.x,I=0,L=w.nodes;I<L.length;I+=1){var N=L[I].id;p[N]&&(p[N].x+=M,p[N].y+=C,l=p[N],(d=e.direction)&&d in yE&&yE[d](l))}var O=mE(p),k=O.x-i.x,F=O.y-i.y;for(var R in p)p[R].x-=k,p[R].y-=F;for(var P=0,D=b;P<D.length;P+=1){var z=D[P].dag,B=z.nodes[0]&&z.nodes[0].ref,U=0,V=0;if(B&&(U=p[B].x-r[B].x,V=p[B].y-r[B].y),U||V)for(var j=0,G=z.nodes;j<G.length;j+=1){var H=G[j].id;p[H]&&(p[H].x-=U,p[H].y-=V)}}for(var W=0,q=Object.keys(r);W<q.length;W+=1){var X=q[W];p[X].x=r[X].x,p[X].y=r[X].y}}(u,a,n),t}function FE(t){return I(I(I(I(I(I(I(I(I({},((u=t).modules.layouts.register("concentric",Vx),{concentric:function(t){return u.modules.layouts.start("concentric",t)}})),((a=t).modules.layouts.register("radial",Hx),{radial:function(t){if(void 0===t.centralNode)throw new Error('concentric layout: missing parameter "centralNode"');if(t.maxIterations=t.maxIterations&&isFinite(t.maxIterations)?Math.floor(t.maxIterations):100,t.maxIterations<1)throw new RangeError("maxIterations must be a positive integer");if(t.iterationsPerRender=t.iterationsPerRender&&isFinite(t.iterationsPerRender)?Math.floor(t.iterationsPerRender):20,t.iterationsPerRender<1)throw new RangeError("iterationsPerRender must be a positive integer");if(t.epsilon=t.epsilon&&isFinite(t.epsilon)?t.epsilon:.001,t.epsilon<=0)throw new RangeError("epsilon has to be a positive number");return a.modules.layouts.start("radial",t)}})),((s=t).modules.layouts.register("force",Xx),{force:function(t){if(void 0===t&&(t={}),t.incremental)return sb(t,s,s.layouts.force);if(void 0!==t.edgeStrength&&(!isFinite(t.edgeStrength)||t.edgeStrength<0))throw new Error("force layout: edgeStrength must be a positive number");if(void 0!==t.steps&&(!isFinite(t.steps)||t.steps<=0))throw new Error("force layout: 'steps' must be a positive integer");if(void 0!==t.edgeLength&&(!isFinite(t.edgeLength)||t.edgeLength<=0))throw new Error("force layout: 'edgeLength' must be positive");if(void 0!==t.gravity&&(!isFinite(t.gravity)||t.gravity<0||1<=t.gravity))throw new Error("force layout: 'gravity' must be between 0 and 1");if(void 0!==t.charge&&!isFinite(t.charge))throw new Error("force layout: 'charge' must be a number");if(void 0!==t.radiusRatio&&(!isFinite(t.radiusRatio)||t.radiusRatio<0))throw new Error("force layout: 'radiusRatio' must be a positive number");if(void 0!==t.theta&&(!isFinite(t.theta)||t.theta<0||1<t.theta))throw new Error("force layout: 'theta' must be between 0 and 1");if(!(void 0===t.cx&&void 0===t.cy||"number"==typeof t.cx&&"number"==typeof t.cy))throw new Error("force layout: both 'cx' and 'cy' must be numbers");if(void 0!==t.siblingsOffset&&!isFinite(t.siblingsOffset))throw new Error("force layout: 'siblingsOffset' must be a number");return s.modules.layouts.start("force",t)}})),((o=t).modules.layouts.register("forceLink",ab),{forceLink:function(t){return void 0===t&&(t={}),t.incremental?sb(t,o,o.layouts.forceLink):o.modules.layouts.start("forceLink",t)}})),((n=t).modules.layouts.register("hierarchical",PE),{hierarchical:function(t){return void 0===t&&(t={}),t.useWebWorker=!1,n.modules.layouts.start("hierarchical",t)}})),((r=t).modules.layouts.register("sequential",PE),{sequential:function(t){void 0===t&&(t={}),t.useWebWorker=!1;var e=I(I({},t),{evenDistribution:!0});return r.modules.layouts.start("sequential",e)}})),((e=t).modules.layouts.register("grid",DE),{grid:function(t){return void 0===t&&(t={}),e.modules.layouts.start("grid",t)}})),(i=t,{incremental:function(t){Ci("Incremental ForceLink layout is now deprecated.\n    Please use the incremental option in force and forceLink layouts.");var e=t.centralNode;if("margin"in t&&(null==t.margin||!isFinite(t.margin)))throw new Error("Incremental ForceLink layout: margin has to be a positive number");return e&&!e.getAttribute("layoutable")?ob(i,t,i.layouts.forceLink):nb(i,fg(i.modules.graph,t),i.layouts.forceLink)}})),{stop:function(){return t.modules.layouts.stop()}});var i,e,r,n,o,s,a,u}var RE={direction:"TB",nodeDistance:50,levelDistance:50,componentDistance:50,gapWidth:1,arrangeComponents:"fit",gridDistance:50,layer:"layer"},PE={imports:{sequential:kE},configure:function(t,e){var i=e.graph,r=e.data;function n(t,e,i){return void 0===i&&(i=t.getNodes()),e?e instanceof mr?e:t.getNodes(e):i}var o=I(I(I({},RE),t),{nodeList:t.nodes});o.direction=t.direction||o.rankdir||RE.direction,o.layerSeparation=o.levelDistance,o.nodesSeparation=o.nodeDistance,o.componentsSeparation=o.componentDistance,o.gapDistance=o.gapWidth,o.packing=o.arrangeComponents;var s=I({},o),a=o.edges,u=o.nodeList;if(-1===["TB","BT","LR","RL"].indexOf(o.direction))throw new Error('direction should be one of the "TB", "BT", "LR", "RL"');if(-1===["fit","grid","singleLine"].indexOf(o.packing))throw new Error('arrangeComponents should be one of the "fit", "grid", "singleLine"');o.nodesGridSeparation=t.gridDistance||RE.gridDistance;var l=u.getId(),d=u.getAttribute("layoutable").reduce(function(t,value,e){return t[l[e]]=value,t},{}),h=u.getAttributes(["x","y"]).reduce(function(t,value,e){return t[l[e]]=value,t},{}),c=u.getAttribute("radius");if("string"!=typeof s.layer)throw new Error("'layer' should be the valid data field name");for(var f=n(i,o.roots,i.nodeList()),g=r.getProperty(o.nodeList,s.layer),p=0,_=f.map(function(i){var r=-1;return o.nodeList.forEach(function(t,e){t===i&&(r=e)}),r});p<_.length;p++){g[_[p]]=0}var v=n(i,o.sinks,i.nodeList()).toArray().reduce(function(t,e){return t[e.getId()]=!0,t},{}),m=l.map(function(t){return v[t]});return{nodes:l,edges:a.map(function(t){return{id:t.getId(),source:t.getSource().getId(),target:t.getTarget().getId()}}),options:Q(o),layoutable:d,radiuses:c,layers:g,sinks:m,coords:h}},context:function(){},update:function(t){var e=t.nodes,i=t.edges,r=t.options,n=t.layoutable,o=t.radiuses,s=t.layers,a=t.sinks,u=t.coords,l=i.filter(function(t){var e=t.source,i=t.target;return e in n&&i in n});return{positions:kE({nodes:e.map(function(t,e){return{id:t,r:o[e],layer:s[e],sink:a[e],layoutable:n[t],x:u[t].x,y:u[t].y}}),edges:l},{packing:{fit:"rect",singleLine:"hierarchy",grid:"singleton"}[r.arrangeComponents],direction:{TB:"down",BT:"up",RL:"left",LR:"right"}[r.direction],layerSeparation:r.layerSeparation,nodesSeparation:r.nodesSeparation,componentsSeparation:r.componentsSeparation,gapDistance:r.gapWidth,nodesGridSeparation:r.nodesGridSeparation,evenDistribution:r.evenDistribution}).nodes}},isRunning:function(){return!1},onSync:function(t,e){var i=t.positions,r=e.graph;return{indexes:i.map(function(t){var e=t.id;return(r.getNode(e)||{_index:-1})._index}),x:i.map(function(t){return t.x}),y:i.map(function(t){return t.y})}}},DE={configure:function(t,e){var i=e.graph,r=e.camera;function n(t){return void 0===t||"number"==typeof t&&isFinite(t)&&0<t}var o,s,a,u,l,d=t.sortBy,h=t,c=h.nodes,f=Array.from(c._indexes),g=f.length,p=function(t,e,i){if(!n(t))throw new TypeError('"rows" should be a positive integer');if(!n(e))throw new TypeError('"cols" should be a positive integer');if(t)return{rows:t,cols:Math.ceil(i/t)};if(e)return{cols:e,rows:Math.ceil(i/e)};var r=Math.ceil(Math.sqrt(i));return{cols:r,rows:Math.ceil(i/r)}}(h.rows,h.cols,g),_=p.rows,v=p.cols,m=(o=d,s=i,a=c,u=f,l=t.sortFallbackValue,"string"!=typeof o?u.map(function(t,e){return e}):"radius"===o?s.getAttribute(!0,"radius").getMultiple(u):"random"===o?u.map(function(){return Math.random()}):a.getData(o).map(function(value){return value||l})),y=c.getAttribute("layoutable"),x=f.reduce(function(t,e,i){return y[i]&&t.push({id:e,attr:m[i]}),t},[]),b=c.getBoundingBox(),E=.65*Math.max(b.maxScaledSize,b.maxFixedSize/r.getZoom()),A=b.minX+E,S=b.maxX-E,w=b.minY+E,T=b.maxY-E;return b.width<E*v*2&&(A=b.cx-E*v+E,S=b.cx+E*v-E),b.height<E*_*2&&(w=b.cy-E*_+E,T=b.cy+E*_-E),{sort:!!d,nodes:x,reverse:!!h.reverse,cols:v,rows:_,minX:A,maxX:S,minY:w,maxY:T}},update:function(t){var e=t.sort,i=t.nodes,r=t.maxX,n=t.minX,o=t.maxY,s=t.minY,a=t.reverse,u=t.rows,l=t.cols;e&&i.sort(function(t,e){var i=t.attr,r=e.attr;return i<r?-1:r<i?1:0}),a&&i.reverse();var d=(r-n)/(l-1),h=(o-s)/(u-1),c=n,f=s;isFinite(d)||(d=0),isFinite(h)||(h=0);var g=0,p=0;return i.forEach(function(t){t.x=c+g*d,t.y=f+p*h,(g+=1)===l&&(p+=1,g=0)}),i},onSync:function(t){return{indexes:t.map(function(t){return t.id}),x:t.map(function(t){return t.x}),y:t.map(function(t){return t.y})}}},zE=(BE.initNamespace=function(t){t.layouts=FE(t)},BE);function BE(){}var UE=(VE.initNamespace=function(t){var i;t.mouse=(i=t,{move:function(t){return i.modules.virtualMouse.move(t)},down:function(t){return i.modules.virtualMouse.down(t)},up:function(t){return i.modules.virtualMouse.up(t)},click:function(t){return i.modules.virtualMouse.click(t)},rightClick:function(t){return i.modules.virtualMouse.rightClick(t)},doubleClick:function(t){return i.modules.virtualMouse.doubleClick(t)},drag:function(t,e){return i.modules.virtualMouse.drag(t,e)},wheel:function(t){return i.modules.virtualMouse.wheel(t)}})},VE);function VE(){}var jE=(GE.initNamespace=function(t){var r;t.pathfinding=(r=t,{astar:function(t,e,i){return void 0===i&&(i={}),r.modules.pathfinding.astar(t,e,i)},dijkstra:function(t,e,i){return void 0===i&&(i={}),r.modules.pathfinding.dijkstra(t,e,i)},dijkstraBig:function(t,e,i){return void 0===i&&(i={}),r.modules.pathfinding.dijkstraBig(t,e,i)}})},GE);function GE(){}var HE=(WE.initNamespace=function(t){var e;t.rules=(e=t,{map:function(t){return e.modules.rules.createMapping(t)},slices:function(t){return e.modules.rules.createSlices(t)},template:function(t){return e.modules.rules.createTemplate(t)}})},WE);function WE(){}var qE=(XE.prototype.clearSelection=function(){return this.modules.selection.clear()},XE.prototype.getSelectedNodes=function(){return this.modules.selection.getSelectedNodes()},XE.prototype.getNonSelectedNodes=function(){return this.modules.selection.getNonSelectedNodes()},XE.prototype.getSelectedEdges=function(){return this.modules.selection.getSelectedEdges()},XE.prototype.getNonSelectedEdges=function(){return this.modules.selection.getNonSelectedEdges()},XE);function XE(){}var YE=(ZE.prototype.setOptions=function(t){return this.modules.settings.update(t)},ZE.prototype.getOptions=function(){return this.modules.settings.get()},ZE);function ZE(){}var KE=(QE.initNamespace=function(t){var n;t.styles=(n=t,{setNodesVisibility:function(value){return n.modules.graphics.setNodesVisibility(value)},setEdgesVisibility:function(value){return n.modules.graphics.setEdgesVisibility(value)},setNodeTextsVisibility:function(value){return n.modules.graphics.setNodeTextsVisibility(value)},setEdgeTextsVisibility:function(value){return n.modules.graphics.setEdgeTextsVisibility(value)},addRule:function(t){return n.modules.styleRules.addRule(t)},getRuleList:function(){return n.modules.styleRules.getRuleList()},addNodeRule:function(t,e){var i,r;return r=1===arguments.length?void(i=t):(i=e,t),n.styles.addRule({nodeAttributes:i,nodeSelector:r})},addEdgeRule:function(t,e){var i,r;return r=1===arguments.length?void(i=t):(i=e,t),n.styles.addRule({edgeAttributes:i,edgeSelector:r})},getNodeRules:function(){return n.styles.getRuleList().filter(function(t){return void 0===t.getDefinition().edgeAttributes})},getEdgeRules:function(){return n.styles.getRuleList().filter(function(t){return void 0===t.getDefinition().nodeAttributes})},createClass:function(t){return n.modules.classes.createClass(t)},getClass:function(t){return n.modules.classes.getClassByName(t)},getClassList:function(){return n.modules.classes.getClassList()},setHoveredNodeAttributes:function(t,e){n.modules.hover.updateNodeAttributes(t,e)},setHoveredEdgeAttributes:function(t,e){n.modules.hover.updateEdgeAttributes(t,e)},setSelectedNodeAttributes:function(t,e){return n.modules.selection.setNodeAttributes(t,e)},setSelectedEdgeAttributes:function(t,e){return n.modules.selection.setEdgeAttributes(t,e)}})},QE);function QE(){}var JE=($E.initNamespace=function(t){var e;t.schema=(e=t,{watchNodeObjectProperty:function(t){return e.modules.watcher.watchNodeObjectProperty(t)},watchEdgeObjectProperty:function(t){return e.modules.watcher.watchEdgeObjectProperty(t)},watchNodeNonObjectProperty:function(t){return e.modules.watcher.watchNodeNonObjectProperty(t)},watchEdgeNonObjectProperty:function(t){return e.modules.watcher.watchEdgeNonObjectProperty(t)}})},$E);function $E(){}function tA(t){return{lasso:{enable:function(t){return l.modules.lasso.enable(t),this},disable:function(){return l.modules.lasso.disable(),this},enabled:function(){return l.modules.lasso.enabled()}},connectNodes:{enable:function(t){return u.modules.connectNodes.enable(t),this},disable:function(){return u.modules.connectNodes.disable(),this},enabled:function(){return u.modules.connectNodes.enabled()}},legend:{enable:function(t){return a.modules.legend.enable(t)},disable:function(){return a.modules.legend.disable()},enabled:function(){return a.modules.legend.enabled()},getOptions:function(){return a.modules.legend.getOptions()}},rectangleSelect:{enable:function(t){s.modules.rectangleSelect.enable(t)},disable:function(){s.modules.rectangleSelect.disable()},enabled:function(){return s.modules.rectangleSelect.enabled()}},resize:{enable:function(t){return o.modules.resizing.enable(t),this},disable:function(){return o.modules.resizing.disable(),this},enabled:function(){return o.modules.resizing.enabled()}},rewire:{enable:function(t){return n.modules.rewiring.enable(t),this},disable:function(){return n.modules.rewiring.disable(),this},enabled:function(){return n.modules.rewiring.enabled()}},snapping:{enable:function(t){return e.modules.snapping.enable(t),this},disable:function(){return e.modules.snapping.disable(),this},enabled:function(){return e.modules.snapping.enabled()}},tooltip:{onNodeHover:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("hover.node",t,e)},onNodeClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.left.node",t,e)},onNodeRightClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.right.node",t,e)},onNodeDoubleClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("doubleClick.left.node",t,e)},onEdgeHover:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("hover.edge",t,e)},onEdgeClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.left.edge",t,e)},onEdgeRightClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.right.edge",t,e)},onEdgeDoubleClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("doubleClick.left.edge",t,e)},onBackgroundClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.left.background",t,e)},onBackgroundRightClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("click.right.background",t,e)},onBackgroundDoubleClick:function(t,e){void 0===e&&(e={}),r.modules.tooltip.setHandler("doubleClick.left.background",t,e)},refresh:function(){return r.modules.tooltip.refresh()},isShown:function(){return r.modules.tooltip.isShown()},hide:function(){r.modules.tooltip.hide()},show:function(t,e){return r.modules.tooltip.show(t,e)}},brand:(i=r=e=n=o=s=a=u=l=t,{set:function(t,e){return i.modules.brand.set(t,e)},remove:function(){i.modules.brand.remove()}})};var i,r,e,n,o,s,a,u,l}var eA=(iA.initNamespace=function(t){t.tools=tA(t)},iA);function iA(){}function rA(t){return!0}function nA(t){return""}function oA(t,e,i){return{}}var sA,aA=(x(uA,sA=qc),uA.prototype._computeNodeGroupId=function(t){if(this._nodeSelector&&this._nodeGroupIdFunction)return this._nodeSelector(t)?this._nodeGroupIdFunction(t):void 0},uA.prototype._computeEdgeGroupId=function(t){if(this._edgeSelector&&this._edgeGroupIdFunction)return this._edgeSelector(t)?this._edgeGroupIdFunction(t):void 0},uA.prototype._addMetaNodes=function(o,t){for(var e=t.getId(),i=o.getNodes().filter(function(t){return null===t.getMetaNode()}),r=new Map,n=0;n<i.size;++n){var s=i.get(n);if(void 0!==(h=this._computeNodeGroupId(s))){var a=r.get(h);a||(a={id:h,nodes:[]},r.set(h,a)),a.nodes.push(s)}}var u=Ao(r),l=u.map(function(t){var e=t.nodes;return o.getNodes(e)}),d=[];for(n=0;n<u.length;++n){var h=u[n].id,c=l[n],f=this._nodeGenerator(c,h,t);void 0===f.id&&(f.id=dA(h,e)),f.position=Jd(c.getPosition()),d.push(f)}return o.addNodes(d.map(function(t){return{id:t.id,attributes:t.position}}),{virtual:!0}).then(function(){var i=o.getNodes(d.map(function(t){return t.id}));i.replaceOriginalAttributes(d.map(function(t){return t.attributes}),["x","y","radius"]);for(var t=i.getData(),e=0;e<t.length;e++){var r=t[e],n=d[e];t[e]=void 0===r?n.data:I(I({},n.data),r)}return i.setData(null,t),i.setVisible(!0),o.modules.grouping.setSubElements(i,l),l.forEach(function(t,e){o.modules.grouping.setMetaElement(t,i.get(e))}),i})},uA.prototype._addMetaEdges=function(o,t){for(var e=t.getId(),i=o.getEdges(),r=new Map,n=o.modules.graphics.getAttributesManager().getUsedEdgeAttributes(),s=0;s<i.size;++s){var a=i.get(s);if(void 0!==(y=this._computeEdgeGroupId(a))){var u=this._edgeSource(a),l=this._edgeTarget(a),d=this._groupEdges?lA(y,u.getId(),l.getId(),this._separateEdgesByDirection):String(a.getId());(m=r.get(d))||(m={id:d,source:u,target:l,edges:[]},r.set(d,m)),m.edges.push(a)}}var h,c,f,g,p=Ao(r),_=p.map(function(t){var e=t.edges;return o.getEdges(e)}),v=[];for(s=0;s<p.length;++s){var m,y=(m=p[s]).id,x=_[s],b=this._groupEdges?this._edgeGenerator(x,y,t):(f=n,g=void 0,{data:(g=x.get(0)).getData(),attributes:g.getAttributes(f)});if(null!=b.id&&(h=o,c=b.id,null!=h.getEdge(c)))throw Error("The id "+b.id+" returned by the edgeGenerator function is not a unique id.");void 0===b.id&&(b.id=dA(y,e)),b.source=m.source.getId(),b.target=m.target.getId(),v.push(b)}return o.addEdges(v.map(function(t){return{id:t.id,source:t.source,target:t.target}}),{virtual:!0}).then(function(){var i=o.getEdges(v.map(function(t){return t.id}));i.replaceOriginalAttributes(v.map(function(t){return t.attributes}));for(var t=i.getData(),e=0;e<t.length;e++){var r=v[e],n=t[e];t[e]=void 0===n?r.data:I(I({},n),r.data)}return i.setData(null,t),i.setVisible(!0),o.modules.grouping.setSubElements(i,_),_.forEach(function(t,e){o.modules.grouping.setMetaElement(t,i.get(e))}),i})},uA);function uA(t){var e=sA.call(this,t)||this;return e._nodeSelector=t.nodeSelector||rA,e._nodeGroupIdFunction=t.nodeGroupIdFunction||nA,e._nodeGenerator=t.nodeGenerator||oA,e._edgeSelector=t.edgeSelector||rA,e._edgeGroupIdFunction=t.edgeGroupIdFunction||nA,e._edgeGenerator=t.edgeGenerator||oA,e._edgeSource=t.edgeSource,e._edgeTarget=t.edgeTarget,e._separateEdgesByDirection=t.separateEdgesByDirection,e._groupSelfLoopEdges=!!t.groupSelfLoopEdges,e._groupEdges=t.groupEdges,e}function lA(t,e,i,r){var n=e,o=i;return!r&&n.toString()>o.toString()&&(n=i,o=e),t+"["+n+"-"+o+"]"}function dA(t,e){return"gen_grp_"+e+"_"+t}var hA,cA=(x(fA,hA=aA),fA.prototype.getName=function(){return Kv.NodeGrouping},fA.prototype.run=function(t){var e,i,u=this,s=t.ogma,r=t.duration,n=t.wrapper,o=t.context,l=s.createNodeList(),d=s.createNodeList(),a=s.createEdgeList(),h=[],c=s.modules.grouping,f=[],g=new Set,p=new Set;return this._addMetaNodes(s,n).then(function(t){return(e=t).setVisible(!1),u._addMetaEdges(s,n)}).then(function(t){return(i=t).setVisible(!1),e.forEach(function(t){var e=t.getSubNodes(),i=t.getPosition(),r=u._showContents(t);if(e){if(r){g.add(t._index);var n=e.getAdjacentEdges({bothExtremities:!0});e.setVisible(!0),n.forEach(function(t){return p.add(t._index)})}else{g.delete(t._index),c.removeVisibleGroup(t),h.push.apply(h,e.getPosition().map(function(t){return t.x-=i.x,t.y-=i.y,t})),l=l.concat(e);for(var o=e.toArray();0!==o.length;){var s=o.pop(),a=s.getSubNodes();a&&c.isVisibleGroup(s)&&(a.setVisible(!1),a.getAdjacentEdges({bothExtremities:!0}).setVisible(!1),o.push.apply(o,a.toArray()))}}d=d.concat(e)}}),a=i.getSubEdges().reduce(function(t,e){var i=e.filter(function(t){if(p.has(t._index))return!1;var e=t.getSource().getMetaNode(),i=t.getTarget().getMetaNode();return!(e&&i&&c.isVisibleGroup(e)&&c.isVisibleGroup(i)&&e===i)});return t.concat(i)},s.createEdgeList()),l.setAttributes(l.getPosition().map(function(t,e){var i=h[e];return t.x-=i.x,t.y-=i.y,t}),r)}).then(function(){l.setVisible(!1),a.setVisible(!1),e.setVisible(!0),i.filter(function(t){return u._groupSelfLoopEdges||t.getSource()!==t.getTarget()}).setVisible(!0)}).then(function(){var o=new Set;e.forEach(function(t){var value,e=g.has(t._index),i=t.getSubNodes();if(i){var r=i.getAdjacentEdges({filter:"all",bothExtremities:!0});if(e){var n=i.reduce(function(t,e){var i=c.getNodeDepth(e);return o.add(e._index),i<t?i:t},0);r.forEach(function(t){return p.add(t._index)}),c.addVisibleGroup(t,-1+n),u._metaNodesIds.has(t.getId())||(u._metaNodesIds.add(t.getId()),f.push(((value=u._onCreated(t,e,i,r))&&"function"===value.then?value:Promise.resolve(value)).then(s.view.afterNextFrame)))}}}),i.forEach(function(t){var e=Math.min(c.getNodeDepth(t.getSource()),c.getNodeDepth(t.getTarget()));t.setAttribute("layer",e)}),a=a.filter(function(t){return!p.has(t._index)}),l=l.filter(function(t){return!o.has(t._index)}),s.modules.graphics.getAttributesManager().update()}).then(function(){return Promise.all(f)}).then(function(){return{metaNodes:e,metaEdges:i,virtualNodes:e,virtualEdges:i,subNodes:d,collapsedSubNodes:l,subEdges:a,offsets:h,invalidMetaNodes:null==o?void 0:o.metaNodes.filter(function(t){return null===t.getSubNodes()}),invalidMetaEdges:null==o?void 0:o.metaEdges.filter(function(t){return null===t.getSubEdges()})}})},fA.prototype.undo=function(t){var e=this,i=t.ogma,r=t.duration,n=t.context,o=n.metaNodes,s=n.metaEdges,a=n.subNodes,u=n.subEdges,l=n.offsets,d=n.collapsedSubNodes,h=i.getNodes(d.getMetaNode()).getPosition(),c=h.map(function(t,e){return i=t,r=l[e],{x:i.x+r.x,y:i.y+r.y};var i,r}),f=i.modules.grouping;return a.setVisible(!0),u.setVisible(!0),f.setMetaElement(a,null),f.setMetaElement(u,null),o.setVisible(!1),s.setVisible(!1),o.forEach(function(t){if(f.isVisibleGroup(t))f.removeVisibleGroup(t);else for(var e=t.getSubNodes().filter(function(t){return f.isVisibleGroup(t)}).toArray();0!==e.length;){var i=e.pop();if(f.isVisibleGroup(i)){var r=i.getSubNodes();r&&(r.setVisible(!0),r.getAdjacentEdges({bothExtremities:!0,filter:"all"}).setVisible(!0),e.push.apply(e,r.toArray()))}}}),f.setSubElements(o,null),f.setSubElements(s,null),f.resetOffsets(),d.setAttributes(h).then(function(){return e._restorePositions?d.setAttributes(c,r):Promise.resolve(d)})},fA.prototype.cleanup=function(t){var e=t.ogma,i=t.context,r=i.metaNodes,n=i.metaEdges,o=i.invalidMetaNodes,s=i.invalidMetaEdges,a=e.modules.graph;o&&(r=r.concat(o)),s&&(n=n.concat(s));var u=Bi(a,r,function(t){return t.isVisible()}),l=Bi(a,n,function(t){return t.isVisible()});return i.metaNodes=i.virtualNodes=u.valid,i.metaEdges=i.virtualEdges=l.valid,Promise.all([function(){return e.modules.grouping.resetOffsets()},e.removeEdges(l.invalid,{virtual:!0}),e.removeNodes(u.invalid,{virtual:!0})]).then(function(){return Promise.resolve()})},fA);function fA(t){var e=void 0===t?{}:t,i=e.selector,r=void 0===i?rA:i,n=e.groupIdFunction,o=void 0===n?nA:n,s=e.nodeGenerator,a=void 0===s?oA:s,u=e.edgeGenerator,l=void 0===u?oA:u,d=e.separateEdgesByDirection,h=void 0!==d&&d,c=e.groupSelfLoopEdges,f=void 0!==c&&c,g=e.groupEdges,p=void 0===g||g,_=e.restorePositions,v=void 0===_||_,m=e.showContents,y=void 0!==m&&m,x=e.onCreated,b=hA.call(this,{nodeSelector:r,nodeGroupIdFunction:o,nodeGenerator:a,edgeSelector:function(t){return!(!t.getSource().getMetaNode()&&!t.getTarget().getMetaNode())},edgeGroupIdFunction:function(){return""},edgeGenerator:l,edgeSource:function(t){return gA(t.getSource())},edgeTarget:function(t){return gA(t.getTarget())},separateEdgesByDirection:h,groupEdges:p,groupSelfLoopEdges:f})||this;return b._metaNodesIds=new Set,b._showContents="function"!=typeof y?function(){return y}:y,b._restorePositions=v,b._onCreated=x||function(t,e,i,r){},b}function gA(t){return t.getMetaNode()||t}var pA,_A=(x(vA,pA=aA),vA.prototype.getName=function(){return Kv.EdgeGrouping},vA.prototype.run=function(t){var e,i,r=t.ogma,n=t.wrapper,o=t.context;return this._addMetaEdges(r,n).then(function(t){return e=t,null!==o&&(e=e.concat(o.metaEdges)),(i=e.getSubEdges().reduce(function(t,value){return t.concat(value)},r.createEdgeList())).setVisible(!1),{metaEdges:e,subEdges:i,virtualNodes:null,virtualEdges:e}})},vA.prototype.undo=function(t){var e=t.ogma,i=t.context,r=i.metaEdges,n=i.subEdges;return e.modules.grouping.setMetaElement(n,null),n.setVisible(!0),r.setVisible(!1),Promise.resolve()},vA.prototype.cleanup=function(t){var e=t.ogma,i=t.context.metaEdges;return e.removeEdges(i.filter(function(t){return!t.isVisible()}),{virtual:!0})},vA);function vA(t){var e=void 0===t?{}:t,i=e.selector,r=void 0===i?rA:i,n=e.groupIdFunction,o=void 0===n?nA:n,s=e.generator,a=void 0===s?oA:s,u=e.separateEdgesByDirection,l=void 0!==u&&u;return pA.call(this,{nodeSelector:null,nodeGroupIdFunction:null,nodeGenerator:null,edgeSelector:r,edgeGroupIdFunction:o,edgeGenerator:a,edgeSource:function(t){return t.getSource()},edgeTarget:function(t){return t.getTarget()},separateEdgesByDirection:l,groupEdges:!0})||this}function mA(t){return null!=t}function yA(t,e){return{source:t.getId(),target:e.getId()}}var xA,bA=(x(EA,xA=qc),EA.prototype.getName=function(){return Kv.NeighborGeneration},EA.prototype.run=function(t){for(var value,u=this,l=t.ogma,e=t.duration,i=t.wrapper.getId(),r=l.getNodes(),n=new Map,o=0;o<r.size;++o){var s=r.get(o),a=(value=this._generateIds(s),((Array.isArray(value)?value:value?[value]:null)||[]).filter(mA));if(a)for(var d=0;d<a.length;++d){var h=a[d];(v=n.get(h))||(v=[],n.set(h,v)),v.push(s)}}var c,f,g=new Array(n.size),p=Eo(n),_=Ao(n).map(function(t){return l.getNodes(t)});for(o=0;o<g.length;++o){h=p[o];var v=_[o],m=this._nodeGenerator(h,v);m.id="_gen_"+i+"_"+h;var y=Jd(v.getPosition());m.attributes=m.attributes||{},m.attributes.x=y.x,m.attributes.y=y.y,g[o]=m}return l.addNodes(g.map(function(t){return{id:t.id,attributes:t.attributes}}),{virtual:!0}).then(function(t){(c=t).replaceOriginalAttributes(g.map(function(t){return t.attributes}),["x","y"]),c.setData(null,g.map(function(t){return t.data}));for(var e=[],i=0;i<t.size;++i)for(var r=t.get(i),n=_[i],o=0;o<n.size;++o){var s=n.get(o),a=u._edgeGenerator(s,r);a.source||a.target||(a.source=s.getId(),a.target=r.getId()),e.push(a)}return l.addEdges(e,{virtual:!0})}).then(function(t){return f=t,c.setVisible(!0),f.setVisible(!0),c.addClass(_i),f.addClass(_i),Promise.all([c.removeClass(_i,e),f.removeClass(_i,e)])}).then(function(){return{virtualNodes:c,virtualEdges:f}})},EA.prototype.undo=function(t){var e=t.context,i=t.duration,r=e.virtualNodes,n=e.virtualEdges;return n&&r?Promise.all([r.addClass(_i,i),n.addClass(_i,i)]).then(function(){r.setVisible(!1),n.setVisible(!1)}):Promise.resolve()},EA.prototype.cleanup=function(t){var e=t.ogma,i=t.context,r=i.virtualEdges,n=i.virtualNodes;if(r&&n){var o=n.filter(function(t){return!t.isVisible()}),s=r.filter(function(t){return!t.isVisible()});e.removeNodes(o,{virtual:!0}),e.removeEdges(s,{virtual:!0})}return Promise.resolve()},EA);function EA(t){var e=xA.call(this)||this,i=t.selector,r=void 0===i?function(){return!0}:i,n=t.neighborIdFunction,o=void 0===n?function(){return null}:n,s=t.nodeGenerator,a=void 0===s?function(){return{}}:s,u=t.edgeGenerator,l=void 0===u?yA:u;return e._generateIds=function(t){return r&&r(t)&&o(t)||null},e._nodeGenerator=a,e._edgeGenerator=l||yA,e}var AA,SA=(x(wA,AA=qc),wA.prototype.run=function(t){for(var e=t.ogma,i=t.duration,r=e.getNodes().filter(this._selector?this._selector:function(t){return!0}),n=[],o=new Map,s=0;s<r.size;++s)for(var a=r.get(s),u=a.getAdjacentEdges(),l=this._dataFunction(a),d=0;d<u.size;++d){var h=u.get(d),c=h.getSource(),f=h.getTarget();if(c!==f&&void 0!==l){var g=c===a?f:c,p=o.get(g);p||(p=[],o.set(g,p)),p.push(l)}n.push(h)}var _=e.getEdges(n),v=e.getNodes(Eo(o)),m=Ao(o),y=v.getData(),x=new Array(v.size);for(s=0;s<x.length;++s){var b=m[s],E=y[s];for(d=0;d<b.length;++d)E=tt(E,b[d]);x[s]=E}return Promise.all([r.addClass(_i,i),_.addClass(_i,i)]).then(function(){return r.setVisible(!1),_.setVisible(!1),v.setData(x),{hiddenNodes:r,hiddenEdges:_,nodesWithDataChange:v,oldDataList:y,virtualNodes:new mr(new Uint32Array,e),virtualEdges:new $i(new Uint32Array,e)}})},wA.prototype.getName=function(){return Kv.NeighborMerging},wA.prototype.undo=function(t){var e=t.duration,i=t.context,r=i.hiddenNodes,n=i.hiddenEdges,o=i.nodesWithDataChange,s=i.oldDataList;return r.setVisible(!0),n.setVisible(!0),r.addClass(_i),n.addClass(_i),Promise.all([r.removeClass(_i,e),n.removeClass(_i,e)]).then(function(){o.setData(s)})},wA);function wA(t){var e=t.selector,i=void 0===e?function(){return!1}:e,r=t.dataFunction,n=void 0===r?function(){}:r,o=AA.call(this)||this;return o._selector=i,o._dataFunction=n,o}function TA(t,e){return t.size===e.size&&0<t.filter(function(t){return e.includes(t)}).size}var CA,MA=(x(IA,CA=qc),IA.prototype.getName=function(){return Kv.NodeCollapsing},IA.prototype.run=function(t){for(var e=this,i=t.ogma,r=t.duration,n=i.getNodes().filter(this._selector),o=n.getAdjacentEdges(),s=[],a=n.map(function(t){return t.getAdjacentNodes().filter(function(t){return!e._selector(t)})}),u=0;u<n.size;u++)for(var l=u;l<n.size;l++){var d=n.get(u),h=n.get(l);if(0<i.modules.graph.getEdgesBetweenTwoNodes(d,h).size&&(a[u].size||a[l].size)&&!TA(a[u],a[l]))throw Error("addNodeCollapsing: invalid connected nodes ["+d.getId()+"] and ["+h.getId()+"] to be collapsed. The addNodeCollapsing function supports only disconnected nodes.")}for(u=0;u<n.size;++u){var c=n.get(u),f=a[u];for(l=0;l<f.size-1;++l){var g=f.get(l),p=i.modules.graph.getEdgesBetweenTwoNodes(c,g);if(g!==c)for(var _=l+1;_<f.size;++_){var v=f.get(_),m=i.modules.graph.getEdgesBetweenTwoNodes(c,v),y=this._edgeGenerator(c,g,v,p,m);if(y)for(var x=N(y),b=0;b<x.length;++b)s.push(LA(i,x[b],b,c,g,v,p,m))}}}return i.addEdges(s,{virtual:!0}).then(function(t){return t.addClass(_i)}).then(function(t){return Promise.all([t.removeClass(_i,r),n.addClass(_i,r),o.addClass(_i,r)])}).then(function(t){var e=t[0];return n.setVisible(!1),o.setVisible(!1),{virtualEdges:e,virtualNodes:null,hiddenNodes:n,hiddenEdges:o}})},IA.prototype.undo=function(t){var e=t.duration,i=t.context,r=t.ogma,n=i.hiddenNodes,o=i.hiddenEdges,s=i.virtualEdges||r.createEdgeList();return n.setVisible(!0),o.setVisible(!0),Promise.all([n.addClass(_i),o.addClass(_i)]).then(function(){return Promise.all([n.removeClass(_i,e),o.removeClass(_i,e),s.addClass(_i,e)])}).then(function(){s.setVisible(!1)})},IA.prototype.cleanup=function(t){var e=t.ogma,i=t.context.virtualEdges||e.createEdgeList();return e.removeEdges(i.filter(function(t){return!t.isVisible()}),{virtual:!0})},IA);function IA(t){var e=t.selector,i=t.edgeGenerator,r=void 0===i?function(){return{}}:i,n=CA.call(this)||this;return n._selector=e||function(t){return!1},n._edgeGenerator=r,n}function LA(t,e,i,r,n,o,s,a){var u=void 0,l=void 0;if(void 0!==e.source&&(u=t.getNode(e.source))!==n&&u!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid source ["+e.source+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(void 0!==e.target&&(l=t.getNode(e.target))!==n&&l!==o)throw new Error(["addNodeCollapsing: edge generator produced RawEdge with invalid target ["+e.target+"]","expected to be ["+n.getId()+"] or ["+o.getId()+"]"].join("; "));if(u&&l&&u===l)throw new Error("addNodeCollapsing: edge generator produced RawEdge with same source and target ["+u.getId()+"]");if(u&&!l)l=u===n?o:n;else if(l&&!u)u=l===n?o:n;else if(!u&&!l){for(var d=!0,h=0;h<s.size;++h){s.get(h).getSource()===n&&(d=!1)}for(h=0;h<a.size;++h){a.get(h).getTarget()===o&&(d=!1)}l=d?(u=o,n):(u=n,o)}return u&&l?I(I({},e),{id:"_gen_"+r.getId()+"_"+u.getId()+"_"+l.getId()+"_"+i,source:u.getId(),target:l.getId()}):{}}var NA,OA=(x(kA,NA=qc),kA.prototype.getName=function(){return Kv.VirtualProperties},kA.prototype.run=function(t){var e=t.ogma,i={nodes:null,edges:null,oldNodesData:null,oldEdgesData:null,virtualEdges:null,virtualNodes:null};return this._nodeDataFunction&&(i.nodes=e.getNodes().filter(this._nodeSelector),i.oldNodesData=FA(i.nodes,this._nodeDataFunction)),this._edgeDataFunction&&(i.edges=e.getEdges().filter(this._edgeSelector),i.oldEdgesData=FA(i.edges,this._edgeDataFunction)),Promise.resolve(i)},kA.prototype.undo=function(t){var e=t.context,i=e.nodes,r=e.oldNodesData,n=e.edges,o=e.oldEdgesData;return i&&i.setData(r),n&&n.setData(o),Promise.resolve()},kA);function kA(t){var e=t.nodeSelector,i=void 0===e?function(){return!0}:e,r=t.edgeSelector,n=void 0===r?function(){return!0}:r,o=t.nodeDataFunction,s=void 0===o?null:o,a=t.edgeDataFunction,u=void 0===a?null:a,l=NA.call(this)||this;return l._nodeSelector=i||function(t){return!0},l._edgeSelector=n||function(t){return!0},l._nodeDataFunction=s,l._edgeDataFunction=u,l}function FA(t,e){for(var i=[],r=0;r<t.size;++r){var n=t.get(r),o=n.getData(),s=tt(o,e(n));i.push(o),n.setData(s)}return i}function RA(t){return I(I(I(I(I(I({},(s=t,{getList:function(){return s.modules.transformations.getList()},clear:function(){return s.modules.transformations.clear()},afterNextUpdate:function(){return s.modules.transformations.whenApplied()}})),(o=t,{addNodeGrouping:function(t){return void 0===t&&(t={}),o.modules.transformations.add(new cA(t),{duration:t.duration,enabled:t.enabled})},addEdgeGrouping:function(t){return void 0===t&&(t={}),o.modules.transformations.add(new _A(t),{duration:t.duration,enabled:t.enabled})}})),(n=t,{addNodeFilter:function(t){return n.modules.filters.addNodeFilter(t)},addEdgeFilter:function(t){return n.modules.filters.addEdgeFilter(t)}})),(r=t,{addNeighborGeneration:function(t){return r.modules.transformations.add(new bA(t),{duration:t.duration,enabled:t.enabled})},addNeighborMerging:function(t){return r.modules.transformations.add(new SA(t),{duration:t.duration,enabled:t.enabled})}})),(i=t,{addNodeCollapsing:function(t){return void 0===t&&(t={}),i.modules.transformations.add(new MA(t),{duration:t.duration,enabled:t.enabled})}})),(e=t,{addVirtualProperties:function(t){return e.modules.transformations.add(new OA(t),{duration:t.duration,enabled:t.enabled})}}));var e,i,r,n,o,s}var PA=(DA.initNamespace=function(t){t.transformations=RA(t)},DA.prototype.addNodeFilter=function(t){return this.modules.filters.addNodeFilter(t)},DA.prototype.addEdgeFilter=function(t){return this.modules.filters.addEdgeFilter(t)},DA.prototype.getNodeFilters=function(){return this.modules.transformations.getList().filter(function(t){return t.getName()===Kv.NodeFilter})},DA.prototype.getEdgeFilters=function(){return this.modules.transformations.getList().filter(function(t){return t.getName()===Kv.EdgeFilter})},DA.prototype.clearNodeFilters=function(){return Promise.all(this.getNodeFilters().map(function(t){return t.destroy()})).then(function(){return Promise.resolve()})},DA.prototype.clearEdgeFilters=function(){return Promise.all(this.getEdgeFilters().map(function(t){return t.destroy()})).then(function(){return Promise.resolve()})},DA);function DA(){}var zA=(BA.initNamespace=function(t){var a,e,i,r,n,o,s,u;t.view=(e=(a=t).modules,i=e.camera,r=e.captor,n=e.dom,o=e.graphics,s=e.locate,u=e.spatial,{setZoom:function(t,e){return i.setZoom(t,e)},zoomIn:function(t,e){return i.zoomIn(t,e)},zoomOut:function(t,e){return i.zoomOut(t,e)},getZoom:function(){return i.getZoom()},setCenter:function(t,e){return i.setCenter(t,e)},move:function(t,e){return i.move(t,e)},getCenter:function(){return i.getCenter()},setAngle:function(t,e){return i.setAngle(t,e)},rotate:function(t,e){return i.rotate(t,e)},getAngle:function(){return i.getAngle()},set:function(t,e){return i.setView(t,e)},get:function(){return i.getView()},graphToScreenCoordinates:function(t){return i.graphToScreenCoordinates(t)},screenToGraphCoordinates:function(t){return i.screenToGraphCoordinates(t)},getImageData:function(){return o.getImageData()},getElementAt:function(t,e){return void 0===e&&(e=!1),e&&(t=a.view.graphToScreenCoordinates(t)),r.getElementAt(t)},getElementsInside:function(t,e,i,r,n){if(void 0===n&&(n=!0),n){var o=a.view.graphToScreenCoordinates({x:t,y:e}),s=a.view.graphToScreenCoordinates({x:i,y:r});return u.queryProjected(o.x,o.y,s.x,s.y)}return u.queryProjected(t,e,i,r)},beforeNextFrame:function(){return n.beforeNextFrame()},afterNextFrame:function(){return n.afterNextFrame()},setFullScreen:function(value){return n.setFullScreen(value)},isFullScreen:function(){return n.isFullScreen()},forceResize:function(){return n.forceResize()},getSize:function(){return n.getDimensions()},setSize:function(t){if(!t||isNaN(t.width)||isNaN(t.height))throw new Error("Size must follow the format { width: number, height: number }");if(t.width<0)throw new Error("width must be positive");if(t.height<0)throw new Error("height must be positive");return n.setDimensions(t),Promise.resolve()},locateGraph:function(t){return s.locateGraph(t)},locateRawGraph:function(t,e){return s.locateRawGraph(t,e)},getGraphBoundingBox:function(){return s.getGraphBoundingBox()}})},BA);function BA(){}function UA(t){return--t*t*t+1}function VA(t,e,i){var r=t-i[0],n=e-i[1];return r*r+n*n}var jA=Object.freeze({__proto__:null,circleCircleIntersection:circleCircleIntersection,circleSortCompare:circleSortCompare,circleContainsPoint:cd,circleContainsCircle:fd,circleIntersectsBox:gd,circleLineIntersection:pd,isPointInLine:cu,twoSegmentsIntersect:function(t,e,i,r,n){if(void 0===n&&(n=!1),n&&(fu(t,i)||fu(t,r)||fu(e,i)||fu(e,r)))return!1;var o=(t.y-i.y)*(r.x-i.x)-(t.x-i.x)*(r.y-i.y),s=(e.x-t.x)*(r.y-i.y)-(e.y-t.y)*(r.x-i.x);if(0==s)return!1;var a=o/s,u=(o=(t.y-i.y)*(e.x-t.x)-(t.x-i.x)*(e.y-t.y))/s;return!(a<=0||1<=a||u<=0||1<=u)},lineAngle:gu,angle:function(t,e,i){var r=gu(t.x,t.y,e.x,e.y)-gu(i.x,i.y,e.x,e.y);return r<0?r+2*Math.PI:r},lineIntersection:function(t,e,i,r,n,o,s,a){var u=(a-o)*(i-t)-(s-n)*(r-e);if(0==u)return null;var l=e-o;return{x:t+(l=((s-n)*l-(a-o)*(t-n))/u)*(i-t),y:e+l*(r-e)}},segmentIntersection:pu,segmentRectangleIntersection:_u,lineLine:vu,lineAABB:mu,distancePointSegment:yu,distToSegmentSquared:xu,getClosestPointOnSegment:bu,getClosestPointOnLine:function(t,e,i,r,n,o){var s=n-i,a=o-r,u=((t-i)*s+(e-r)*a)/(s*s+a*a);return{x:i+s*u,y:r+a*u}},defaultAABB:Ta,rotate:Ca,move:function(t,e,i,r){return void 0===i&&(i=0),void 0===r&&(r={x:0,y:0}),r.x=t.x+i*Math.sin(e),r.y=t.y+i*Math.cos(e),r},distance:distance,squaredDistance:Ma,radiansToDegrees:Ia,degreesToRadians:function(t){return t*Math.PI/180},extendBounds:La,isPointInPolygon:Yd,polygonsIntersect:Qd,computeCentroid:Jd,quadBezierAABB:Tu,cubicBezierAABB:Mu,getSelfLoopControlPoints:ma,getQuadraticCurveControlPoint:va,getPointOnQuadraticCurve:Iu,isPointOnQuadraticCurve:Lu,getPointOnBezierCurve:Nu,isPointOnBezierCurve:Ou,getQuadraticCurveBoundingBox:ku,getBezierCurveBoundingBox:Fu,getAABB:Tp,getOBBPoints:Cp,moveAABB:Mp,padBounds:function(t,e){return La(t,e)},overlapsAABB:function(t,e){return Lp(t[0],t[1],t[2],t[3],e[0],e[1],e[2],e[3])},intersects:Ip,overlaps:Lp});var GA=Object.freeze({__proto__:null,minHeap:minHeap,bellmanFord:bellmanFord,dijkstra:dijkstra,johnson:johnson,largestEmptyCircle:Jx,minDisk:minDisk,removeRadialOverlap:removeRadialOverlap,convexhull:Zx,circlePack:function(t){var I=t.X,L=t.Y,N=t.R,O=t.center,e=t.maxSteps,i=void 0===e?1e3:e,r=t.padding,k=void 0===r?5:r,n=t.epsilon,o=void 0===n?1e-5:n,s=t.damping,F=void 0===s?2:s,R=t.pinned,a=t.indexes,u=t.onUpdate,l=t.pushSmallerOut,P=void 0===l||l,D=a?a.length:I.length,z=a;if(isFinite(R)||(R=-1),void 0===z){z=new Uint32Array(D);for(var d=0;d<D;d++)z[d]=d}else z=a;if(-1!==R)O=[I[R],L[R]];else if(!O){var h=0,c=0;for(d=0;d<D;d++)h+=I[z[d]],c+=L[z[d]];O=[h/D,c/D]}var f=function(t,e){for(var i=1/0,r=-1/0,n=0;n<t.length;n++){var o=t[n],s=e?e[o]:o;i=Math.min(s,i),r=Math.max(s,r)}return{min:i,max:r}}(z,N),B=f.min,U=f.max;function g(t,e){for(var i=0,r=0;r<D-1;r++)for(var n=r+1;n<D;n++)if(r!==n){var o=z[r],s=z[n],a=I[o],u=L[o],l=N[o],d=I[s],h=L[s],c=N[s],f=d-a,g=h-u,p=f*f+g*g;if(p<(E=l+c+k)*E-t){var _=(E-Math.sqrt(p))*e,v=1/p,m=(A=f*v*_)*A+(S=g*v*_)*S;if(s!==R)i+=m*(C=l/B),I[s]+=A*C,L[s]+=S*C;if(o!==R)i+=m*(C=c/B),I[o]-=A*C,L[o]-=S*C}}var y=t*F*(1-e),x=O[0],b=O[1];for(r=0;r<D;r++){if((o=z[r])!==R){var E,A,S,w=I[o],T=L[o],C=(E=N[o])/U,M=P?y*C:y;i+=m=(A=(w-x)*M)*A+(S=(T-b)*M)*S,I[o]-=A,L[o]-=S}}return i}z.sort(function(t,e){return N[e]*VA(I[e],L[e],O)-N[t]*VA(I[t],L[t],O)});var p=0,_=0,v=UA(1/D);for(d=0;d<i&&(p=g(v,UA((d+1)/i)),u&&setTimeout(function(){return u(I,L)}),!(Math.abs(p-_)<o));d++)_=p;return{X:I,Y:L}},Quadtree:Up,weightedStress:weightedStress,distanceStress:distanceStress,constrainedStress:constrainedStress,stressMinimizationStep:stressMinimizationStep,stressMinimizationStepGeneral:function(t,e,i,r,n,o,s,a){s=s||0;var u,l=e,d=i;-1===(n=void 0===n?-1:n)&&(s=0);for(var h=0;h<r;h++){for(var c=a[h],f=0,g=0,p=0,_=e[c],v=i[c],m=0;m<r;m++){var y=a[m],x=0;if(y!==c){var b=0,E=t[c][y]*o,A=1/(E*E);c!==n&&y!==n||(b=A);var S=(1-s)*A+s*b;if(f+=S,0!=A){var w=e[y],T=i[y],C=_-w,M=v-T,I=C*C+M*M;1e-6<I&&(x=1/Math.sqrt(I)),g+=S*(w+E*(_-w)*x),p+=S*(T+E*(v-T)*x)}}}0!==(u=f)&&(l[c]=g/u,d[c]=p/u)}return{x:l,y:d}},detectCyclesUndirected:function(t,e,i,r){void 0===r&&(r=!1);for(var n,o,s,a,u=new Int32Array(t.length),l={},d=0;d<t.length;d++)u[d]=-1,l[t[d]]=d;for(d=0;d<e.length;d++){var h=l[e[d]],c=l[i[d]];if(r&&h===c)return!0;var f=Ff(u,h),g=Ff(u,c);if(f===g)return!0;o=g,0,s=Ff(n=u,f),a=Ff(n,o),n[s]=a}return!1},detectCyclesDirected:Pf,detectCyclesUndirectedDFS:function(t,e,i){for(var r=t.length,n=new Uint8Array(r),o=new Int32Array(r),s={},a=0;a<r;a++)o[s[t[a]]=a]=-1;var u=kf(t,e,i,s,!0);for(a=0;a<e.length;a++){var l=s[e[a]],d=s[i[a]];u[l]=u[l]||[],u[l].push(d)}for(a=0;a<r;a++){if(!n[a]&&Df(a,n,-1,o,u,[],t))return!0}return!1},CyclesFinder:zf}),HA=1,Ogma=function(){function Ogma(t){var e=this;void 0===t&&(t={}),this.node=function(t){return new _r(t,e)},this.edge=function(t){return new Qi(t,e)},this.nodeList=function(t){return new mr(t||new Uint32Array(0),e)},this.edgeList=function(t){return new $i(t||new Uint32Array(0),e)},this._onReady=[],this._init(t)}return Ogma.prototype._init=function(t){var e=this;this._initParameters=t,this._debug=!!t.debug,this._token=HA++,this.modules=new dm(this,t),KE.initNamespace(this),cm.initNamespace(this),Ey.initNamespace(this),Bx.initNamespace(this),By.initNamespace(this),zE.initNamespace(this),Dx.initNamespace(this),PA.initNamespace(this),eA.initNamespace(this),zA.initNamespace(this),UE.initNamespace(this),Em.initNamespace(this),JE.initNamespace(this),HE.initNamespace(this),Vy.initNamespace(this),jE.initNamespace(this),mm.initNamespace(this),this._onReady.forEach(function(t){return t(e)}),this.safelyBindToInstance()},Ogma.prototype.safelyBindToInstance=function(){for(var t=0,e=Object.keys(Ogma.prototype);t<e.length;t++){var i=e[t];"function"==typeof Ogma.prototype[i]&&(this[i]=this[i].bind(this))}},Ogma.prototype.onReady=function(t){this._onReady.push(t)},Ogma.prototype._destroy=function(){if(!this._token)throw new Error('"destroy" called twice on the same instance of Ogma');this._onReady=[],this.modules.destroy(),this.modules=null},Ogma.prototype.destroy=function(){this._destroy()},Ogma.prototype.reset=function(){var t=this._initParameters;this._destroy(),this._init(t)},Ogma.prototype.isDebug=function(){return this._debug},Ogma.libraries=A,Ogma.build={version:"3.0.5",commit:"4d7dddd",date:"Mon Jun 29 2020 17:35:08 GMT+0200 (Central European Summer Time)"},Ogma.geometry=jA,Ogma.algorithms=GA,Ogma.utils=ds,Ogma}(),WA=[cm,gm,_m,mm,xm,Em,Ey,By,Vy,Hy,qy,Dx,Bx,zE,jE,qE,YE,KE,eA,PA,zA,UE,JE,HE];return Object.assign.apply(Object,E([Ogma.prototype],WA.map(function(t){return t.prototype}))),Ogma});
//# sourceMappingURL=ogma.min.js.map
